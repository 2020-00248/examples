(window.webpackJsonpUV=window.webpackJsonpUV||[]).push([[0],{34:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,o=i(36),s=i(3),a=i(4),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=function(t){function e(e){var i=t.call(this,e,!1,!1)||this;return i.allowClose=!0,i.isActive=!1,i.isUnopened=!0,i}return r(e,t),e.prototype.create=function(){var e=this;this.setConfig("dialogue"),t.prototype.create.call(this),this.component.subscribe(s.a.CLOSE_ACTIVE_DIALOGUE,(function(){e.isActive&&e.allowClose&&e.close()})),this.component.subscribe(s.a.ESCAPE,(function(){e.isActive&&e.allowClose&&e.close()})),this.$top=$('<div class="top"></div>'),this.$element.append(this.$top),this.$closeButton=$('<button type="button" class="btn btn-default close" tabindex="0">'+this.content.close+"</button>"),this.$middle=$('<div class="middle"></div>'),this.$element.append(this.$middle),this.$content=$('<div class="content"></div>'),this.$middle.append(this.$content),this.$buttons=$('<div class="buttons"></div>'),this.$middle.append(this.$buttons),this.$bottom=$('<div class="bottom"></div>'),this.$element.append(this.$bottom),this.config.topCloseButtonEnabled?this.$top.append(this.$closeButton):this.$buttons.append(this.$closeButton),this.$closeButton.on("click",(function(t){t.preventDefault(),e.close()})),this.returnFunc=this.close},e.prototype.enableClose=function(){this.allowClose=!0,this.$closeButton.show()},e.prototype.disableClose=function(){this.allowClose=!1,this.$closeButton.hide()},e.prototype.setDockedPosition=function(){var t=Math.floor(this.extension.height()-this.$element.outerHeight(!0)),e=0,i=0,n=0;if(this.$triggerButton){t=this.$triggerButton.offset().top-this.extension.$element.offset().top-this.$element.outerHeight(!0)+4;var o=this.$triggerButton.offset().left-this.extension.$element.offset().left;n=a.h.normalise(o,0,this.extension.width()),e=Math.floor(this.extension.width()*n-this.$element.width()*n)+2,i=Math.floor(this.$element.width()*n)}this.$bottom.css("backgroundPosition",i+"px 0px"),this.$element.css({top:t,left:e})},e.prototype.open=function(t){var e=this;this.$element.attr("aria-hidden","false"),this.$element.show(),t?(this.$triggerButton=$(t),this.$bottom.show()):this.$bottom.hide(),this.isActive=!0,setTimeout((function(){var t=e.$element.find(".default");if(t.length)t.focus();else{var i=e.$element.find("input:visible").first();i.length?i.focus():e.$closeButton.focus()}}),1),this.component.publish(s.a.SHOW_OVERLAY),this.isUnopened&&(this.isUnopened=!1,this.afterFirstOpen()),this.resize()},e.prototype.afterFirstOpen=function(){},e.prototype.close=function(){this.isActive&&(this.$element.attr("aria-hidden","true"),this.$element.hide(),this.isActive=!1,this.component.publish(this.closeCommand),this.component.publish(s.a.HIDE_OVERLAY))},e.prototype.resize=function(){t.prototype.resize.call(this),this.$element.css({top:Math.floor(this.extension.height()/2-this.$element.height()/2),left:Math.floor(this.extension.width()/2-this.$element.width()/2)})},e}(o.a)},36:function(t,e,i){"use strict";var n=i(3),o=i(4),s=function(){function t(t,e,i){this.isResized=!1,this.$element=t,this.fitToParentWidth=e||!1,this.fitToParentHeight=i||!1,this.create()}return t.prototype.create=function(){var t=this;this.component.subscribe(n.a.RESIZE,(function(){t.resize()}))},t.prototype.whenResized=function(t){var e=this;o.a.waitFor((function(){return e.isResized}),t)},t.prototype.resize=function(){var t=this.$element.parent();this.fitToParentWidth&&this.$element.width(t.width()),this.fitToParentHeight&&this.$element.height(t.height()),this.isResized=!0},t}();i.d(e,"a",(function(){return h}));var a,r=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=function(t){function e(e,i,n){return t.call(this,e,i,n)||this}return r(e,t),e.prototype.create=function(){this.component=this.$element.closest(".uv").data("component"),t.prototype.create.call(this),this.extension=this.component.extension,this.config={},this.config.content={},this.config.options={};var e=this;e.modules&&e.modules.length&&(e.modules=e.modules.reverse(),e.modules.forEach((function(t){e.config=$.extend(!0,e.config,e.extension.data.config.modules[t])}))),this.content=this.config.content,this.options=this.config.options},e.prototype.init=function(){},e.prototype.setConfig=function(t){this.modules||(this.modules=[]),this.modules.push(t)},e.prototype.resize=function(){t.prototype.resize.call(this)},e}(s)},43:function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t[t.AUTH_CORS_ERROR=0]="AUTH_CORS_ERROR",t[t.DEGRADED_RESOURCE=1]="DEGRADED_RESOURCE"}(n||(n={}))},45:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,o=i(3),s=i(36),a=i(4),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.create=function(){var e=this;this.setConfig("footerPanel"),t.prototype.create.call(this),this.component.subscribe(o.a.TOGGLE_FULLSCREEN,(function(){e.updateFullScreenButton()})),this.component.subscribe(o.a.METRIC_CHANGED,(function(){e.updateMinimisedButtons(),e.updateMoreInfoButton()})),this.component.subscribe(o.a.SETTINGS_CHANGED,(function(){e.updateDownloadButton()})),this.$options=$('<div class="options"></div>'),this.$element.append(this.$options),this.$feedbackButton=$('\n          <button class="feedback btn imageBtn" title="'+this.content.feedback+'" tabindex="0">\n            <i class="uv-icon uv-icon-feedback" aria-hidden="true"></i>'+this.content.feedback+"\n          </button>\n        "),this.$options.prepend(this.$feedbackButton),this.$openButton=$('\n          <button class="open btn imageBtn" title="'+this.content.open+'" tabindex="0">\n            <i class="uv-icon-open" aria-hidden="true"></i>'+this.content.open+"\n          </button>\n        "),this.$options.prepend(this.$openButton),this.$bookmarkButton=$('\n          <button class="bookmark btn imageBtn" title="'+this.content.bookmark+'" tabindex="0">\n            <i class="uv-icon uv-icon-bookmark" aria-hidden="true"></i>'+this.content.bookmark+"\n          </button>\n        "),this.$options.prepend(this.$bookmarkButton),this.$shareButton=$('\n          <button class="share btn imageBtn" title="'+this.content.share+'" tabindex="0">\n            <i class="uv-icon uv-icon-share" aria-hidden="true"></i>'+this.content.share+"\n          </button>\n        "),this.$options.append(this.$shareButton),this.$embedButton=$('\n          <button class="embed btn imageBtn" title="'+this.content.embed+'" tabindex="0">\n            <i class="uv-icon uv-icon-embed" aria-hidden="true"></i>'+this.content.embed+"\n          </button>\n        "),this.$options.append(this.$embedButton),this.$downloadButton=$('\n          <button class="download btn imageBtn" title="'+this.content.download+'" tabindex="0">\n            <i class="uv-icon uv-icon-download" aria-hidden="true"></i>'+this.content.download+"\n          </button>\n        "),this.$options.prepend(this.$downloadButton),this.$moreInfoButton=$('\n          <button class="moreInfo btn imageBtn" title="'+this.content.moreInfo+'" tabindex="0">\n            <i class="uv-icon uv-icon-more-info" aria-hidden="true"></i>'+this.content.moreInfo+"\n          </button>\n        "),this.$options.prepend(this.$moreInfoButton),this.$fullScreenBtn=$('\n          <button class="fullScreen btn imageBtn" title="'+this.content.fullScreen+'" tabindex="0">\n            <i class="uv-icon uv-icon-fullscreen" aria-hidden="true"></i>'+this.content.fullScreen+"\n          </button>\n        "),this.$options.append(this.$fullScreenBtn),this.$openButton.onPressed((function(){e.component.publish(o.a.OPEN)})),this.$feedbackButton.onPressed((function(){e.component.publish(o.a.FEEDBACK)})),this.$bookmarkButton.onPressed((function(){e.component.publish(o.a.BOOKMARK)})),this.$shareButton.onPressed((function(){e.component.publish(o.a.SHOW_SHARE_DIALOGUE,e.$shareButton)})),this.$embedButton.onPressed((function(){e.component.publish(o.a.SHOW_EMBED_DIALOGUE,e.$embedButton)})),this.$downloadButton.onPressed((function(){e.component.publish(o.a.SHOW_DOWNLOAD_DIALOGUE,e.$downloadButton)})),this.$moreInfoButton.onPressed((function(){e.component.publish(o.a.SHOW_MOREINFO_DIALOGUE,e.$moreInfoButton)})),this.$fullScreenBtn.on("click",(function(t){t.preventDefault(),e.component.publish(o.a.TOGGLE_FULLSCREEN)})),a.b.getBool(this.options.embedEnabled,!0)||this.$embedButton.hide(),this.updateMoreInfoButton(),this.updateOpenButton(),this.updateFeedbackButton(),this.updateBookmarkButton(),this.updateEmbedButton(),this.updateDownloadButton(),this.updateFullScreenButton(),this.updateShareButton(),this.updateMinimisedButtons()},e.prototype.updateMinimisedButtons=function(){a.b.getBool(this.options.minimiseButtons,!1)?this.$options.addClass("minimiseButtons"):this.extension.isDesktopMetric()?this.$options.removeClass("minimiseButtons"):this.$options.addClass("minimiseButtons")},e.prototype.updateMoreInfoButton=function(){!a.b.getBool(this.options.moreInfoEnabled,!1)||this.extension.isDesktopMetric()||this.extension.isCatchAllMetric()?this.$moreInfoButton.hide():this.$moreInfoButton.show()},e.prototype.updateOpenButton=function(){a.b.getBool(this.options.openEnabled,!1)&&a.e.isInIFrame()?this.$openButton.show():this.$openButton.hide()},e.prototype.updateFullScreenButton=function(){a.b.getBool(this.options.fullscreenEnabled,!0)&&a.e.supportsFullscreen()?(this.extension.data.isLightbox&&this.$fullScreenBtn.addClass("lightbox"),this.extension.isFullScreen()?(this.$fullScreenBtn.switchClass("fullScreen","exitFullscreen"),this.$fullScreenBtn.find("i").switchClass("uv-icon-fullscreen","uv-icon-exit-fullscreen"),this.$fullScreenBtn.attr("title",this.content.exitFullScreen),$(this.$fullScreenBtn[0].firstChild.nextSibling.nextSibling).replaceWith(this.content.exitFullScreen)):(this.$fullScreenBtn.switchClass("exitFullscreen","fullScreen"),this.$fullScreenBtn.find("i").switchClass("uv-icon-exit-fullscreen","uv-icon-fullscreen"),this.$fullScreenBtn.attr("title",this.content.fullScreen),$(this.$fullScreenBtn[0].firstChild.nextSibling.nextSibling).replaceWith(this.content.fullScreen))):this.$fullScreenBtn.hide()},e.prototype.updateEmbedButton=function(){this.extension.helper.isUIEnabled("embed")&&a.b.getBool(this.options.embedEnabled,!1)?this.extension.isMobile()||this.$embedButton.show():this.$embedButton.hide()},e.prototype.updateShareButton=function(){this.extension.helper.isUIEnabled("share")&&a.b.getBool(this.options.shareEnabled,!0)?this.$shareButton.show():this.$shareButton.hide()},e.prototype.updateDownloadButton=function(){a.b.getBool(this.options.downloadEnabled,!0)?this.$downloadButton.show():this.$downloadButton.hide()},e.prototype.updateFeedbackButton=function(){a.b.getBool(this.options.feedbackEnabled,!1)?this.$feedbackButton.show():this.$feedbackButton.hide()},e.prototype.updateBookmarkButton=function(){a.b.getBool(this.options.bookmarkEnabled,!1)?this.$bookmarkButton.show():this.$bookmarkButton.hide()},e.prototype.resize=function(){t.prototype.resize.call(this)},e}(s.a)},50:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(){}},53:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,o=i(3),s=i(54),a=i(4),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.create=function(){var e=this;t.prototype.create.call(this),this.$element.width(this.options.panelCollapsedWidth),this.component.subscribe(o.a.TOGGLE_EXPAND_LEFT_PANEL,(function(){e.isFullyExpanded?e.collapseFull():e.expandFull()}))},e.prototype.init=function(){t.prototype.init.call(this),a.b.getBool(this.extension.getSettings().leftPanelOpen,this.options.panelOpen)&&this.toggle(!0)},e.prototype.getTargetWidth=function(){return this.isFullyExpanded||!this.isExpanded?this.options.panelExpandedWidth:this.options.panelCollapsedWidth},e.prototype.getFullTargetWidth=function(){return this.$element.parent().width()},e.prototype.toggleFinish=function(){t.prototype.toggleFinish.call(this),this.isExpanded?this.component.publish(o.a.OPEN_LEFT_PANEL):this.component.publish(o.a.CLOSE_LEFT_PANEL),this.extension.updateSettings({leftPanelOpen:this.isExpanded})},e.prototype.resize=function(){t.prototype.resize.call(this),this.isFullyExpanded&&this.$element.width(this.$element.parent().width())},e}(s.a)},54:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n,o=i(36),s=i(4),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=function(t){function e(e){var i=t.call(this,e,!1,!0)||this;return i.isExpanded=!1,i.isFullyExpanded=!1,i.isUnopened=!0,i.autoToggled=!1,i.expandFullEnabled=!0,i}return a(e,t),e.prototype.create=function(){var e=this;t.prototype.create.call(this),this.$top=$('<div class="top"></div>'),this.$element.append(this.$top),this.$title=$('<div class="title"></div>'),this.$title.prop("title",this.content.title),this.$top.append(this.$title),this.$expandFullButton=$('<a class="expandFullButton" tabindex="0"></a>'),this.$expandFullButton.prop("title",this.content.expandFull),this.$top.append(this.$expandFullButton),s.b.getBool(this.config.options.expandFullEnabled,!0)||this.$expandFullButton.hide(),this.$collapseButton=$('<div class="collapseButton" tabindex="0"></div>'),this.$collapseButton.prop("title",this.content.collapse),this.$top.append(this.$collapseButton),this.$closed=$('<div class="closed"></div>'),this.$element.append(this.$closed),this.$expandButton=$('<a class="expandButton" tabindex="0"></a>'),this.$expandButton.prop("title",this.content.expand),this.$closed.append(this.$expandButton),this.$closedTitle=$('<a class="title"></a>'),this.$closedTitle.prop("title",this.content.title),this.$closed.append(this.$closedTitle),this.$main=$('<div class="main"></div>'),this.$element.append(this.$main),this.$expandButton.onPressed((function(){e.toggle()})),this.$expandFullButton.onPressed((function(){e.expandFull()})),this.$closedTitle.onPressed((function(){e.toggle()})),this.$title.onPressed((function(){e.isFullyExpanded?e.collapseFull():e.toggle()})),this.$collapseButton.onPressed((function(){e.isFullyExpanded?e.collapseFull():e.toggle()})),this.$top.hide(),this.$main.hide()},e.prototype.init=function(){t.prototype.init.call(this)},e.prototype.setTitle=function(t){this.$title.text(t),this.$closedTitle.text(t)},e.prototype.toggle=function(t){var e=this;this.autoToggled=!!t,this.isExpanded&&(this.$top.attr("aria-hidden","true"),this.$main.attr("aria-hidden","true"),this.$closed.attr("aria-hidden","false"),this.$top.hide(),this.$main.hide(),this.$closed.show()),this.$element.stop().animate({width:this.getTargetWidth(),left:this.getTargetLeft()},this.options.panelAnimationDuration,(function(){e.toggled()}))},e.prototype.toggled=function(){this.toggleStart(),this.isExpanded=!this.isExpanded,this.isExpanded&&(this.$top.attr("aria-hidden","false"),this.$main.attr("aria-hidden","false"),this.$closed.attr("aria-hidden","true"),this.$closed.hide(),this.$top.show(),this.$main.show()),this.toggleFinish(),this.isUnopened=!1},e.prototype.expandFull=function(){var t=this;this.isExpanded||this.toggled();var e=this.getFullTargetWidth(),i=this.getFullTargetLeft();this.expandFullStart(),this.$element.stop().animate({width:e,left:i},this.options.panelAnimationDuration,(function(){t.expandFullFinish()}))},e.prototype.collapseFull=function(){var t=this,e=this.getTargetWidth(),i=this.getTargetLeft();this.collapseFullStart(),this.$element.stop().animate({width:e,left:i},this.options.panelAnimationDuration,(function(){t.collapseFullFinish()}))},e.prototype.getTargetWidth=function(){return 0},e.prototype.getTargetLeft=function(){return 0},e.prototype.getFullTargetWidth=function(){return 0},e.prototype.getFullTargetLeft=function(){return 0},e.prototype.toggleStart=function(){},e.prototype.toggleFinish=function(){this.isExpanded&&!this.autoToggled?this.focusCollapseButton():this.focusExpandButton()},e.prototype.expandFullStart=function(){},e.prototype.expandFullFinish=function(){this.isFullyExpanded=!0,this.$expandFullButton.hide(),this.focusCollapseButton()},e.prototype.collapseFullStart=function(){},e.prototype.collapseFullFinish=function(){this.isFullyExpanded=!1,this.expandFullEnabled&&this.$expandFullButton.show(),this.focusExpandFullButton()},e.prototype.focusExpandButton=function(){var t=this;setTimeout((function(){t.$expandButton.focus()}),1)},e.prototype.focusExpandFullButton=function(){var t=this;setTimeout((function(){t.$expandFullButton.focus()}),1)},e.prototype.focusCollapseButton=function(){var t=this;setTimeout((function(){t.$collapseButton.focus()}),1)},e.prototype.resize=function(){t.prototype.resize.call(this),this.$main.height(this.$element.parent().height()-this.$top.outerHeight(!0))},e}(o.a)},55:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n,o=i(3),s=i(36),a=i(0),r=i(4),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),c=function(t){function e(e){var i=t.call(this,e,!0,!0)||this;return i.isCreated=!1,i.isOpen=!1,i}return h(e,t),e.prototype.create=function(){var e=this;t.prototype.create.call(this),this.component.subscribe(o.a.CANVAS_INDEX_CHANGED,(function(t){e.selectIndex(parseInt(t))})),this.component.subscribe(o.a.LOGIN,(function(){e.loadThumbs()})),this.component.subscribe(o.a.CLICKTHROUGH,(function(){e.loadThumbs()})),this.$thumbs=$('<div class="thumbs"></div>'),this.$element.append(this.$thumbs);var i=this.extension.helper.getViewingDirection()||a.f.LEFT_TO_RIGHT;this.$thumbs.addClass(i);var n=this;$.templates({thumbsTemplate:'<div id="thumb{{>index}}" class="{{:~className()}}" data-src="{{>uri}}" data-visible="{{>visible}}" data-index="{{>index}}">                                <div class="wrap" style="height:{{>height + ~extraHeight()}}px"></div>                                <div class="info">                                    <span class="index">{{:#index + 1}}</span>                                    <span class="label" title="{{>label}}">{{>label}}&nbsp;</span>                                    <span class="searchResults" title="{{:~searchResultsTitle()}}">{{>data.searchResults}}</span>                                </div>                             </div>                             {{if ~separator()}}                                  <div class="separator"></div>                              {{/if}}'});var s=this.options.thumbsExtraHeight;$.views.helpers({separator:function(){return!1},extraHeight:function(){return s},className:function(){var t="thumb";0===this.data.index&&(t+=" first"),this.data.uri||(t+=" placeholder");var e=n.extension.helper.getViewingDirection();return!e||e!==a.f.LEFT_TO_RIGHT&&e!==a.f.RIGHT_TO_LEFT?n.extension.helper.isPaged()?t+=" twoCol":t+=" oneCol":t+=" twoCol",t},searchResultsTitle:function(){var t=Number(this.data.data.searchResults);return t?t>1?r.n.format(n.content.searchResults,t.toString()):r.n.format(n.content.searchResult,t.toString()):""}}),this.$element.on("scroll",(function(){e.scrollStop()}),100),this.resize()},e.prototype.databind=function(){this.thumbs&&(this._$thumbsCache=null,this.createThumbs(),this.loadThumbs(0),this.selectIndex(this.extension.helper.canvasIndex))},e.prototype.createThumbs=function(){var t=this;if(this.thumbs){for(var e=[],i=0;i<this.thumbs.length;i++){var n=this.thumbs[i];e.push(n.height)}var s=r.h.median(e);for(i=0;i<this.thumbs.length;i++){(n=this.thumbs[i]).height=s}this.$thumbs.link($.templates.thumbsTemplate,this.thumbs),this.$thumbs.undelegate(".thumb","click"),this.$thumbs.delegate(".thumb","click",(function(e){e.preventDefault();var i=$.view(this).data;t.lastThumbClickedIndex=i.index,t.component.publish(o.a.THUMB_SELECTED,i)})),this.setLabel(),this.isCreated=!0}},e.prototype.scrollStop=function(){var t=1/((this.$thumbs.height()-this.$element.height())/this.$element.scrollTop());t>1&&(t=1);var e=Math.floor((this.thumbs.length-1)*t);this.loadThumbs(e)},e.prototype.loadThumbs=function(t){if(void 0===t&&(t=this.extension.helper.canvasIndex),this.thumbs&&this.thumbs.length){var e,i=this.extension.helper.getCanvasByIndex(t).getContent();if(i.length){var n=i[0].getBody();if(n.length){var o=n[0].getType();o&&(e=o.toString().toLowerCase())}}for(var s=t,a=this.options.thumbsLoadRange,h={start:s>a?s-a:0,end:s<this.thumbs.length-1-a?s+a:this.thumbs.length-1},c=this.options.thumbsImageFadeInDuration,l=h.start;l<=h.end;l++){var u=this.getThumbByIndex(l),p=u.find(".wrap");if(!p.hasClass("loading")&&!p.hasClass("loaded"))if("false"!==u.attr("data-visible")){p.removeClass("loadingFailed"),p.addClass("loading"),e&&p.addClass(e);var d=u.attr("data-src");this.config.options.thumbsCacheInvalidation&&this.config.options.thumbsCacheInvalidation.enabled&&(d+=this.config.options.thumbsCacheInvalidation.paramType+"t="+r.c.getTimeStamp());var f=$('<img src="'+d+'" alt=""/>');f.hide(),f.on("load",(function(){$(this).fadeIn(c,(function(){$(this).parent().switchClass("loading","loaded")}))})),f.on("error",(function(){$(this).parent().switchClass("loading","loadingFailed")})),p.append(f)}else p.addClass("hidden")}}},e.prototype.show=function(){var t=this;this.isOpen=!0,this.$element.show(),setTimeout((function(){t.selectIndex(t.extension.helper.canvasIndex)}),1)},e.prototype.hide=function(){this.isOpen=!1,this.$element.hide()},e.prototype.isPDF=function(){var t=this.extension.helper.getCurrentCanvas().getType();return!!t&&t.toString().includes("pdf")},e.prototype.setLabel=function(){$(this.$thumbs).find("span.index").hide(),$(this.$thumbs).find("span.label").show()},e.prototype.addSelectedClassToThumbs=function(t){this.getThumbByIndex(t).addClass("selected")},e.prototype.selectIndex=function(t){-1!==t&&(this.thumbs&&this.thumbs.length&&(this.getAllThumbs().removeClass("selected"),this.$selectedThumb=this.getThumbByIndex(t),this.addSelectedClassToThumbs(t),~this.extension.getPagedIndices(t).indexOf(this.lastThumbClickedIndex)||this.$element.scrollTop(this.$selectedThumb.position().top),this.loadThumbs(t)))},e.prototype.getAllThumbs=function(){return this._$thumbsCache||(this._$thumbsCache=this.$thumbs.find(".thumb")),this._$thumbsCache},e.prototype.getThumbByIndex=function(t){return this.$thumbs.find('[data-index="'+t+'"]')},e.prototype.scrollToThumb=function(t){var e=this.getThumbByIndex(t);this.$element.scrollTop(e.position().top)},e.prototype.resize=function(){t.prototype.resize.call(this)},e}(s.a)},56:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n,o=i(3),s=i(34),a=i(57),r=i(4),h=i(1),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),l=function(t){function e(e){return t.call(this,e)||this}return c(e,t),e.prototype.create=function(){var e=this;this.setConfig("downloadDialogue"),t.prototype.create.call(this),this.openCommand=o.a.SHOW_DOWNLOAD_DIALOGUE,this.closeCommand=o.a.HIDE_DOWNLOAD_DIALOGUE,this.component.subscribe(this.openCommand,(function(t){e.open(t)})),this.component.subscribe(this.closeCommand,(function(){e.close()})),this.$title=$("<h1>"+this.content.title+"</h1>"),this.$content.append(this.$title),this.$noneAvailable=$('<div class="noneAvailable">'+this.content.noneAvailable+"</div>"),this.$content.append(this.$noneAvailable),this.$downloadOptions=$('<ol class="options"></ol>'),this.$content.append(this.$downloadOptions),this.$footer=$('<div class="footer"></div>'),this.$content.append(this.$footer),this.$termsOfUseButton=$('<a href="#">'+this.extension.data.config.content.termsOfUse+"</a>"),this.$footer.append(this.$termsOfUseButton),this.$termsOfUseButton.onPressed((function(){e.component.publish(o.a.SHOW_TERMS_OF_USE)})),this.$element.hide(),this.updateTermsOfUseButton()},e.prototype.addEntireFileDownloadOptions=function(){if(this.isDownloadOptionAvailable(a.a.ENTIRE_FILE_AS_ORIGINAL)){this.$downloadOptions.empty();for(var t=this.extension.helper.getCurrentCanvas(),e=!1,i=t.getRenderings(),n=0;n<i.length;n++){var o=i[n],s=o.getFormat(),r="";s&&(r=s.toString()),this.addEntireFileDownloadOption(o.id,h.LanguageMap.getValue(o.getLabel()),r),e=!0}if(!e){var c=!1,l=t.getContent();for(n=0;n<l.length;n++){var u=l[n].getBody();if(u.length)(r=u[0].getFormat())&&(this.addEntireFileDownloadOption(u[0].id,"",r.toString()),c=!0)}c||this.addEntireFileDownloadOption(t.id,"","")}}},e.prototype.addEntireFileDownloadOption=function(t,e,i){var n;n=i?r.f.simplifyMimeType(i):this.getFileExtension(t),e||(e=this.content.entireFileAsOriginal),n&&(e+=" ("+n+")"),this.$downloadOptions.append('<li><a href="'+t+'" target="_blank" download tabindex="0">'+e+"</li>")},e.prototype.resetDynamicDownloadOptions=function(){this.renderingUrls=[],this.renderingUrlsCount=0,this.$downloadOptions.find("li.dynamic").remove()},e.prototype.getDownloadOptionsForRenderings=function(t,e,i){for(var n=t.getRenderings(),o=[],s=0;s<n.length;s++){var a=n[s];if(a){var c=h.LanguageMap.getValue(a.getLabel(),this.extension.getLocale()),l="downloadOption"+ ++this.renderingUrlsCount;c?c+=" ({0})":c=e;var u=r.f.simplifyMimeType(a.getFormat().toString());c=r.n.format(c,u),this.renderingUrls[l]=a.id;var p=$('<li class="option dynamic"><input id="'+l+'" data-mime="'+u+'" title="'+c+'" type="radio" name="downloadOptions" tabindex="0" /><label for="'+l+'">'+c+"</label></li>");o.push({type:i,button:p})}}return o},e.prototype.getSelectedOption=function(){return this.$downloadOptions.find("li.option input:checked")},e.prototype.getCurrentResourceId=function(){return this.extension.helper.getCurrentCanvas().externalResource.data.id},e.prototype.getCurrentResourceFormat=function(){var t=this.getCurrentResourceId();return t.substr(t.lastIndexOf(".")+1).toLowerCase()},e.prototype.updateNoneAvailable=function(){this.$downloadOptions.find("li:visible").length?this.$noneAvailable.hide():this.$noneAvailable.show()},e.prototype.updateTermsOfUseButton=function(){var t=this.extension.helper.getRequiredStatement();r.b.getBool(this.extension.data.config.options.termsOfUseEnabled,!1)&&t&&t.value?this.$termsOfUseButton.show():this.$termsOfUseButton.hide()},e.prototype.getFileExtension=function(t){var e=t.split(".").pop();return e.length>5||-1!==e.indexOf("/")?null:e},e.prototype.isMediaDownloadEnabled=function(){return this.extension.helper.isUIEnabled("mediaDownload")},e.prototype.isDownloadOptionAvailable=function(t){switch(t){case a.a.ENTIRE_FILE_AS_ORIGINAL:return this.isMediaDownloadEnabled()}return!0},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.resize=function(){this.setDockedPosition()},e}(s.a)},57:function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t.CANVAS_RENDERINGS="canvasRenderings",t.CURRENT_VIEW="currentView",t.ENTIRE_DOCUMENT_AS_PDF="entireDocumentAsPdf",t.ENTIRE_DOCUMENT_AS_TEXT="entireDocumentAsText",t.ENTIRE_FILE_AS_ORIGINAL="entireFileAsOriginal",t.IMAGE_RENDERINGS="imageRenderings",t.MANIFEST_RENDERINGS="manifestRenderings",t.RANGE_RENDERINGS="rangeRenderings",t.SELECTION="selection",t.UNKNOWN="unknown",t.WHOLE_IMAGE_HIGH_RES="wholeImageHighRes",t.WHOLE_IMAGE_LOW_RES="wholeImageLowRes",t.WHOLE_IMAGES_HIGH_RES="wholeImagesHighRes"}(n||(n={}))},59:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n,o=i(3),s=i(34),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.create=function(){var e=this;this.setConfig("settingsDialogue"),t.prototype.create.call(this),this.openCommand=o.a.SHOW_SETTINGS_DIALOGUE,this.closeCommand=o.a.HIDE_SETTINGS_DIALOGUE,this.component.subscribe(this.openCommand,(function(){e.open()})),this.component.subscribe(this.closeCommand,(function(){e.close()})),this.$title=$("<h1></h1>"),this.$content.append(this.$title),this.$scroll=$('<div class="scroll"></div>'),this.$content.append(this.$scroll),this.$version=$('<div class="version"></div>'),this.$content.append(this.$version),this.$website=$('<div class="website"></div>'),this.$content.append(this.$website),this.$locale=$('<div class="setting locale"></div>'),this.$scroll.append(this.$locale),this.$localeLabel=$('<label for="locale">'+this.content.locale+"</label>"),this.$locale.append(this.$localeLabel),this.$localeDropDown=$('<select id="locale"></select>'),this.$locale.append(this.$localeDropDown),this.$title.text(this.content.title),this.$website.html(this.content.website),this.$website.targetBlank(),this._createLocalesMenu(),this.$element.hide()},e.prototype.getSettings=function(){return this.extension.getSettings()},e.prototype.updateSettings=function(t){this.extension.updateSettings(t),this.component.publish(o.a.UPDATE_SETTINGS,t)},e.prototype.open=function(){var e=this;t.prototype.open.call(this),$.getJSON(this.extension.data.root+"/info.json",(function(t){e.$version.text("v"+t.version)}))},e.prototype._createLocalesMenu=function(){var t=this,e=this.extension.data.locales;if(e&&e.length>1){for(var i=0;i<e.length;i++){var n=e[i];this.$localeDropDown.append('<option value="'+n.name+'">'+n.label+"</option>")}this.$localeDropDown.val(e[0].name)}else this.$locale.hide();this.$localeDropDown.change((function(){t.extension.changeLocale(t.$localeDropDown.val())}))},e.prototype.resize=function(){t.prototype.resize.call(this)},e}(s.a)},60:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n,o=i(3),s=i(34),a=i(4),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=function(t){function e(e){var i=t.call(this,e)||this;return i.aspectRatio=.75,i.isEmbedViewVisible=!1,i.isShareViewVisible=!1,i.maxWidth=8e3,i.maxHeight=i.maxWidth*i.aspectRatio,i.minWidth=200,i.minHeight=i.minWidth*i.aspectRatio,i.shareManifests=!1,i}return r(e,t),e.prototype.create=function(){var e=this;this.setConfig("shareDialogue"),t.prototype.create.call(this),this.openCommand=o.a.SHOW_SHARE_DIALOGUE,this.closeCommand=o.a.HIDE_SHARE_DIALOGUE,this.shareManifests=this.options.shareManifests||!1,this.component.subscribe(this.openCommand,(function(t){e.open(t),e.isShareAvailable()?e.openShareView():e.openEmbedView()})),this.component.subscribe(this.closeCommand,(function(){e.close()})),this.component.subscribe(o.a.SHOW_EMBED_DIALOGUE,(function(t){e.open(t),e.openEmbedView()})),this.$tabs=$('<div class="tabs"></div>'),this.$content.append(this.$tabs),this.$shareButton=$('<a class="share tab default" tabindex="0">'+this.content.share+"</a>"),this.$shareButton.prop("title",this.content.share),this.$tabs.append(this.$shareButton),this.$embedButton=$('<a class="embed tab" tabindex="0">'+this.content.embed+"</a>"),this.$embedButton.prop("title",this.content.embed),this.$tabs.append(this.$embedButton),this.$tabsContent=$('<div class="tabsContent"></div>'),this.$content.append(this.$tabsContent),this.$footer=$('<div class="footer"></div>'),this.$content.append(this.$footer),this.$shareView=$('<div class="shareView view"></div>'),this.$tabsContent.append(this.$shareView),this.$shareHeader=$('<div class="header"></div>'),this.$shareView.append(this.$shareHeader),this.$shareLink=$('<a class="shareLink" onclick="return false;"></a>'),this.$shareView.append(this.$shareLink),this.$shareInput=$('<input class="shareInput" type="text" readonly="readonly" aria-label="'+this.content.shareUrl+'"/>'),this.$shareView.append(this.$shareInput),this.$shareFrame=$('<iframe class="shareFrame"></iframe>'),this.$shareView.append(this.$shareFrame),this.$embedView=$('<div class="embedView view"></div>'),this.$tabsContent.append(this.$embedView),this.$embedHeader=$('<div class="header"></div>'),this.$embedView.append(this.$embedHeader),this.$code=$('<input class="code" type="text" readonly="readonly" aria-label="'+this.content.embed+'"/>'),this.$embedView.append(this.$code),this.$customSize=$('<div class="customSize"></div>'),this.$embedView.append(this.$customSize),this.$size=$('<span class="size">'+this.content.size+"</span>"),this.$customSize.append(this.$size),this.$customSizeDropDown=$('<select id="size" aria-label="'+this.content.size+'"></select>'),this.$customSize.append(this.$customSizeDropDown),this.$customSizeDropDown.append('<option value="small" data-width="560" data-height="420">560 x 420</option>'),this.$customSizeDropDown.append('<option value="medium" data-width="640" data-height="480">640 x 480</option>'),this.$customSizeDropDown.append('<option value="large" data-width="800" data-height="600">800 x 600</option>'),this.$customSizeDropDown.append('<option value="custom">'+this.content.customSize+"</option>"),this.$widthInput=$('<input class="width" type="text" maxlength="10" aria-label="'+this.content.width+'"/>'),this.$customSize.append(this.$widthInput),this.$x=$('<span class="x">x</span>'),this.$customSize.append(this.$x),this.$heightInput=$('<input class="height" type="text" maxlength="10" aria-label="'+this.content.height+'"/>'),this.$customSize.append(this.$heightInput);var i=this.extension.getIIIFShareUrl(this.shareManifests);this.$iiifButton=$('<a class="imageBtn iiif" href="'+i+'" title="'+this.content.iiif+'" target="_blank"></a>'),this.$footer.append(this.$iiifButton),this.$termsOfUseButton=$('<a href="#">'+this.extension.data.config.content.termsOfUse+"</a>"),this.$footer.append(this.$termsOfUseButton),this.$widthInput.on("keydown",(function(t){return a.i.numericalInput(t)})),this.$heightInput.on("keydown",(function(t){return a.i.numericalInput(t)})),this.$shareInput.focus((function(){$(this).select()})),this.$code.focus((function(){$(this).select()})),this.$shareButton.onPressed((function(){e.openShareView()})),this.$embedButton.onPressed((function(){e.openEmbedView()})),this.$customSizeDropDown.change((function(){e.update()})),this.$widthInput.change((function(){e.updateHeightRatio(),e.update()})),this.$heightInput.change((function(){e.updateWidthRatio(),e.update()})),this.$termsOfUseButton.onPressed((function(){e.component.publish(o.a.SHOW_TERMS_OF_USE)})),this.$element.hide(),this.update()},e.prototype.open=function(e){t.prototype.open.call(this,e),this.update()},e.prototype.getShareUrl=function(){return this.extension.getShareUrl()},e.prototype.isShareAvailable=function(){return!!this.getShareUrl()},e.prototype.update=function(){this.isShareAvailable()?this.$shareButton.show():this.$shareButton.hide();var t=this.getSelectedSize();"custom"===t.val()?(this.$widthInput.show(),this.$x.show(),this.$heightInput.show()):(this.$widthInput.hide(),this.$x.hide(),this.$heightInput.hide(),this.currentWidth=Number(t.data("width")),this.currentHeight=Number(t.data("height")),this.$widthInput.val(String(this.currentWidth)),this.$heightInput.val(String(this.currentHeight))),this.updateInstructions(),this.updateShareOptions(),this.updateShareFrame(),this.updateTermsOfUseButton()},e.prototype.updateShareOptions=function(){var t=this.getShareUrl();t&&(this.$shareInput.val(t),this.$shareLink.prop("href",t),this.$shareLink.text(t)),this.extension.isMobile()?(this.$shareInput.hide(),this.$shareLink.show()):(this.$shareInput.show(),this.$shareLink.hide())},e.prototype.updateInstructions=function(){a.b.getBool(this.options.instructionsEnabled,!1)?(this.$shareHeader.show(),this.$embedHeader.show(),this.$shareHeader.text(this.content.shareInstructions),this.$embedHeader.text(this.content.embedInstructions)):(this.$shareHeader.hide(),this.$embedHeader.hide())},e.prototype.getSelectedSize=function(){return this.$customSizeDropDown.find(":selected")},e.prototype.updateWidthRatio=function(){this.currentHeight=Number(this.$heightInput.val()),this.currentHeight<this.minHeight?(this.currentHeight=this.minHeight,this.$heightInput.val(String(this.currentHeight))):this.currentHeight>this.maxHeight&&(this.currentHeight=this.maxHeight,this.$heightInput.val(String(this.currentHeight))),this.currentWidth=Math.floor(this.currentHeight/this.aspectRatio),this.$widthInput.val(String(this.currentWidth))},e.prototype.updateHeightRatio=function(){this.currentWidth=Number(this.$widthInput.val()),this.currentWidth<this.minWidth?(this.currentWidth=this.minWidth,this.$widthInput.val(String(this.currentWidth))):this.currentWidth>this.maxWidth&&(this.currentWidth=this.maxWidth,this.$widthInput.val(String(this.currentWidth))),this.currentHeight=Math.floor(this.currentWidth*this.aspectRatio),this.$heightInput.val(String(this.currentHeight))},e.prototype.updateShareFrame=function(){var t=this.extension.helper.getShareServiceUrl();t&&(a.b.getBool(this.config.options.shareFrameEnabled,!0)&&t?(this.$shareFrame.prop("src",t),this.$shareFrame.show()):this.$shareFrame.hide())},e.prototype.updateTermsOfUseButton=function(){var t=this.extension.helper.getRequiredStatement();a.b.getBool(this.extension.data.config.options.termsOfUseEnabled,!1)&&t&&t.value?this.$termsOfUseButton.show():this.$termsOfUseButton.hide()},e.prototype.openShareView=function(){this.isShareViewVisible=!0,this.isEmbedViewVisible=!1,this.$embedView.hide(),this.$shareView.show(),this.$shareButton.addClass("on default"),this.$embedButton.removeClass("on default"),this.resize()},e.prototype.openEmbedView=function(){this.isShareViewVisible=!1,this.isEmbedViewVisible=!0,this.$embedView.show(),this.$shareView.hide(),this.$shareButton.removeClass("on default"),this.$embedButton.addClass("on default"),this.resize()},e.prototype.close=function(){t.prototype.close.call(this)},e.prototype.getViews=function(){return this.$tabsContent.find(".view")},e.prototype.equaliseViewHeights=function(){this.getViews().equaliseHeight(!0)},e.prototype.resize=function(){this.equaliseViewHeights(),this.setDockedPosition()},e}(s.a)},71:function(t,e,i){"use strict";var n,o=i(7),s=i(3),a=function(t,e){this.informationType=t,this.param=e},r=i(43),h=function(){function t(){}return t.FORBIDDEN="forbiddenResourceMessage",t}(),c=i(1),l=i(4),u=i(2),p=function(){function t(){}return t.loadExternalResources=function(e,i){return new Promise((function(n){c.Utils.loadExternalResourcesAuth09(e,i,t.clickThrough,t.restricted,t.login,t.getAccessToken,t.storeAccessToken,t.getStoredAccessToken,t.handleExternalResourceResponse).then((function(t){n(t)})).catch((function(e){switch(e.name){case c.StatusCode.AUTHORIZATION_FAILED.toString():t.publish(s.a.LOGIN_FAILED);break;case c.StatusCode.FORBIDDEN.toString():t.publish(s.a.FORBIDDEN);break;case c.StatusCode.RESTRICTED.toString():break;default:t.publish(s.a.SHOW_MESSAGE,[e.message||e])}}))}))},t.clickThrough=function(e){return new Promise((function(i){t.publish(s.a.SHOW_CLICKTHROUGH_DIALOGUE,[{resource:e,acceptCallback:function(){if(e.clickThroughService)var n=window.open(e.clickThroughService.id),o=window.setInterval((function(){n&&n.closed&&(window.clearInterval(o),t.publish(s.a.CLICKTHROUGH),i())}),500)}}])}))},t.restricted=function(e){return new Promise((function(i,n){t.publish(s.a.SHOW_RESTRICTED_DIALOGUE,[{resource:e,acceptCallback:function(){t.publish(s.a.LOAD_FAILED),n(e)}}])}))},t.login=function(e){return new Promise((function(i){var n={};e.status===u.FORBIDDEN&&(n.warningMessage=h.FORBIDDEN,n.showCancelButton=!0),t.publish(s.a.SHOW_LOGIN_DIALOGUE,[{resource:e,loginCallback:function(){if(e.loginService)var n=window.open(e.loginService.id+"?t="+(new Date).getTime()),o=window.setInterval((function(){n&&n.closed&&(window.clearInterval(o),t.publish(s.a.LOGIN),i())}),500)},logoutCallback:function(){if(e.logoutService)var n=window.open(e.logoutService.id+"?t="+(new Date).getTime()),o=window.setInterval((function(){n&&n.closed&&(window.clearInterval(o),t.publish(s.a.LOGOUT),i())}),500)},options:n}])}))},t.getAccessToken=function(t,e){return new Promise((function(i,n){if(t.tokenService){var o=t.tokenService.id,s=o+"|"+(new Date).getTime(),a=function(t){window.removeEventListener("message",a);var o=t.data;o.error?e?n(o.errorDescription):i(void 0):i(o)};window.addEventListener("message",a,!1);var r=o+"?messageId="+s;$("#commsFrame").prop("src",r)}else n("Token service not found")}))},t.storeAccessToken=function(t,e,i){return new Promise((function(n,o){t.tokenService?(l.l.set(t.tokenService.id,e,e.expiresIn,i),n()):o("Token service not found")}))},t.getStoredAccessToken=function(t,e){return new Promise((function(i,n){var o,s=[],a=null;if(t.tokenService&&(a=l.l.get(t.tokenService.id,e)),a)s.push(a);else for(var r=l.o.getUrlParts(t.dataUri).hostname,h=l.l.getItems(e),c=0;c<h.length;c++)(a=h[c]).key.includes(r)&&s.push(a);(s=s.sort((function(t,e){return t.expiresAt-e.expiresAt}))).length&&(o=s[s.length-1].value),i(o)}))},t.handleExternalResourceResponse=function(e){return new Promise((function(i,n){if(e.isResponseHandled=!0,e.status===u.OK)i(e);else if(e.status===u.MOVED_TEMPORARILY)i(e),t.publish(s.a.RESOURCE_DEGRADED,[e]);else if(e.error.status===u.UNAUTHORIZED||e.error.status===u.INTERNAL_SERVER_ERROR)n(e.error.statusText);else if(e.error.status===u.FORBIDDEN){var o=new Error;o.message="Forbidden",o.name=c.StatusCode.FORBIDDEN.toString(),n(o)}else n(e.error.statusText)}))},t.handleDegraded=function(e){var i=new a(r.a.DEGRADED_RESOURCE,e);t.publish(s.a.SHOW_INFORMATION,[i])},t}(),d=function(){function t(){}return t.loadExternalResources=function(e,i,n){return new Promise((function(o){t.storageStrategy=i,e=e.map((function(t){return t.authAPIVersion=1,t.options=n,t})),c.Utils.loadExternalResourcesAuth1(e,t.openContentProviderInteraction,t.openTokenService,t.getStoredAccessToken,t.userInteractedWithContentProvider,t.getContentProviderInteraction,t.handleMovedTemporarily,t.showOutOfOptionsMessages).then((function(t){o(t)})).catch((function(e){switch(e.name){case c.StatusCode.AUTHORIZATION_FAILED.toString():t.publish(s.a.LOGIN_FAILED);break;case c.StatusCode.FORBIDDEN.toString():t.publish(s.a.FORBIDDEN);break;case c.StatusCode.RESTRICTED.toString():break;default:t.publish(s.a.SHOW_MESSAGE,[e.message||e])}}))}))},t.getCookieServiceUrl=function(e){return e.id+"?origin="+t.getOrigin()},t.openContentProviderInteraction=function(e){var i=t.getCookieServiceUrl(e);return window.open(i)},t.getOrigin=function(t){var e=window.location;return t&&((e=document.createElement("a")).href=t),e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")},t.userInteractedWithContentProvider=function(t){return new Promise((function(e){var i=window.setInterval((function(){t.closed&&(window.clearInterval(i),e(!0))}),500)}))},t.handleMovedTemporarily=function(e){return new Promise((function(i){t.showDegradedMessage(e),e.isResponseHandled=!0,i()}))},t.showDegradedMessage=function(e){var i=new a(r.a.DEGRADED_RESOURCE,e);t.publish(s.a.SHOW_INFORMATION,[i])},t.storeAccessToken=function(e,i){return new Promise((function(n,o){e.tokenService?(l.l.set(e.tokenService.id,i,i.expiresIn,t.storageStrategy),n()):o("Token service not found")}))},t.getStoredAccessToken=function(e){return new Promise((function(i,n){var o=[],s=null;if(e.tokenService&&(s=l.l.get(e.tokenService.id,t.storageStrategy)),s)o.push(s);else for(var a=l.o.getUrlParts(e.dataUri).hostname,r=l.l.getItems(t.storageStrategy),h=0;h<r.length;h++)(s=r[h]).key.includes(a)&&o.push(s);var c=null;(o=o.sort((function(t,e){return t.expiresAt-e.expiresAt}))).length&&(c=o[o.length-1].value),i(c)}))},t.getContentProviderInteraction=function(e,i){return new Promise((function(n){e.isResponseHandled&&!e.authHoldingPage?(t.showDegradedMessage(e),n(null)):e.authHoldingPage?(e.authHoldingPage.location.href=t.getCookieServiceUrl(i),n(e.authHoldingPage)):t.publish(s.a.SHOW_AUTH_DIALOGUE,[{service:i,closeCallback:function(){n(null)},confirmCallback:function(){var e=t.openContentProviderInteraction(i);n(e)},cancelCallback:function(){n(null)}}])}))},t.openTokenService=function(e,i){return new Promise((function(n,o){var s=t.getOrigin(i.id),a=(new Date).getTime();t.messages[a]={resolve:n,reject:o,serviceOrigin:s,resource:e},window.addEventListener("message",t.receiveToken,!1);var r=i.id+"?messageId="+a+"&origin="+t.getOrigin();$("#commsFrame").prop("src",r);setTimeout((function(){t.messages[a]&&(t.messages[a].reject("Message unhandled after 5000ms, rejecting"),delete t.messages[a])}),5e3)}))},t.receiveToken=function(e){if(e.data.hasOwnProperty("messageId")){var i=t.messages[e.data.messageId];i&&e.origin==i.serviceOrigin&&t.storeAccessToken(i.resource,e.data).then((function(){i.resolve(e.data),delete t.messages[e.data.messageId]}))}},t.showOutOfOptionsMessages=function(e,i){if(console.log(e),e.status!=u.MOVED_TEMPORARILY){var n="";i.getFailureHeader()&&(n+="<p>"+i.getFailureHeader()+"</p>"),i.getFailureDescription()&&(n+=i.getFailureDescription()),t.publish(s.a.SHOW_MESSAGE,[Object(o.c)(n)])}},t.messages={},t}(),f=i(34),m=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),b=function(t){function e(e){return t.call(this,e)||this}return m(e,t),e.prototype.create=function(){var e=this;this.setConfig("authDialogue"),t.prototype.create.call(this),this.openCommand=s.a.SHOW_AUTH_DIALOGUE,this.closeCommand=s.a.HIDE_AUTH_DIALOGUE,this.component.subscribe(this.openCommand,(function(t){e.closeCallback=t.closeCallback,e.confirmCallback=t.confirmCallback,e.cancelCallback=t.cancelCallback,e.service=t.service,e.open()})),this.component.subscribe(this.closeCommand,(function(){e.close()})),this.$title=$("<h1></h1>"),this.$content.append(this.$title),this.$content.append('            <div>                <p class="message scroll"></p>            </div>'),this.$buttons.prepend(this._buttonsToAdd()),this.$message=this.$content.find(".message"),this.$confirmButton=this.$buttons.find(".confirm"),this.$confirmButton.text(this.content.confirm),this.$cancelButton=this.$buttons.find(".close"),this.$cancelButton.text(this.content.cancel),this.$element.hide(),this.$confirmButton.on("click",(function(t){t.preventDefault(),e.confirmCallback&&e.confirmCallback(),e.close()})),this.$cancelButton.on("click",(function(t){t.preventDefault(),e.cancelCallback&&e.cancelCallback(),e.close()}))},e.prototype.open=function(){t.prototype.open.call(this);var e=this.service.getHeader(),i=this.service.getDescription(),n=this.service.getConfirmLabel();e&&this.$title.text(Object(o.c)(e)),i&&(this.$message.html(Object(o.c)(i)),this.$message.targetBlank(),this.$message.find("a").on("click",(function(){var t=$(this).attr("href");this.component.publish(s.a.EXTERNAL_LINK_CLICKED,t)}))),n&&this.$confirmButton.text(Object(o.c)(n)),this.resize()},e.prototype.resize=function(){t.prototype.resize.call(this)},e.prototype._buttonsToAdd=function(){var t='<a class="confirm btn btn-primary" href="#" target="_parent"></a>';return this.config.topCloseButtonEnabled&&(t+='<button class="close btn btn-default"></button>'),t},e}(f.a),g=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),E=function(t){function e(e){return t.call(this,e)||this}return g(e,t),e.prototype.create=function(){var e=this;this.setConfig("clickThroughDialogue"),t.prototype.create.call(this),this.openCommand=s.a.SHOW_CLICKTHROUGH_DIALOGUE,this.closeCommand=s.a.HIDE_CLICKTHROUGH_DIALOGUE,this.component.subscribe(this.openCommand,(function(t){e.acceptCallback=t.acceptCallback,e.resource=t.resource,e.open()})),this.component.subscribe(this.closeCommand,(function(){e.close()})),this.$title=$("<h1></h1>"),this.$content.append(this.$title),this.$content.append('            <div>                <p class="message scroll"></p>                <div class="buttons">                    <a class="acceptTerms btn btn-primary" href="#" target="_parent"></a>                </div>            </div>'),this.$message=this.$content.find(".message"),this.$acceptTermsButton=this.$content.find(".acceptTerms"),this.$acceptTermsButton.text("Accept Terms and Open"),this.$element.hide(),this.$acceptTermsButton.on("click",(function(t){t.preventDefault(),e.close(),e.component.publish(s.a.ACCEPT_TERMS),e.acceptCallback&&e.acceptCallback()}))},e.prototype.open=function(){t.prototype.open.call(this),this.resource.clickThroughService&&(this.$title.text(this.resource.clickThroughService.getProperty("label")),this.$message.html(this.resource.clickThroughService.getProperty("description")),this.$message.targetBlank()),this.$message.find("a").on("click",(function(){var t=$(this).attr("href");this.component.publish(s.a.EXTERNAL_LINK_CLICKED,t)})),this.resize()},e.prototype.resize=function(){t.prototype.resize.call(this)},e}(f.a),v=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),_=function(t){function e(e){return t.call(this,e)||this}return v(e,t),e.prototype.create=function(){var e=this;this.setConfig("loginDialogue"),t.prototype.create.call(this),this.openCommand=s.a.SHOW_LOGIN_DIALOGUE,this.closeCommand=s.a.HIDE_LOGIN_DIALOGUE,this.component.subscribe(this.openCommand,(function(t){e.loginCallback=t.loginCallback,e.logoutCallback=t.logoutCallback,e.options=t.options,e.resource=t.resource,e.open()})),this.component.subscribe(this.closeCommand,(function(){e.close()})),this.$title=$("<h1></h1>"),this.$content.append(this.$title),this.$content.append('            <div>                <p class="message scroll"></p>                <div class="buttons">                    <a class="logout btn btn-primary" href="#" target="_parent"></a>                    <a class="login btn btn-primary" href="#" target="_parent"></a>                    <a class="cancel btn btn-primary" href="#"></a>                </div>            </div>'),this.$message=this.$content.find(".message"),this.$loginButton=this.$content.find(".login"),this.$loginButton.text(this.content.login),this.$logoutButton=this.$content.find(".logout"),this.$logoutButton.text(this.content.logout),this.$cancelButton=this.$content.find(".cancel"),this.$cancelButton.text(this.content.cancel),this.$element.hide(),this.$loginButton.on("click",(function(t){t.preventDefault(),e.close(),e.loginCallback&&e.loginCallback()})),this.$logoutButton.on("click",(function(t){t.preventDefault(),e.close(),e.logoutCallback&&e.logoutCallback()})),this.$cancelButton.on("click",(function(t){t.preventDefault(),e.close()})),this.updateLogoutButton()},e.prototype.open=function(){t.prototype.open.call(this);var e="";this.resource.loginService&&(this.$title.text(this.resource.loginService.getProperty("label")),e=this.resource.loginService.getProperty("description")),this.options.warningMessage&&(e='<span class="warning">'+this.extension.data.config.content[this.options.warningMessage]+'</span><span class="description">'+e+"</span>"),this.updateLogoutButton(),this.$message.html(e),this.$message.targetBlank(),this.$message.find("a").on("click",(function(){var t=$(this).attr("href");this.component.publish(s.a.EXTERNAL_LINK_CLICKED,t)})),this.options.showCancelButton?this.$cancelButton.show():this.$cancelButton.hide(),this.resize()},e.prototype.updateLogoutButton=function(){this.extension.isLoggedIn?this.$logoutButton.show():this.$logoutButton.hide()},e.prototype.resize=function(){t.prototype.resize.call(this)},e}(f.a),O=function(){function t(t){this.value="",t&&(this.value=t.toLowerCase())}return t.prototype.toString=function(){return this.value},t}(),I=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return I(e,t),e.DESKTOP=new e("desktop"),e.MOBILELANDSCAPE=new e("mobilelandscape"),e.MOBILEPORTRAIT=new e("mobileportrait"),e.NONE=new e("none"),e.WATCH=new e("watch"),e}(O),C=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),T=function(t){function e(e){return t.call(this,e)||this}return C(e,t),e.prototype.create=function(){var e=this;this.setConfig("restrictedDialogue"),t.prototype.create.call(this),this.openCommand=s.a.SHOW_RESTRICTED_DIALOGUE,this.closeCommand=s.a.HIDE_RESTRICTED_DIALOGUE,this.component.subscribe(this.openCommand,(function(t){e.acceptCallback=t.acceptCallback,e.options=t.options,e.resource=t.resource,e.open()})),this.component.subscribe(this.closeCommand,(function(){e.close()})),this.$title=$("<h1></h1>"),this.$content.append(this.$title),this.$content.append('            <div>                <p class="message scroll"></p>                <div class="buttons">                    <a class="cancel btn btn-primary" href="#" target="_parent"></a>                </div>            </div>'),this.$message=this.$content.find(".message"),this.$message.targetBlank(),this.$cancelButton=this.$content.find(".cancel"),this.$cancelButton.text(this.content.cancel),this.$element.hide(),this.$cancelButton.on("click",(function(t){t.preventDefault(),e.close()}))},e.prototype.open=function(){t.prototype.open.call(this),this.isAccepted=!1;var e="";this.resource.restrictedService&&(this.$title.text(this.resource.restrictedService.getProperty("label")),e=this.resource.restrictedService.getProperty("description")),this.$message.html(e),this.$message.targetBlank(),this.$message.find("a").on("click",(function(){var t=$(this).attr("href");this.component.publish(s.a.EXTERNAL_LINK_CLICKED,t)})),this.resize()},e.prototype.close=function(){t.prototype.close.call(this),!this.isAccepted&&this.acceptCallback&&(this.isAccepted=!0,this.acceptCallback())},e.prototype.resize=function(){t.prototype.resize.call(this)},e}(f.a),S=i(36),A=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),D=function(t){function e(e){return t.call(this,e)||this}return A(e,t),e.prototype.create=function(){var e=this;this.setConfig("genericDialogue"),t.prototype.create.call(this),this.openCommand=s.a.SHOW_GENERIC_DIALOGUE,this.closeCommand=s.a.HIDE_GENERIC_DIALOGUE,this.component.subscribe(this.openCommand,(function(t){e.acceptCallback=t.acceptCallback,e.showMessage(t)})),this.component.subscribe(this.closeCommand,(function(){e.close()})),this.$message=$("<p></p>"),this.$content.append(this.$message),this.$acceptButton=$('\n          <button class="btn btn-primary accept default">\n            '+this.content.ok+"\n          </button>\n        "),this.$buttons.append(this.$acceptButton),this.$buttons.find(".close").hide(),this.$acceptButton.onPressed((function(){e.accept()})),this.returnFunc=function(){e.isActive&&e.accept()},this.$element.hide()},e.prototype.accept=function(){this.component.publish(s.a.CLOSE_ACTIVE_DIALOGUE),this.acceptCallback&&this.acceptCallback()},e.prototype.showMessage=function(t){this.$message.html(t.message),t.buttonText?this.$acceptButton.text(t.buttonText):this.$acceptButton.text(this.content.ok),!1===t.allowClose&&this.disableClose(),this.open()},e.prototype.resize=function(){t.prototype.resize.call(this)},e}(f.a),w=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),L=function(t){function e(e){return t.call(this,e,!0,!0)||this}return w(e,t),e.prototype.create=function(){var e=this;t.prototype.create.call(this),this.component.subscribe(s.a.SHOW_OVERLAY,(function(){e.$overlays.show()})),this.component.subscribe(s.a.HIDE_OVERLAY,(function(){e.$overlays.hide()})),this.$headerPanel=$('<div class="headerPanel"></div>'),this.$element.append(this.$headerPanel),this.$mainPanel=$('<div class="mainPanel"></div>'),this.$element.append(this.$mainPanel),this.$centerPanel=$('<div class="centerPanel"></div>'),this.$mainPanel.append(this.$centerPanel),this.$leftPanel=$('<div class="leftPanel"></div>'),this.$mainPanel.append(this.$leftPanel),this.$rightPanel=$('<div class="rightPanel"></div>'),this.$mainPanel.append(this.$rightPanel),this.$footerPanel=$('<div class="footerPanel"></div>'),this.$element.append(this.$footerPanel),this.$mobileFooterPanel=$('<div class="mobileFooterPanel"></div>'),this.$element.append(this.$mobileFooterPanel),this.$overlays=$('<div class="overlays"></div>'),this.$element.append(this.$overlays),this.$genericDialogue=$('<div class="overlay genericDialogue" aria-hidden="true"></div>'),this.$overlays.append(this.$genericDialogue),this.$overlays.on("click",(function(t){$(t.target).hasClass("overlays")&&(t.preventDefault(),e.component.publish(s.a.CLOSE_ACTIVE_DIALOGUE))})),new D(this.$genericDialogue)},e.prototype.resize=function(){var e=this;t.prototype.resize.call(this),setTimeout((function(){e.$overlays.width(e.extension.width()),e.$overlays.height(e.extension.height())}),1);var i=this.$element.height()-parseInt(this.$mainPanel.css("paddingTop"))-(this.$headerPanel.is(":visible")?this.$headerPanel.height():0)-(this.$footerPanel.is(":visible")?this.$footerPanel.height():0)-(this.$mobileFooterPanel.is(":visible")?this.$mobileFooterPanel.height():0);this.$mainPanel.height(i)},e}(S.a),x=i(8),R=i(0),N=i(44);i.d(e,"a",(function(){return B}));var B=function(){function t(){this.isCreated=!1,this.isLoggedIn=!1,this.metric=y.NONE,this.metrics=[],this.shifted=!1,this.tabbing=!1}return t.prototype.create=function(){var t=this,e=this;if(p.publish=this.component.publish.bind(this.component),d.publish=this.component.publish.bind(this.component),this.$element=$(this.component.options.target),this.$element.data("component",this.component),this.fire(s.a.CREATE,{data:this.data,settings:this.getSettings(),preview:this.getSharePreview()}),this._parseMetrics(),this._initLocales(),this.$element.empty(),this.$element.removeClass(),this.$element.addClass("uv"),this.$element.addClass("loading"),this.data.locales&&this.$element.addClass(this.data.locales[0].name.toLowerCase()),this.$element.addClass(this.name),this.$element.addClass("browser-"+window.browserDetect.browser),this.$element.addClass("browser-version-"+window.browserDetect.version),this.$element.prop("tabindex",0),this.data.embedded&&this.$element.addClass("embedded"),this.isMobile()&&this.$element.addClass("mobile"),this.data.isLightbox&&this.$element.addClass("lightbox"),l.e.supportsFullscreen()&&this.$element.addClass("fullscreen-supported"),this.$element.on("mousemove",(function(e){t.mouseX=e.pageX,t.mouseY=e.pageY})),!this.data.isReload){var i=l.e.getHiddenProp();if(i){var n=i.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(n,(function(){l.e.isHidden()||t.resize()}))}l.b.getBool(this.data.config.options.dropEnabled,!0)&&this.$element.on("drop",(function(e){e.preventDefault();var i=e.originalEvent.dataTransfer.getData("URL"),n=l.o.getUrlParts(i),o=l.o.getQuerystringParameterFromString("manifest",n.search);if(o||(o=l.o.getQuerystringParameterFromString("collection",n.search)),o){t.fire(s.a.DROP,o);var a={};a.manifestUri=o,t.reload(a)}})),this.$element.on("dragover",(function(t){t.preventDefault()})),this.$element.on("keyup keydown",(function(e){t.shifted=e.shiftKey,t.tabbing=e.keyCode===N.a.Tab})),this.$element.on("keydown",(function(i){var n=null,o=!0;i.ctrlKey||i.altKey||i.shiftKey||(i.keyCode===N.a.Enter&&(n=s.a.RETURN,o=!1),i.keyCode===N.a.Escape&&(n=s.a.ESCAPE),i.keyCode===N.a.PageUp&&(n=s.a.PAGE_UP),i.keyCode===N.a.PageDown&&(n=s.a.PAGE_DOWN),i.keyCode===N.a.End&&(n=s.a.END),i.keyCode===N.a.Home&&(n=s.a.HOME),i.keyCode!==N.a.NumpadPlus&&171!==i.keyCode&&i.keyCode!==N.a.Equals||(n=s.a.PLUS,o=!1),i.keyCode!==N.a.NumpadMinus&&173!==i.keyCode&&i.keyCode!==N.a.Dash||(n=s.a.MINUS,o=!1),e.useArrowKeysToNavigate()&&(i.keyCode===N.a.LeftArrow&&(n=s.a.LEFT_ARROW),i.keyCode===N.a.UpArrow&&(n=s.a.UP_ARROW),i.keyCode===N.a.RightArrow&&(n=s.a.RIGHT_ARROW),i.keyCode===N.a.DownArrow&&(n=s.a.DOWN_ARROW))),n&&(o&&i.preventDefault(),t.component.publish(n))}))}this.component.subscribe(s.a.EXIT_FULLSCREEN,(function(){t.isOverlayActive()&&t.component.publish(s.a.ESCAPE),t.component.publish(s.a.ESCAPE),t.component.publish(s.a.RESIZE)})),this.$element.append('<a href="/" id="top"></a>'),this.$element.append('<iframe id="commsFrame" style="display:none"></iframe>'),this.component.subscribe(s.a.ACCEPT_TERMS,(function(){t.fire(s.a.ACCEPT_TERMS)})),this.component.subscribe(s.a.LOGIN_FAILED,(function(){t.fire(s.a.LOGIN_FAILED),t.showMessage(t.data.config.content.authorisationFailedMessage)})),this.component.subscribe(s.a.LOGIN,(function(){t.isLoggedIn=!0,t.fire(s.a.LOGIN)})),this.component.subscribe(s.a.LOGOUT,(function(){t.isLoggedIn=!1,t.fire(s.a.LOGOUT)})),this.component.subscribe(s.a.BOOKMARK,(function(){t.bookmark(),t.fire(s.a.BOOKMARK)})),this.component.subscribe(s.a.CANVAS_INDEX_CHANGE_FAILED,(function(){t.fire(s.a.CANVAS_INDEX_CHANGE_FAILED)})),this.component.subscribe(s.a.CANVAS_INDEX_CHANGED,(function(e){t.data.canvasIndex=e,t.lastCanvasIndex=t.helper.canvasIndex,t.helper.canvasIndex=e,t.fire(s.a.CANVAS_INDEX_CHANGED,t.data.canvasIndex)})),this.component.subscribe(s.a.CLICKTHROUGH,(function(){t.fire(s.a.CLICKTHROUGH)})),this.component.subscribe(s.a.CLOSE_ACTIVE_DIALOGUE,(function(){t.fire(s.a.CLOSE_ACTIVE_DIALOGUE)})),this.component.subscribe(s.a.CLOSE_LEFT_PANEL,(function(){t.fire(s.a.CLOSE_LEFT_PANEL),t.resize()})),this.component.subscribe(s.a.CLOSE_RIGHT_PANEL,(function(){t.fire(s.a.CLOSE_RIGHT_PANEL),t.resize()})),this.component.subscribe(s.a.COLLECTION_INDEX_CHANGED,(function(e){t.data.collectionIndex=e,t.fire(s.a.COLLECTION_INDEX_CHANGED,t.data.collectionIndex)})),this.component.subscribe(s.a.CREATED,(function(){t.isCreated=!0,t.fire(s.a.CREATED)})),this.component.subscribe(s.a.DOWN_ARROW,(function(){t.fire(s.a.DOWN_ARROW)})),this.component.subscribe(s.a.DOWNLOAD,(function(e){t.fire(s.a.DOWNLOAD,e)})),this.component.subscribe(s.a.END,(function(){t.fire(s.a.END)})),this.component.subscribe(s.a.ESCAPE,(function(){t.fire(s.a.ESCAPE),t.isFullScreen()&&!t.isOverlayActive()&&t.component.publish(s.a.TOGGLE_FULLSCREEN)})),this.component.subscribe(s.a.EXTERNAL_LINK_CLICKED,(function(e){t.fire(s.a.EXTERNAL_LINK_CLICKED,e)})),this.component.subscribe(s.a.FEEDBACK,(function(){t.feedback()})),this.component.subscribe(s.a.FORBIDDEN,(function(){t.fire(s.a.FORBIDDEN),t.component.publish(s.a.OPEN_EXTERNAL_RESOURCE)})),this.component.subscribe(s.a.HIDE_DOWNLOAD_DIALOGUE,(function(){t.fire(s.a.HIDE_DOWNLOAD_DIALOGUE)})),this.component.subscribe(s.a.HIDE_EMBED_DIALOGUE,(function(){t.fire(s.a.HIDE_EMBED_DIALOGUE)})),this.component.subscribe(s.a.HIDE_EXTERNALCONTENT_DIALOGUE,(function(){t.fire(s.a.HIDE_EXTERNALCONTENT_DIALOGUE)})),this.component.subscribe(s.a.HIDE_GENERIC_DIALOGUE,(function(){t.fire(s.a.HIDE_GENERIC_DIALOGUE)})),this.component.subscribe(s.a.HIDE_HELP_DIALOGUE,(function(){t.fire(s.a.HIDE_HELP_DIALOGUE)})),this.component.subscribe(s.a.HIDE_INFORMATION,(function(){t.fire(s.a.HIDE_INFORMATION)})),this.component.subscribe(s.a.HIDE_LOGIN_DIALOGUE,(function(){t.fire(s.a.HIDE_LOGIN_DIALOGUE)})),this.component.subscribe(s.a.HIDE_OVERLAY,(function(){t.fire(s.a.HIDE_OVERLAY)})),this.component.subscribe(s.a.HIDE_RESTRICTED_DIALOGUE,(function(){t.fire(s.a.HIDE_RESTRICTED_DIALOGUE)})),this.component.subscribe(s.a.HIDE_SETTINGS_DIALOGUE,(function(){t.fire(s.a.HIDE_SETTINGS_DIALOGUE)})),this.component.subscribe(s.a.HOME,(function(){t.fire(s.a.HOME)})),this.component.subscribe(s.a.LEFT_ARROW,(function(){t.fire(s.a.LEFT_ARROW)})),this.component.subscribe(s.a.LEFTPANEL_COLLAPSE_FULL_FINISH,(function(){t.fire(s.a.LEFTPANEL_COLLAPSE_FULL_FINISH)})),this.component.subscribe(s.a.LEFTPANEL_COLLAPSE_FULL_START,(function(){t.fire(s.a.LEFTPANEL_COLLAPSE_FULL_START)})),this.component.subscribe(s.a.LEFTPANEL_EXPAND_FULL_FINISH,(function(){t.fire(s.a.LEFTPANEL_EXPAND_FULL_FINISH)})),this.component.subscribe(s.a.LEFTPANEL_EXPAND_FULL_START,(function(){t.fire(s.a.LEFTPANEL_EXPAND_FULL_START)})),this.component.subscribe(s.a.LOAD_FAILED,(function(){t.fire(s.a.LOAD_FAILED),null==!e.lastCanvasIndex&&e.lastCanvasIndex!==e.helper.canvasIndex&&t.component.publish(s.a.CANVAS_INDEX_CHANGED,e.lastCanvasIndex)})),this.component.subscribe(s.a.MANIFEST_INDEX_CHANGED,(function(e){t.data.manifestIndex=e,t.fire(s.a.MANIFEST_INDEX_CHANGED,t.data.manifestIndex)})),this.component.subscribe(s.a.NOT_FOUND,(function(){t.fire(s.a.NOT_FOUND)})),this.component.subscribe(s.a.OPEN,(function(){t.fire(s.a.OPEN);var e=l.n.format(t.data.config.options.openTemplate,t.helper.manifestUri);window.open(e)})),this.component.subscribe(s.a.OPEN_LEFT_PANEL,(function(){t.fire(s.a.OPEN_LEFT_PANEL),t.resize()})),this.component.subscribe(s.a.OPEN_EXTERNAL_RESOURCE,(function(){t.fire(s.a.OPEN_EXTERNAL_RESOURCE)})),this.component.subscribe(s.a.OPENED_EXTERNAL_RESOURCE,(function(){t.$element.removeClass("loading"),t.component.publish(s.a.RESIZE),t.fire(s.a.OPENED_EXTERNAL_RESOURCE)})),this.component.subscribe(s.a.OPEN_RIGHT_PANEL,(function(){t.fire(s.a.OPEN_RIGHT_PANEL),t.resize()})),this.component.subscribe(s.a.PAGE_DOWN,(function(){t.fire(s.a.PAGE_DOWN)})),this.component.subscribe(s.a.PAGE_UP,(function(){t.fire(s.a.PAGE_UP)})),this.component.subscribe(s.a.RANGE_CHANGED,(function(e){e?(t.data.rangeId=e.id,t.helper.rangeId=e.id,t.fire(s.a.RANGE_CHANGED,t.data.rangeId)):(t.data.rangeId=void 0,t.helper.rangeId=void 0,t.fire(s.a.RANGE_CHANGED,null))})),this.component.subscribe(s.a.RESOURCE_DEGRADED,(function(e){t.fire(s.a.RESOURCE_DEGRADED),p.handleDegraded(e)})),this.component.subscribe(s.a.RETURN,(function(){t.fire(s.a.RETURN)})),this.component.subscribe(s.a.RIGHT_ARROW,(function(){t.fire(s.a.RIGHT_ARROW)})),this.component.subscribe(s.a.RIGHTPANEL_COLLAPSE_FULL_FINISH,(function(){t.fire(s.a.RIGHTPANEL_COLLAPSE_FULL_FINISH)})),this.component.subscribe(s.a.RIGHTPANEL_COLLAPSE_FULL_START,(function(){t.fire(s.a.RIGHTPANEL_COLLAPSE_FULL_START)})),this.component.subscribe(s.a.RIGHTPANEL_EXPAND_FULL_FINISH,(function(){t.fire(s.a.RIGHTPANEL_EXPAND_FULL_FINISH)})),this.component.subscribe(s.a.RIGHTPANEL_EXPAND_FULL_START,(function(){t.fire(s.a.RIGHTPANEL_EXPAND_FULL_START)})),this.component.subscribe(s.a.SEQUENCE_INDEX_CHANGED,(function(e){t.data.sequenceIndex=e,t.fire(s.a.SEQUENCE_INDEX_CHANGED,t.data.sequenceIndex)})),this.component.subscribe(s.a.SETTINGS_CHANGED,(function(e){t.fire(s.a.SETTINGS_CHANGED,e)})),this.component.subscribe(s.a.SHOW_DOWNLOAD_DIALOGUE,(function(){t.fire(s.a.SHOW_DOWNLOAD_DIALOGUE)})),this.component.subscribe(s.a.SHOW_EMBED_DIALOGUE,(function(){t.fire(s.a.SHOW_EMBED_DIALOGUE)})),this.component.subscribe(s.a.SHOW_EXTERNALCONTENT_DIALOGUE,(function(){t.fire(s.a.SHOW_EXTERNALCONTENT_DIALOGUE)})),this.component.subscribe(s.a.SHOW_GENERIC_DIALOGUE,(function(){t.fire(s.a.SHOW_GENERIC_DIALOGUE)})),this.component.subscribe(s.a.SHOW_HELP_DIALOGUE,(function(){t.fire(s.a.SHOW_HELP_DIALOGUE)})),this.component.subscribe(s.a.SHOW_INFORMATION,(function(){t.fire(s.a.SHOW_INFORMATION)})),this.component.subscribe(s.a.SHOW_LOGIN_DIALOGUE,(function(){t.fire(s.a.SHOW_LOGIN_DIALOGUE)})),this.component.subscribe(s.a.SHOW_CLICKTHROUGH_DIALOGUE,(function(){t.fire(s.a.SHOW_CLICKTHROUGH_DIALOGUE)})),this.component.subscribe(s.a.SHOW_MESSAGE,(function(e){t.showMessage(e)})),this.component.subscribe(s.a.SHOW_RESTRICTED_DIALOGUE,(function(){t.fire(s.a.SHOW_RESTRICTED_DIALOGUE)})),this.component.subscribe(s.a.SHOW_OVERLAY,(function(){t.fire(s.a.SHOW_OVERLAY)})),this.component.subscribe(s.a.SHOW_SETTINGS_DIALOGUE,(function(){t.fire(s.a.SHOW_SETTINGS_DIALOGUE)})),this.component.subscribe(s.a.SHOW_TERMS_OF_USE,(function(){t.fire(s.a.SHOW_TERMS_OF_USE);var e=t.helper.getLicense();if(!e){var i=t.helper.getRequiredStatement();i&&i.value&&(e=i.value)}e&&t.showMessage(e)})),this.component.subscribe(s.a.THUMB_SELECTED,(function(e){t.fire(s.a.THUMB_SELECTED,e.index)})),this.component.subscribe(s.a.TOGGLE_FULLSCREEN,(function(){$("#top").focus(),t.component.isFullScreen=!t.component.isFullScreen,t.component.isFullScreen?t.$element.addClass("fullscreen"):t.$element.removeClass("fullscreen"),t.fire(s.a.TOGGLE_FULLSCREEN,{isFullScreen:t.component.isFullScreen,overrideFullScreen:t.data.config.options.overrideFullScreen})})),this.component.subscribe(s.a.UP_ARROW,(function(){t.fire(s.a.UP_ARROW)})),this.component.subscribe(s.a.UPDATE_SETTINGS,(function(){t.fire(s.a.UPDATE_SETTINGS)})),this.component.subscribe(s.a.VIEW_FULL_TERMS,(function(){t.fire(s.a.VIEW_FULL_TERMS)})),this.component.subscribe(s.a.WINDOW_UNLOAD,(function(){t.fire(s.a.WINDOW_UNLOAD)})),this.shell=new L(this.$element),this.createModules(),this.modulesCreated(),this.component.publish(s.a.RESIZE),setTimeout((function(){t.render(),t.component.publish(s.a.CREATED),t._setDefaultFocus()}),1)},t.prototype.createModules=function(){this.$authDialogue=$('<div class="overlay auth" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$authDialogue),this.authDialogue=new b(this.$authDialogue),this.$clickThroughDialogue=$('<div class="overlay clickthrough" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$clickThroughDialogue),this.clickThroughDialogue=new E(this.$clickThroughDialogue),this.$restrictedDialogue=$('<div class="overlay login" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$restrictedDialogue),this.restrictedDialogue=new T(this.$restrictedDialogue),this.$loginDialogue=$('<div class="overlay login" aria-hidden="true"></div>'),this.shell.$overlays.append(this.$loginDialogue),this.loginDialogue=new _(this.$loginDialogue)},t.prototype.modulesCreated=function(){},t.prototype._setDefaultFocus=function(){var t=this;setTimeout((function(){t.data.config.options.allowStealFocus&&$("[tabindex=0]").focus()}),1)},t.prototype.width=function(){return this.$element.width()},t.prototype.height=function(){return this.$element.height()},t.prototype.exitFullScreen=function(){this.component.publish(s.a.EXIT_FULLSCREEN)},t.prototype.fire=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.component.fire(t,arguments[1])},t.prototype.redirect=function(t){this.fire(s.a.REDIRECT,t)},t.prototype.refresh=function(){this.fire(s.a.REFRESH,null)},t.prototype.render=function(){if(this.isCreated&&this.data.collectionIndex===this.helper.collectionIndex||this.component.publish(s.a.COLLECTION_INDEX_CHANGED,this.data.collectionIndex),this.isCreated&&this.data.manifestIndex===this.helper.manifestIndex||this.component.publish(s.a.MANIFEST_INDEX_CHANGED,this.data.manifestIndex),this.isCreated&&this.data.sequenceIndex===this.helper.sequenceIndex||this.component.publish(s.a.SEQUENCE_INDEX_CHANGED,this.data.sequenceIndex),this.isCreated&&this.data.canvasIndex===this.helper.canvasIndex||this.component.publish(s.a.CANVAS_INDEX_CHANGED,this.data.canvasIndex),(!this.isCreated||this.data.rangeId!==this.helper.rangeId)&&this.data.rangeId){var t=this.helper.getRangeById(this.data.rangeId);t?this.component.publish(s.a.RANGE_CHANGED,t):console.warn("range id not found:",this.data.rangeId)}},t.prototype._initLocales=function(){var t=this.data.config.localisation.locales.slice(0),e=this.data.locales,i=[];e?(e.forEach((function(e){var n=t.filter((function(t){return t.name===e.name}));if(n.length){var o=n[0];e.label&&(o.label=e.label),o.added=!0,i.push(o)}})),l.b.getBool(this.data.config.options.limitLocales,!1)||t.forEach((function(t){t.added||i.push(t),delete t.added})),this.data.locales=i):console.warn("No locales configured")},t.prototype._parseMetrics=function(){var t=this.data.config.options.metrics;if(t)for(var e=0;e<t.length;e++){var i=t[e];"string"==typeof i.type&&(i.type=new y(i.type)),this.metrics.push(i)}},t.prototype._updateMetric=function(){var t=this;setTimeout((function(){for(var e=!1,i=0;i<t.metrics.length;i++){var n=t.metrics[i];t.width()>=n.minWidth&&t.width()<=n.maxWidth&&t.height()>=n.minHeight&&t.height()<=n.maxHeight&&(e=!0,t.metric!==n.type&&(t.metric=n.type,t.component.publish(s.a.METRIC_CHANGED)))}e||t.metric!==y.NONE&&(t.metric=y.NONE,t.component.publish(s.a.METRIC_CHANGED))}),1)},t.prototype.resize=function(){this._updateMetric(),this.component.publish(s.a.RESIZE)},t.prototype.reload=function(t){this.component.publish(s.a.RELOAD,t)},t.prototype.isSeeAlsoEnabled=function(){return!1!==this.data.config.options.seeAlsoEnabled},t.prototype.getShareUrl=function(){if(!this.data.embedded)return l.e.isInIFrame()?parent.document.location.href:document.location.href;if(this.helper.hasRelatedPage()){var t=this.helper.getRelated();return t&&t.length&&(t=t[0]),t["@id"]}return null},t.prototype.getIIIFShareUrl=function(t){var e;return void 0===t&&(t=!1),t&&(e=this.helper.manifest?this.helper.manifest.id:this.helper.manifestUri),e+"?manifest="+e},t.prototype.addTimestamp=function(t){return t+"?t="+l.c.getTimeStamp()},t.prototype.getDomain=function(){return l.o.getUrlParts(this.helper.manifestUri).host},t.prototype.getAppUri=function(){var t=l.o.getUrlParts(document.location.href),e=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),i=t.pathname;i.startsWith("/")||(i="/"+i);var n=e+(i=i.substr(0,i.lastIndexOf("/")+1)),s="";return l.e.isInIFrame()||((s=this.data.root||"").startsWith("./")&&(s=s.substr(2)),s&&!s.endsWith("/")&&(s+="/")),Object(o.a)(s)?s+"uv.html":n+s+"uv.html"},t.prototype.getSettings=function(){if(l.b.getBool(this.data.config.options.saveUserSettings,!1)){var t=l.l.get("uv.settings",l.m.LOCAL);if(t)return $.extend(this.data.config.options,t.value)}return this.data.config.options},t.prototype.updateSettings=function(t){if(l.b.getBool(this.data.config.options.saveUserSettings,!1)){var e=l.l.get("uv.settings",l.m.LOCAL);e&&(t=$.extend(e.value,t)),l.l.set("uv.settings",t,31536e4,l.m.LOCAL)}this.data.config.options=$.extend(this.data.config.options,t)},t.prototype.getLocale=function(){return this.helper.options.locale},t.prototype.getSharePreview=function(){var t=this.helper.getLabel(),e=this.helper.getCurrentCanvas(),i=e.getProperty("thumbnail");return i&&"string"==typeof i||(i=e.getCanonicalImageUri(this.data.config.options.bookmarkThumbWidth)),{title:t,image:i}},t.prototype.getPagedIndices=function(t){return void 0===t&&(t=this.helper.canvasIndex),[t]},t.prototype.getCurrentCanvases=function(){for(var t=this.getPagedIndices(this.helper.canvasIndex),e=[],i=0;i<t.length;i++){var n=t[i],o=this.helper.getCanvasByIndex(n);e.push(o)}return e},t.prototype.getCanvasLabels=function(t){var e=this.getPagedIndices(),i="";if(1===e.length)i=t;else for(var n=1;n<=e.length;n++)i.length&&(i+=","),i+=t+" "+n;return i},t.prototype.getCurrentCanvasRange=function(){return this.helper.getCanvasRange(this.helper.getCurrentCanvas())},t.prototype.getExternalResources=function(t){var e=this,i=this.getPagedIndices(),n=[];i.forEach((function(i){var o,s=e.helper.getCanvasByIndex(i);if(o=s.externalResource?s.externalResource:new x.b(s,{authApiVersion:e.data.config.options.authAPIVersion}),t){var a=t.find((function(t){return t.dataUri===o.dataUri}));a?n.push(a):n.push(o)}else n.push(o)}));var o=this.data.config.options.tokenStorage;return 1===this.data.config.options.authAPIVersion?new Promise((function(t){var i={locale:e.helper.options.locale};d.loadExternalResources(n,o,i).then((function(i){e.resources=i.map((function(t){return e._prepareResourceData(t)})),e.component.publish(s.a.OPENED_EXTERNAL_RESOURCE),t(e.resources)}))})):new Promise((function(t){p.loadExternalResources(n,o).then((function(i){e.resources=i.map((function(t){return e._prepareResourceData(t)})),e.component.publish(s.a.OPENED_EXTERNAL_RESOURCE),t(e.resources)}))}))},t.prototype._prepareResourceData=function(t){return t.data.hasServiceDescriptor=t.hasServiceDescriptor(),t.hasServiceDescriptor()||(t.data.id=t.dataUri,t.data.width=t.width,t.data.height=t.height),t.data.index=t.index,l.j.toPlainObject(t.data)},t.prototype.getMediaFormats=function(t){var e=t.getContent();return e&&e.length?e[0].getBody():[{id:t.id,type:t.getType(),getFormat:function(){return""}}]},t.prototype.viewCanvas=function(t){this.helper.isCanvasIndexOutOfRange(t)?this.showMessage(this.data.config.content.canvasIndexOutOfRange):this.component.publish(s.a.OPEN_EXTERNAL_RESOURCE)},t.prototype.showMessage=function(t,e,i,n){this.closeActiveDialogue(),this.component.publish(s.a.SHOW_GENERIC_DIALOGUE,{message:t,acceptCallback:e,buttonText:i,allowClose:n})},t.prototype.closeActiveDialogue=function(){this.component.publish(s.a.CLOSE_ACTIVE_DIALOGUE)},t.prototype.isOverlayActive=function(){return this.shell.$overlays.is(":visible")},t.prototype.isDesktopMetric=function(){return this.metric.toString()===y.DESKTOP.toString()},t.prototype.isWatchMetric=function(){return this.metric.toString()===y.WATCH.toString()},t.prototype.isCatchAllMetric=function(){return this.metric.toString()===y.NONE.toString()},t.prototype.viewManifest=function(t){var e={};e.manifestUri=this.helper.manifestUri,e.collectionIndex=this.helper.getCollectionIndex(t),e.manifestIndex=t.index,e.sequenceIndex=0,e.canvasIndex=0,this.reload(e)},t.prototype.viewCollection=function(t){var e={};e.manifestUri=t.parentCollection?t.parentCollection.id:this.helper.manifestUri,e.collectionIndex=t.index,e.manifestIndex=0,e.sequenceIndex=0,e.canvasIndex=0,this.reload(e)},t.prototype.isFullScreen=function(){return this.component.isFullScreen},t.prototype.isHeaderPanelEnabled=function(){return l.b.getBool(this.data.config.options.headerPanelEnabled,!0)},t.prototype.isLeftPanelEnabled=function(){if(l.b.getBool(this.data.config.options.leftPanelEnabled,!0)){if(this.helper.hasParentCollection())return!0;if(this.helper.isMultiCanvas()){var t=this.helper.getViewingHint();if(!t||t&&t!==R.g.CONTINUOUS)return!0}}return!1},t.prototype.isRightPanelEnabled=function(){return l.b.getBool(this.data.config.options.rightPanelEnabled,!0)},t.prototype.isFooterPanelEnabled=function(){return l.b.getBool(this.data.config.options.footerPanelEnabled,!0)},t.prototype.isMobile=function(){return $.browser.mobile},t.prototype.useArrowKeysToNavigate=function(){return l.b.getBool(this.data.config.options.useArrowKeysToNavigate,!0)},t.prototype.bookmark=function(){},t.prototype.feedback=function(){this.fire(s.a.FEEDBACK,this.data)},t.prototype.getAlternateLocale=function(){var t=null;return this.data.locales&&this.data.locales.length>1&&(t=this.data.locales[1]),t},t.prototype.getSerializedLocales=function(){return this.data.locales?this.serializeLocales(this.data.locales):null},t.prototype.serializeLocales=function(t){for(var e="",i=0;i<t.length;i++){var n=t[i];i>0&&(e+=","),e+=n.name,n.label&&(e+=":"+n.label)}return e},t.prototype.changeLocale=function(t){var e={};if(this.data.locales){e.locales=this.data.locales.slice(0);var i=e.locales.findIndex((function(e){return e.name===t}));e.locales.splice(0,0,e.locales.splice(i,1)[0]),this.reload(e)}},t}()},72:function(t,e,i){"use strict";var n=i(3),o=i(36),s=function(t,e){this.message=t,this.actions=e},a=function(){},r=i(43),h=function(){function t(t){this.extension=t}return t.prototype.Get=function(t){var e=this;switch(t.informationType){case r.a.AUTH_CORS_ERROR:return new s(this.extension.data.config.content.authCORSError,[]);case r.a.DEGRADED_RESOURCE:var i=[],o=new a,h=t.param.loginService.getConfirmLabel();h||(h=this.extension.data.config.content.fallbackDegradedLabel),o.label=h;var c=t.param;o.action=function(){c.authHoldingPage=window.open("","_blank"),e.extension.component.publish(n.a.HIDE_INFORMATION),e.extension.component.publish(n.a.OPEN_EXTERNAL_RESOURCE,[[c]])},i.push(o);var l=t.param.loginService.getServiceLabel();return l||(l=this.extension.data.config.content.fallbackDegradedMessage),new s(l,i)}},t}(),c=i(4);i.d(e,"a",(function(){return p}));var l,u=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),p=function(t){function e(e){return t.call(this,e,!1,!1)||this}return u(e,t),e.prototype.create=function(){var e=this;this.setConfig("headerPanel"),t.prototype.create.call(this),this.component.subscribe(n.a.SHOW_INFORMATION,(function(t){e.showInformation(t)})),this.component.subscribe(n.a.HIDE_INFORMATION,(function(){e.hideInformation()})),this.$options=$('<div class="options"></div>'),this.$element.append(this.$options),this.$centerOptions=$('<div class="centerOptions"></div>'),this.$options.append(this.$centerOptions),this.$rightOptions=$('<div class="rightOptions"></div>'),this.$options.append(this.$rightOptions),this.$localeToggleButton=$('<a class="localeToggle" tabindex="0"></a>'),this.$rightOptions.append(this.$localeToggleButton),this.$settingsButton=$('\n          <button class="btn imageBtn settings" tabindex="0" title="'+this.content.settings+'">\n            <i class="uv-icon-settings" aria-hidden="true"></i>'+this.content.settings+"\n          </button>\n        "),this.$settingsButton.attr("title",this.content.settings),this.$rightOptions.append(this.$settingsButton),this.$informationBox=$('<div class="informationBox" aria-hidden="true">                                     <div class="message"></div>                                     <div class="actions"></div>                                     <button type="button" class="close" aria-label="Close">                                         <span aria-hidden="true">&#215;</span>                                    </button>                                   </div>'),this.$element.append(this.$informationBox),this.$informationBox.hide(),this.$informationBox.find(".close").attr("title",this.content.close),this.$informationBox.find(".close").on("click",(function(t){t.preventDefault(),e.component.publish(n.a.HIDE_INFORMATION)})),this.$localeToggleButton.on("click",(function(){e.extension.changeLocale(String(e.$localeToggleButton.data("locale")))})),this.$settingsButton.onPressed((function(){e.component.publish(n.a.SHOW_SETTINGS_DIALOGUE)})),c.b.getBool(this.options.centerOptionsEnabled,!0)||this.$centerOptions.hide(),this.updateLocaleToggle(),this.updateSettingsButton()},e.prototype.updateLocaleToggle=function(){if(this.localeToggleIsVisible()){var t=this.extension.getAlternateLocale(),e=t.name.split("-")[0].toUpperCase();this.$localeToggleButton.data("locale",t.name),this.$localeToggleButton.attr("title",t.label),this.$localeToggleButton.text(e)}else this.$localeToggleButton.hide()},e.prototype.updateSettingsButton=function(){c.b.getBool(this.options.settingsButtonEnabled,!0)?this.$settingsButton.show():this.$settingsButton.hide()},e.prototype.localeToggleIsVisible=function(){var t=this.extension.data.locales;return!!t&&(t.length>1&&c.b.getBool(this.options.localeToggleEnabled,!1))},e.prototype.showInformation=function(t){var e=new h(this.extension);this.information=e.Get(t),this.$informationBox.find(".message").html(this.information.message).find("a").attr("target","_top");var i=this.$informationBox.find(".actions");i.empty();for(var n=0;n<this.information.actions.length;n++){var o=this.information.actions[n],s=$('<a href="#" class="btn btn-default">'+o.label+"</a>");s.on("click",o.action),i.append(s)}this.$informationBox.attr("aria-hidden","false"),this.$informationBox.show(),this.$element.addClass("showInformation"),this.extension.resize()},e.prototype.hideInformation=function(){this.$element.removeClass("showInformation"),this.$informationBox.attr("aria-hidden","true"),this.$informationBox.hide(),this.extension.resize()},e.prototype.getSettings=function(){return this.extension.getSettings()},e.prototype.updateSettings=function(t){this.extension.updateSettings(t),this.component.publish(n.a.UPDATE_SETTINGS,t)},e.prototype.resize=function(){t.prototype.resize.call(this);var e=this.$element.width()/2-this.$centerOptions.outerWidth()/2;if(this.$centerOptions.css({left:e}),this.$informationBox.is(":visible")){var i=this.$informationBox.find(".actions"),n=this.$informationBox.find(".message");n.width(Math.floor(this.$element.width())-Math.ceil(n.horizontalMargins())-Math.ceil(i.outerWidth(!0))-Math.ceil(this.$informationBox.find(".close").outerWidth(!0))-2),n.text(this.information.message)}this.extension.width()<this.extension.data.config.options.minWidthBreakPoint?this.localeToggleIsVisible()&&this.$localeToggleButton.hide():this.localeToggleIsVisible()&&this.$localeToggleButton.show()},e}(o.a)},73:function(t,e,i){"use strict";var n,o=i(3),s=i(54),a=i(4),r=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),h=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.create=function(){t.prototype.create.call(this),this.$element.width(this.options.panelCollapsedWidth)},e.prototype.init=function(){var e=this;t.prototype.init.call(this),a.b.getBool(this.extension.getSettings().rightPanelOpen,this.options.panelOpen)&&this.toggle(!0),this.component.subscribe(o.a.TOGGLE_EXPAND_RIGHT_PANEL,(function(){e.isFullyExpanded?e.collapseFull():e.expandFull()}))},e.prototype.getTargetWidth=function(){return this.isExpanded?this.options.panelCollapsedWidth:this.options.panelExpandedWidth},e.prototype.getTargetLeft=function(){return this.isExpanded?this.$element.parent().width()-this.options.panelCollapsedWidth:this.$element.parent().width()-this.options.panelExpandedWidth},e.prototype.toggleFinish=function(){t.prototype.toggleFinish.call(this),this.isExpanded?this.component.publish(o.a.OPEN_RIGHT_PANEL):this.component.publish(o.a.CLOSE_RIGHT_PANEL),this.extension.updateSettings({rightPanelOpen:this.isExpanded})},e.prototype.resize=function(){t.prototype.resize.call(this),this.$element.css({left:Math.floor(this.$element.parent().width()-this.$element.outerWidth())})},e}(s.a),c=i(7),l=i(8),u=i(58);i.d(e,"a",(function(){return d}));var p=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),d=function(t){function e(e){return t.call(this,e)||this}return p(e,t),e.prototype.create=function(){var e=this;this.setConfig("moreInfoRightPanel"),t.prototype.create.call(this),this.component.subscribe(o.a.CANVAS_INDEX_CHANGED,(function(){e.databind()})),this.component.subscribe(o.a.RANGE_CHANGED,(function(){e.databind()})),this.setTitle(this.config.content.title),this.$metadata=$('<div class="iiif-metadata-component"></div>'),this.$main.append(this.$metadata),this.metadataComponent=new u.MetadataComponent({target:this.$metadata[0],data:this._getData()}),this.metadataComponent.on("iiifViewerLinkClicked",(function(t){var i=a.o.getHashParameterFromString("rid",t);if(i){var n=e.extension.helper.getRangeById(i);n&&e.component.publish(o.a.RANGE_CHANGED,n)}}),!1)},e.prototype.toggleFinish=function(){t.prototype.toggleFinish.call(this),this.databind()},e.prototype.databind=function(){this.metadataComponent.set(this._getData())},e.prototype._getCurrentRange=function(){return this.extension.helper.getCurrentRange()},e.prototype._getData=function(){return{canvasDisplayOrder:this.config.options.canvasDisplayOrder,canvases:this.extension.getCurrentCanvases(),canvasExclude:this.config.options.canvasExclude,canvasLabels:this.extension.getCanvasLabels(this.content.page),content:this.config.content,copiedMessageDuration:2e3,copyToClipboardEnabled:a.b.getBool(this.config.options.copyToClipboardEnabled,!1),helper:this.extension.helper,licenseFormatter:new l.d(this.config.license?this.config.license:{}),limit:this.config.options.textLimit||4,limitType:u.LimitType.LINES,limitToRange:a.b.getBool(this.config.options.limitToRange,!1),manifestDisplayOrder:this.config.options.manifestDisplayOrder,manifestExclude:this.config.options.manifestExclude,range:this._getCurrentRange(),rtlLanguageCodes:this.config.options.rtlLanguageCodes,sanitizer:function(t){return Object(c.c)(t)},showAllLanguages:this.config.options.showAllLanguages}},e.prototype.resize=function(){t.prototype.resize.call(this),this.$main.height(this.$element.height()-this.$top.height()-this.$main.verticalMargins())},e}(h)},74:function(t,e,i){"use strict";var n,o=i(36);!function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_CENTER=1]="TOP_CENTER",t[t.TOP_RIGHT=2]="TOP_RIGHT",t[t.CENTER_LEFT=3]="CENTER_LEFT",t[t.CENTER=4]="CENTER",t[t.CENTER_RIGHT=5]="CENTER_RIGHT",t[t.BOTTOM_LEFT=6]="BOTTOM_LEFT",t[t.BOTTOM_CENTER=7]="BOTTOM_CENTER",t[t.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"}(n||(n={}));var s=i(7),a=i(4);i.d(e,"a",(function(){return c}));var r,h=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),c=function(t){function e(e){var i=t.call(this,e,!1,!0)||this;return i.subtitleExpanded=!1,i.isAttributionOpen=!1,i.attributionPosition=n.BOTTOM_LEFT,i}return h(e,t),e.prototype.create=function(){var e=this;t.prototype.create.call(this),this.$title=$('<div class="title"></div>'),this.$element.append(this.$title),this.$subtitle=$('<div class="subtitle">\n                                <div class="wrapper">\n                                    <button type="button" class="expand-btn" aria-label="Expand">\n                                        <span aria-hidden="true">+</span>\n                                    </button>\n                                    <span class="text"></span>\n                                </div>\n                            </div>'),this.$element.append(this.$subtitle),this.$subtitleWrapper=this.$subtitle.find(".wrapper"),this.$subtitleExpand=this.$subtitle.find(".expand-btn"),this.$subtitleText=this.$subtitle.find(".text"),this.$content=$('<div id="content" class="content"></div>'),this.$element.append(this.$content),this.$attribution=$('\n                                <div class="attribution">\n                                  <div class="header">\n                                    <div class="title"></div>\n                                    <button type="button" class="close" aria-label="Close">\n                                      <span aria-hidden="true">&#215;</span>\n                                    </button>\n                                  </div>\n                                  <div class="main">\n                                    <div class="attribution-text"></div>\n                                    <div class="license"></div>\n                                    <div class="logo"></div>\n                                  </div>\n                                </div>\n        '),this.$attribution.find(".header .title").text(this.content.attribution),this.$content.append(this.$attribution),this.closeAttribution(),this.$closeAttributionButton=this.$attribution.find(".header .close"),this.$closeAttributionButton.on("click",(function(t){t.preventDefault(),e.closeAttribution()})),this.$subtitleExpand.on("click",(function(t){t.preventDefault(),e.subtitleExpanded=!e.subtitleExpanded,e.subtitleExpanded?(e.$subtitleWrapper.addClass("expanded"),e.$subtitleExpand.text("-")):(e.$subtitleWrapper.removeClass("expanded"),e.$subtitleExpand.text("+")),e.resize()})),a.b.getBool(this.options.titleEnabled,!0)?this.$title.removeClass("hidden"):this.$title.addClass("hidden"),a.b.getBool(this.options.subtitleEnabled,!1)?this.$subtitle.removeClass("hidden"):this.$subtitle.addClass("hidden"),this.whenResized((function(){e.updateRequiredStatement()}))},e.prototype.openAttribution=function(){this.$attribution.show(),this.isAttributionOpen=!0},e.prototype.closeAttribution=function(){this.$attribution.hide(),this.isAttributionOpen=!1},e.prototype.updateRequiredStatement=function(){var t=this,e=this.extension.helper.getRequiredStatement(),i=a.b.getBool(this.options.requiredStatementEnabled,!0);if(e&&e.value&&i){this.openAttribution();var n=this.$attribution.find(".title"),o=this.$attribution.find(".attribution-text"),r=this.$attribution.find(".license"),h=this.$attribution.find(".logo");if(e.label){var c=Object(s.c)(e.label);n.html(c)}else n.text(this.content.attribution);if(e.value){var l=Object(s.c)(e.value);o.html(l),o.find("img").one("load",(function(){t.resize()})).each((function(){this.complete&&$(this).load()})),o.targetBlank()}r.hide(),h.hide(),this.resize()}},e.prototype.resize=function(){t.prototype.resize.call(this);var e,i,o=this.extension.shell.$leftPanel.is(":visible")?Math.floor(this.extension.shell.$leftPanel.width()):0,a=this.extension.shell.$rightPanel.is(":visible")?Math.floor(this.extension.shell.$rightPanel.width()):0,r=Math.floor(this.$element.parent().width()-o-a);if(this.$element.css({left:o,width:r}),e=this.options&&!1===this.options.titleEnabled||!this.$title.is(":visible")?0:this.$title.height(),i=this.options&&!1===this.options.subtitleEnabled||!this.$subtitle.is(":visible")?0:this.$subtitle.height(),this.$content.height(this.$element.height()-e-i),this.$content.width(this.$element.width()),this.$attribution&&this.isAttributionOpen){switch(this.attributionPosition){case n.BOTTOM_LEFT:this.$attribution.css("top",this.$content.height()-this.$attribution.outerHeight()-this.$attribution.verticalMargins()),this.$attribution.css("left",0);break;case n.BOTTOM_RIGHT:this.$attribution.css("top",this.$content.height()-this.$attribution.outerHeight()-this.$attribution.verticalMargins()),this.$attribution.css("left",this.$content.width()-this.$attribution.outerWidth()-this.$attribution.horizontalMargins())}this.$content.width()<=this.$attribution.width()?this.$attribution.hide():this.$attribution.show()}this.subtitle&&this.options.subtitleEnabled?(this.$subtitleText.html(Object(s.c)(this.subtitle.replace(/<br\s*[\/]?>/gi,"; "))),this.$subtitleText.removeClass("elided"),this.$subtitle.removeClass("hidden"),this.$subtitleWrapper.css("max-height",this.$content.height()+this.$subtitle.outerHeight()),this.$subtitleWrapper.width(this.$content.width()),this.subtitleExpanded?this.$subtitleText.width(this.$content.width()-this.$subtitleText.horizontalMargins()-2):(this.$subtitleText.width("auto"),this.$subtitleWrapper.width("auto"),this.$subtitleExpand.hide(),this.$subtitleText.width()>this.$content.width()&&(this.$subtitleExpand.show(),this.$subtitleText.addClass("elided"),this.$subtitleText.width(this.$content.width()-(this.$subtitleExpand.outerWidth()+this.$subtitleText.horizontalMargins()))))):this.$subtitle.addClass("hidden")},e}(o.a)}}]);