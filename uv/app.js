var requirejs,require,define;!function(global){function commentReplace(e,t,n,i){return i||""}function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,i){return t&&eachProp(t,function(t,o){(n||!hasProp(e,o))&&(!i||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[o]=t:(e[o]||(e[o]={}),mixin(e[o],t,n,i)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,i){var o=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return o.requireType=e,o.requireModules=i,n&&(o.originalError=n),o}function newContext(e){function t(e){var t,n;for(t=0;t<e.length;t++)if(n=e[t],"."===n)e.splice(t,1),t-=1;else if(".."===n){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}function n(e,n,i){var o,s,a,r,l,h,c,u,p,d,m,g,f=n&&n.split("/"),v=y.map,$=v&&v["*"];if(e&&(e=e.split("/"),c=e.length-1,y.nodeIdCompat&&jsSuffixRegExp.test(e[c])&&(e[c]=e[c].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&f&&(g=f.slice(0,f.length-1),e=g.concat(e)),t(e),e=e.join("/")),i&&v&&(f||$)){a=e.split("/");e:for(r=a.length;r>0;r-=1){if(h=a.slice(0,r).join("/"),f)for(l=f.length;l>0;l-=1)if(s=getOwn(v,f.slice(0,l).join("/")),s&&(s=getOwn(s,h))){u=s,p=r;break e}!d&&$&&getOwn($,h)&&(d=getOwn($,h),m=r)}!u&&d&&(u=d,p=m),u&&(a.splice(0,p,u),e=a.join("/"))}return o=getOwn(y.pkgs,e),o?o:e}function i(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===E.contextName?(t.parentNode.removeChild(t),!0):void 0})}function o(e){var t=getOwn(y.paths,e);return t&&isArray(t)&&t.length>1?(t.shift(),E.require.undef(e),E.makeRequire(null,{skipMap:!0})([e]),!0):void 0}function s(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function a(e,t,i,o){var a,r,l,h,c=null,u=t?t.name:null,p=e,d=!0,m="";return e||(d=!1,e="_@r"+(T+=1)),h=s(e),c=h[0],e=h[1],c&&(c=n(c,u,o),r=getOwn(D,c)),e&&(c?m=r&&r.normalize?r.normalize(e,function(e){return n(e,u,o)}):-1===e.indexOf("!")?n(e,u,o):e:(m=n(e,u,o),h=s(m),c=h[0],m=h[1],i=!0,a=E.nameToUrl(m))),l=!c||r||i?"":"_unnormalized"+(O+=1),{prefix:c,name:m,parentMap:t,unnormalized:!!l,url:a,originalName:p,isDefine:d,id:(c?c+"!"+m:m)+l}}function r(e){var t=e.id,n=getOwn(x,t);return n||(n=x[t]=new E.Module(e)),n}function l(e,t,n){var i=e.id,o=getOwn(x,i);!hasProp(D,i)||o&&!o.defineEmitComplete?(o=r(e),o.error&&"error"===t?n(o.error):o.on(t,n)):"defined"===t&&n(D[i])}function h(e,t){var n=e.requireModules,i=!1;t?t(e):(each(n,function(t){var n=getOwn(x,t);n&&(n.error=e,n.events.error&&(i=!0,n.emit("error",e)))}),i||req.onError(e))}function c(){globalDefQueue.length&&(each(globalDefQueue,function(e){var t=e[0];"string"==typeof t&&(E.defQueueMap[t]=!0),B.push(e)}),globalDefQueue=[])}function u(e){delete x[e],delete S[e]}function p(e,t,n){var i=e.map.id;e.error?e.emit("error",e.error):(t[i]=!0,each(e.depMaps,function(i,o){var s=i.id,a=getOwn(x,s);!a||e.depMatched[o]||n[s]||(getOwn(t,s)?(e.defineDep(o,D[s]),e.check()):p(a,t,n))}),n[i]=!0)}function d(){var e,t,n=1e3*y.waitSeconds,s=n&&E.startTime+n<(new Date).getTime(),a=[],r=[],l=!1,c=!0;if(!$){if($=!0,eachProp(S,function(e){var n=e.map,h=n.id;if(e.enabled&&(n.isDefine||r.push(e),!e.error))if(!e.inited&&s)o(h)?(t=!0,l=!0):(a.push(h),i(h));else if(!e.inited&&e.fetched&&n.isDefine&&(l=!0,!n.prefix))return c=!1}),s&&a.length)return e=makeError("timeout","Load timeout for modules: "+a,null,a),e.contextName=E.contextName,h(e);c&&each(r,function(e){p(e,{},{})}),s&&!t||!l||!isBrowser&&!isWebWorker||_||(_=setTimeout(function(){_=0,d()},50)),$=!1}}function m(e){hasProp(D,e[0])||r(a(e[0],null,!0)).init(e[1],e[2])}function g(e,t,n,i){e.detachEvent&&!isOpera?i&&e.detachEvent(i,t):e.removeEventListener(n,t,!1)}function f(e){var t=e.currentTarget||e.srcElement;return g(t,E.onScriptLoad,"load","onreadystatechange"),g(t,E.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function v(){var e;for(c();B.length;){if(e=B.shift(),null===e[0])return h(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));m(e)}E.defQueueMap={}}var $,b,E,C,_,y={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},x={},S={},w={},B=[],D={},I={},R={},T=1,O=1;return C={require:function(e){return e.require?e.require:e.require=E.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?D[e.map.id]=e.exports:e.exports=D[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(y.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},b=function(e){this.events=getOwn(w,e.id)||{},this.map=e,this.shim=getOwn(y.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},b.prototype={init:function(e,t,n,i){i=i||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,E.startTime=(new Date).getTime();var e=this.map;return this.shim?void E.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;I[e]||(I[e]=!0,E.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id,i=this.depExports,o=this.exports,s=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(s)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{o=E.execCb(n,s,i,o)}catch(a){e=a}else o=E.execCb(n,s,i,o);if(this.map.isDefine&&void 0===o&&(t=this.module,t?o=t.exports:this.usingExports&&(o=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",h(this.error=e)}else o=s;if(this.exports=o,this.map.isDefine&&!this.ignore&&(D[n]=o,req.onResourceLoad)){var r=[];each(this.depMaps,function(e){r.push(e.normalizedMap||e)}),req.onResourceLoad(E,this.map,r)}u(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(E.defQueueMap,n)||this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=a(e.prefix);this.depMaps.push(i),l(i,"defined",bind(this,function(i){var o,s,c,p=getOwn(R,this.map.id),d=this.map.name,m=this.map.parentMap?this.map.parentMap.name:null,g=E.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(d=i.normalize(d,function(e){return n(e,m,!0)})||""),s=a(e.prefix+"!"+d,this.map.parentMap),l(s,"defined",bind(this,function(e){this.map.normalizedMap=s,this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),c=getOwn(x,s.id),void(c&&(this.depMaps.push(s),this.events.error&&c.on("error",bind(this,function(e){this.emit("error",e)})),c.enable()))):p?(this.map.url=E.nameToUrl(p),void this.load()):(o=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),o.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(x,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&u(e.map.id)}),h(e)}),o.fromText=bind(this,function(n,i){var s=e.name,l=a(s),c=useInteractive;i&&(n=i),c&&(useInteractive=!1),r(l),hasProp(y.config,t)&&(y.config[s]=y.config[t]);try{req.exec(n)}catch(u){return h(makeError("fromtexteval","fromText eval for "+t+" failed: "+u,u,[t]))}c&&(useInteractive=!0),this.depMaps.push(l),E.completeLoad(s),g([s],o)}),void i.load(e.name,g,o,y))})),E.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){S[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,i,o;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,o=getOwn(C,e.id))return void(this.depExports[t]=o(this));this.depCount+=1,l(e,"defined",bind(this,function(e){this.undefed||(this.defineDep(t,e),this.check())})),this.errback?l(e,"error",bind(this,this.errback)):this.events.error&&l(e,"error",bind(this,function(e){this.emit("error",e)}))}n=e.id,i=x[n],hasProp(C,n)||!i||i.enabled||E.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(x,e.id);t&&!t.enabled&&E.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},E={config:y,contextName:e,registry:x,defined:D,urlFetched:I,defQueue:B,defQueueMap:{},Module:b,makeModuleMap:a,nextTick:req.nextTick,onError:h,configure:function(e){if(e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/"),"string"==typeof e.urlArgs){var t=e.urlArgs;e.urlArgs=function(e,n){return(-1===n.indexOf("?")?"?":"&")+t}}var n=y.shim,i={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){i[t]?(y[t]||(y[t]={}),mixin(y[t],e,!0,!0)):y[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(R[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=E.makeShimExports(e)),n[t]=e}),y.shim=n),e.packages&&each(e.packages,function(e){var t,n;e="string"==typeof e?{name:e}:e,n=e.name,t=e.location,t&&(y.paths[n]=e.location),y.pkgs[n]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(x,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t,null,!0))}),(e.deps||e.callback)&&E.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,o){function s(n,i,l){var c,u,p;return o.enableBuildCallback&&i&&isFunction(i)&&(i.__requireJsBuild=!0),"string"==typeof n?isFunction(i)?h(makeError("requireargs","Invalid require call"),l):t&&hasProp(C,n)?C[n](x[t.id]):req.get?req.get(E,n,t,s):(u=a(n,t,!1,!0),c=u.id,hasProp(D,c)?D[c]:h(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(v(),E.nextTick(function(){v(),p=r(a(null,t)),p.skipMap=o.skipMap,p.init(n,i,l,{enabled:!0}),d()}),s)}return o=o||{},mixin(s,{isBrowser:isBrowser,toUrl:function(e){var i,o=e.lastIndexOf("."),s=e.split("/")[0],a="."===s||".."===s;return-1!==o&&(!a||o>1)&&(i=e.substring(o,e.length),e=e.substring(0,o)),E.nameToUrl(n(e,t&&t.id,!0),i,!0)},defined:function(e){return hasProp(D,a(e,t,!1,!0).id)},specified:function(e){return e=a(e,t,!1,!0).id,hasProp(D,e)||hasProp(x,e)}}),t||(s.undef=function(e){c();var n=a(e,t,!0),o=getOwn(x,e);o.undefed=!0,i(e),delete D[e],delete I[n.url],delete w[e],eachReverse(B,function(t,n){t[0]===e&&B.splice(n,1)}),delete E.defQueueMap[e],o&&(o.events.defined&&(w[e]=o.events),u(e))}),s},enable:function(e){var t=getOwn(x,e.id);t&&r(e).enable()},completeLoad:function(e){var t,n,i,s=getOwn(y.shim,e)||{},a=s.exports;for(c();B.length;){if(n=B.shift(),null===n[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);m(n)}if(E.defQueueMap={},i=getOwn(x,e),!t&&!hasProp(D,e)&&i&&!i.inited){if(!(!y.enforceDefine||a&&getGlobal(a)))return o(e)?void 0:h(makeError("nodefine","No define call for "+e,null,[e]));m([e,s.deps||[],s.exportsFn])}d()},nameToUrl:function(e,t,n){var i,o,s,a,r,l,h,c=getOwn(y.pkgs,e);if(c&&(e=c),h=getOwn(R,e))return E.nameToUrl(h,t,n);if(req.jsExtRegExp.test(e))r=e+(t||"");else{for(i=y.paths,o=e.split("/"),s=o.length;s>0;s-=1)if(a=o.slice(0,s).join("/"),l=getOwn(i,a)){isArray(l)&&(l=l[0]),o.splice(0,s,l);break}r=o.join("/"),r+=t||(/^data\:|^blob\:|\?/.test(r)||n?"":".js"),r=("/"===r.charAt(0)||r.match(/^[\w\+\.\-]+:/)?"":y.baseUrl)+r}return y.urlArgs&&!/^blob\:/.test(r)?r+y.urlArgs(e,r):r},load:function(e,t){req.load(E,e,t)},execCb:function(e,t,n,i){return t.apply(i,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=f(e);E.completeLoad(t.id)}},onScriptError:function(e){var t=f(e);if(!o(t.id)){var n=[];return eachProp(x,function(e,i){0!==i.indexOf("_@r")&&each(e.depMaps,function(e){return e.id===t.id?(n.push(i),!0):void 0})}),h(makeError("scripterror",'Script error for "'+t.id+(n.length?'", needed by: '+n.join(", "):'"'),e,[t.id]))}}},E.require=E.makeRequire(),E}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.2.0",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,i){var o,s,a=defContextName;return isArray(e)||"string"==typeof e||(s=e,isArray(t)?(e=t,t=n,n=i):e=[]),s&&s.context&&(a=s.context),o=getOwn(contexts,a),o||(o=contexts[a]=req.s.newContext(a)),s&&o.configure(s),o.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,n){var i=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return i.type=e.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i},req.load=function(e,t,n){var i,o=e&&e.config||{};if(isBrowser)return i=req.createNode(o,t,n),i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)),i.src=n,o.onNodeCreated&&o.onNodeCreated(i,o,t,n),currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{setTimeout(function(){},0),importScripts(n),e.completeLoad(t)}catch(s){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,s,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||-1!==mainScript.indexOf("!")||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(e,t,n){var i,o;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(i=currentlyAddingScript||getInteractiveScript(),i&&(e||(e=i.getAttribute("data-requiremodule")),o=contexts[i.getAttribute("data-requirecontext")])),o?(o.defQueue.push([e,t,n]),o.defQueueMap[e]=!0):globalDefQueue.push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("requireLib",function(){}),define("modules/uv-shared-module/BaseCommands",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}return e}();n.namespace="uv.",n.ACCEPT_TERMS=n.namespace+"onAcceptTerms",n.BOOKMARK=n.namespace+"onBookmark",n.CANVAS_INDEX_CHANGE_FAILED=n.namespace+"onCanvasIndexChangeFailed",n.CANVAS_INDEX_CHANGED=n.namespace+"onCanvasIndexChanged",n.CLICKTHROUGH=n.namespace+"onClickthrough",n.CLOSE_ACTIVE_DIALOGUE=n.namespace+"onCloseActiveDialogue",n.CLOSE_LEFT_PANEL=n.namespace+"onCloseLeftPanel",n.CLOSE_RIGHT_PANEL=n.namespace+"onCloseRightPanel",n.CREATED=n.namespace+"onCreated",n.DOWN_ARROW=n.namespace+"onDownArrow",n.DOWNLOAD=n.namespace+"onDownload",n.DROP=n.namespace+"onDrop",n.END=n.namespace+"onEnd",n.ESCAPE=n.namespace+"onEscape",n.EXTERNAL_LINK_CLICKED=n.namespace+"onExternalLinkClicked",n.FEEDBACK=n.namespace+"onFeedback",n.FORBIDDEN=n.namespace+"onForbidden",n.HIDE_CLICKTHROUGH_DIALOGUE=n.namespace+"onHideClickthroughDialogue",n.HIDE_DOWNLOAD_DIALOGUE=n.namespace+"onHideDownloadDialogue",n.HIDE_EMBED_DIALOGUE=n.namespace+"onHideEmbedDialogue",n.HIDE_EXTERNALCONTENT_DIALOGUE=n.namespace+"onHideExternalContentDialogue",n.HIDE_GENERIC_DIALOGUE=n.namespace+"onHideGenericDialogue",n.HIDE_HELP_DIALOGUE=n.namespace+"onHideHelpDialogue",n.HIDE_INFORMATION=n.namespace+"onHideInformation",n.HIDE_LOGIN_DIALOGUE=n.namespace+"onHideLoginDialogue",n.HIDE_MOREINFO_DIALOGUE=n.namespace+"onHideMoreInfoDialogue",n.HIDE_OVERLAY=n.namespace+"onHideOverlay",n.HIDE_RESTRICTED_DIALOGUE=n.namespace+"onHideRestrictedDialogue",n.HIDE_SETTINGS_DIALOGUE=n.namespace+"onHideSettingsDialogue",n.HIDE_SHARE_DIALOGUE=n.namespace+"onHideShareDialogue",n.HOME=n.namespace+"onHome",n.LEFT_ARROW=n.namespace+"onLeftArrow",n.LEFTPANEL_COLLAPSE_FULL_FINISH=n.namespace+"onLeftPanelCollapseFullFinish",n.LEFTPANEL_COLLAPSE_FULL_START=n.namespace+"onLeftPanelCollapseFullStart",n.LEFTPANEL_EXPAND_FULL_FINISH=n.namespace+"onLeftPanelExpandFullFinish",n.LEFTPANEL_EXPAND_FULL_START=n.namespace+"onLeftPanelExpandFullStart",n.LOAD_FAILED=n.namespace+"onLoadFailed",n.LOAD=n.namespace+"onLoad",n.LOGIN_FAILED=n.namespace+"onLoginFailed",n.LOGIN=n.namespace+"onLogin",n.LOGOUT=n.namespace+"onLogout",n.METRIC_CHANGED=n.namespace+"onMetricChanged",n.MINUS=n.namespace+"onMinus",n.NOT_FOUND=n.namespace+"onNotFound",n.OPEN_EXTERNAL_RESOURCE=n.namespace+"onOpenExternalResource",n.OPEN_LEFT_PANEL=n.namespace+"onOpenLeftPanel",n.OPEN_RIGHT_PANEL=n.namespace+"onOpenRightPanel",n.OPEN=n.namespace+"onOpen",n.PAGE_DOWN=n.namespace+"onPageDown",n.PAGE_UP=n.namespace+"onPageUp",n.PARENT_EXIT_FULLSCREEN=n.namespace+"onParentExitFullScreen",n.PLUS=n.namespace+"onPlus",n.REDIRECT=n.namespace+"onRedirect",n.REFRESH=n.namespace+"onRefresh",n.RESIZE=n.namespace+"onResize",n.RESOURCE_DEGRADED=n.namespace+"onResourceDegraded",n.RETRY=n.namespace+"onRetry",n.RETURN=n.namespace+"onReturn",n.RIGHT_ARROW=n.namespace+"onRightArrow",n.RIGHTPANEL_COLLAPSE_FULL_FINISH=n.namespace+"onRightPanelCollapseFullFinish",n.RIGHTPANEL_COLLAPSE_FULL_START=n.namespace+"onRightPanelCollapseFullStart",n.RIGHTPANEL_EXPAND_FULL_FINISH=n.namespace+"onRightPanelExpandFullFinish",n.RIGHTPANEL_EXPAND_FULL_START=n.namespace+"onRightPanelExpandFullStart",n.SEQUENCE_INDEX_CHANGED=n.namespace+"onSequenceIndexChanged",n.SETTINGS_CHANGED=n.namespace+"onSettingsChanged",n.SHOW_CLICKTHROUGH_DIALOGUE=n.namespace+"onShowClickThroughDialogue",n.SHOW_DOWNLOAD_DIALOGUE=n.namespace+"onShowDownloadDialogue",n.SHOW_EMBED_DIALOGUE=n.namespace+"onShowEmbedDialogue",n.SHOW_EXTERNALCONTENT_DIALOGUE=n.namespace+"onShowExternalContentDialogue",n.SHOW_GENERIC_DIALOGUE=n.namespace+"onShowGenericDialogue",n.SHOW_HELP_DIALOGUE=n.namespace+"onShowHelpDialogue",n.SHOW_INFORMATION=n.namespace+"onShowInformation",n.SHOW_LOGIN_DIALOGUE=n.namespace+"onShowLoginDialogue",n.SHOW_MOREINFO_DIALOGUE=n.namespace+"onShowMoreInfoDialogue",n.SHOW_OVERLAY=n.namespace+"onShowOverlay",n.SHOW_RESTRICTED_DIALOGUE=n.namespace+"onShowRestrictedDialogue",n.SHOW_SETTINGS_DIALOGUE=n.namespace+"onShowSettingsDialogue",n.SHOW_SHARE_DIALOGUE=n.namespace+"onShowShareDialogue",n.SHOW_TERMS_OF_USE=n.namespace+"onShowTermsOfUse",n.THUMB_SELECTED=n.namespace+"onThumbSelected",n.TOGGLE_EXPAND_LEFT_PANEL=n.namespace+"onToggleExpandLeftPanel",n.TOGGLE_EXPAND_RIGHT_PANEL=n.namespace+"onToggleExpandRightPanel",n.TOGGLE_FULLSCREEN=n.namespace+"onToggleFullScreen",n.UP_ARROW=n.namespace+"onUpArrow",n.UPDATE_SETTINGS=n.namespace+"onUpdateSettings",n.VIEW_FULL_TERMS=n.namespace+"onViewFullTerms",n.WINDOW_UNLOAD=n.namespace+"onWindowUnload",t.BaseCommands=n}),define("Params",["require","exports"],function(e,t){"use strict";var n;!function(e){e[e.collectionIndex=0]="collectionIndex",e[e.manifestIndex=1]="manifestIndex",e[e.sequenceIndex=2]="sequenceIndex",e[e.canvasIndex=3]="canvasIndex",e[e.xywh=4]="xywh",e[e.rotation=5]="rotation",e[e.highlight=6]="highlight",e[e.anchor=7]="anchor"}(n=t.Params||(t.Params={}))}),define("BootstrapParams",["require","exports","./Params"],function(e,t,n){"use strict";var i=function(){function e(){this.paramMap=["c","m","s","cv","xywh","r","h","a"],this.config=Utils.Urls.getQuerystringParameter("config"),this.domain=Utils.Urls.getQuerystringParameter("domain"),this.embedDomain=Utils.Urls.getQuerystringParameter("embedDomain"),this.embedScriptUri=Utils.Urls.getQuerystringParameter("embedScriptUri"),this.isHomeDomain="true"===Utils.Urls.getQuerystringParameter("isHomeDomain"),this.isLightbox="true"===Utils.Urls.getQuerystringParameter("isLightbox"),this.isOnlyInstance="true"===Utils.Urls.getQuerystringParameter("isOnlyInstance"),this.isReload="true"===Utils.Urls.getQuerystringParameter("isReload");var e=Utils.Urls.getQuerystringParameter("jsonp");this.jsonp=null===e?null:!("false"===e||"0"===e),this.manifestUri=Utils.Urls.getQuerystringParameter("manifestUri");var t=Utils.Urls.getQuerystringParameter("locale")||"en-GB";this.setLocale(t),this.collectionIndex=this.getParam(n.Params.collectionIndex),this.manifestIndex=this.getParam(n.Params.manifestIndex),this.sequenceIndex=this.getParam(n.Params.sequenceIndex),this.canvasIndex=this.getParam(n.Params.canvasIndex)}return e.prototype.getLocaleName=function(){return this.localeName},e.prototype.getParam=function(e){if(this.hashParamsAvailable()){var t=parseInt(Utils.Urls.getHashParameter(this.paramMap[e],parent.document));if(t||0===t)return t}return parseInt(Utils.Urls.getQuerystringParameter(this.paramMap[e]))||0},e.prototype.hashParamsAvailable=function(){return this.isHomeDomain&&!this.isReload&&this.isOnlyInstance},e.prototype.setLocale=function(e){this.locale=e,this.locales=[];for(var t=this.locale.split(","),n=0;n<t.length;n++){var i=t[n].split(":");this.locales.push({name:i[0].trim(),label:i[1]?i[1].trim():""})}this.localeName=this.locales[0].name},e}();t.BootstrapParams=i}),define("Bootstrapper",["require","exports","./modules/uv-shared-module/BaseCommands","./BootstrapParams"],function(e,t,n,i){"use strict";var o=function(){function e(e){this.isFullScreen=!1,this.extensions=e}return e.prototype.bootstrap=function(e){var t=this;this.params=new i.BootstrapParams,e&&(this.params=$.extend(!0,this.params,e)),this.params.manifestUri&&($("#app").empty(),$("#app").addClass("loading"),$('link[type*="text/css"]').remove(),jQuery.support.cors=!0,Manifold.loadManifest({iiifResourceUri:this.params.manifestUri,collectionIndex:this.params.collectionIndex,manifestIndex:this.params.manifestIndex,sequenceIndex:this.params.sequenceIndex,canvasIndex:this.params.canvasIndex,locale:this.params.localeName}).then(function(e){var n=e.getTrackingLabel();n+=", URI: "+t.params.embedDomain,window.trackingLabel=n;var i=e.getSequenceByIndex(t.params.sequenceIndex);if(!i)return void t.notFound();var o=e.getCanvasByIndex(t.params.canvasIndex);if(!o)return void t.notFound();var s=o.getType(),a=t.extensions[s.toString()];if(!a){var r=o.getProperty("format");a=t.extensions[r]}return a?(a.helper=e,void t.featureDetect(function(){t.configure(a,function(e){t.injectCss(a,e,function(){t.createExtension(a,e)})})})):void alert("No matching UV extension found.")})["catch"](function(){this.notFound()}))},e.prototype.isCORSEnabled=function(){return null===this.params.jsonp?Modernizr.cors:!this.params.jsonp},e.prototype.notFound=function(){try{return void parent.$(parent.document).trigger(n.BaseCommands.NOT_FOUND)}catch(e){}},e.prototype.featureDetect=function(e){yepnope({test:window.btoa&&window.atob,nope:"lib/base64.min.js",complete:function(){e()}})},e.prototype.configure=function(e,t){var n=this,i=this;this.getConfigExtension(e,function(o){var s="lib/"+e.name+"."+i.params.getLocaleName()+".config.json";$.getJSON(s,function(i){n.extendConfig(e,i,o,t)})})},e.prototype.extendConfig=function(e,t,n,i){t.name=e.name,n&&(t.uri=this.params.config,$.extend(!0,t,n)),i(t)},e.prototype.getConfigExtension=function(e,t){var n=sessionStorage.getItem(e.name+"."+this.params.localeName);if(n)t(JSON.parse(n));else if(this.params.config)if(this.isCORSEnabled())$.getJSON(this.params.config,function(e){t(e)});else{var i={url:this.params.config,type:"GET",dataType:"jsonp",jsonp:"callback",jsonpCallback:"configExtensionCallback"};$.ajax(i),window.configExtensionCallback=function(e){t(e)}}else t(null)},e.prototype.injectCss=function(e,t,n){var i="themes/"+t.options.theme+"/css/"+e.name+"/theme.css";yepnope.injectCss(i,function(){n()})},e.prototype.createExtension=function(e,t){this.config=t;var n=e.helper;this.extension=new e.type(this),this.extension.helper=n,this.extension.name=e.name,this.extension.create()},e}();t.Bootstrapper=o}),define("modules/uv-shared-module/Panel",["require","exports","./BaseCommands"],function(e,t,n){"use strict";var i=function(){function e(e,t,n){this.isResized=!1,this.$element=e,this.fitToParentWidth=t||!1,this.fitToParentHeight=n||!1,this.create()}return e.prototype.create=function(){var e=this;$.subscribe(n.BaseCommands.RESIZE,function(){e.resize()})},e.prototype.resize=function(){var e=this.$element.parent();this.fitToParentWidth&&this.$element.width(e.width()),this.fitToParentHeight&&this.$element.height(e.height()),this.isResized=!0},e}();t.Panel=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-shared-module/BaseView",["require","exports","./Panel"],function(e,t,n){"use strict";var i=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}return __extends(t,e),t.prototype.create=function(){this.bootstrapper=$("body > #app").data("bootstrapper"),e.prototype.create.call(this),this.extension=this.bootstrapper.extension,this.config={},this.config.content={},this.config.options={},this.content=this.config.content,this.options=this.config.options;var t=this;t.modules&&t.modules.length&&(t.modules=t.modules.reverse(),$.each(t.modules,function(e,n){t.config=$.extend(!0,t.config,t.extension.config.modules[n])}))},t.prototype.init=function(){},t.prototype.setConfig=function(e){this.modules||(this.modules=[]),this.modules.push(e)},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(n.Panel);t.BaseView=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-shared-module/Dialogue",["require","exports","./BaseView","./BaseCommands"],function(e,t,n,i){"use strict";var o=function(e){function t(t){var n=e.call(this,t,!1,!1)||this;return n.allowClose=!0,n.isActive=!1,n.isUnopened=!0,n}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("dialogue"),e.prototype.create.call(this),$.subscribe(i.BaseCommands.CLOSE_ACTIVE_DIALOGUE,function(){t.isActive&&t.allowClose&&t.close()}),$.subscribe(i.BaseCommands.ESCAPE,function(){t.isActive&&t.allowClose&&t.close()}),this.$top=$('<div class="top"></div>'),this.$element.append(this.$top),this.$closeButton=$('<a href="#" class="close" tabindex="0">'+this.content.close+"</a>"),this.$top.append(this.$closeButton),this.$middle=$('<div class="middle"></div>'),this.$element.append(this.$middle),this.$content=$('<div class="content"></div>'),this.$middle.append(this.$content),this.$bottom=$('<div class="bottom"></div>'),this.$element.append(this.$bottom),this.$closeButton.on("click",function(e){e.preventDefault(),t.close()}),this.returnFunc=this.close},t.prototype.enableClose=function(){this.allowClose=!0,this.$closeButton.show()},t.prototype.disableClose=function(){this.allowClose=!1,this.$closeButton.hide()},t.prototype.setDockedPosition=function(){var e=Math.floor(this.extension.height()-this.$element.outerHeight(!0)),t=0,n=0;if(this.$triggerButton){var i=Math.normalise(this.$triggerButton.offset().left,0,this.extension.width());t=Math.floor(this.extension.width()*i-this.$element.width()*i),n=this.$element.width()*i}this.$bottom.css("backgroundPosition",n+"px 0px"),this.$element.css({top:e,left:t})},t.prototype.open=function(e){var t=this;this.$element.show(),e&&e.length?(this.$triggerButton=e,this.$bottom.show()):this.$bottom.hide(),this.isActive=!0,setTimeout(function(){var e=t.$element.find(".default");if(e.length)e.focus();else{var n=t.$element.find("input:visible").first();n.length?n.focus():t.$closeButton.focus()}},1),$.publish(i.BaseCommands.SHOW_OVERLAY),this.isUnopened&&(this.isUnopened=!1,this.afterFirstOpen()),this.resize()},t.prototype.afterFirstOpen=function(){},t.prototype.close=function(){this.isActive&&(this.$element.hide(),this.isActive=!1,$.publish(this.closeCommand),$.publish(i.BaseCommands.HIDE_OVERLAY))},t.prototype.resize=function(){e.prototype.resize.call(this),this.$element.css({top:Math.floor(this.extension.height()/2-this.$element.height()/2),left:Math.floor(this.extension.width()/2-this.$element.width()/2)})},t}(n.BaseView);t.Dialogue=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);
};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-dialogues-module/ClickThroughDialogue",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/Dialogue"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("clickThroughDialogue"),e.prototype.create.call(this),this.openCommand=n.BaseCommands.SHOW_CLICKTHROUGH_DIALOGUE,this.closeCommand=n.BaseCommands.HIDE_CLICKTHROUGH_DIALOGUE,$.subscribe(this.openCommand,function(e,n){t.acceptCallback=n.acceptCallback,t.resource=n.resource,t.open()}),$.subscribe(this.closeCommand,function(e){t.close()}),this.$title=$("<h1></h1>"),this.$content.append(this.$title),this.$content.append('            <div>                <p class="message scroll"></p>                <div class="buttons">                    <a class="acceptTerms btn btn-primary" href="#" target="_parent"></a>                </div>            </div>'),this.$message=this.$content.find(".message"),this.$acceptTermsButton=this.$content.find(".acceptTerms"),this.$acceptTermsButton.text("Accept Terms and Open"),this.$element.hide(),this.$acceptTermsButton.on("click",function(e){e.preventDefault(),t.close(),$.publish(n.BaseCommands.ACCEPT_TERMS),t.acceptCallback&&t.acceptCallback()})},t.prototype.open=function(){e.prototype.open.call(this),this.$title.text(this.resource.clickThroughService.getProperty("label")),this.$message.html(this.resource.clickThroughService.getProperty("description")),this.$message.targetBlank(),this.$message.find("a").on("click",function(){var e=$(this).attr("href");$.publish(n.BaseCommands.EXTERNAL_LINK_CLICKED,[e])}),this.resize()},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(i.Dialogue);t.ClickThroughDialogue=o}),define("modules/uv-shared-module/InformationArgs",["require","exports"],function(e,t){"use strict";var n=function(){function e(e,t){this.informationType=e,this.param=t}return e}();t.InformationArgs=n}),define("modules/uv-shared-module/InformationType",["require","exports"],function(e,t){"use strict";var n;!function(e){e[e.AUTH_CORS_ERROR=0]="AUTH_CORS_ERROR",e[e.DEGRADED_RESOURCE=1]="DEGRADED_RESOURCE"}(n=t.InformationType||(t.InformationType={}))});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-dialogues-module/LoginDialogue",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/Dialogue"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("loginDialogue"),e.prototype.create.call(this),this.openCommand=n.BaseCommands.SHOW_LOGIN_DIALOGUE,this.closeCommand=n.BaseCommands.HIDE_LOGIN_DIALOGUE,$.subscribe(this.openCommand,function(e,n){t.loginCallback=n.loginCallback,t.logoutCallback=n.logoutCallback,t.options=n.options,t.resource=n.resource,t.open()}),$.subscribe(this.closeCommand,function(e){t.close()}),this.$title=$("<h1></h1>"),this.$content.append(this.$title),this.$content.append('            <div>                <p class="message scroll"></p>                <div class="buttons">                    <a class="logout btn btn-primary" href="#" target="_parent"></a>                    <a class="login btn btn-primary" href="#" target="_parent"></a>                    <a class="cancel btn btn-primary" href="#"></a>                </div>            </div>'),this.$message=this.$content.find(".message"),this.$loginButton=this.$content.find(".login"),this.$loginButton.text(this.content.login),this.$logoutButton=this.$content.find(".logout"),this.$logoutButton.text(this.content.logout),this.$cancelButton=this.$content.find(".cancel"),this.$cancelButton.text(this.content.cancel),this.$element.hide(),this.$loginButton.on("click",function(e){e.preventDefault(),t.close(),t.loginCallback&&t.loginCallback()}),this.$logoutButton.on("click",function(e){e.preventDefault(),t.close(),t.logoutCallback&&t.logoutCallback()}),this.$cancelButton.on("click",function(e){e.preventDefault(),t.close()}),this.updateLogoutButton()},t.prototype.open=function(){e.prototype.open.call(this),this.$title.text(this.resource.loginService.getProperty("label"));var t=this.resource.loginService.getProperty("description");this.options.warningMessage&&(t='<span class="warning">'+this.extension.config.content[this.options.warningMessage]+'</span><span class="description">'+t+"</span>"),this.updateLogoutButton(),this.$message.html(t),this.$message.targetBlank(),this.$message.find("a").on("click",function(){var e=$(this).attr("href");$.publish(n.BaseCommands.EXTERNAL_LINK_CLICKED,[e])}),this.options.showCancelButton?this.$cancelButton.show():this.$cancelButton.hide(),this.resize()},t.prototype.updateLogoutButton=function(){this.extension.isLoggedIn?this.$logoutButton.show():this.$logoutButton.hide()},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(i.Dialogue);t.LoginDialogue=o}),define("modules/uv-shared-module/LoginWarningMessages",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}return e}();n.FORBIDDEN="forbiddenResourceMessage",t.LoginWarningMessages=n}),define("modules/uv-shared-module/Metric",["require","exports"],function(e,t){"use strict";var n=function(){function e(e,t){this.minWidth=e,this.maxWidth=t}return e}();t.Metric=n}),define("modules/uv-shared-module/Metrics",["require","exports","./Metric"],function(e,t,n){"use strict";var i=function(){function e(){}return e}();i.MOBILE_LANDSCAPE=new n.Metric(0,640),i.LAPTOP=new n.Metric(640,1/0),t.Metrics=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-dialogues-module/RestrictedDialogue",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/Dialogue"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("restrictedDialogue"),e.prototype.create.call(this),this.openCommand=n.BaseCommands.SHOW_RESTRICTED_DIALOGUE,this.closeCommand=n.BaseCommands.HIDE_RESTRICTED_DIALOGUE,$.subscribe(this.openCommand,function(e,n){t.acceptCallback=n.acceptCallback,t.options=n.options,t.resource=n.resource,t.open()}),$.subscribe(this.closeCommand,function(e){t.close()}),this.$title=$("<h1></h1>"),this.$content.append(this.$title),this.$content.append('            <div>                <p class="message scroll"></p>                <div class="buttons">                    <a class="cancel btn btn-primary" href="#" target="_parent"></a>                </div>            </div>'),this.$message=this.$content.find(".message"),this.$message.targetBlank(),this.$cancelButton=this.$content.find(".cancel"),this.$cancelButton.text(this.content.cancel),this.$element.hide(),this.$cancelButton.on("click",function(e){e.preventDefault(),t.close()})},t.prototype.open=function(){e.prototype.open.call(this),this.isAccepted=!1,this.$title.text(this.resource.restrictedService.getProperty("label"));var t=this.resource.restrictedService.getProperty("description");this.$message.html(t),this.$message.targetBlank(),this.$message.find("a").on("click",function(){var e=$(this).attr("href");$.publish(n.BaseCommands.EXTERNAL_LINK_CLICKED,[e])}),this.resize()},t.prototype.close=function(){e.prototype.close.call(this),!this.isAccepted&&this.acceptCallback&&(this.isAccepted=!0,this.acceptCallback())},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(i.Dialogue);t.RestrictedDialogue=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-shared-module/GenericDialogue",["require","exports","./BaseCommands","./Dialogue"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("genericDialogue"),e.prototype.create.call(this),this.openCommand=n.BaseCommands.SHOW_GENERIC_DIALOGUE,this.closeCommand=n.BaseCommands.HIDE_GENERIC_DIALOGUE,$.subscribe(this.openCommand,function(e,n){t.acceptCallback=n.acceptCallback,t.showMessage(n)}),$.subscribe(this.closeCommand,function(e){t.close()}),this.$message=$("<p></p>"),this.$content.append(this.$message),this.$acceptButton=$('<a href="#" class="btn btn-primary accept default"></a>'),this.$content.append(this.$acceptButton),this.$acceptButton.text(this.content.ok),this.$acceptButton.onPressed(function(){t.accept()}),this.returnFunc=function(){t.isActive&&t.accept()},this.$element.hide()},t.prototype.accept=function(){$.publish(n.BaseCommands.CLOSE_ACTIVE_DIALOGUE),this.acceptCallback&&this.acceptCallback()},t.prototype.showMessage=function(e){this.$message.html(e.message),e.buttonText?this.$acceptButton.text(e.buttonText):this.$acceptButton.text(this.content.ok),e.allowClose===!1&&this.disableClose(),this.open()},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(i.Dialogue);t.GenericDialogue=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-shared-module/Shell",["require","exports","./BaseCommands","./BaseView","./GenericDialogue"],function(e,t,n,i,o){"use strict";var s=function(e){function t(n){var i=this;return t.$element=n,i=e.call(this,t.$element,!0,!0)||this}return __extends(t,e),t.prototype.create=function(){e.prototype.create.call(this),$.subscribe(n.BaseCommands.SHOW_OVERLAY,function(){t.$overlays.show()}),$.subscribe(n.BaseCommands.HIDE_OVERLAY,function(){t.$overlays.hide()}),t.$headerPanel=$('<div class="headerPanel"></div>'),t.$element.append(t.$headerPanel),t.$mainPanel=$('<div class="mainPanel"></div>'),t.$element.append(t.$mainPanel),t.$centerPanel=$('<div class="centerPanel"></div>'),t.$mainPanel.append(t.$centerPanel),t.$leftPanel=$('<div class="leftPanel"></div>'),t.$mainPanel.append(t.$leftPanel),t.$rightPanel=$('<div class="rightPanel"></div>'),t.$mainPanel.append(t.$rightPanel),t.$footerPanel=$('<div class="footerPanel"></div>'),t.$element.append(t.$footerPanel),t.$mobileFooterPanel=$('<div class="footerPanel mobile"></div>'),t.$element.append(t.$mobileFooterPanel),t.$overlays=$('<div class="overlays"></div>'),t.$element.append(t.$overlays),t.$genericDialogue=$('<div class="overlay genericDialogue"></div>'),t.$overlays.append(t.$genericDialogue),t.$overlays.on("click",function(e){$(e.target).hasClass("overlays")&&(e.preventDefault(),$.publish(n.BaseCommands.CLOSE_ACTIVE_DIALOGUE))}),new o.GenericDialogue(t.$genericDialogue)},t.prototype.resize=function(){e.prototype.resize.call(this),t.$overlays.width(this.extension.width()),t.$overlays.height(this.extension.height());var n=this.$element.height()-parseInt(t.$mainPanel.css("marginTop"))-(t.$headerPanel.is(":visible")?t.$headerPanel.height():0)-(t.$footerPanel.is(":visible")?t.$footerPanel.height():0)-(t.$mobileFooterPanel.is(":visible")?t.$mobileFooterPanel.height():0);t.$mainPanel.height(n)},t}(i.BaseView);t.Shell=s}),define("modules/uv-shared-module/BaseExtension",["require","exports","./BaseCommands","../../BootstrapParams","../../modules/uv-dialogues-module/ClickThroughDialogue","./InformationArgs","./InformationType","../../modules/uv-dialogues-module/LoginDialogue","./LoginWarningMessages","../../modules/uv-shared-module/Metrics","../../Params","../../modules/uv-dialogues-module/RestrictedDialogue","./Shell"],function(e,t,n,i,o,s,a,r,l,h,c,u,p){"use strict";var d=function(){function t(e){this.isCreated=!1,this.isLoggedIn=!1,this.shifted=!1,this.tabbing=!1,this.bootstrapper=e,this.config=this.bootstrapper.config,this.jsonp=this.bootstrapper.params.jsonp,this.locale=this.bootstrapper.params.getLocaleName(),this.isHomeDomain=this.bootstrapper.params.isHomeDomain,this.isReload=this.bootstrapper.params.isReload,this.embedDomain=this.bootstrapper.params.embedDomain,this.isOnlyInstance=this.bootstrapper.params.isOnlyInstance,this.embedScriptUri=this.bootstrapper.params.embedScriptUri,this.domain=this.bootstrapper.params.domain,this.isLightbox=this.bootstrapper.params.isLightbox}return t.prototype.create=function(){var e=this,t=this;this.$element=$("#app"),this.$element.data("bootstrapper",this.bootstrapper);var o=$(window);if(this.embedWidth=o.width(),this.embedHeight=o.height(),this.$element.width(this.embedWidth),this.$element.height(this.embedHeight),!this.isReload&&Utils.Documents.isInIFrame()&&(this.bootstrapper.socket=new easyXDM.Socket({onMessage:function(t,n){t=$.parseJSON(t),e.handleParentFrameEvent(t)}})),this.triggerSocket(n.BaseCommands.LOAD,{bootstrapper:{config:this.bootstrapper.config,params:this.bootstrapper.params},settings:this.getSettings(),preview:this.getSharePreview()}),this.$element.empty(),this.$element.removeClass(),this.$element.addClass("browser-"+window.browserDetect.browser),this.$element.addClass("browser-version-"+window.browserDetect.version),this.isHomeDomain||this.$element.addClass("embedded"),this.isLightbox&&this.$element.addClass("lightbox"),$(document).on("mousemove",function(t){e.mouseX=t.pageX,e.mouseY=t.pageY}),!this.isReload){window.onresize=function(){var t=$(window);$("body").height(t.height()),e.resize()};var s=Utils.Documents.getHiddenProp();if(s){var a=s.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(a,function(){Utils.Documents.isHidden()||e.resize()})}Utils.Bools.getBool(this.config.options.dropEnabled,!0)&&this.$element.on("drop",function(t){t.preventDefault();var o=t.originalEvent.dataTransfer.getData("URL"),s=Utils.Urls.getUrlParts(o),a=Utils.Urls.getQuerystringParameterFromString("manifest",s.search);if(a){e.triggerSocket(n.BaseCommands.DROP,a);var r=new i.BootstrapParams;r.manifestUri=a,e.reload(r)}}),this.$element.on("dragover",function(e){e.preventDefault()}),$(document).on("keyup keydown",function(t){e.shifted=t.shiftKey,e.tabbing=t.keyCode===KeyCodes.KeyDown.Tab}),$(document).keydown(function(e){var i=null,o=!0;e.ctrlKey||e.altKey||e.shiftKey||(e.keyCode===KeyCodes.KeyDown.Enter&&(i=n.BaseCommands.RETURN,o=!1),e.keyCode===KeyCodes.KeyDown.Escape&&(i=n.BaseCommands.ESCAPE),e.keyCode===KeyCodes.KeyDown.PageUp&&(i=n.BaseCommands.PAGE_UP),e.keyCode===KeyCodes.KeyDown.PageDown&&(i=n.BaseCommands.PAGE_DOWN),e.keyCode===KeyCodes.KeyDown.End&&(i=n.BaseCommands.END),e.keyCode===KeyCodes.KeyDown.Home&&(i=n.BaseCommands.HOME),(e.keyCode===KeyCodes.KeyDown.NumpadPlus||171===e.keyCode||e.keyCode===KeyCodes.KeyDown.Equals)&&(i=n.BaseCommands.PLUS,o=!1),(e.keyCode===KeyCodes.KeyDown.NumpadMinus||173===e.keyCode||e.keyCode===KeyCodes.KeyDown.Dash)&&(i=n.BaseCommands.MINUS,o=!1),t.useArrowKeysToNavigate()&&(e.keyCode===KeyCodes.KeyDown.LeftArrow&&(i=n.BaseCommands.LEFT_ARROW),e.keyCode===KeyCodes.KeyDown.UpArrow&&(i=n.BaseCommands.UP_ARROW),e.keyCode===KeyCodes.KeyDown.RightArrow&&(i=n.BaseCommands.RIGHT_ARROW),e.keyCode===KeyCodes.KeyDown.DownArrow&&(i=n.BaseCommands.DOWN_ARROW))),i&&(o&&e.preventDefault(),$.publish(i))}),this.bootstrapper.params.isHomeDomain&&Utils.Documents.isInIFrame()&&$.subscribe(n.BaseCommands.PARENT_EXIT_FULLSCREEN,function(){e.isOverlayActive()&&$.publish(n.BaseCommands.ESCAPE),$.publish(n.BaseCommands.ESCAPE),$.publish(n.BaseCommands.RESIZE)})}this.$element.append('<a href="/" id="top"></a>'),this.$element.append('<iframe id="commsFrame" style="display:none"></iframe>'),$.subscribe(n.BaseCommands.ACCEPT_TERMS,function(){e.triggerSocket(n.BaseCommands.ACCEPT_TERMS)}),$.subscribe(n.BaseCommands.LOGIN_FAILED,function(){e.triggerSocket(n.BaseCommands.LOGIN_FAILED),e.showMessage(e.config.content.authorisationFailedMessage)}),$.subscribe(n.BaseCommands.LOGIN,function(){e.isLoggedIn=!0,e.triggerSocket(n.BaseCommands.LOGIN)}),$.subscribe(n.BaseCommands.LOGOUT,function(){e.isLoggedIn=!1,e.triggerSocket(n.BaseCommands.LOGOUT)}),$.subscribe(n.BaseCommands.BOOKMARK,function(){e.bookmark(),e.triggerSocket(n.BaseCommands.BOOKMARK)}),$.subscribe(n.BaseCommands.CANVAS_INDEX_CHANGE_FAILED,function(){e.triggerSocket(n.BaseCommands.CANVAS_INDEX_CHANGE_FAILED)}),$.subscribe(n.BaseCommands.CANVAS_INDEX_CHANGED,function(t,i){e.triggerSocket(n.BaseCommands.CANVAS_INDEX_CHANGED,i)}),$.subscribe(n.BaseCommands.CLICKTHROUGH,function(){e.triggerSocket(n.BaseCommands.CLICKTHROUGH)}),$.subscribe(n.BaseCommands.CLOSE_ACTIVE_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.CLOSE_ACTIVE_DIALOGUE)}),$.subscribe(n.BaseCommands.CLOSE_LEFT_PANEL,function(){e.triggerSocket(n.BaseCommands.CLOSE_LEFT_PANEL),e.resize()}),$.subscribe(n.BaseCommands.CLOSE_RIGHT_PANEL,function(){e.triggerSocket(n.BaseCommands.CLOSE_RIGHT_PANEL),e.resize()}),$.subscribe(n.BaseCommands.CREATED,function(){e.isCreated=!0,e.triggerSocket(n.BaseCommands.CREATED)}),$.subscribe(n.BaseCommands.DOWN_ARROW,function(){e.triggerSocket(n.BaseCommands.DOWN_ARROW)}),$.subscribe(n.BaseCommands.DOWNLOAD,function(t,i){e.triggerSocket(n.BaseCommands.DOWNLOAD,i)}),$.subscribe(n.BaseCommands.END,function(){e.triggerSocket(n.BaseCommands.END)}),$.subscribe(n.BaseCommands.ESCAPE,function(){e.triggerSocket(n.BaseCommands.ESCAPE),e.isFullScreen()&&!e.isOverlayActive()&&$.publish(n.BaseCommands.TOGGLE_FULLSCREEN)}),$.subscribe(n.BaseCommands.EXTERNAL_LINK_CLICKED,function(t,i){e.triggerSocket(n.BaseCommands.EXTERNAL_LINK_CLICKED,i)}),$.subscribe(n.BaseCommands.FEEDBACK,function(){e.feedback()}),$.subscribe(n.BaseCommands.FORBIDDEN,function(){e.triggerSocket(n.BaseCommands.FORBIDDEN),$.publish(n.BaseCommands.OPEN_EXTERNAL_RESOURCE)}),$.subscribe(n.BaseCommands.HIDE_DOWNLOAD_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.HIDE_DOWNLOAD_DIALOGUE)}),$.subscribe(n.BaseCommands.HIDE_EMBED_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.HIDE_EMBED_DIALOGUE)}),$.subscribe(n.BaseCommands.HIDE_EXTERNALCONTENT_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.HIDE_EXTERNALCONTENT_DIALOGUE)}),$.subscribe(n.BaseCommands.HIDE_GENERIC_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.HIDE_GENERIC_DIALOGUE)}),$.subscribe(n.BaseCommands.HIDE_HELP_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.HIDE_HELP_DIALOGUE)}),$.subscribe(n.BaseCommands.HIDE_INFORMATION,function(){e.triggerSocket(n.BaseCommands.HIDE_INFORMATION)}),$.subscribe(n.BaseCommands.HIDE_LOGIN_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.HIDE_LOGIN_DIALOGUE)}),$.subscribe(n.BaseCommands.HIDE_OVERLAY,function(){e.triggerSocket(n.BaseCommands.HIDE_OVERLAY)}),$.subscribe(n.BaseCommands.HIDE_RESTRICTED_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.HIDE_RESTRICTED_DIALOGUE)}),$.subscribe(n.BaseCommands.HIDE_SETTINGS_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.HIDE_SETTINGS_DIALOGUE)}),$.subscribe(n.BaseCommands.HOME,function(){e.triggerSocket(n.BaseCommands.HOME)}),$.subscribe(n.BaseCommands.LEFT_ARROW,function(){e.triggerSocket(n.BaseCommands.LEFT_ARROW)}),$.subscribe(n.BaseCommands.LEFTPANEL_COLLAPSE_FULL_FINISH,function(){e.triggerSocket(n.BaseCommands.LEFTPANEL_COLLAPSE_FULL_FINISH)}),$.subscribe(n.BaseCommands.LEFTPANEL_COLLAPSE_FULL_START,function(){e.triggerSocket(n.BaseCommands.LEFTPANEL_COLLAPSE_FULL_START)}),$.subscribe(n.BaseCommands.LEFTPANEL_EXPAND_FULL_FINISH,function(){e.triggerSocket(n.BaseCommands.LEFTPANEL_EXPAND_FULL_FINISH)}),$.subscribe(n.BaseCommands.LEFTPANEL_EXPAND_FULL_START,function(){e.triggerSocket(n.BaseCommands.LEFTPANEL_EXPAND_FULL_START)}),$.subscribe(n.BaseCommands.LOAD_FAILED,function(){e.triggerSocket(n.BaseCommands.LOAD_FAILED),_.isNull(t.lastCanvasIndex)||t.lastCanvasIndex===t.helper.canvasIndex||e.viewCanvas(t.lastCanvasIndex)}),$.subscribe(n.BaseCommands.NOT_FOUND,function(){e.triggerSocket(n.BaseCommands.NOT_FOUND)}),$.subscribe(n.BaseCommands.OPEN,function(){e.triggerSocket(n.BaseCommands.OPEN);var t=String.format(e.config.options.openTemplate,e.helper.iiifResourceUri);window.open(t)}),$.subscribe(n.BaseCommands.OPEN_LEFT_PANEL,function(){e.triggerSocket(n.BaseCommands.OPEN_LEFT_PANEL),e.resize()}),$.subscribe(n.BaseCommands.OPEN_EXTERNAL_RESOURCE,function(){e.triggerSocket(n.BaseCommands.OPEN_EXTERNAL_RESOURCE)}),$.subscribe(n.BaseCommands.OPEN_RIGHT_PANEL,function(){e.triggerSocket(n.BaseCommands.OPEN_RIGHT_PANEL),e.resize()}),$.subscribe(n.BaseCommands.PAGE_DOWN,function(){e.triggerSocket(n.BaseCommands.PAGE_DOWN)}),$.subscribe(n.BaseCommands.PAGE_UP,function(){e.triggerSocket(n.BaseCommands.PAGE_UP)}),$.subscribe(n.BaseCommands.RESOURCE_DEGRADED,function(t,i){e.triggerSocket(n.BaseCommands.RESOURCE_DEGRADED),e.handleDegraded(i)}),$.subscribe(n.BaseCommands.RETURN,function(){e.triggerSocket(n.BaseCommands.RETURN)}),$.subscribe(n.BaseCommands.RIGHT_ARROW,function(){e.triggerSocket(n.BaseCommands.RIGHT_ARROW)}),$.subscribe(n.BaseCommands.RIGHTPANEL_COLLAPSE_FULL_FINISH,function(){e.triggerSocket(n.BaseCommands.RIGHTPANEL_COLLAPSE_FULL_FINISH)}),$.subscribe(n.BaseCommands.RIGHTPANEL_COLLAPSE_FULL_START,function(){e.triggerSocket(n.BaseCommands.RIGHTPANEL_COLLAPSE_FULL_START)}),$.subscribe(n.BaseCommands.RIGHTPANEL_EXPAND_FULL_FINISH,function(){e.triggerSocket(n.BaseCommands.RIGHTPANEL_EXPAND_FULL_FINISH)}),$.subscribe(n.BaseCommands.RIGHTPANEL_EXPAND_FULL_START,function(){e.triggerSocket(n.BaseCommands.RIGHTPANEL_EXPAND_FULL_START)}),$.subscribe(n.BaseCommands.SEQUENCE_INDEX_CHANGED,function(){e.triggerSocket(n.BaseCommands.SEQUENCE_INDEX_CHANGED)}),$.subscribe(n.BaseCommands.SETTINGS_CHANGED,function(t,i){e.triggerSocket(n.BaseCommands.SETTINGS_CHANGED,i)}),$.subscribe(n.BaseCommands.SHOW_DOWNLOAD_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.SHOW_DOWNLOAD_DIALOGUE)}),$.subscribe(n.BaseCommands.SHOW_EMBED_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.SHOW_EMBED_DIALOGUE)}),$.subscribe(n.BaseCommands.SHOW_EXTERNALCONTENT_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.SHOW_EXTERNALCONTENT_DIALOGUE)}),$.subscribe(n.BaseCommands.SHOW_GENERIC_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.SHOW_GENERIC_DIALOGUE)}),$.subscribe(n.BaseCommands.SHOW_HELP_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.SHOW_HELP_DIALOGUE)}),$.subscribe(n.BaseCommands.SHOW_INFORMATION,function(){e.triggerSocket(n.BaseCommands.SHOW_INFORMATION)}),$.subscribe(n.BaseCommands.SHOW_LOGIN_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.SHOW_LOGIN_DIALOGUE)}),$.subscribe(n.BaseCommands.SHOW_CLICKTHROUGH_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.SHOW_CLICKTHROUGH_DIALOGUE)}),$.subscribe(n.BaseCommands.SHOW_RESTRICTED_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.SHOW_RESTRICTED_DIALOGUE)}),$.subscribe(n.BaseCommands.SHOW_OVERLAY,function(){e.triggerSocket(n.BaseCommands.SHOW_OVERLAY)}),$.subscribe(n.BaseCommands.SHOW_SETTINGS_DIALOGUE,function(){e.triggerSocket(n.BaseCommands.SHOW_SETTINGS_DIALOGUE)}),$.subscribe(n.BaseCommands.SHOW_TERMS_OF_USE,function(){e.triggerSocket(n.BaseCommands.SHOW_TERMS_OF_USE);var t=e.helper.getAttribution();e.showMessage(t)}),$.subscribe(n.BaseCommands.THUMB_SELECTED,function(t,i){e.triggerSocket(n.BaseCommands.THUMB_SELECTED,i.index)}),$.subscribe(n.BaseCommands.TOGGLE_FULLSCREEN,function(){$("#top").focus(),e.bootstrapper.isFullScreen=!e.bootstrapper.isFullScreen,e.triggerSocket(n.BaseCommands.TOGGLE_FULLSCREEN,{isFullScreen:e.bootstrapper.isFullScreen,overrideFullScreen:e.config.options.overrideFullScreen})}),$.subscribe(n.BaseCommands.UP_ARROW,function(){e.triggerSocket(n.BaseCommands.UP_ARROW)}),$.subscribe(n.BaseCommands.UPDATE_SETTINGS,function(){e.triggerSocket(n.BaseCommands.UPDATE_SETTINGS)}),$.subscribe(n.BaseCommands.VIEW_FULL_TERMS,function(){e.triggerSocket(n.BaseCommands.VIEW_FULL_TERMS)}),$.subscribe(n.BaseCommands.WINDOW_UNLOAD,function(){e.triggerSocket(n.BaseCommands.WINDOW_UNLOAD)}),this.shell=new p.Shell(this.$element),this.getDependencies(function(t){e.loadDependencies(t)})},t.prototype.createModules=function(){this.$clickThroughDialogue=$('<div class="overlay clickthrough"></div>'),p.Shell.$overlays.append(this.$clickThroughDialogue),this.clickThroughDialogue=new o.ClickThroughDialogue(this.$clickThroughDialogue),this.$restrictedDialogue=$('<div class="overlay login"></div>'),p.Shell.$overlays.append(this.$restrictedDialogue),this.restrictedDialogue=new u.RestrictedDialogue(this.$restrictedDialogue),this.$loginDialogue=$('<div class="overlay login"></div>'),p.Shell.$overlays.append(this.$loginDialogue),this.loginDialogue=new r.LoginDialogue(this.$loginDialogue)},t.prototype.modulesCreated=function(){},t.prototype.getDependencies=function(t){var n=this,i="lib/"+this.name+"-dependencies",o=$("script[data-requiremodule]").filter(function(){var e=$(this).attr("data-requiremodule");return-1!=e.indexOf(n.name)&&-1!=e.indexOf("dependencies")});o.length?t(null):e([i],function(e){for(var n="lib/",i=0;i<e.dependencies.length;i++)e.dependencies[i]=n+e.dependencies[i];t(e)})},t.prototype.loadDependencies=function(t){var n=this;t?e(t.dependencies,function(){n.dependenciesLoaded()}):n.dependenciesLoaded()},t.prototype.dependenciesLoaded=function(){this.createModules(),this.modulesCreated(),$.publish(n.BaseCommands.RESIZE),$.publish(n.BaseCommands.CREATED),this.setParams(),this.setDefaultFocus(),this.viewCanvas(this.getCanvasIndexParam())},t.prototype.setParams=function(){this.isHomeDomain&&(this.setParam(c.Params.collectionIndex,this.helper.collectionIndex),this.setParam(c.Params.manifestIndex,this.helper.manifestIndex),this.setParam(c.Params.sequenceIndex,this.helper.sequenceIndex),this.setParam(c.Params.canvasIndex,this.helper.canvasIndex))},t.prototype.setDefaultFocus=function(){var e=this;setTimeout(function(){e.config.options.allowStealFocus&&$("[tabindex=0]").focus()},1)},t.prototype.width=function(){return $(window).width()},t.prototype.height=function(){return $(window).height()},t.prototype.triggerSocket=function(e,t){jQuery(document).trigger(e,[t]),this.bootstrapper.socket&&this.bootstrapper.socket.postMessage(JSON.stringify({eventName:e,eventObject:t}))},t.prototype.redirect=function(e){this.triggerSocket(n.BaseCommands.REDIRECT,e)},t.prototype.refresh=function(){this.triggerSocket(n.BaseCommands.REFRESH,null)},t.prototype._updateMetric=function(){for(var e=Object.keys(h.Metrics),t=0;t<e.length;t++){var i=h.Metrics[e[t]];this.width()>i.minWidth&&this.width()<=i.maxWidth&&this.metric!==i&&(this.metric=i,$.publish(n.BaseCommands.METRIC_CHANGED))}},t.prototype.resize=function(){this._updateMetric(),$.publish(n.BaseCommands.RESIZE)},t.prototype.handleParentFrameEvent=function(e){var t=this;Utils.Async.waitFor(function(){return t.isCreated},function(){switch(e.eventName){case n.BaseCommands.TOGGLE_FULLSCREEN:$.publish(n.BaseCommands.TOGGLE_FULLSCREEN,e.eventObject);break;case n.BaseCommands.PARENT_EXIT_FULLSCREEN:$.publish(n.BaseCommands.PARENT_EXIT_FULLSCREEN)}})},t.prototype.reload=function(e){var t=new i.BootstrapParams;e&&(t=$.extend(t,e)),t.isReload=!0,$.disposePubSub(),this.bootstrapper.bootstrap(t)},t.prototype.getCanvasIndexParam=function(){return this.bootstrapper.params.getParam(c.Params.canvasIndex)},t.prototype.getSequenceIndexParam=function(){return this.bootstrapper.params.getParam(c.Params.sequenceIndex)},t.prototype.isSeeAlsoEnabled=function(){return this.config.options.seeAlsoEnabled!==!1},t.prototype.getShareUrl=function(){if(this.isDeepLinkingEnabled())return Utils.Documents.isInIFrame()?parent.document.location.href:document.location.href;if(this.helper.hasRelatedPage()){var e=this.helper.getRelated();return e&&e.length&&(e=e[0]),e["@id"]}return null},t.prototype.getIIIFShareUrl=function(){return this.helper.iiifResourceUri+"?manifest="+this.helper.iiifResourceUri},t.prototype.addTimestamp=function(e){return e+"?t="+Utils.Dates.getTimeStamp()},t.prototype.isDeepLinkingEnabled=function(){return this.isHomeDomain&&this.isOnlyInstance},t.prototype.isOnHomeDomain=function(){return this.isDeepLinkingEnabled()},t.prototype.getDomain=function(){var e=Utils.Urls.getUrlParts(this.helper.iiifResourceUri);return e.host},t.prototype.getEmbedDomain=function(){return this.embedDomain},t.prototype.getSettings=function(){if(Utils.Bools.getBool(this.config.options.saveUserSettings,!1)){var e=Utils.Storage.get("uv.settings",Utils.StorageType.local);if(e)return $.extend(this.config.options,e.value)}return this.config.options},t.prototype.updateSettings=function(e){if(Utils.Bools.getBool(this.config.options.saveUserSettings,!1)){var t=Utils.Storage.get("uv.settings",Utils.StorageType.local);t&&(e=$.extend(t.value,e)),Utils.Storage.set("uv.settings",e,31536e4,Utils.StorageType.local)}this.config.options=$.extend(this.config.options,e)},t.prototype.sanitize=function(e){var t=document.createElement("div"),n=$(t);n.html(e);var i=new Sanitize({elements:["a","b","br","img","p","i","span"],attributes:{a:["href"],img:["src","alt"]},protocols:{a:{href:["http","https"]}}});return n.html(i.clean_node(t)),n.html()},t.prototype.getLocales=function(){if(this.locales)return this.locales;var e=this.config.localisation.locales.clone(),t=this.bootstrapper.params.locales,n=[];$.each(t,function(t,i){var o=_.filter(e,function(e){return e.name===i.name});if(o.length){var s=o[0];i.label&&(s.label=i.label),s.added=!0,n.push(s)}});var i=Utils.Bools.getBool(this.config.options.limitLocales,!1);return i||$.each(e,function(e,t){t.added||n.push(t),delete t.added}),this.locales=n},t.prototype.getAlternateLocale=function(){for(var e,t=this.getLocales(),n=0;n<t.length;n++){var i=t[n];i.name!==this.locale&&(e=i)}return i},t.prototype.changeLocale=function(e){var t=this.locales.clone(),n=t.indexOfTest(function(t){return t.name===e});t.move(n,0);var o=this.serializeLocales(t),s=new i.BootstrapParams;s.setLocale(o),this.reload(s)},t.prototype.serializeLocales=function(e){for(var t="",n=0;n<e.length;n++){var i=e[n];n>0&&(t+=","),t+=i.name,i.label&&(t+=":"+i.label)}return t},t.prototype.getSerializedLocales=function(){return this.serializeLocales(this.locales)},t.prototype.getSharePreview=function(){var e={};e.title=this.helper.getLabel();var t=this.helper.getCurrentCanvas(),n=t.getProperty("thumbnail");return n&&_.isString(n)||(n=t.getCanonicalImageUri(this.config.options.bookmarkThumbWidth)),e.image=n,e},t.prototype.getPagedIndices=function(e){return"undefined"==typeof e&&(e=this.helper.canvasIndex),[e]},t.prototype.getCurrentCanvases=function(){for(var e=this.getPagedIndices(this.helper.canvasIndex),t=[],n=0;n<e.length;n++){var i=e[n],o=this.helper.getCanvasByIndex(i);t.push(o)}return t},t.prototype.getCanvasLabels=function(e){var t=this.getPagedIndices(),n="";if(1===t.length)n=e;else for(var i=1;i<=t.length;i++)n.length&&(n+=","),n+=e+" "+i;return n},t.prototype.getCurrentCanvasRange=function(){var e=this.helper.getCanvasRange(this.helper.getCurrentCanvas());return e},t.prototype.getExternalResources=function(e){var t=this,i=this.getPagedIndices(),o=[];_.each(i,function(n){var i=t.helper.getCanvasByIndex(n),s=new Manifold.ExternalResource(i,t.helper.getInfoUri);if(s.index=n,e){var a=_.find(e,function(e){return e.dataUri===s.dataUri});a?o.push(a):o.push(s)}else o.push(s);
});var s=this.config.options.tokenStorage;return new Promise(function(e){manifesto.Utils.loadExternalResources(o,s,t.clickThrough,t.restricted,t.login,t.getAccessToken,t.storeAccessToken,t.getStoredAccessToken,t.handleExternalResourceResponse).then(function(n){t.resources=$.map(n,function(e){return e.data.index=e.index,_.toPlainObject(e.data)}),e(t.resources)})["catch"](function(e){switch(e.name){case manifesto.StatusCodes.AUTHORIZATION_FAILED.toString():$.publish(n.BaseCommands.LOGIN_FAILED);break;case manifesto.StatusCodes.FORBIDDEN.toString():$.publish(n.BaseCommands.FORBIDDEN);break;case manifesto.StatusCodes.RESTRICTED.toString():break;default:t.showMessage(e.message||e)}})})},t.prototype.getParam=function(e){var t;return this.isDeepLinkingEnabled()&&(t=Utils.Urls.getHashParameter(this.bootstrapper.params.paramMap[e],parent.document)),t||(t=Utils.Urls.getQuerystringParameter(this.bootstrapper.params.paramMap[e])),t},t.prototype.setParam=function(e,t){this.isDeepLinkingEnabled()&&Utils.Urls.setHashParameter(this.bootstrapper.params.paramMap[e],t,parent.document)},t.prototype.viewCanvas=function(e){this.helper.isCanvasIndexOutOfRange(e)&&(this.showMessage(this.config.content.canvasIndexOutOfRange),e=0),this.lastCanvasIndex=this.helper.canvasIndex,this.helper.canvasIndex=e,$.publish(n.BaseCommands.CANVAS_INDEX_CHANGED,[e]),$.publish(n.BaseCommands.OPEN_EXTERNAL_RESOURCE),this.setParam(c.Params.canvasIndex,e)},t.prototype.showMessage=function(e,t,i,o){this.closeActiveDialogue(),$.publish(n.BaseCommands.SHOW_GENERIC_DIALOGUE,[{message:e,acceptCallback:t,buttonText:i,allowClose:o}])},t.prototype.closeActiveDialogue=function(){$.publish(n.BaseCommands.CLOSE_ACTIVE_DIALOGUE)},t.prototype.isOverlayActive=function(){return p.Shell.$overlays.is(":visible")},t.prototype.viewManifest=function(e){var t=new i.BootstrapParams;t.manifestUri=this.helper.iiifResourceUri,t.collectionIndex=this.helper.getCollectionIndex(e),t.manifestIndex=e.index,t.sequenceIndex=0,t.canvasIndex=0,this.reload(t)},t.prototype.viewCollection=function(e){var t=new i.BootstrapParams;t.manifestUri=this.helper.iiifResourceUri,t.collectionIndex=e.index,t.manifestIndex=0,t.sequenceIndex=0,t.canvasIndex=0,this.reload(t)},t.prototype.isFullScreen=function(){return this.bootstrapper.isFullScreen},t.prototype.isHeaderPanelEnabled=function(){return Utils.Bools.getBool(this.config.options.headerPanelEnabled,!0)},t.prototype.isLeftPanelEnabled=function(){if(Utils.Bools.getBool(this.config.options.leftPanelEnabled,!0)){if(this.helper.hasParentCollection())return!0;if(this.helper.isMultiCanvas()&&this.helper.getViewingHint().toString()!==manifesto.ViewingHint.continuous().toString())return!0}return!1},t.prototype.isRightPanelEnabled=function(){return Utils.Bools.getBool(this.config.options.rightPanelEnabled,!0)},t.prototype.isFooterPanelEnabled=function(){return Utils.Bools.getBool(this.config.options.footerPanelEnabled,!0)},t.prototype.useArrowKeysToNavigate=function(){return Utils.Bools.getBool(this.config.options.useArrowKeysToNavigate,!0)},t.prototype.bookmark=function(){},t.prototype.feedback=function(){this.triggerSocket(n.BaseCommands.FEEDBACK,new i.BootstrapParams)},t.prototype.getBookmarkUri=function(){var e=parent.document.URL,t=Utils.Urls.getUrlParts(e),n=t.pathname+t.search+parent.document.location.hash;return n.startsWith("/")||(n="/"+n),n},t.prototype.clickThrough=function(e){return new Promise(function(t){$.publish(n.BaseCommands.SHOW_CLICKTHROUGH_DIALOGUE,[{resource:e,acceptCallback:function(){var i=window.open(e.clickThroughService.id),o=window.setInterval(function(){i.closed&&(window.clearInterval(o),$.publish(n.BaseCommands.CLICKTHROUGH),t())},500)}}])})},t.prototype.restricted=function(e){return new Promise(function(t,i){$.publish(n.BaseCommands.SHOW_RESTRICTED_DIALOGUE,[{resource:e,acceptCallback:function(){$.publish(n.BaseCommands.LOAD_FAILED),i(e)}}])})},t.prototype.login=function(e){return new Promise(function(t){var i={};e.status===HTTPStatusCode.FORBIDDEN&&(i.warningMessage=l.LoginWarningMessages.FORBIDDEN,i.showCancelButton=!0),$.publish(n.BaseCommands.SHOW_LOGIN_DIALOGUE,[{resource:e,loginCallback:function(){var i=window.open(e.loginService.id+"?t="+(new Date).getTime()),o=window.setInterval(function(){i.closed&&(window.clearInterval(o),$.publish(n.BaseCommands.LOGIN),t())},500)},logoutCallback:function(){var i=window.open(e.logoutService.id+"?t="+(new Date).getTime()),o=window.setInterval(function(){i.closed&&(window.clearInterval(o),$.publish(n.BaseCommands.LOGOUT),t())},500)},options:i}])})},t.prototype.getAccessToken=function(e,t){return new Promise(function(n,i){var o=e.tokenService.id,s=o+"|"+(new Date).getTime(),a=function(e){window.removeEventListener("message",a);var o=e.data;o.error?t?i(o.errorDescription):n(null):n(o)};window.addEventListener("message",a,!1);var r=o+"?messageId="+s;$("#commsFrame").prop("src",r)})},t.prototype.storeAccessToken=function(e,t,n){return new Promise(function(i,o){Utils.Storage.set(e.tokenService.id,t,t.expiresIn,new Utils.StorageType(n)),i()})},t.prototype.getStoredAccessToken=function(e,t){return new Promise(function(n,i){var o,s=[];if(e.tokenService&&(o=Utils.Storage.get(e.tokenService.id,new Utils.StorageType(t))),o)s.push(o);else for(var a=Utils.Urls.getUrlParts(e.dataUri).hostname,r=Utils.Storage.getItems(new Utils.StorageType(t)),l=0;l<r.length;l++)o=r[l],o.key.contains(a)&&s.push(o);s=_.sortBy(s,function(e){return e.expiresAt});var h;s.length&&(h=s.last().value),n(h)})},t.prototype.handleExternalResourceResponse=function(e){return new Promise(function(t,i){if(e.isResponseHandled=!0,e.status===HTTPStatusCode.OK)t(e);else if(e.status===HTTPStatusCode.MOVED_TEMPORARILY)t(e),$.publish(n.BaseCommands.RESOURCE_DEGRADED,[e]);else if(e.error.status===HTTPStatusCode.UNAUTHORIZED||e.error.status===HTTPStatusCode.INTERNAL_SERVER_ERROR)if(Modernizr.cors)i(e.error.statusText);else{var o=new s.InformationArgs(a.InformationType.AUTH_CORS_ERROR,null);$.publish(n.BaseCommands.SHOW_INFORMATION,[o]),t(e)}else if(e.error.status===HTTPStatusCode.FORBIDDEN){var r=new Error;r.message="Forbidden",r.name=manifesto.StatusCodes.FORBIDDEN.toString(),i(r)}else i(e.error.statusText)})},t.prototype.handleDegraded=function(e){var t=new s.InformationArgs(a.InformationType.DEGRADED_RESOURCE,e);$.publish(n.BaseCommands.SHOW_INFORMATION,[t])},t}();t.BaseExtension=d}),define("modules/uv-shared-module/Bookmark",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}return e}();t.Bookmark=n}),define("extensions/uv-seadragon-extension/Commands",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}return e}();n.namespace="seadragonExtension.",n.CLEAR_SEARCH=n.namespace+"onClearSearch",n.CURRENT_VIEW_URI=n.namespace+"onCurrentViewUri",n.FIRST=n.namespace+"onFirst",n.GALLERY_DECREASE_SIZE=n.namespace+"onGalleryDecreaseSize",n.GALLERY_INCREASE_SIZE=n.namespace+"onGalleryIncreaseSize",n.GALLERY_THUMB_SELECTED=n.namespace+"onGalleryThumbSelected",n.HIDE_MULTISELECT_DIALOGUE=n.namespace+"onHideMultiSelectDialogue",n.IMAGE_SEARCH=n.namespace+"onImageSearch",n.LAST=n.namespace+"onLast",n.MODE_CHANGED=n.namespace+"onModeChanged",n.MULTISELECT_CHANGE=n.namespace+"onMultiSelectChange",n.MULTISELECTION_MADE=n.namespace+"onMultiSelectionMade",n.NEXT_SEARCH_RESULT=n.namespace+"onNextSearchResult",n.NEXT=n.namespace+"onNext",n.NEXT_IMAGES_SEARCH_RESULT_UNAVAILABLE=n.namespace+"onNextImagesSearchResultUnavailable",n.PREV_IMAGES_SEARCH_RESULT_UNAVAILABLE=n.namespace+"onPrevImagesSearchResultUnavailable",n.OPEN_THUMBS_VIEW=n.namespace+"onOpenThumbsView",n.OPEN_TREE_VIEW=n.namespace+"onOpenTreeView",n.PAGE_SEARCH=n.namespace+"onPageSearch",n.PAGING_TOGGLED=n.namespace+"onPagingToggled",n.PREV_SEARCH_RESULT=n.namespace+"onPrevSearchResult",n.PREV=n.namespace+"onPrev",n.PRINT=n.namespace+"onPrint",n.ROTATE=n.namespace+"onRotate",n.SEADRAGON_ANIMATION_FINISH=n.namespace+"onAnimationfinish",n.SEADRAGON_ANIMATION_START=n.namespace+"onAnimationStart",n.SEADRAGON_ANIMATION=n.namespace+"onAnimation",n.SEADRAGON_OPEN=n.namespace+"onOpen",n.SEADRAGON_RESIZE=n.namespace+"onResize",n.SEADRAGON_ROTATION=n.namespace+"onRotation",n.SEARCH_PREVIEW_FINISH=n.namespace+"onSearchPreviewFinish",n.SEARCH_PREVIEW_START=n.namespace+"onSearchPreviewStart",n.SEARCH_RESULT_CANVAS_CHANGED=n.namespace+"onSearchResultCanvasChanged",n.SEARCH_RESULT_RECT_CHANGED=n.namespace+"onSearchResultRectChanged",n.SEARCH_RESULTS_EMPTY=n.namespace+"onSearchResultsEmpty",n.SEARCH_RESULTS=n.namespace+"onSearchResults",n.SEARCH_RESULTS_CLEARED=n.namespace+"onSearchResultsCleared",n.SEARCH=n.namespace+"onSearch",n.SHOW_MULTISELECT_DIALOGUE=n.namespace+"onShowMultiSelectDialogue",n.THUMB_MULTISELECTED=n.namespace+"onThumbMultiSelected",n.TREE_NODE_MULTISELECTED=n.namespace+"onTreeNodeMultiSelected",n.TREE_NODE_SELECTED=n.namespace+"onTreeNodeSelected",n.VIEW_PAGE=n.namespace+"onViewPage",n.ZOOM_IN=n.namespace+"onZoomIn",n.ZOOM_OUT=n.namespace+"onZoomOut",t.Commands=n});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-contentleftpanel-module/GalleryView",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/BaseView","../../extensions/uv-seadragon-extension/Commands"],function(e,t,n,i,o){"use strict";var s=function(e){function t(t){var n=e.call(this,t,!0,!0)||this;return n.isOpen=!1,n}return __extends(t,e),t.prototype.create=function(){this.setConfig("contentLeftPanel"),e.prototype.create.call(this),this.$gallery=$('<div class="iiif-gallery-component"></div>'),this.$element.append(this.$gallery)},t.prototype.setup=function(){this.component=new IIIFComponents.GalleryComponent({target:this.$gallery[0],data:this.galleryData}),this.component.on("thumbSelected",function(e){var t=e[0];$.publish(o.Commands.GALLERY_THUMB_SELECTED,[t]),$.publish(n.BaseCommands.THUMB_SELECTED,[t])}),this.component.on("decreaseSize",function(){$.publish(o.Commands.GALLERY_DECREASE_SIZE)}),this.component.on("increaseSize",function(){$.publish(o.Commands.GALLERY_INCREASE_SIZE)})},t.prototype.databind=function(){this.component.options.data=this.galleryData,this.component.set(null),this.resize()},t.prototype.show=function(){var e=this;this.isOpen=!0,this.$element.show(),setTimeout(function(){e.component.selectIndex(e.extension.helper.canvasIndex)},10)},t.prototype.hide=function(){this.isOpen=!1,this.$element.hide()},t.prototype.resize=function(){e.prototype.resize.call(this);var t=this.$gallery.find(".main"),n=this.$gallery.find(".header");t.height(this.$element.height()-n.height())},t}(i.BaseView);t.GalleryView=s});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-shared-module/BaseExpandPanel",["require","exports","./BaseView"],function(e,t,n){"use strict";var i=function(e){function t(t){var n=e.call(this,t,!1,!0)||this;return n.isExpanded=!1,n.isFullyExpanded=!1,n.isUnopened=!0,n.autoToggled=!1,n.expandFullEnabled=!0,n}return __extends(t,e),t.prototype.create=function(){var t=this;e.prototype.create.call(this),this.$top=$('<div class="top"></div>'),this.$element.append(this.$top),this.$title=$('<div class="title"></div>'),this.$title.prop("title",this.content.title),this.$top.append(this.$title),this.$expandFullButton=$('<a class="expandFullButton" tabindex="0"></a>'),this.$expandFullButton.prop("title",this.content.expandFull),this.$top.append(this.$expandFullButton),Utils.Bools.getBool(this.config.options.expandFullEnabled,!0)||this.$expandFullButton.hide(),this.$collapseButton=$('<div class="collapseButton" tabindex="0"></div>'),this.$collapseButton.prop("title",this.content.collapse),this.$top.append(this.$collapseButton),this.$closed=$('<div class="closed"></div>'),this.$element.append(this.$closed),this.$expandButton=$('<a class="expandButton" tabindex="0"></a>'),this.$expandButton.prop("title",this.content.expand),this.$closed.append(this.$expandButton),this.$closedTitle=$('<a class="title"></a>'),this.$closedTitle.prop("title",this.content.title),this.$closed.append(this.$closedTitle),this.$main=$('<div class="main"></div>'),this.$element.append(this.$main),this.$expandButton.onPressed(function(){t.toggle()}),this.$expandFullButton.onPressed(function(){t.expandFull()}),this.$closedTitle.onPressed(function(){t.toggle()}),this.$title.onPressed(function(){t.isFullyExpanded?t.collapseFull():t.toggle()}),this.$collapseButton.onPressed(function(){t.isFullyExpanded?t.collapseFull():t.toggle()}),this.$top.hide(),this.$main.hide()},t.prototype.init=function(){e.prototype.init.call(this)},t.prototype.setTitle=function(e){this.$title.text(e),this.$closedTitle.text(e)},t.prototype.toggle=function(e){var t=this;e?this.autoToggled=!0:this.autoToggled=!1,this.isExpanded&&(this.$top.hide(),this.$main.hide(),this.$closed.show()),this.$element.stop().animate({width:this.getTargetWidth(),left:this.getTargetLeft()},this.options.panelAnimationDuration,function(){t.toggled()})},t.prototype.toggled=function(){this.toggleStart(),this.isExpanded=!this.isExpanded,this.isExpanded&&(this.$closed.hide(),this.$top.show(),this.$main.show()),this.toggleFinish(),this.isUnopened=!1},t.prototype.expandFull=function(){var e=this;this.isExpanded||this.toggled();var t=this.getFullTargetWidth(),n=this.getFullTargetLeft();this.expandFullStart(),this.$element.stop().animate({width:t,left:n},this.options.panelAnimationDuration,function(){e.expandFullFinish()})},t.prototype.collapseFull=function(){var e=this,t=this.getTargetWidth(),n=this.getTargetLeft();this.collapseFullStart(),this.$element.stop().animate({width:t,left:n},this.options.panelAnimationDuration,function(){e.collapseFullFinish()})},t.prototype.getTargetWidth=function(){return 0},t.prototype.getTargetLeft=function(){return 0},t.prototype.getFullTargetWidth=function(){return 0},t.prototype.getFullTargetLeft=function(){return 0},t.prototype.toggleStart=function(){},t.prototype.toggleFinish=function(){this.isExpanded&&!this.autoToggled?this.focusCollapseButton():this.focusExpandButton()},t.prototype.expandFullStart=function(){},t.prototype.expandFullFinish=function(){this.isFullyExpanded=!0,this.$expandFullButton.hide(),this.focusCollapseButton()},t.prototype.collapseFullStart=function(){},t.prototype.collapseFullFinish=function(){this.isFullyExpanded=!1,this.expandFullEnabled&&this.$expandFullButton.show(),this.focusExpandFullButton()},t.prototype.focusExpandButton=function(){var e=this;setTimeout(function(){e.$expandButton.focus()},1)},t.prototype.focusExpandFullButton=function(){var e=this;setTimeout(function(){e.$expandFullButton.focus()},1)},t.prototype.focusCollapseButton=function(){var e=this;setTimeout(function(){e.$collapseButton.focus()},1)},t.prototype.resize=function(){e.prototype.resize.call(this),this.$main.height(this.$element.parent().height()-this.$top.outerHeight(!0))},t}(n.BaseView);t.BaseExpandPanel=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-shared-module/LeftPanel",["require","exports","./BaseCommands","./BaseExpandPanel"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;e.prototype.create.call(this),this.$element.width(this.options.panelCollapsedWidth),$.subscribe(n.BaseCommands.TOGGLE_EXPAND_LEFT_PANEL,function(){t.isFullyExpanded?t.collapseFull():t.expandFull()})},t.prototype.init=function(){e.prototype.init.call(this);var t=Utils.Bools.getBool(this.extension.getSettings().leftPanelOpen,this.options.panelOpen);t&&this.toggle(!0)},t.prototype.getTargetWidth=function(){return this.isFullyExpanded||!this.isExpanded?this.options.panelExpandedWidth:this.options.panelCollapsedWidth},t.prototype.getFullTargetWidth=function(){return this.$element.parent().width()},t.prototype.toggleFinish=function(){e.prototype.toggleFinish.call(this),this.isExpanded?$.publish(n.BaseCommands.OPEN_LEFT_PANEL):$.publish(n.BaseCommands.CLOSE_LEFT_PANEL),this.extension.updateSettings({leftPanelOpen:this.isExpanded})},t.prototype.resize=function(){e.prototype.resize.call(this),this.isFullyExpanded&&this.$element.width(this.$element.parent().width())},t}(i.BaseExpandPanel);t.LeftPanel=o}),define("extensions/uv-seadragon-extension/Mode",["require","exports"],function(e,t){"use strict";var n=function(){function e(e){this.value=e}return e.prototype.toString=function(){return this.value},e}();n.image=new n("image"),n.page=new n("page"),t.Mode=n});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-shared-module/ThumbsView",["require","exports","./BaseCommands","./BaseView"],function(e,t,n,i){"use strict";var o=function(e){function t(t){var n=e.call(this,t,!0,!0)||this;return n.isCreated=!1,n.isOpen=!1,n}return __extends(t,e),t.prototype.create=function(){var t=this;e.prototype.create.call(this),$.subscribe(n.BaseCommands.CANVAS_INDEX_CHANGED,function(e,n){t.selectIndex(parseInt(n))}),$.subscribe(n.BaseCommands.LOGIN,function(){t.loadThumbs()}),$.subscribe(n.BaseCommands.CLICKTHROUGH,function(){t.loadThumbs()}),this.$thumbs=$('<div class="thumbs"></div>'),this.$element.append(this.$thumbs),this.$thumbs.addClass(this.extension.helper.getViewingDirection().toString());var i=this;$.templates({thumbsTemplate:'<div id="thumb{{>index}}" class="{{:~className()}}" data-src="{{>uri}}" data-visible="{{>visible}}" data-index="{{>index}}">                                <div class="wrap" style="height:{{>height + ~extraHeight()}}px"></div>                                <div class="info">                                    <span class="index">{{:#index + 1}}</span>                                    <span class="label" title="{{>label}}">{{>label}}&nbsp;</span>                                    <span class="searchResults" title="{{:~searchResultsTitle()}}">{{>data.searchResults}}</span>                                </div>                             </div>                             {{if ~separator()}}                                  <div class="separator"></div>                              {{/if}}'});var o=this.options.thumbsExtraHeight;$.views.helpers({separator:function(){return!1},extraHeight:function(){return o},className:function(){var e="thumb";0===this.data.index&&(e+=" first"),this.data.uri||(e+=" placeholder");var t=i.extension.helper.getViewingDirection().toString();return e+=t===manifesto.ViewingDirection.topToBottom().toString()||t===manifesto.ViewingDirection.bottomToTop().toString()?" oneCol":" twoCol"},searchResultsTitle:function(){var e=Number(this.data.data.searchResults);return e?e>1?String.format(i.content.searchResults,e):String.format(i.content.searchResult,e):void 0}}),this.$element.on("scroll",function(){t.scrollStop()},100),this.resize()},t.prototype.databind=function(){this.thumbs&&(this._thumbsCache=null,this.createThumbs(),this.loadThumbs(0),this.selectIndex(this.extension.helper.canvasIndex))},t.prototype.createThumbs=function(){var e=this;if(this.thumbs){for(var t=[],i=0;i<this.thumbs.length;i++){var o=this.thumbs[i];t.push(o.height)}for(var s=Math.median(t),i=0;i<this.thumbs.length;i++){var o=this.thumbs[i];o.height=s}this.$thumbs.link($.templates.thumbsTemplate,this.thumbs),this.$thumbs.undelegate(".thumb","click"),this.$thumbs.delegate(".thumb","click",function(t){t.preventDefault();var i=$.view(this).data;e.lastThumbClickedIndex=i.index,$.publish(n.BaseCommands.THUMB_SELECTED,[i])}),this.setLabel(),this.isCreated=!0}},t.prototype.selectAll=function(e){},t.prototype.scrollStop=function(){var e=1/((this.$thumbs.height()-this.$element.height())/this.$element.scrollTop());e>1&&(e=1);var t=Math.floor((this.thumbs.length-1)*e);this.loadThumbs(t)},t.prototype.loadThumbs=function(e){if(this.thumbs&&this.thumbs.length){_.isUndefined(e)&&(e=this.extension.helper.canvasIndex);for(var t=e,n=this.options.thumbsLoadRange,i={start:t>n?t-n:0,end:t<this.thumbs.length-1-n?t+n:this.thumbs.length-1},o=this.options.thumbsImageFadeInDuration,s=i.start;s<=i.end;s++){var a=this.getThumbByIndex(s),r=a.find(".wrap");if(!r.hasClass("loading")&&!r.hasClass("loaded")){var l=a.attr("data-visible");if("false"!==l){r.removeClass("loadingFailed"),r.addClass("loading");var h=a.attr("data-src");h+="?t="+Utils.Dates.getTimeStamp();var c=$('<img src="'+h+'" />');$(c).hide().load(function(){$(this).fadeIn(o,function(){$(this).parent().swapClass("loading","loaded")})}).error(function(){$(this).parent().swapClass("loading","loadingFailed")}),r.append(c)}else r.addClass("hidden")}}}},t.prototype.show=function(){var e=this;this.isOpen=!0,this.$element.show(),setTimeout(function(){e.selectIndex(e.extension.helper.canvasIndex)},1)},t.prototype.hide=function(){this.isOpen=!1,this.$element.hide()},t.prototype.isPDF=function(){return this.extension.helper.getElementType().toString().contains("pdf")},t.prototype.setLabel=function(){$(this.$thumbs).find("span.index").hide(),$(this.$thumbs).find("span.label").show()},t.prototype.addSelectedClassToThumbs=function(e){this.getThumbByIndex(e).addClass("selected")},t.prototype.selectIndex=function(e){if(-1!==e&&this.thumbs&&this.thumbs.length){this.getAllThumbs().removeClass("selected"),this.$selectedThumb=this.getThumbByIndex(e),this.addSelectedClassToThumbs(e);var t=this.extension.getPagedIndices(e);~t.indexOf(this.lastThumbClickedIndex)||this.$element.scrollTop(this.$selectedThumb.position().top),this.loadThumbs(e)}},t.prototype.getAllThumbs=function(){return this._thumbsCache||(this._thumbsCache=this.$thumbs.find(".thumb")),this._thumbsCache},t.prototype.getThumbByIndex=function(e){return this.$thumbs.find('[data-index="'+e+'"]')},t.prototype.scrollToThumb=function(e){var t=this.getThumbByIndex(e);this.$element.scrollTop(t.position().top)},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(i.BaseView);t.ThumbsView=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-contentleftpanel-module/ThumbsView",["require","exports","../uv-shared-module/ThumbsView","../../extensions/uv-seadragon-extension/Commands","../../extensions/uv-seadragon-extension/Mode"],function(e,t,n,i,o){"use strict";var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("contentLeftPanel"),e.prototype.create.call(this),$.subscribe(i.Commands.MODE_CHANGED,function(e,n){t.setLabel()}),$.subscribe(i.Commands.SEARCH_PREVIEW_START,function(e,n){t.searchPreviewStart(n)}),$.subscribe(i.Commands.SEARCH_PREVIEW_FINISH,function(){t.searchPreviewFinish()}),this.extension.helper.isPaged()&&this.$thumbs.addClass("paged");var n=this;$.views.helpers({separator:function(){return n.extension.helper.isVerticallyAligned()?!0:n.extension.helper.isPaged()?(this.data.index-1)%2==0?!1:!0:!1}})},t.prototype.addSelectedClassToThumbs=function(e){if(this.extension.isPagingSettingEnabled())for(var t=this.extension.getPagedIndices(e),n=0;n<t.length;n++)this.getThumbByIndex(t[n]).addClass("selected");else this.getThumbByIndex(e).addClass("selected")},t.prototype.isPageModeEnabled=function(){return"function"==typeof this.extension.getMode?this.config.options.pageModeEnabled&&this.extension.getMode().toString()===o.Mode.page.toString():this.config.options.pageModeEnabled},t.prototype.searchPreviewStart=function(e){this.scrollToThumb(e);var t=this.getThumbByIndex(e);t.addClass("searchpreview")},t.prototype.searchPreviewFinish=function(){this.scrollToThumb(this.extension.helper.canvasIndex),this.getAllThumbs().removeClass("searchpreview")},t.prototype.setLabel=function(){this.isPDF()?($(this.$thumbs).find("span.index").hide(),$(this.$thumbs).find("span.label").hide()):this.isPageModeEnabled()?($(this.$thumbs).find("span.index").hide(),$(this.$thumbs).find("span.label").show()):($(this.$thumbs).find("span.index").show(),$(this.$thumbs).find("span.label").hide())},t}(n.ThumbsView);t.ThumbsView=s});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-contentleftpanel-module/TreeView",["require","exports","../uv-shared-module/BaseView","../../extensions/uv-seadragon-extension/Commands"],function(e,t,n,i){"use strict";var o=function(e){function t(t){var n=e.call(this,t,!0,!0)||this;return n.isOpen=!1,n}return __extends(t,e),t.prototype.create=function(){this.setConfig("contentLeftPanel"),e.prototype.create.call(this),this.$tree=$('<div class="iiif-tree-component"></div>'),this.$element.append(this.$tree)},t.prototype.setup=function(){this.component=new IIIFComponents.TreeComponent({target:this.$tree[0],data:this.treeData}),this.component.on("treeNodeSelected",function(e){var t=e[0];$.publish(i.Commands.TREE_NODE_SELECTED,[t])}),this.component.on("treeNodeMultiSelected",function(e){var t=e[0];$.publish(i.Commands.TREE_NODE_MULTISELECTED,[t])})},t.prototype.databind=function(){this.component.options.data=this.treeData,this.component.set(null),this.resize()},t.prototype.show=function(){this.isOpen=!0,this.$element.show()},t.prototype.hide=function(){this.isOpen=!1,this.$element.hide()},t.prototype.selectNode=function(e){this.component.selectNode(e)},t.prototype.deselectCurrentNode=function(){this.component.deselectCurrentNode()},t.prototype.getNodeById=function(e){return this.component.getNodeById(e)},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(n.BaseView);t.TreeView=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-contentleftpanel-module/ContentLeftPanel",["require","exports","../uv-shared-module/BaseCommands","../../extensions/uv-seadragon-extension/Commands","./GalleryView","../uv-shared-module/LeftPanel","../uv-shared-module/Metrics","../../extensions/uv-seadragon-extension/Mode","./ThumbsView","./TreeView"],function(e,t,n,i,o,s,a,r,l,h){"use strict";var c=function(e){function t(t){var n=e.call(this,t)||this;return n.expandFullEnabled=!1,n.isThumbsViewOpen=!1,n.isTreeViewOpen=!1,n.treeSortType=Manifold.TreeSortType.NONE,n}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("contentLeftPanel"),e.prototype.create.call(this);$.subscribe(n.BaseCommands.SETTINGS_CHANGED,function(){t.databind()}),$.subscribe(i.Commands.GALLERY_THUMB_SELECTED,function(){t.collapseFull()}),$.subscribe(n.BaseCommands.METRIC_CHANGED,function(){t.extension.metric===a.Metrics.MOBILE_LANDSCAPE&&t.isFullyExpanded&&t.collapseFull()}),$.subscribe(i.Commands.SEARCH_RESULTS,function(){t.databindThumbsView(),t.databindGalleryView()}),$.subscribe(i.Commands.SEARCH_RESULTS_CLEARED,function(){t.databindThumbsView(),t.databindGalleryView()}),$.subscribe(i.Commands.SEARCH_RESULTS_EMPTY,function(){t.databindThumbsView(),t.databindGalleryView()}),$.subscribe(n.BaseCommands.CANVAS_INDEX_CHANGED,function(e,n){t.isFullyExpanded&&t.collapseFull(),t.selectCurrentTreeNode(),t.updateTreeTabBySelection()}),this.$tabs=$('<div class="tabs"></div>'),this.$main.append(this.$tabs),this.$treeButton=$('<a class="index tab" tabindex="0">'+this.content.index+"</a>"),this.$tabs.append(this.$treeButton),this.$thumbsButton=$('<a class="thumbs tab" tabindex="0">'+this.content.thumbnails+"</a>"),this.$thumbsButton.prop("title",this.content.thumbnails),this.$tabs.append(this.$thumbsButton),this.$tabsContent=$('<div class="tabsContent"></div>'),this.$main.append(this.$tabsContent),this.$options=$('<div class="options"></div>'),this.$tabsContent.append(this.$options),this.$topOptions=$('<div class="top"></div>'),this.$options.append(this.$topOptions),this.$treeSelect=$("<select></select>"),this.$topOptions.append(this.$treeSelect),this.$bottomOptions=$('<div class="bottom"></div>'),this.$options.append(this.$bottomOptions),this.$leftOptions=$('<div class="left"></div>'),this.$bottomOptions.append(this.$leftOptions),this.$rightOptions=$('<div class="right"></div>'),this.$bottomOptions.append(this.$rightOptions),this.$treeViewOptions=$('<div class="treeView"></div>'),this.$leftOptions.append(this.$treeViewOptions),this.$sortByLabel=$('<span class="sort">'+this.content.sortBy+"</span>"),this.$treeViewOptions.append(this.$sortByLabel),this.$sortButtonGroup=$('<div class="btn-group"></div>'),this.$treeViewOptions.append(this.$sortButtonGroup),this.$sortByDateButton=$('<button class="btn tabindex="0"">'+this.content.date+"</button>"),this.$sortButtonGroup.append(this.$sortByDateButton),this.$sortByVolumeButton=$('<button class="btn" tabindex="0">'+this.content.volume+"</button>"),this.$sortButtonGroup.append(this.$sortByVolumeButton),this.$views=$('<div class="views"></div>'),this.$tabsContent.append(this.$views),this.$treeView=$('<div class="treeView"></div>'),this.$views.append(this.$treeView),this.$thumbsView=$('<div class="thumbsView" tabindex="0"></div>'),this.$views.append(this.$thumbsView),this.$galleryView=$('<div class="galleryView"></div>'),this.$views.append(this.$galleryView),this.$treeSelect.hide(),this.$treeSelect.change(function(){t.databindTreeView(),t.selectCurrentTreeNode(),t.updateTreeTabBySelection()}),this.$sortByDateButton.on("click",function(){t.sortByDate()}),this.$sortByVolumeButton.on("click",function(){t.sortByVolume()}),this.$treeViewOptions.hide(),this.$treeButton.onPressed(function(){t.openTreeView(),$.publish(i.Commands.OPEN_TREE_VIEW)}),this.$thumbsButton.onPressed(function(){t.openThumbsView(),$.publish(i.Commands.OPEN_THUMBS_VIEW)}),this.setTitle(this.content.title),this.$sortByVolumeButton.addClass("on");var o=this.options.tabOrder;if(o){o=o.toLowerCase(),o=o.replace(/ /g,"");var s=o.split(",");"thumbs"===s[0]?(this.$treeButton.before(this.$thumbsButton),this.$thumbsButton.addClass("first")):this.$treeButton.addClass("first")}},t.prototype.createTreeView=function(){this.treeView=new h.TreeView(this.$treeView),this.treeView.treeData=this.getTreeData(),this.treeView.setup(),this.databindTreeView();var e=this.extension.helper.getTopRanges();if(e.length>1)for(var t=0;t<e.length;t++){var n=e[t];this.$treeSelect.append('<option value="'+n.id+'">'+Manifesto.TranslationCollection.getValue(n.getLabel())+"</option>")}this.updateTreeViewOptions()},t.prototype.databind=function(){this.databindThumbsView(),this.databindTreeView(),this.databindGalleryView();
},t.prototype.updateTreeViewOptions=function(){var e=this.getTree();this.isCollection()&&this.extension.helper.treeHasNavDates(e)?this.$treeViewOptions.show():this.$treeViewOptions.hide(),this.$treeSelect.find("option").length?this.$treeSelect.show():this.$treeSelect.hide()},t.prototype.sortByDate=function(){this.treeSortType=Manifold.TreeSortType.DATE,this.treeView.treeData=this.getTreeData(),this.treeView.databind(),this.selectCurrentTreeNode(),this.$sortByDateButton.addClass("on"),this.$sortByVolumeButton.removeClass("on"),this.resize()},t.prototype.sortByVolume=function(){this.treeSortType=Manifold.TreeSortType.NONE,this.treeView.treeData=this.getTreeData(),this.treeView.databind(),this.selectCurrentTreeNode(),this.$sortByDateButton.removeClass("on"),this.$sortByVolumeButton.addClass("on"),this.resize()},t.prototype.isCollection=function(){var e=this.getTree();return e.data.type===manifesto.TreeNodeType.collection().toString()},t.prototype.databindTreeView=function(){this.treeView&&(this.treeView.treeData=this.getTreeData(),this.treeView.databind(),this.selectCurrentTreeNode())},t.prototype.getTreeData=function(){return{branchNodesSelectable:!1,helper:this.extension.helper,topRangeIndex:this.getSelectedTopRangeIndex(),treeSortType:this.treeSortType}},t.prototype.updateTreeTabByCanvasIndex=function(){var e=this.extension.helper.getTopRanges();if(e.length>1){var t=this.getCurrentCanvasTopRangeIndex(),n=e[t];this.setTreeTabTitle(Manifesto.TranslationCollection.getValue(n.getLabel()))}else this.setTreeTabTitle(this.content.index)},t.prototype.setTreeTabTitle=function(e){this.$treeButton.text(e),this.$treeButton.prop("title",e)},t.prototype.updateTreeTabBySelection=function(){var e,t=this.extension.helper.getTopRanges();t.length>1&&(e=this.treeView?this.getSelectedTree().text():Manifesto.TranslationCollection.getValue(t[0].getLabel())),e?this.setTreeTabTitle(e):this.setTreeTabTitle(this.content.index)},t.prototype.getViewingDirection=function(){return this.extension.helper.getViewingDirection()},t.prototype.createThumbsView=function(){this.thumbsView=new l.ThumbsView(this.$thumbsView),this.databindThumbsView()},t.prototype.databindThumbsView=function(){if(this.thumbsView){var e,t,n=this.getViewingDirection().toString();n===manifesto.ViewingDirection.topToBottom().toString()||n===manifesto.ViewingDirection.bottomToTop().toString()?(e=this.config.options.oneColThumbWidth,t=this.config.options.oneColThumbHeight):(e=this.config.options.twoColThumbWidth,t=this.config.options.twoColThumbHeight);var i=this.extension.helper.getThumbs(e,t);n===manifesto.ViewingDirection.bottomToTop().toString()&&i.reverse();var o=this.extension.searchResults;if(o&&o.length)for(var s=0;s<o.length;s++){var a=o[s],r=i.en().where(function(e){return e.index===a.canvasIndex}).first(),l=$.extend(!0,{},r.data);l.searchResults=a.rects.length,r.data=l}this.thumbsView.thumbs=i,this.thumbsView.databind()}},t.prototype.createGalleryView=function(){this.galleryView=new o.GalleryView(this.$galleryView),this.galleryView.galleryData=this.getGalleryData(),this.galleryView.setup(),this.databindGalleryView()},t.prototype.databindGalleryView=function(){this.galleryView&&(this.galleryView.galleryData=this.getGalleryData(),this.galleryView.databind())},t.prototype.getGalleryData=function(){return{helper:this.extension.helper,chunkedResizingThreshold:this.config.options.galleryThumbChunkedResizingThreshold,content:this.config.content,debug:!1,imageFadeInDuration:300,initialZoom:6,minLabelWidth:20,pageModeEnabled:this.isPageModeEnabled(),scrollStopDuration:100,searchResults:this.extension.searchResults,sizingEnabled:Modernizr.inputtypes.range,thumbHeight:this.config.options.galleryThumbHeight,thumbLoadPadding:this.config.options.galleryThumbLoadPadding,thumbWidth:this.config.options.galleryThumbWidth,viewingDirection:this.getViewingDirection()}},t.prototype.isPageModeEnabled=function(){return"function"==typeof this.extension.getMode?Utils.Bools.getBool(this.config.options.pageModeEnabled,!0)&&this.extension.getMode().toString()===r.Mode.page.toString():Utils.Bools.getBool(this.config.options.pageModeEnabled,!0)},t.prototype.getSelectedTree=function(){return this.$treeSelect.find(":selected")},t.prototype.getSelectedTopRangeIndex=function(){var e=this.getSelectedTree().index();return-1===e&&(e=0),e},t.prototype.getTree=function(){var e=this.getSelectedTopRangeIndex();return this.extension.helper.getTree(e,Manifold.TreeSortType.NONE)},t.prototype.toggleFinish=function(){if(e.prototype.toggleFinish.call(this),this.isUnopened){var t=Utils.Bools.getBool(this.config.options.treeEnabled,!0),n=Utils.Bools.getBool(this.config.options.thumbsEnabled,!0),i=this.getTree();i&&i.nodes.length||(t=!1),t&&n||this.$tabs.hide(),n&&this.defaultToThumbsView()?this.openThumbsView():t&&this.openTreeView()}},t.prototype.defaultToThumbsView=function(){var e=Utils.Bools.getBool(this.config.options.defaultToTreeEnabled,!1),t=this.config.options.defaultToTreeIfGreaterThan||0,n=this.getTree();return e&&n.nodes.length>t?!1:!0},t.prototype.expandFullStart=function(){e.prototype.expandFullStart.call(this),$.publish(n.BaseCommands.LEFTPANEL_EXPAND_FULL_START)},t.prototype.expandFullFinish=function(){e.prototype.expandFullFinish.call(this),this.$treeButton.hasClass("on")?this.openTreeView():this.$thumbsButton.hasClass("on")&&this.openThumbsView(),$.publish(n.BaseCommands.LEFTPANEL_EXPAND_FULL_FINISH)},t.prototype.collapseFullStart=function(){e.prototype.collapseFullStart.call(this),$.publish(n.BaseCommands.LEFTPANEL_COLLAPSE_FULL_START)},t.prototype.collapseFullFinish=function(){e.prototype.collapseFullFinish.call(this),this.$thumbsButton.hasClass("on")&&this.openThumbsView(),$.publish(n.BaseCommands.LEFTPANEL_COLLAPSE_FULL_FINISH)},t.prototype.openTreeView=function(){this.isTreeViewOpen=!0,this.isThumbsViewOpen=!1,this.treeView||this.createTreeView(),this.$treeButton.addClass("on"),this.$thumbsButton.removeClass("on"),this.treeView.show(),this.thumbsView&&this.thumbsView.hide(),this.galleryView&&this.galleryView.hide(),this.updateTreeViewOptions(),this.selectCurrentTreeNode(),this.resize(),this.treeView.resize()},t.prototype.openThumbsView=function(){this.isTreeViewOpen=!1,this.isThumbsViewOpen=!0,this.thumbsView||this.createThumbsView(),this.isFullyExpanded&&!this.galleryView&&this.createGalleryView(),this.$treeButton.removeClass("on"),this.$thumbsButton.addClass("on"),this.treeView&&this.treeView.hide(),this.$treeSelect.hide(),this.$treeViewOptions.hide(),this.resize(),this.isFullyExpanded?(this.thumbsView.hide(),this.galleryView&&this.galleryView.show(),this.galleryView&&this.galleryView.resize()):(this.galleryView&&this.galleryView.hide(),this.thumbsView.show(),this.thumbsView.resize())},t.prototype.selectTopRangeIndex=function(e){this.$treeSelect.prop("selectedIndex",e)},t.prototype.getCurrentCanvasTopRangeIndex=function(){var e=-1,t=this.extension.getCurrentCanvasRange();return t&&(e=Number(t.path.split("/")[0])),e},t.prototype.selectCurrentTreeNode=function(){if(this.treeView){var e,t=this.getCurrentCanvasTopRangeIndex(),n=this.getSelectedTopRangeIndex(),i=t===n;if(-1!=t){var o=this.extension.getCurrentCanvasRange();o&&o.treeNode&&(e=this.treeView.getNodeById(o.treeNode.id))}e&&i?this.treeView.selectNode(e):this.treeView.deselectCurrentNode()}},t.prototype.resize=function(){e.prototype.resize.call(this),this.$tabsContent.height(this.$main.height()-(this.$tabs.is(":visible")?this.$tabs.height():0)-this.$tabsContent.verticalPadding()),this.$views.height(this.$tabsContent.height()-this.$options.outerHeight())},t}(s.LeftPanel);t.ContentLeftPanel=c}),define("modules/uv-shared-module/Point",["require","exports"],function(e,t){"use strict";var n=function(){function e(e,t){this.x=e,this.y=t}return e}();t.Point=n}),define("extensions/uv-seadragon-extension/CroppedImageDimensions",["require","exports","../../modules/uv-shared-module/Point"],function(e,t,n){"use strict";var i=Utils.Measurements.Size,o=function(){function e(){this.region=new i(0,0),this.regionPos=new n.Point(0,0),this.size=new i(0,0)}return e}();t.CroppedImageDimensions=o}),define("modules/uv-shared-module/DownloadOption",["require","exports"],function(e,t){"use strict";var n=function(){function e(e){this.value=e}return e.prototype.toString=function(){return this.value},e}();n.currentViewAsJpg=new n("currentViewAsJpg"),n.dynamicCanvasRenderings=new n("dynamicCanvasRenderings"),n.dynamicImageRenderings=new n("dynamicImageRenderings"),n.dynamicSequenceRenderings=new n("dynamicSequenceRenderings"),n.entireFileAsOriginal=new n("entireFileAsOriginal"),n.selection=new n("selection"),n.wholeImageHighRes=new n("wholeImageHighRes"),n.wholeImagesHighRes=new n("wholeImagesHighRes"),n.wholeImageLowResAsJpg=new n("wholeImageLowResAsJpg"),t.DownloadOption=n});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-dialogues-module/DownloadDialogue",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/Dialogue","../uv-shared-module/DownloadOption"],function(e,t,n,i,o){"use strict";var s=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("downloadDialogue"),e.prototype.create.call(this),this.openCommand=n.BaseCommands.SHOW_DOWNLOAD_DIALOGUE,this.closeCommand=n.BaseCommands.HIDE_DOWNLOAD_DIALOGUE,$.subscribe(this.openCommand,function(e,n){t.open(n)}),$.subscribe(this.closeCommand,function(e){t.close()}),this.$title=$("<h1>"+this.content.title+"</h1>"),this.$content.append(this.$title),this.$noneAvailable=$('<div class="noneAvailable">'+this.content.noneAvailable+"</div>"),this.$content.append(this.$noneAvailable),this.$downloadOptions=$('<ol class="options"></ol>'),this.$content.append(this.$downloadOptions),this.$footer=$('<div class="footer"></div>'),this.$content.append(this.$footer),this.$termsOfUseButton=$('<a href="#">'+this.extension.config.content.termsOfUse+"</a>"),this.$footer.append(this.$termsOfUseButton),this.$termsOfUseButton.onPressed(function(){$.publish(n.BaseCommands.SHOW_TERMS_OF_USE)}),this.$element.hide(),this.updateTermsOfUseButton()},t.prototype.addEntireFileDownloadOptions=function(){var e=this;if(this.isDownloadOptionAvailable(o.DownloadOption.entireFileAsOriginal)){this.$downloadOptions.empty();var t=this.extension.helper.getCurrentCanvas(),n=!1;$.each(t.getRenderings(),function(t,i){var o=i.getFormat(),s="";o&&(s=o.toString()),e.addEntireFileDownloadOption(i.id,Manifesto.TranslationCollection.getValue(i.getLabel()),s),n=!0}),n||this.addEntireFileDownloadOption(t.id,null,null)}},t.prototype.addEntireFileDownloadOption=function(e,t,n){t?t+=" ({0})":t=this.content.entireFileAsOriginal;var i;i=n?Utils.Files.simplifyMimeType(n):this.getFileExtension(e),this.$downloadOptions.append('<li><a href="'+e+'" target="_blank" download tabindex="0">'+String.format(t,i)+"</li>")},t.prototype.updateNoneAvailable=function(){this.$downloadOptions.find("li:visible").length?this.$noneAvailable.hide():this.$noneAvailable.show()},t.prototype.updateTermsOfUseButton=function(){var e=this.extension.helper.getAttribution();Utils.Bools.getBool(this.extension.config.options.termsOfUseEnabled,!1)&&e?this.$termsOfUseButton.show():this.$termsOfUseButton.hide()},t.prototype.getFileExtension=function(e){return e.split(".").pop()},t.prototype.isDownloadOptionAvailable=function(e){switch(e){case o.DownloadOption.entireFileAsOriginal:this.extension.helper.manifest.getService(manifesto.ServiceProfile.uiExtensions());if(!this.extension.helper.isUIEnabled("mediaDownload"))return!1}return!0},t.prototype.close=function(){e.prototype.close.call(this)},t.prototype.resize=function(){this.setDockedPosition()},t}(i.Dialogue);t.DownloadDialogue=s}),define("extensions/uv-seadragon-extension/DownloadType",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}return e}();n.CURRENTVIEW="currentView",n.ENTIREDOCUMENTASPDF="entireDocumentAsPdf",n.ENTIREDOCUMENTASTEXT="entireDocumentAsText",n.WHOLEIMAGEHIGHRES="wholeImageHighRes",n.WHOLEIMAGESHIGHRES="wholeImageHighRes",n.WHOLEIMAGELOWRES="wholeImageLowRes",n.UNKNOWN="unknown",t.DownloadType=n});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-seadragon-extension/DownloadDialogue",["require","exports","../../modules/uv-shared-module/BaseCommands","../../modules/uv-dialogues-module/DownloadDialogue","./Commands","../../modules/uv-shared-module/DownloadOption","./DownloadType"],function(e,t,n,i,o,s,a){"use strict";var r=Utils.Measurements.Size,l=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("downloadDialogue"),e.prototype.create.call(this),this.$imageOptionsContainer=$('<li class="group image"></li>'),this.$downloadOptions.append(this.$imageOptionsContainer),this.$imageOptions=$("<ul></ul>"),this.$imageOptionsContainer.append(this.$imageOptions),this.$currentViewAsJpgButton=$('<li class="option single"><input id="'+s.DownloadOption.currentViewAsJpg.toString()+'" type="radio" name="downloadOptions" tabindex="0" /><label for="'+s.DownloadOption.currentViewAsJpg.toString()+'"></label></li>'),this.$imageOptions.append(this.$currentViewAsJpgButton),this.$currentViewAsJpgButton.hide(),this.$wholeImageHighResButton=$('<li class="option single"><input id="'+s.DownloadOption.wholeImageHighRes.toString()+'" type="radio" name="downloadOptions" tabindex="0" /><label id="'+s.DownloadOption.wholeImageHighRes.toString()+'label" for="'+s.DownloadOption.wholeImageHighRes.toString()+'"></label></li>'),this.$imageOptions.append(this.$wholeImageHighResButton),this.$wholeImageHighResButton.hide(),this.$wholeImagesHighResButton=$('<li class="option multiple"><input id="'+s.DownloadOption.wholeImagesHighRes.toString()+'" type="radio" name="downloadOptions" tabindex="0" /><label id="'+s.DownloadOption.wholeImagesHighRes.toString()+'label" for="'+s.DownloadOption.wholeImagesHighRes.toString()+'"></label></li>'),this.$imageOptions.append(this.$wholeImagesHighResButton),this.$wholeImageHighResButton.hide(),this.$wholeImageLowResAsJpgButton=$('<li class="option single"><input id="'+s.DownloadOption.wholeImageLowResAsJpg.toString()+'" type="radio" name="downloadOptions" tabindex="0" /><label for="'+s.DownloadOption.wholeImageLowResAsJpg.toString()+'">'+this.content.wholeImageLowResAsJpg+"</label></li>"),this.$imageOptions.append(this.$wholeImageLowResAsJpgButton),this.$wholeImageLowResAsJpgButton.hide(),this.$canvasOptionsContainer=$('<li class="group canvas"></li>'),this.$downloadOptions.append(this.$canvasOptionsContainer),this.$canvasOptions=$("<ul></ul>"),this.$canvasOptionsContainer.append(this.$canvasOptions),this.$sequenceOptionsContainer=$('<li class="group sequence"></li>'),this.$downloadOptions.append(this.$sequenceOptionsContainer),this.$sequenceOptions=$("<ul></ul>"),this.$sequenceOptionsContainer.append(this.$sequenceOptions),this.$selectionButton=$('<li class="option"><input id="'+s.DownloadOption.selection.toString()+'" type="radio" name="downloadOptions" tabindex="0" /><label id="'+s.DownloadOption.selection.toString()+'label" for="'+s.DownloadOption.selection.toString()+'"></label></li>'),this.$sequenceOptions.append(this.$selectionButton),this.$selectionButton.hide(),this.$buttonsContainer=$('<div class="buttons"></div>'),this.$content.append(this.$buttonsContainer),this.$downloadButton=$('<a class="btn btn-primary" href="#" tabindex="0">'+this.content.download+"</a>"),this.$buttonsContainer.append(this.$downloadButton),this.$explanatoryTextTemplate=$('<span class="explanatory"></span>');var i=this;this.$downloadButton.on("click",function(e){e.preventDefault();var r=i.getSelectedOption(),l=r.attr("id"),h=r.attr("title"),c=r.data("mime"),u=a.DownloadType.UNKNOWN,p=t.extension.helper.getCurrentCanvas();if(t.renderingUrls[l])c&&(-1!==c.toLowerCase().indexOf("pdf")?u=a.DownloadType.ENTIREDOCUMENTASPDF:-1!==c.toLowerCase().indexOf("txt")&&(u=a.DownloadType.ENTIREDOCUMENTASTEXT)),(u=a.DownloadType.ENTIREDOCUMENTASPDF)&&window.open(t.renderingUrls[l]);else switch(l){case s.DownloadOption.currentViewAsJpg.toString():var d=i.extension.getViewer();window.open(i.extension.getCroppedImageUri(p,d)),u=a.DownloadType.CURRENTVIEW;break;case s.DownloadOption.selection.toString():Utils.Async.waitFor(function(){return!t.isActive},function(){$.publish(o.Commands.SHOW_MULTISELECT_DIALOGUE)});break;case s.DownloadOption.wholeImageHighRes.toString():window.open(t.getCanvasHighResImageUri(t.extension.helper.getCurrentCanvas())),u=a.DownloadType.WHOLEIMAGEHIGHRES;break;case s.DownloadOption.wholeImagesHighRes.toString():for(var m=t.extension.getPagedIndices(),g=0;g<m.length;g++)window.open(t.getCanvasHighResImageUri(t.extension.helper.getCanvasByIndex(m[g])));u=a.DownloadType.WHOLEIMAGESHIGHRES;break;case s.DownloadOption.wholeImageLowResAsJpg.toString():window.open(i.extension.getConfinedImageUri(p,i.options.confinedImageSize)),u=a.DownloadType.WHOLEIMAGELOWRES}$.publish(n.BaseCommands.DOWNLOAD,[{type:u,label:h}]),t.close()})},t.prototype.open=function(t){e.prototype.open.call(this,t);var n=this.extension.helper.getCurrentCanvas(),i=this.extension.getViewerRotation(),o=i%180==0;if(this.isDownloadOptionAvailable(s.DownloadOption.currentViewAsJpg)){var a=this.$currentViewAsJpgButton.find("input"),r=this.$currentViewAsJpgButton.find("label"),l=this.content.currentViewAsJpg,h=this.extension.getViewer(),c=this.extension.getCroppedImageDimensions(n,h);if(c?(l=o?String.format(l,c.size.width,c.size.height):String.format(l,c.size.height,c.size.width),r.text(l),a.prop("title",l),this.$currentViewAsJpgButton.data("width",c.size.width),this.$currentViewAsJpgButton.data("height",c.size.height),this.$currentViewAsJpgButton.show()):this.$currentViewAsJpgButton.hide(),Utils.Bools.getBool(this.options.optionsExplanatoryTextEnabled,!1)){var u=this.content.currentViewAsJpgExplanation;if(u){var p=this.$explanatoryTextTemplate.clone();p.text(u),r.append(p)}}}else this.$currentViewAsJpgButton.hide();if(this.isDownloadOptionAvailable(s.DownloadOption.wholeImageHighRes)){var a=this.$wholeImageHighResButton.find("input"),r=this.$wholeImageHighResButton.find("label"),d=this.getCanvasMimeType(this.extension.helper.getCurrentCanvas());d=d?Utils.Files.simplifyMimeType(d):"?";var m=this.getCanvasComputedDimensions(this.extension.helper.getCurrentCanvas());if(m){var l=o?String.format(this.content.wholeImageHighRes,m.width,m.height,d):String.format(this.content.wholeImageHighRes,m.height,m.width,d);r.text(l),a.prop("title",l),this.$wholeImageHighResButton.data("width",m.width),this.$wholeImageHighResButton.data("height",m.height),this.$wholeImageHighResButton.show()}else this.$wholeImageHighResButton.hide();if(Utils.Bools.getBool(this.options.optionsExplanatoryTextEnabled,!1)){var u=this.content.wholeImageHighResExplanation;if(u){var p=this.$explanatoryTextTemplate.clone();p.text(u),r.append(p)}}}else this.$wholeImageHighResButton.hide();if(this.isDownloadOptionAvailable(s.DownloadOption.wholeImagesHighRes)){var a=this.$wholeImagesHighResButton.find("input"),r=this.$wholeImagesHighResButton.find("label"),d=this.getCanvasMimeType(this.extension.helper.getCurrentCanvas());d=d?Utils.Files.simplifyMimeType(d):"?";var l=String.format(this.content.wholeImagesHighRes,d);if(r.text(l),a.prop("title",l),this.$wholeImagesHighResButton.show(),Utils.Bools.getBool(this.options.optionsExplanatoryTextEnabled,!1)){var u=this.content.wholeImagesHighResExplanation;if(u){var p=this.$explanatoryTextTemplate.clone();p.text(u),r.append(p)}}}else this.$wholeImagesHighResButton.hide();if(this.isDownloadOptionAvailable(s.DownloadOption.wholeImageLowResAsJpg)){var a=this.$wholeImageLowResAsJpgButton.find("input"),r=this.$wholeImageLowResAsJpgButton.find("label"),m=this.extension.getConfinedImageDimensions(n,this.options.confinedImageSize),l=o?String.format(this.content.wholeImageLowResAsJpg,m.width,m.height):String.format(this.content.wholeImageLowResAsJpg,m.height,m.width);if(r.text(l),a.prop("title",l),this.$wholeImageLowResAsJpgButton.data("width",m.width),this.$wholeImageLowResAsJpgButton.data("height",m.height),this.$wholeImageLowResAsJpgButton.show(),Utils.Bools.getBool(this.options.optionsExplanatoryTextEnabled,!1)){var u=this.content.wholeImageLowResAsJpgExplanation;if(u){var p=this.$explanatoryTextTemplate.clone();p.text(u),r.append(p)}}}else this.$wholeImageLowResAsJpgButton.hide();if(this.isDownloadOptionAvailable(s.DownloadOption.selection)){var a=this.$selectionButton.find("input"),r=this.$selectionButton.find("label");if(r.text(this.content.downloadSelection),a.prop("title",this.content.downloadSelection),this.$selectionButton.show(),Utils.Bools.getBool(this.options.optionsExplanatoryTextEnabled,!1)){var u=this.content.selectionExplanation;if(u){var p=this.$explanatoryTextTemplate.clone();p.text(u),r.append(p)}}}else this.$selectionButton.hide();if(this.resetDynamicDownloadOptions(),this.isDownloadOptionAvailable(s.DownloadOption.dynamicImageRenderings))for(var g=n.getImages(),f=0;f<g.length;f++)this.addDownloadOptionsForRenderings(g[f].getResource(),this.content.entireFileAsOriginal,s.DownloadOption.dynamicImageRenderings);if(this.isDownloadOptionAvailable(s.DownloadOption.dynamicCanvasRenderings)&&this.addDownloadOptionsForRenderings(n,this.content.entireFileAsOriginal,s.DownloadOption.dynamicCanvasRenderings),this.isDownloadOptionAvailable(s.DownloadOption.dynamicSequenceRenderings)&&this.addDownloadOptionsForRenderings(this.extension.helper.getCurrentSequence(),this.content.entireDocument,s.DownloadOption.dynamicSequenceRenderings),this.isDownloadOptionAvailable(s.DownloadOption.currentViewAsJpg)){var v=parseInt(this.$currentViewAsJpgButton.data("width").toString()),b=parseInt(this.$currentViewAsJpgButton.data("height").toString()),E=parseInt(this.$wholeImageHighResButton.data("width").toString()),C=parseInt(this.$wholeImageHighResButton.data("height").toString()),_=v/E*100,y=b/C*100,x=this.options.currentViewDisabledPercentage;_>=x&&y>=x?this.$currentViewAsJpgButton.hide():this.$currentViewAsJpgButton.show()}var S=this.$imageOptions.find("li.single");S=S.sort(function(e,t){var n=$(e).data("width");n?n=parseInt(n.toString()):0;var i=$(e).data("height");i?i=parseInt(i.toString()):0;var o=$(t).data("width");o?o=parseInt(o.toString()):0;var s=$(t).data("height");s?s=parseInt(s.toString()):0;var a=n*i,r=o*s;return r>a?-1:a>r?1:0}),S.detach().appendTo(this.$imageOptions);var w=this.$downloadOptions.find("li.group");w.each(function(e,t){var n=$(t);n.show(),n.find("li.option:hidden").length===n.find("li.option").length&&n.hide()}),this.$downloadOptions.find("li.group:visible").last().addClass("lastVisible"),this.$downloadOptions.find("li.option:visible").length?(this.$downloadOptions.find("li.option input:visible:first").prop("checked",!0),this.$noneAvailable.hide(),this.$downloadButton.show()):(this.$noneAvailable.show(),this.$downloadButton.hide()),this.resize()},t.prototype.resetDynamicDownloadOptions=function(){this.renderingUrls=[],this.renderingUrlsCount=0,this.$downloadOptions.find("li.dynamic").remove()},t.prototype.addDownloadOptionsForRenderings=function(e,t,n){for(var i=e.getRenderings(),o=0;o<i.length;o++){var a=i[o];if(a){var r=Manifesto.TranslationCollection.getValue(a.getLabel()),l="downloadOption"+ ++this.renderingUrlsCount;r?r+=" ({0})":r=t;var h=Utils.Files.simplifyMimeType(a.getFormat().toString());r=String.format(r,h),this.renderingUrls[l]=a.id;var c=$('<li class="option dynamic"><input id="'+l+'" data-mime="'+h+'" title="'+r+'" type="radio" name="downloadOptions" tabindex="0" /><label for="'+l+'">'+r+"</label></li>");switch(n){case s.DownloadOption.dynamicImageRenderings:this.$imageOptions.append(c);break;case s.DownloadOption.dynamicCanvasRenderings:this.$canvasOptions.append(c);break;case s.DownloadOption.dynamicSequenceRenderings:this.$sequenceOptions.append(c)}}}},t.prototype.getSelectedOption=function(){return this.$downloadOptions.find("li.option input:checked")},t.prototype.getCanvasImageResource=function(e){var t=e.getImages();return t[0]?t[0].getResource():null},t.prototype.getCanvasHighResImageUri=function(e){var t=this.getCanvasComputedDimensions(e);if(t){var n=t.width,i=e.getCanonicalImageUri(n),o=i.split("/"),s=this.extension.getViewerRotation();return o[o.length-2]=String(s),i=o.join("/")}return""},t.prototype.getCanvasMimeType=function(e){var t=this.getCanvasImageResource(e),n=t.getFormat();return n?n.toString():null},t.prototype.getCanvasDimensions=function(e){return e.externalResource.data?new r(e.externalResource.data.width,e.externalResource.data.height):new r(0,0)},t.prototype.getCanvasMaxDimensions=function(e){return e.externalResource.data&&e.externalResource.data.profile[1]?new r(e.externalResource.data.profile[1].maxWidth,e.externalResource.data.profile[1].maxHeight):null},t.prototype.getCanvasComputedDimensions=function(e){var t=this.getCanvasDimensions(e),n=this.getCanvasMaxDimensions(e);if(!n)return null;var i=t.width,o=t.height;if(!_.isUndefined(n.width)&&n.width<t.width)if(i=n.width,_.isUndefined(n.height)){var s=Math.normalise(n.width,0,t.width);o=Math.floor(t.height*s)}else o=n.height;return new r(i,o)},t.prototype.isDownloadOptionAvailable=function(t){switch(t){case s.DownloadOption.currentViewAsJpg:case s.DownloadOption.dynamicCanvasRenderings:case s.DownloadOption.dynamicImageRenderings:case s.DownloadOption.wholeImageHighRes:if(!this.extension.isPagingSettingEnabled()||this.extension.isPagingSettingEnabled()&&this.extension.resources&&1===this.extension.resources.length){var n=this.getCanvasMaxDimensions(this.extension.helper.getCurrentCanvas());if(n){if(_.isUndefined(n.width))return!0;if(n.width<=this.options.maxImageWidth)return!0}}return!1;case s.DownloadOption.wholeImagesHighRes:return this.extension.isPagingSettingEnabled()&&this.extension.resources&&this.extension.resources.length>1?!0:!1;case s.DownloadOption.wholeImageLowResAsJpg:var i=this.getCanvasComputedDimensions(this.extension.helper.getCurrentCanvas());return i?!this.extension.isPagingSettingEnabled()&&i.width>this.options.confinedImageSize:!1;case s.DownloadOption.selection:return this.options.selectionEnabled;default:return e.prototype.isDownloadOptionAvailable.call(this,t)}},t}(i.DownloadDialogue);t.DownloadDialogue=l});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-dialogues-module/ExternalContentDialogue",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/Dialogue"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("externalContentDialogue"),e.prototype.create.call(this),this.openCommand=n.BaseCommands.SHOW_EXTERNALCONTENT_DIALOGUE,this.closeCommand=n.BaseCommands.HIDE_EXTERNALCONTENT_DIALOGUE,$.subscribe(this.openCommand,function(e,n){t.open(),t.$iframe.prop("src",n.uri)}),$.subscribe(this.closeCommand,function(e){t.close()}),this.$iframe=$("<iframe></iframe>"),this.$content.append(this.$iframe),this.$element.hide()},t.prototype.resize=function(){e.prototype.resize.call(this),this.$iframe.width(this.$content.width()),this.$iframe.height(this.$content.height())},t}(i.Dialogue);t.ExternalContentDialogue=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-shared-module/FooterPanel",["require","exports","./BaseCommands","./BaseView","./Metrics"],function(e,t,n,i,o){"use strict";var s=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("footerPanel"),e.prototype.create.call(this),$.subscribe(n.BaseCommands.TOGGLE_FULLSCREEN,function(){t.updateFullScreenButton()}),$.subscribe(n.BaseCommands.METRIC_CHANGED,function(){t.updateMinimisedButtons(),t.updateMoreInfoButton()}),$.subscribe(n.BaseCommands.SETTINGS_CHANGED,function(){t.updateDownloadButton()}),this.$options=$('<div class="options"></div>'),this.$element.append(this.$options),this.$feedbackButton=$('<a class="feedback" title="'+this.content.feedback+'" tabindex="0">'+this.content.feedback+"</a>"),this.$options.prepend(this.$feedbackButton),this.$openButton=$('<a class="open" title="'+this.content.open+'" tabindex="0">'+this.content.open+"</a>"),this.$options.prepend(this.$openButton),this.$bookmarkButton=$('<a class="bookmark" title="'+this.content.bookmark+'" tabindex="0">'+this.content.bookmark+"</a>"),this.$options.prepend(this.$bookmarkButton),this.$shareButton=$('<a href="#" class="share" title="'+this.content.share+'" tabindex="0">'+this.content.share+"</a>"),this.$options.append(this.$shareButton),this.$embedButton=$('<a href="#" class="embed" title="'+this.content.embed+'" tabindex="0">'+this.content.embed+"</a>"),this.$options.append(this.$embedButton),this.$downloadButton=$('<a class="download" title="'+this.content.download+'" tabindex="0">'+this.content.download+"</a>"),this.$options.prepend(this.$downloadButton),this.$moreInfoButton=$('<a href="#" class="moreInfo" title="'+this.content.moreInfo+'" tabindex="0">'+this.content.moreInfo+"</a>"),this.$options.prepend(this.$moreInfoButton),this.$fullScreenBtn=$('<a href="#" class="fullScreen" title="'+this.content.fullScreen+'" tabindex="0">'+this.content.fullScreen+"</a>"),this.$options.append(this.$fullScreenBtn),this.$openButton.onPressed(function(){$.publish(n.BaseCommands.OPEN)}),this.$feedbackButton.onPressed(function(){$.publish(n.BaseCommands.FEEDBACK)}),this.$bookmarkButton.onPressed(function(){$.publish(n.BaseCommands.BOOKMARK)}),this.$shareButton.onPressed(function(){$.publish(n.BaseCommands.SHOW_SHARE_DIALOGUE,[t.$shareButton])}),this.$embedButton.onPressed(function(){$.publish(n.BaseCommands.SHOW_EMBED_DIALOGUE,[t.$embedButton])}),this.$downloadButton.onPressed(function(){$.publish(n.BaseCommands.SHOW_DOWNLOAD_DIALOGUE,[t.$downloadButton])}),this.$moreInfoButton.onPressed(function(){$.publish(n.BaseCommands.SHOW_MOREINFO_DIALOGUE,[t.$moreInfoButton])}),this.$fullScreenBtn.on("click",function(e){e.preventDefault(),$.publish(n.BaseCommands.TOGGLE_FULLSCREEN)}),Utils.Bools.getBool(this.options.embedEnabled,!0)||this.$embedButton.hide(),this.updateMoreInfoButton(),this.updateOpenButton(),this.updateFeedbackButton(),this.updateBookmarkButton(),this.updateEmbedButton(),this.updateDownloadButton(),this.updateFullScreenButton(),this.updateShareButton(),this.updateMinimisedButtons()},t.prototype.updateMinimisedButtons=function(){return Utils.Bools.getBool(this.options.minimiseButtons,!1)?void this.$options.addClass("minimiseButtons"):void(this.extension.metric===o.Metrics.MOBILE_LANDSCAPE?this.$options.addClass("minimiseButtons"):this.$options.removeClass("minimiseButtons"))},t.prototype.updateMoreInfoButton=function(){var e=Utils.Bools.getBool(this.options.moreInfoEnabled,!1);e&&this.extension.metric===o.Metrics.MOBILE_LANDSCAPE?this.$moreInfoButton.show():this.$moreInfoButton.hide();
},t.prototype.updateOpenButton=function(){var e=Utils.Bools.getBool(this.options.openEnabled,!1);e&&!this.extension.isHomeDomain?this.$openButton.show():this.$openButton.hide()},t.prototype.updateFullScreenButton=function(){Utils.Bools.getBool(this.options.fullscreenEnabled,!0)||this.$fullScreenBtn.hide(),this.extension.isLightbox&&this.$fullScreenBtn.addClass("lightbox"),this.extension.isFullScreen()?(this.$fullScreenBtn.swapClass("fullScreen","exitFullscreen"),this.$fullScreenBtn.text(this.content.exitFullScreen),this.$fullScreenBtn.attr("title",this.content.exitFullScreen)):(this.$fullScreenBtn.swapClass("exitFullscreen","fullScreen"),this.$fullScreenBtn.text(this.content.fullScreen),this.$fullScreenBtn.attr("title",this.content.fullScreen))},t.prototype.updateEmbedButton=function(){this.extension.helper.isUIEnabled("embed")&&Utils.Bools.getBool(this.options.embedEnabled,!1)?$.browser.mobile||this.$embedButton.show():this.$embedButton.hide()},t.prototype.updateShareButton=function(){this.extension.helper.isUIEnabled("share")&&Utils.Bools.getBool(this.options.shareEnabled,!0)?this.$shareButton.show():this.$shareButton.hide()},t.prototype.updateDownloadButton=function(){var e=Utils.Bools.getBool(this.options.downloadEnabled,!0);e?this.$downloadButton.show():this.$downloadButton.hide()},t.prototype.updateFeedbackButton=function(){var e=Utils.Bools.getBool(this.options.feedbackEnabled,!1);e?this.$feedbackButton.show():this.$feedbackButton.hide()},t.prototype.updateBookmarkButton=function(){var e=Utils.Bools.getBool(this.options.bookmarkEnabled,!1);e?this.$bookmarkButton.show():this.$bookmarkButton.hide()},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(i.BaseView);t.FooterPanel=s});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-osdmobilefooterpanel-module/MobileFooter",["require","exports","../uv-shared-module/FooterPanel","../../extensions/uv-seadragon-extension/Commands"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("mobileFooterPanel"),e.prototype.create.call(this),this.$spacer=$('<div class="spacer"></div>'),this.$options.prepend(this.$spacer),this.$rotateButton=$('<a class="rotate" title="'+this.content.rotateRight+'" tabindex="0">'+this.content.rotateRight+"</a>"),this.$options.prepend(this.$rotateButton),this.$zoomOutButton=$('<a class="zoomOut" title="'+this.content.zoomOut+'" tabindex="0">'+this.content.zoomOut+"</a>"),this.$options.prepend(this.$zoomOutButton),this.$zoomInButton=$('<a class="zoomIn" title="'+this.content.zoomIn+'" tabindex="0">'+this.content.zoomIn+"</a>"),this.$options.prepend(this.$zoomInButton),this.$zoomInButton.onPressed(function(){$.publish(i.Commands.ZOOM_IN)}),this.$zoomOutButton.onPressed(function(){$.publish(i.Commands.ZOOM_OUT)}),this.$rotateButton.onPressed(function(){$.publish(i.Commands.ROTATE)})},t.prototype.resize=function(){e.prototype.resize.call(this),this.$options.css("left",Math.floor(this.$element.width()/2-this.$options.width()/2))},t}(n.FooterPanel);t.FooterPanel=o}),define("modules/uv-shared-module/AutoComplete",["require","exports"],function(e,t){"use strict";var n=function(){function e(e,t,n,i,o,s,a){void 0===o&&(o=300),void 0===s&&(s=2),void 0===a&&(a=!1);var r=this;this._validKeyDownCodes=[KeyCodes.KeyDown.Backspace,KeyCodes.KeyDown.Spacebar,KeyCodes.KeyDown.Tab,KeyCodes.KeyDown.LeftArrow,KeyCodes.KeyDown.RightArrow,KeyCodes.KeyDown.Delete],this._validKeyPressCodes=[KeyCodes.KeyPress.GraveAccent,KeyCodes.KeyPress.DoubleQuote],this._lastKeyDownWasValid=!1,this._$element=e,this._autoCompleteFunc=t,this._delay=o,this._minChars=s,this._onSelect=i,this._parseResultsFunc=n,this._positionAbove=a,this._$searchResultsList=$('<ul class="autocomplete"></ul>'),this._positionAbove?this._$element.parent().prepend(this._$searchResultsList):this._$element.parent().append(this._$searchResultsList),this._$searchResultTemplate=$('<li class="result"><a href="#" tabindex="-1"></a></li>');var l=function(){var e=0;return function(t,n){clearTimeout(e),e=setTimeout(t,n)}}(),h=this;this._$element.on("keydown",function(e){var t=e.originalEvent;h._lastKeyDownWasValid=h._isValidKeyDown(t);var n=Utils.Keyboard.getCharCode(t),i=!1;n===KeyCodes.KeyDown.LeftArrow?i=!0:n===KeyCodes.KeyDown.RightArrow&&(i=!0),i&&(t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation())}),this._$element.on("keypress",function(e){var t=h._isValidKeyPress(e.originalEvent);return h._lastKeyDownWasValid||t?!0:(e.preventDefault(),!1)}),this._$element.on("keyup",function(e){if(!h._getSelectedListItem().length&&e.keyCode===KeyCodes.KeyDown.Enter)return void h._onSelect(h._getTerms());if(h._$searchResultsList.is(":visible")&&h._results.length)if(e.keyCode===KeyCodes.KeyDown.Enter)h._searchForItem(h._getSelectedListItem());else{if(e.keyCode===KeyCodes.KeyDown.DownArrow)return void h._setSelectedResultIndex(1);if(e.keyCode===KeyCodes.KeyDown.UpArrow)return void h._setSelectedResultIndex(-1)}e.keyCode!==KeyCodes.KeyDown.Enter&&l(function(){var e=h._getTerms();e&&e.length>h._minChars&&!e.contains(" ")?h._search(e):(h._clearResults(),h._hideResults())},h._delay)}),$(document).on("mouseup",function(e){0===r._$searchResultsList.parent().has($(e.target)[0]).length&&(r._clearResults(),r._hideResults())}),this._hideResults()}return e.prototype._isValidKeyDown=function(e){var t=this._validKeyDownCodes.contains(Utils.Keyboard.getCharCode(e));return t},e.prototype._isValidKeyPress=function(e){var t=Utils.Keyboard.getCharCode(e),n=String.fromCharCode(t),i=n.isAlphanumeric()||this._validKeyPressCodes.contains(t);return i},e.prototype._getTerms=function(){return this._$element.val().trim()},e.prototype._setSelectedResultIndex=function(e){var t;t=1===e?this._selectedResultIndex+1:this._selectedResultIndex-1;var n=this._$searchResultsList.find("li");0>t?t=n.length-1:t>n.length-1&&(t=0),this._selectedResultIndex=t,n.removeClass("selected");var i=n.eq(this._selectedResultIndex);i.addClass("selected");var o=i.outerHeight(!0)*this._selectedResultIndex;this._$searchResultsList.scrollTop(o)},e.prototype._search=function(e){this._results=[],this._clearResults(),this._showResults(),this._$searchResultsList.append('<li class="loading"></li>'),this._updateListPosition();var t=this;this._autoCompleteFunc(e,function(e){t._listResults(e)})},e.prototype._clearResults=function(){this._$searchResultsList.empty()},e.prototype._hideResults=function(){this._$searchResultsList.hide()},e.prototype._showResults=function(){this._selectedResultIndex=-1,this._$searchResultsList.show()},e.prototype._updateListPosition=function(){this._positionAbove?this._$searchResultsList.css({top:-1*this._$searchResultsList.outerHeight(!0)}):this._$searchResultsList.css({top:this._$element.outerHeight(!0)})},e.prototype._listResults=function(e){if(this._results=this._parseResultsFunc(e),this._clearResults(),!this._results.length)return void this._hideResults();for(var t=0;t<this._results.length;t++){var n=this._results[t],i=this._$searchResultTemplate.clone(),o=i.find("a");o.text(n),this._$searchResultsList.append(i)}this._updateListPosition();var s=this;this._$searchResultsList.find("li").on("click",function(e){e.preventDefault(),s._searchForItem($(this))})},e.prototype._searchForItem=function(e){var t=e.find("a").text();this._$element.val(t),this._hideResults(),this._onSelect(t),this._clearResults(),this._hideResults()},e.prototype._getSelectedListItem=function(){return this._$searchResultsList.find("li.selected")},e}();t.AutoComplete=n});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-searchfooterpanel-module/FooterPanel",["require","exports","../uv-shared-module/AutoComplete","../uv-shared-module/BaseCommands","../uv-shared-module/FooterPanel","../../extensions/uv-seadragon-extension/Commands","../../extensions/uv-seadragon-extension/Mode"],function(e,t,n,i,o,s,a){"use strict";var r=function(e){function t(t){var n=e.call(this,t)||this;return n.placemarkerTouched=!1,n}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("searchFooterPanel"),e.prototype.create.call(this),$.subscribe(i.BaseCommands.CANVAS_INDEX_CHANGED,function(e,n){t.canvasIndexChanged(),t.setCurrentSearchResultPlacemarker(),t.updatePrevButton(),t.updateNextButton()}),$.subscribe(s.Commands.MODE_CHANGED,function(e,n){t.settingsChanged()}),$.subscribe(s.Commands.SEARCH,function(e,n){t.terms=n}),$.subscribe(s.Commands.SEARCH_RESULTS,function(e,n){t.displaySearchResults(n.terms,n.results),t.setCurrentSearchResultPlacemarker()}),$.subscribe(s.Commands.SEARCH_RESULTS_EMPTY,function(){t.hideSearchSpinner()}),$.subscribe(s.Commands.SEARCH_RESULT_RECT_CHANGED,function(){t.updatePrevButton(),t.updateNextButton()}),this.$printButton=$('<a class="print" title="'+this.content.print+'" tabindex="0">'+this.content.print+"</a>"),this.$options.prepend(this.$printButton),this.$searchContainer=$('<div class="search"></div>'),this.$element.prepend(this.$searchContainer),this.$searchOptions=$('<div class="searchOptions"></div>'),this.$searchContainer.append(this.$searchOptions),this.$searchLabel=$('<span class="label">'+this.content.searchWithin+"</span>"),this.$searchOptions.append(this.$searchLabel),this.$searchTextContainer=$('<div class="searchTextContainer"></div>'),this.$searchOptions.append(this.$searchTextContainer),this.$searchText=$('<input class="searchText" type="text" maxlength="100" value="'+this.content.enterKeyword+'" />'),this.$searchTextContainer.append(this.$searchText),this.$searchButton=$('<a class="imageButton searchButton" tabindex="0"></a>'),this.$searchTextContainer.append(this.$searchButton),this.$searchPagerContainer=$('<div class="searchPager"></div>'),this.$element.prepend(this.$searchPagerContainer),this.$searchPagerControls=$('<div class="controls"></div>'),this.$searchPagerContainer.prepend(this.$searchPagerControls),this.$previousResultButton=$('<a class="previousResult" title="'+this.content.previousResult+'">'+this.content.previousResult+"</a>"),this.$searchPagerControls.append(this.$previousResultButton),this.$searchResultsInfo=$('<div class="searchResultsInfo"><span class="number">x</span> <span class="foundFor"></span> \'<span class="terms">y</span>\'</div>'),this.$searchPagerControls.append(this.$searchResultsInfo),this.$clearSearchResultsButton=$('<a class="clearSearch" title="'+this.content.clearSearch+'">'+this.content.clearSearch+"</a>"),this.$searchResultsInfo.append(this.$clearSearchResultsButton),this.$nextResultButton=$('<a class="nextResult" title="'+this.content.nextResult+'">'+this.content.nextResult+"</a>"),this.$searchPagerControls.append(this.$nextResultButton),this.$searchResultsContainer=$('<div class="searchResults"></div>'),this.$element.prepend(this.$searchResultsContainer),this.$line=$('<div class="line"></div>'),this.$searchResultsContainer.append(this.$line),this.$pagePositionMarker=$('<div class="positionPlacemarker"></div>'),this.$searchResultsContainer.append(this.$pagePositionMarker),this.$pagePositionLabel=$('<div class="label"></div>'),this.$searchResultsContainer.append(this.$pagePositionLabel),this.$placemarkerDetails=$('<div class="placeMarkerDetails"></div>'),this.$searchResultsContainer.append(this.$placemarkerDetails),this.$placemarkerDetailsTop=$("<h1></h1>"),this.$placemarkerDetails.append(this.$placemarkerDetailsTop),this.$placemarkerDetailsBottom=$("<p></p>"),this.$placemarkerDetails.append(this.$placemarkerDetailsBottom),this.$searchPagerContainer.hide(),this.$placemarkerDetails.hide();var o=this;this.$searchButton.on("click",function(e){e.preventDefault(),t.search(t.$searchText.val())}),this.$searchText.on("focus",function(){t.$searchText.val()===t.content.enterKeyword&&t.$searchText.val("")}),this.$placemarkerDetails.on("mouseover",function(){$.publish(s.Commands.SEARCH_PREVIEW_START,[t.currentPlacemarkerIndex])}),this.$placemarkerDetails.on("mouseleave",function(){$(this).hide(),$.publish(s.Commands.SEARCH_PREVIEW_FINISH);var e=o.getSearchResultPlacemarkers();e.removeClass("hover")}),this.$placemarkerDetails.on("click",function(e){$.publish(s.Commands.VIEW_PAGE,[t.currentPlacemarkerIndex])}),this.$previousResultButton.on("click",function(e){e.preventDefault(),$.publish(s.Commands.PREV_SEARCH_RESULT)}),this.$nextResultButton.on("click",function(e){e.preventDefault(),$.publish(s.Commands.NEXT_SEARCH_RESULT)}),this.$clearSearchResultsButton.on("click",function(e){e.preventDefault(),$.publish(s.Commands.CLEAR_SEARCH),t.clearSearchResults()}),this.extension.isSearchWithinEnabled()||(this.$searchContainer.hide(),this.$searchPagerContainer.hide(),this.$searchResultsContainer.hide(),this.$element.addClass("min")),1===this.extension.helper.getTotalCanvases()&&this.$searchResultsContainer.hide();var a=this.extension.getAutoCompleteUri();a?new n.AutoComplete(this.$searchText,function(e,t){$.getJSON(String.format(a,e),function(e){t(e)})},function(e){return $.map(e.terms,function(e){return e.match})},function(e){t.search(e)},300,2,!0):this.$searchText.on("keyup",function(e){e.keyCode===KeyCodes.KeyDown.Enter&&o.search(o.$searchText.val())}),this.$printButton.onPressed(function(){$.publish(s.Commands.PRINT)}),this.updatePrintButton();var r=Utils.Bools.getBool(this.config.options.positionMarkerEnabled,!0);r||(this.$pagePositionMarker.hide(),this.$pagePositionLabel.hide())},t.prototype.isZoomToSearchResultEnabled=function(){return Utils.Bools.getBool(this.extension.config.options.zoomToSearchResultEnabled,!0)},t.prototype.isPreviousButtonEnabled=function(){var e=this.extension.helper.canvasIndex,t=this.getFirstSearchResultCanvasIndex(),n=this.getCurrentSearchResultRectIndex();return this.isZoomToSearchResultEnabled()&&this.extension.currentSearchResultRect?t>e?!1:e===t&&0===n?!1:!0:e>t},t.prototype.isCanvasIndexLessThanFirstSearchResultIndex=function(){var e=this.extension.searchResults;return this.extension.helper.canvasIndex<=e[0].canvasIndex},t.prototype.isNextButtonEnabled=function(){var e=this.extension.helper.canvasIndex,t=this.getLastSearchResultCanvasIndex(),n=this.getCurrentSearchResultRectIndex();return this.isZoomToSearchResultEnabled()&&this.extension.currentSearchResultRect?e>t?!1:e===t&&n===this.getLastSearchResultRectIndex()?!1:!0:t>e},t.prototype.getSearchResults=function(){return this.extension.searchResults},t.prototype.getCurrentSearchResultRectIndex=function(){return this.extension.getCurrentSearchResultRectIndex()},t.prototype.getFirstSearchResultCanvasIndex=function(){var e=this.getSearchResults(),t=e[0].canvasIndex;return t},t.prototype.getLastSearchResultCanvasIndex=function(){var e=this.getSearchResults(),t=e[e.length-1].canvasIndex;return t},t.prototype.getLastSearchResultRectIndex=function(){return this.extension.getLastSearchResultRectIndex()},t.prototype.updateNextButton=function(){var e=this.extension.searchResults;e&&e.length&&(this.isNextButtonEnabled()?this.$nextResultButton.removeClass("disabled"):this.$nextResultButton.addClass("disabled"))},t.prototype.updatePrevButton=function(){var e=this.extension.searchResults;e&&e.length&&(this.isPreviousButtonEnabled()?this.$previousResultButton.removeClass("disabled"):this.$previousResultButton.addClass("disabled"))},t.prototype.updatePrintButton=function(){var e=Utils.Bools.getBool(this.options.printEnabled,!1);e?this.$printButton.show():this.$printButton.hide()},t.prototype.search=function(e){return this.terms=e,""===this.terms||this.terms===this.content.enterKeyword?void this.extension.showMessage(this.config.modules.genericDialogue.content.emptyValue,function(){this.$searchText.focus()}):(this.$searchText.blur(),this.showSearchSpinner(),void $.publish(s.Commands.SEARCH,[this.terms]))},t.prototype.getSearchResultPlacemarkers=function(){return this.$searchResultsContainer.find(".searchResultPlacemarker")},t.prototype.setCurrentSearchResultPlacemarker=function(){var e=this.getSearchResultPlacemarkers();e.parent().find(".current").removeClass("current");var t=$('.searchResultPlacemarker[data-index="'+this.extension.helper.canvasIndex+'"]');t.addClass("current")},t.prototype.positionSearchResultPlacemarkers=function(){var e=this.extension.searchResults;if(e.length){var t=this.getSearchResultPlacemarkers();t.remove();for(var n=this.getPageLineRatio(),i=this.$line.position().top,o=this.$line.position().left,s=this,a=0;a<e.length;a++){var r=e[a],l=r.canvasIndex*n,h=$('<div class="searchResultPlacemarker" data-index="'+r.canvasIndex+'"></div>');h[0].ontouchstart=function(e){s.onPlacemarkerTouchStart.call(this,s)},h.click(function(e){s.onPlacemarkerClick.call(this,s)}),h.mouseenter(function(e){s.onPlacemarkerMouseEnter.call(this,s)}),h.mouseleave(function(e){s.onPlacemarkerMouseLeave.call(this,e,s)}),this.$searchResultsContainer.append(h);var c=i-h.height(),u=o+l-h.width()/2;h.css({top:c,left:u})}}},t.prototype.onPlacemarkerTouchStart=function(e){e.placemarkerTouched=!0;var t=$(this),n=parseInt(t.attr("data-index"));$.publish(s.Commands.VIEW_PAGE,[n])},t.prototype.onPlacemarkerClick=function(e){if(!e.placemarkerTouched){e.placemarkerTouched=!1;var t=$(this),n=parseInt(t.attr("data-index"));$.publish(s.Commands.VIEW_PAGE,[n])}},t.prototype.onPlacemarkerMouseEnter=function(e){if(!e.placemarkerTouched){var t=$(this);t.addClass("hover");var n=parseInt(t.attr("data-index"));$.publish(s.Commands.SEARCH_PREVIEW_START,[n]);var i=e.getSearchResultPlacemarkers(),o=i.index(t[0]);e.currentPlacemarkerIndex=n,e.$placemarkerDetails.show();var r="{0} {1}",l=e.extension.getMode();if(l.toString()===a.Mode.page.toString()){var h=e.extension.helper.getCanvasByIndex(n),c=Manifesto.TranslationCollection.getValue(h.getLabel());""===c&&(c=this.extension.helper.manifest.options.defaultLabel),r=String.format(r,e.content.pageCaps,c)}else r=String.format(r,e.content.imageCaps,n+1);e.$placemarkerDetailsTop.html(r);var u,p=e.extension.searchResults[o],d=Utils.Strings.ellipsis(e.terms,e.options.elideDetailsTermsCount);1===p.rects.length?(u=e.content.instanceFound,u=String.format(u,d)):(u=e.content.instancesFound,u=String.format(u,p.rects.length,d)),e.$placemarkerDetailsBottom.html(u);var m=t.position(),g=m.top-e.$placemarkerDetails.height(),f=m.left;f<e.$placemarkerDetails.width()/2?f=0-t.width()/2:f>e.$line.width()-e.$placemarkerDetails.width()/2?f=e.$line.width()-e.$placemarkerDetails.width()+t.width()/2:f-=e.$placemarkerDetails.width()/2,e.$placemarkerDetails.css({top:g,left:f})}},t.prototype.onPlacemarkerMouseLeave=function(e,t){$.publish(s.Commands.SEARCH_PREVIEW_FINISH);var n=$(this),i=e.toElement||e.relatedTarget,o=$(i).closest(t.$placemarkerDetails).length;i!=t.$placemarkerDetails.get(0)&&0===o&&(t.$placemarkerDetails.hide(),n.removeClass("hover"))},t.prototype.setPageMarkerPosition=function(){if(null!=this.extension.helper.canvasIndex){var e=this.getPageLineRatio(),t=this.$line.position().top,n=this.$line.position().left,i=this.extension.helper.canvasIndex*e,o=t,s=n+i;this.$pagePositionMarker.css({top:o,left:s});var a=this.$line.width();s+this.$pagePositionLabel.outerWidth(!0)>a?(s-=this.$pagePositionLabel.outerWidth(!0),this.$pagePositionLabel.removeClass("right"),this.$pagePositionLabel.addClass("left")):(this.$pagePositionLabel.removeClass("left"),this.$pagePositionLabel.addClass("right")),this.$pagePositionLabel.css({top:o,left:s})}},t.prototype.clearSearchResults=function(){this.extension.searchResults=[];var e=this.getSearchResultPlacemarkers();e.remove(),this.$searchText.val(this.content.enterKeyword),this.$searchContainer.show(),this.$searchPagerContainer.hide(),this.$searchText.focus()},t.prototype.getPageLineRatio=function(){var e=this.$line.width();return 1===this.extension.helper.getTotalCanvases()?0:e/(this.extension.helper.getTotalCanvases()-1)},t.prototype.canvasIndexChanged=function(){this.setPageMarkerPosition(),this.setPlacemarkerLabel()},t.prototype.settingsChanged=function(){this.setPlacemarkerLabel()},t.prototype.setPlacemarkerLabel=function(){var e=this.content.displaying,t=this.extension.helper.canvasIndex;if(this.isPageModeEnabled()){var n=this.extension.helper.getCanvasByIndex(t),i=Manifesto.TranslationCollection.getValue(n.getLabel());""===i&&(i=this.content.defaultLabel);var o=this.extension.helper.getLastCanvasLabel(!0);this.$pagePositionLabel.html(String.format(e,this.content.page,this.extension.sanitize(i),this.extension.sanitize(o)))}else this.$pagePositionLabel.html(String.format(e,this.content.image,t+1,this.extension.helper.getTotalCanvases()))},t.prototype.isPageModeEnabled=function(){return this.config.options.pageModeEnabled&&this.extension.getMode().toString()===a.Mode.page.toString()},t.prototype.showSearchSpinner=function(){this.$searchText.addClass("searching")},t.prototype.hideSearchSpinner=function(){this.$searchText.removeClass("searching")},t.prototype.displaySearchResults=function(e,t){if(t){this.hideSearchSpinner(),this.positionSearchResultPlacemarkers(),this.$searchContainer.hide(),this.$searchPagerControls.css({left:0});var n=this.$searchPagerContainer.find(".number");n.text(this.extension.getTotalSearchResultRects());var i=this.$searchResultsInfo.find(".foundFor");1===t.length?i.html(this.content.resultFoundFor):i.html(this.content.resultsFoundFor);var o=this.$searchPagerContainer.find(".terms");o.html(Utils.Strings.ellipsis(e,this.options.elideResultsTermsCount)),o.prop("title",e),this.$searchPagerContainer.show(),this.resize()}},t.prototype.resize=function(){e.prototype.resize.call(this);var t=this.extension.searchResults;t&&t.length&&this.positionSearchResultPlacemarkers(),this.setPageMarkerPosition(),this.$searchPagerContainer.width(this.$element.width());var n=this.$element.width()/2;this.$searchPagerControls.css({left:n-this.$searchPagerControls.width()/2}),this.$searchOptions.css({left:n-this.$searchOptions.outerWidth()/2})},t}(o.FooterPanel);t.FooterPanel=r});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-dialogues-module/HelpDialogue",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/Dialogue"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("helpDialogue"),e.prototype.create.call(this),this.openCommand=n.BaseCommands.SHOW_HELP_DIALOGUE,this.closeCommand=n.BaseCommands.HIDE_HELP_DIALOGUE,$.subscribe(this.openCommand,function(e,n){t.open()}),$.subscribe(this.closeCommand,function(e){t.close()}),this.$title=$("<h1></h1>"),this.$content.append(this.$title),this.$scroll=$('<div class="scroll"></div>'),this.$content.append(this.$scroll),this.$message=$("<p></p>"),this.$scroll.append(this.$message),this.$title.text(this.content.title),this.$message.html(this.content.text),this.$message.targetBlank(),this.$element.hide()},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(i.Dialogue);t.HelpDialogue=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-dialogues-module/MoreInfoDialogue",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/Dialogue"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("moreInfoDialogue"),e.prototype.create.call(this),this.openCommand=n.BaseCommands.SHOW_MOREINFO_DIALOGUE,this.closeCommand=n.BaseCommands.HIDE_MOREINFO_DIALOGUE,$.subscribe(this.openCommand,function(e,n){t.open(n)}),$.subscribe(this.closeCommand,function(e){t.close()}),this.config.content=this.extension.config.modules.moreInfoRightPanel.content,this.config.options=this.extension.config.modules.moreInfoRightPanel.options,this.$title=$("<h1>"+this.config.content.title+"</h1>"),this.$content.append(this.$title),this.$metadata=$('<div class="iiif-metadata-component"></div>'),this.$content.append(this.$metadata),this.component=new IIIFComponents.MetadataComponent({target:this.$metadata[0],data:this._getData()}),this.$element.hide()},t.prototype.open=function(t){e.prototype.open.call(this,t),this.component.set(null)},t.prototype._getData=function(){var e=this;return{canvasDisplayOrder:this.config.options.canvasDisplayOrder,canvases:this.extension.getCurrentCanvases(),canvasExclude:this.config.options.canvasExclude,canvasLabels:this.extension.getCanvasLabels(this.content.page),content:this.config.content,copiedMessageDuration:2e3,copyToClipboardEnabled:Utils.Bools.getBool(this.config.options.copyToClipboardEnabled,!1),helper:this.extension.helper,licenseFormatter:null,limit:this.config.options.textLimit||4,limitType:IIIFComponents.MetadataComponentOptions.LimitType.LINES,manifestDisplayOrder:this.config.options.manifestDisplayOrder,manifestExclude:this.config.options.manifestExclude,range:this.extension.getCurrentCanvasRange(),rtlLanguageCodes:this.config.options.rtlLanguageCodes,sanitizer:function(t){return e.extension.sanitize(t)},showAllLanguages:this.config.options.showAllLanguages}},t.prototype.close=function(){e.prototype.close.call(this)},t.prototype.resize=function(){this.setDockedPosition()},t}(i.Dialogue);t.MoreInfoDialogue=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-shared-module/RightPanel",["require","exports","./BaseCommands","./BaseExpandPanel"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){e.prototype.create.call(this),this.$element.width(this.options.panelCollapsedWidth)},t.prototype.init=function(){var t=this;e.prototype.init.call(this);var i=Utils.Bools.getBool(this.extension.getSettings().rightPanelOpen,this.options.panelOpen);i&&this.toggle(!0),$.subscribe(n.BaseCommands.TOGGLE_EXPAND_RIGHT_PANEL,function(){t.isFullyExpanded?t.collapseFull():t.expandFull()})},t.prototype.getTargetWidth=function(){return this.isExpanded?this.options.panelCollapsedWidth:this.options.panelExpandedWidth},t.prototype.getTargetLeft=function(){return this.isExpanded?this.$element.parent().width()-this.options.panelCollapsedWidth:this.$element.parent().width()-this.options.panelExpandedWidth},t.prototype.toggleFinish=function(){e.prototype.toggleFinish.call(this),this.isExpanded?$.publish(n.BaseCommands.OPEN_RIGHT_PANEL):$.publish(n.BaseCommands.CLOSE_RIGHT_PANEL),this.extension.updateSettings({rightPanelOpen:this.isExpanded})},t.prototype.resize=function(){e.prototype.resize.call(this),this.$element.css({left:Math.floor(this.$element.parent().width()-this.$element.outerWidth())})},t}(i.BaseExpandPanel);t.RightPanel=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-moreinforightpanel-module/MoreInfoRightPanel",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/RightPanel"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("moreInfoRightPanel"),e.prototype.create.call(this),$.subscribe(n.BaseCommands.CANVAS_INDEX_CHANGED,function(e,n){t.databind()}),this.setTitle(this.config.content.title),this.$metadata=$('<div class="iiif-metadata-component"></div>'),this.$main.append(this.$metadata),this.component=new IIIFComponents.MetadataComponent({target:this.$metadata[0],data:this._getData()})},t.prototype.toggleFinish=function(){e.prototype.toggleFinish.call(this),this.databind()},t.prototype.databind=function(){this.component.options.data=this._getData(),this.component.set(null)},t.prototype._getData=function(){var e=this;return{canvasDisplayOrder:this.config.options.canvasDisplayOrder,canvases:this.extension.getCurrentCanvases(),canvasExclude:this.config.options.canvasExclude,canvasLabels:this.extension.getCanvasLabels(this.content.page),content:this.config.content,copiedMessageDuration:2e3,copyToClipboardEnabled:Utils.Bools.getBool(this.config.options.copyToClipboardEnabled,!1),helper:this.extension.helper,licenseFormatter:null,limit:this.config.options.textLimit||4,limitType:IIIFComponents.MetadataComponentOptions.LimitType.LINES,manifestDisplayOrder:this.config.options.manifestDisplayOrder,manifestExclude:this.config.options.manifestExclude,range:this.extension.getCurrentCanvasRange(),rtlLanguageCodes:this.config.options.rtlLanguageCodes,sanitizer:function(t){return e.extension.sanitize(t)},showAllLanguages:this.config.options.showAllLanguages}},t.prototype.resize=function(){e.prototype.resize.call(this),this.$main.height(this.$element.height()-this.$top.height()-this.$main.verticalMargins())},t}(i.RightPanel);t.MoreInfoRightPanel=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-multiselectdialogue-module/MultiSelectDialogue",["require","exports","../../extensions/uv-seadragon-extension/Commands","../../modules/uv-shared-module/Dialogue","../../extensions/uv-seadragon-extension/Mode"],function(e,t,n,i,o){"use strict";var s=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("multiSelectDialogue"),e.prototype.create.call(this);var i=this;this.openCommand=n.Commands.SHOW_MULTISELECT_DIALOGUE,this.closeCommand=n.Commands.HIDE_MULTISELECT_DIALOGUE,$.subscribe(this.openCommand,function(e,n){t.open();var i=t.extension.helper.getMultiSelectState();i.setEnabled(!0),t.component.set(null)}),$.subscribe(this.closeCommand,function(e){t.close();var n=t.extension.helper.getMultiSelectState();n.setEnabled(!1)}),this.$title=$("<h1></h1>"),this.$content.append(this.$title),this.$title.text(this.content.title),this.$gallery=$('<div class="iiif-gallery-component"></div>'),this.$content.append(this.$gallery),this.data={helper:this.extension.helper,chunkedResizingThreshold:this.config.options.galleryThumbChunkedResizingThreshold,content:this.config.content,debug:!1,imageFadeInDuration:300,initialZoom:4,minLabelWidth:20,pageModeEnabled:this.isPageModeEnabled(),searchResults:[],scrollStopDuration:100,sizingEnabled:!0,thumbHeight:this.config.options.galleryThumbHeight,thumbLoadPadding:this.config.options.galleryThumbLoadPadding,
thumbWidth:this.config.options.galleryThumbWidth,viewingDirection:this.extension.helper.getViewingDirection()},this.component=new IIIFComponents.GalleryComponent({target:this.$gallery[0],data:this.data});var o=this.$gallery.find("a.select");o.addClass("btn btn-primary"),this.component.on("multiSelectionMade",function(e){var t=e[0];$.publish(n.Commands.MULTISELECTION_MADE,[t]),i.close()}),this.$element.hide()},t.prototype.isPageModeEnabled=function(){return Utils.Bools.getBool(this.config.options.pageModeEnabled,!0)&&this.extension.getMode().toString()===o.Mode.page.toString()},t.prototype.open=function(){e.prototype.open.call(this)},t.prototype.close=function(){e.prototype.close.call(this)},t.prototype.resize=function(){e.prototype.resize.call(this);var t=this.$gallery.find(".main"),n=this.$gallery.find(".header");t.height(this.$content.height()-this.$title.outerHeight()-this.$title.verticalMargins()-n.height())},t}(i.Dialogue);t.MultiSelectDialogue=s}),define("extensions/uv-seadragon-extension/MultiSelectionArgs",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}return e}();t.MultiSelectionArgs=n}),define("modules/uv-shared-module/Information",["require","exports"],function(e,t){"use strict";var n=function(){function e(e,t){this.message=e,this.actions=t}return e}();t.Information=n}),define("modules/uv-shared-module/InformationAction",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}return e}();t.InformationAction=n}),define("modules/uv-shared-module/InformationFactory",["require","exports","./BaseCommands","./Information","./InformationAction","./InformationType"],function(e,t,n,i,o,s){"use strict";var a=function(){function e(e){this.extension=e}return e.prototype.Get=function(e){switch(e.informationType){case s.InformationType.AUTH_CORS_ERROR:return new i.Information(this.extension.config.content.authCORSError,[]);case s.InformationType.DEGRADED_RESOURCE:var t=[],a=new o.InformationAction;return a.label=this.extension.config.content.degradedResourceLogin,a.action=function(){$.publish(n.BaseCommands.HIDE_INFORMATION),$.publish(n.BaseCommands.OPEN_EXTERNAL_RESOURCE,[[e.param]])},t.push(a),new i.Information(this.extension.config.content.degradedResourceMessage,t)}},e}();t.InformationFactory=a});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-shared-module/HeaderPanel",["require","exports","./BaseCommands","./BaseView","../uv-shared-module/InformationFactory"],function(e,t,n,i,o){"use strict";var s=function(e){function t(t){return e.call(this,t,!1,!1)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("headerPanel"),e.prototype.create.call(this),$.subscribe(n.BaseCommands.SHOW_INFORMATION,function(e,n){t.showInformation(n)}),$.subscribe(n.BaseCommands.HIDE_INFORMATION,function(){t.hideInformation()}),this.$options=$('<div class="options"></div>'),this.$element.append(this.$options),this.$centerOptions=$('<div class="centerOptions"></div>'),this.$options.append(this.$centerOptions),this.$rightOptions=$('<div class="rightOptions"></div>'),this.$options.append(this.$rightOptions),this.$localeToggleButton=$('<a class="localeToggle" tabindex="0"></a>'),this.$rightOptions.append(this.$localeToggleButton),this.$settingsButton=$('<a class="imageBtn settings" tabindex="0"></a>'),this.$settingsButton.attr("title",this.content.settings),this.$rightOptions.append(this.$settingsButton),this.$informationBox=$('<div class="informationBox">                                     <div class="message"></div>                                     <div class="actions"></div>                                     <div class="close"></div>                                   </div>'),this.$element.append(this.$informationBox),this.$informationBox.hide(),this.$informationBox.find(".close").attr("title",this.content.close),this.$informationBox.find(".close").on("click",function(e){e.preventDefault(),$.publish(n.BaseCommands.HIDE_INFORMATION)}),this.$localeToggleButton.on("click",function(){t.extension.changeLocale(String(t.$localeToggleButton.data("locale")))}),this.$settingsButton.onPressed(function(){$.publish(n.BaseCommands.SHOW_SETTINGS_DIALOGUE)}),this.updateLocaleToggle(),this.updateSettingsButton()},t.prototype.updateLocaleToggle=function(){if(!this.localeToggleIsVisible())return void this.$localeToggleButton.hide();var e=this.extension.getAlternateLocale(),t=e.name.split("-")[0].toUpperCase();this.$localeToggleButton.data("locale",e.name),this.$localeToggleButton.attr("title",e.label),this.$localeToggleButton.text(t)},t.prototype.updateSettingsButton=function(){var e=Utils.Bools.getBool(this.options.settingsButtonEnabled,!0);e?this.$settingsButton.show():this.$settingsButton.hide()},t.prototype.localeToggleIsVisible=function(){return this.extension.getLocales().length>1&&Utils.Bools.getBool(this.options.localeToggleEnabled,!1)},t.prototype.showInformation=function(e){var t=new o.InformationFactory(this.extension);this.information=t.Get(e);var n=this.$informationBox.find(".message");n.html(this.information.message).find("a").attr("target","_top");var i=this.$informationBox.find(".actions");i.empty();for(var s=0;s<this.information.actions.length;s++){var a=this.information.actions[s],r=$('<a href="#" class="btn btn-default">'+a.label+"</a>");r.on("click",a.action),i.append(r)}this.$informationBox.show(),this.$element.addClass("showInformation"),this.extension.resize()},t.prototype.hideInformation=function(){this.$element.removeClass("showInformation"),this.$informationBox.hide(),this.extension.resize()},t.prototype.getSettings=function(){return this.extension.getSettings()},t.prototype.updateSettings=function(e){this.extension.updateSettings(e),$.publish(n.BaseCommands.UPDATE_SETTINGS,[e])},t.prototype.resize=function(){e.prototype.resize.call(this);var t=this.$element.width(),n=t/2,i=this.$centerOptions.outerWidth(),o=n-i/2;if(this.$centerOptions.css({left:o}),this.$informationBox.is(":visible")){var s=this.$informationBox.find(".actions"),a=this.$informationBox.find(".message");a.width(this.$element.width()-a.horizontalMargins()-s.outerWidth(!0)-this.$informationBox.find(".close").outerWidth(!0)-1),a.ellipsisFill(this.information.message)}this.extension.width()<this.extension.config.options.minWidthBreakPoint?this.localeToggleIsVisible()&&this.$localeToggleButton.hide():this.localeToggleIsVisible()&&this.$localeToggleButton.show()},t}(i.BaseView);t.HeaderPanel=s});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-pagingheaderpanel-module/PagingHeaderPanel",["require","exports","../uv-shared-module/AutoComplete","../uv-shared-module/BaseCommands","../../extensions/uv-seadragon-extension/Commands","../uv-shared-module/HeaderPanel","../../extensions/uv-seadragon-extension/Mode"],function(e,t,n,i,o,s,a){"use strict";var r=function(e){function t(t){var n=e.call(this,t)||this;return n.firstButtonEnabled=!1,n.lastButtonEnabled=!1,n.nextButtonEnabled=!1,n.prevButtonEnabled=!1,n}return __extends(t,e),t.prototype.create=function(){var t=this;if(this.setConfig("pagingHeaderPanel"),e.prototype.create.call(this),$.subscribe(i.BaseCommands.CANVAS_INDEX_CHANGED,function(e,n){t.canvasIndexChanged(n)}),$.subscribe(i.BaseCommands.SETTINGS_CHANGED,function(e){t.modeChanged(),t.updatePagingToggle()}),$.subscribe(i.BaseCommands.CANVAS_INDEX_CHANGE_FAILED,function(e){t.setSearchFieldValue(t.extension.helper.canvasIndex)}),$.subscribe(i.BaseCommands.LEFTPANEL_EXPAND_FULL_START,function(e){t.openGallery()}),$.subscribe(i.BaseCommands.LEFTPANEL_COLLAPSE_FULL_START,function(e){t.closeGallery()}),this.$prevOptions=$('<div class="prevOptions"></div>'),this.$centerOptions.append(this.$prevOptions),this.$firstButton=$('<a class="imageBtn first" tabindex="0"></a>'),this.$prevOptions.append(this.$firstButton),this.$prevButton=$('<a class="imageBtn prev" tabindex="0"></a>'),this.$prevOptions.append(this.$prevButton),this.$modeOptions=$('<div class="mode"></div>'),this.$centerOptions.append(this.$modeOptions),this.$imageModeLabel=$('<label for="image">'+this.content.image+"</label>"),this.$modeOptions.append(this.$imageModeLabel),this.$imageModeOption=$('<input type="radio" id="image" name="mode" tabindex="0"/>'),this.$modeOptions.append(this.$imageModeOption),this.$pageModeLabel=$('<label for="page"></label>'),this.$modeOptions.append(this.$pageModeLabel),this.$pageModeOption=$('<input type="radio" id="page" name="mode" tabindex="0"/>'),this.$modeOptions.append(this.$pageModeOption),this.$search=$('<div class="search"></div>'),this.$centerOptions.append(this.$search),this.$searchText=$('<input class="searchText" maxlength="50" type="text" tabindex="0"/>'),this.$search.append(this.$searchText),Utils.Bools.getBool(this.options.autoCompleteBoxEnabled,!0))this.$searchText.hide(),this.$autoCompleteBox=$('<input class="autocompleteText" type="text" maxlength="100" />'),this.$search.append(this.$autoCompleteBox),new n.AutoComplete(this.$autoCompleteBox,function(e,n){var i=[],o=t.extension.helper.getCanvases();if(t.isPageModeEnabled())for(var s=0;s<o.length;s++){var a=o[s],r=Manifesto.TranslationCollection.getValue(a.getLabel());r.startsWith(e)&&i.push(r)}else for(var s=0;s<o.length;s++){var a=o[s];a.index.toString().startsWith(e)&&i.push(a.index.toString())}n(i)},function(e){return e},function(e){t.search(e)},300,0);else if(Utils.Bools.getBool(this.options.imageSelectionBoxEnabled,!0)){this.$selectionBoxOptions=$('<div class="image-selectionbox-options"></div>'),this.$centerOptions.append(this.$selectionBoxOptions),this.$imageSelectionBox=$('<select class="image-selectionbox" name="image-select" tabindex="0" ></select>'),this.$selectionBoxOptions.append(this.$imageSelectionBox);for(var s=0;s<this.extension.helper.getTotalCanvases();s++){var r=this.extension.helper.getCanvasByIndex(s),l=this.extension.sanitize(Manifesto.TranslationCollection.getValue(r.getLabel()));this.$imageSelectionBox.append("<option value="+s+">"+l+"</option>")}this.$imageSelectionBox.change(function(){var e=parseInt(t.$imageSelectionBox.val());$.publish(o.Commands.IMAGE_SEARCH,[e])})}this.$total=$('<span class="total"></span>'),this.$search.append(this.$total),this.$searchButton=$('<a class="go btn btn-primary" tabindex="0">'+this.content.go+"</a>"),this.$search.append(this.$searchButton),this.$nextOptions=$('<div class="nextOptions"></div>'),this.$centerOptions.append(this.$nextOptions),this.$nextButton=$('<a class="imageBtn next" tabindex="0"></a>'),this.$nextOptions.append(this.$nextButton),this.$lastButton=$('<a class="imageBtn last" tabindex="0"></a>'),this.$nextOptions.append(this.$lastButton),this.isPageModeEnabled()?(this.$pageModeOption.attr("checked","checked"),this.$pageModeOption.removeAttr("disabled"),this.$pageModeLabel.removeClass("disabled")):(this.$imageModeOption.attr("checked","checked"),this.$pageModeOption.attr("disabled","disabled"),this.$pageModeLabel.addClass("disabled")),this.extension.helper.getManifestType().toString()===manifesto.ManifestType.manuscript().toString()?this.$pageModeLabel.text(this.content.folio):this.$pageModeLabel.text(this.content.page),this.$galleryButton=$('<a class="imageBtn gallery" title="'+this.content.gallery+'" tabindex="0"></a>'),this.$rightOptions.prepend(this.$galleryButton),this.$pagingToggleButtons=$('<div class="pagingToggleButtons"></div>'),this.$rightOptions.prepend(this.$pagingToggleButtons),this.$oneUpButton=$('<a class="imageBtn one-up" title="'+this.content.oneUp+'" tabindex="0"></a>'),this.$pagingToggleButtons.append(this.$oneUpButton),this.$twoUpButton=$('<a class="imageBtn two-up" title="'+this.content.twoUp+'" tabindex="0"></a>'),this.$pagingToggleButtons.append(this.$twoUpButton),this.updatePagingToggle(),this.updateGalleryButton(),this.$oneUpButton.onPressed(function(){var e=!1;t.updateSettings({pagingEnabled:e}),$.publish(o.Commands.PAGING_TOGGLED,[e])}),this.$twoUpButton.onPressed(function(){var e=!0;t.updateSettings({pagingEnabled:e}),$.publish(o.Commands.PAGING_TOGGLED,[e])}),this.$galleryButton.onPressed(function(){$.publish(i.BaseCommands.TOGGLE_EXPAND_LEFT_PANEL)}),this.setTitles(),this.setTotal();var h=this.extension.helper.getViewingDirection();1===this.extension.helper.getTotalCanvases()&&this.$centerOptions.hide(),this.$firstButton.onPressed(function(){switch(h.toString()){case manifesto.ViewingDirection.leftToRight().toString():case manifesto.ViewingDirection.topToBottom().toString():case manifesto.ViewingDirection.bottomToTop().toString():$.publish(o.Commands.FIRST);break;case manifesto.ViewingDirection.rightToLeft().toString():$.publish(o.Commands.LAST)}}),this.$prevButton.onPressed(function(){switch(h.toString()){case manifesto.ViewingDirection.leftToRight().toString():case manifesto.ViewingDirection.bottomToTop().toString():case manifesto.ViewingDirection.topToBottom().toString():$.publish(o.Commands.PREV);break;case manifesto.ViewingDirection.rightToLeft().toString():$.publish(o.Commands.NEXT)}}),this.$nextButton.onPressed(function(){switch(h.toString()){case manifesto.ViewingDirection.leftToRight().toString():case manifesto.ViewingDirection.bottomToTop().toString():case manifesto.ViewingDirection.topToBottom().toString():$.publish(o.Commands.NEXT);break;case manifesto.ViewingDirection.rightToLeft().toString():$.publish(o.Commands.PREV)}}),this.$lastButton.onPressed(function(){switch(h.toString()){case manifesto.ViewingDirection.leftToRight().toString():case manifesto.ViewingDirection.topToBottom().toString():case manifesto.ViewingDirection.bottomToTop().toString():$.publish(o.Commands.LAST);break;case manifesto.ViewingDirection.rightToLeft().toString():$.publish(o.Commands.FIRST)}}),this.config.options.pageModeEnabled?(this.$imageModeOption.on("click",function(e){$.publish(o.Commands.MODE_CHANGED,[a.Mode.image.toString()])}),this.$pageModeOption.on("click",function(e){$.publish(o.Commands.MODE_CHANGED,[a.Mode.page.toString()])})):(this.$imageModeOption.hide(),this.$pageModeLabel.hide(),this.$pageModeOption.hide()),this.$searchText.onEnter(function(){t.$searchText.blur(),t.search(t.$searchText.val())}),this.$searchText.click(function(){$(this).select()}),this.$searchButton.onPressed(function(){t.options.autoCompleteBoxEnabled?t.search(t.$autoCompleteBox.val()):t.search(t.$searchText.val())}),this.options.modeOptionsEnabled===!1&&(this.$modeOptions.hide(),this.$centerOptions.addClass("modeOptionsDisabled")),this.options.imageSelectionBoxEnabled===!0&&this.options.autoCompleteBoxEnabled!==!0&&this.$search.hide(),this.options.helpEnabled===!1&&this.$helpButton.hide(),Utils.Bools.getBool(this.options.pagingToggleEnabled,!0)||this.$pagingToggleButtons.hide()},t.prototype.openGallery=function(){this.$oneUpButton.removeClass("on"),this.$twoUpButton.removeClass("on"),this.$galleryButton.addClass("on")},t.prototype.closeGallery=function(){this.updatePagingToggle(),this.$galleryButton.removeClass("on")},t.prototype.isPageModeEnabled=function(){return this.config.options.pageModeEnabled&&this.extension.getMode().toString()===a.Mode.page.toString()},t.prototype.setTitles=function(){this.isPageModeEnabled()?(this.$firstButton.prop("title",this.content.firstPage),this.$prevButton.prop("title",this.content.previousPage),this.$nextButton.prop("title",this.content.nextPage),this.$lastButton.prop("title",this.content.lastPage)):(this.$firstButton.prop("title",this.content.firstImage),this.$prevButton.prop("title",this.content.previousImage),this.$nextButton.prop("title",this.content.nextImage),this.$lastButton.prop("title",this.content.lastImage)),this.$searchButton.prop("title",this.content.go)},t.prototype.updatePagingToggle=function(){return this.pagingToggleIsVisible()?void(this.extension.isPagingSettingEnabled()?(this.$oneUpButton.removeClass("on"),this.$twoUpButton.addClass("on")):(this.$twoUpButton.removeClass("on"),this.$oneUpButton.addClass("on"))):void this.$pagingToggleButtons.hide()},t.prototype.pagingToggleIsVisible=function(){return Utils.Bools.getBool(this.options.pagingToggleEnabled,!0)&&this.extension.helper.isPagingAvailable()},t.prototype.updateGalleryButton=function(){this.galleryIsVisible()||this.$galleryButton.hide()},t.prototype.galleryIsVisible=function(){return Utils.Bools.getBool(this.options.galleryButtonEnabled,!0)&&this.extension.isLeftPanelEnabled()},t.prototype.setTotal=function(){var e=this.content.of;this.isPageModeEnabled()?this.$total.html(String.format(e,this.extension.helper.getLastCanvasLabel(!0))):this.$total.html(String.format(e,this.extension.helper.getTotalCanvases()))},t.prototype.setSearchFieldValue=function(e){var t,n=this.extension.helper.getCanvasByIndex(e);if(this.isPageModeEnabled()){var i=Manifesto.TranslationCollection.getValue(n.getLabel());t="-"===i?"":i}else e+=1,t=e;this.options.autoCompleteBoxEnabled?this.$autoCompleteBox.val(t):this.$searchText.val(t)},t.prototype.search=function(e){if(!e)return this.extension.showMessage(this.content.emptyValue),void $.publish(i.BaseCommands.CANVAS_INDEX_CHANGE_FAILED);if(this.isPageModeEnabled())$.publish(o.Commands.PAGE_SEARCH,[e]);else{var t;if(t=this.options.autoCompleteBoxEnabled?parseInt(this.$autoCompleteBox.val(),10):parseInt(this.$searchText.val(),10),t-=1,isNaN(t))return this.extension.showMessage(this.extension.config.modules.genericDialogue.content.invalidNumber),void $.publish(i.BaseCommands.CANVAS_INDEX_CHANGE_FAILED);var n=this.extension.helper.getCanvasByIndex(t);if(!n)return this.extension.showMessage(this.extension.config.modules.genericDialogue.content.pageNotFound),void $.publish(i.BaseCommands.CANVAS_INDEX_CHANGE_FAILED);$.publish(o.Commands.IMAGE_SEARCH,[t])}},t.prototype.canvasIndexChanged=function(e){this.setSearchFieldValue(e),this.options.imageSelectionBoxEnabled===!0&&this.options.autoCompleteBoxEnabled!==!0&&this.$imageSelectionBox.val(e);var t=this.extension.helper.getViewingDirection();t.toString()===manifesto.ViewingDirection.rightToLeft().toString()?(this.extension.helper.isFirstCanvas()?(this.disableLastButton(),this.disableNextButton()):(this.enableLastButton(),this.enableNextButton()),this.extension.helper.isLastCanvas()?(this.disableFirstButton(),this.disablePrevButton()):(this.enableFirstButton(),this.enablePrevButton())):(this.extension.helper.isFirstCanvas()?(this.disableFirstButton(),this.disablePrevButton()):(this.enableFirstButton(),this.enablePrevButton()),this.extension.helper.isLastCanvas()?(this.disableLastButton(),this.disableNextButton()):(this.enableLastButton(),this.enableNextButton()))},t.prototype.disableFirstButton=function(){this.firstButtonEnabled=!1,this.$firstButton.disable()},t.prototype.enableFirstButton=function(){this.firstButtonEnabled=!0,this.$firstButton.enable()},t.prototype.disableLastButton=function(){this.lastButtonEnabled=!1,this.$lastButton.disable()},t.prototype.enableLastButton=function(){this.lastButtonEnabled=!0,this.$lastButton.enable()},t.prototype.disablePrevButton=function(){this.prevButtonEnabled=!1,this.$prevButton.disable()},t.prototype.enablePrevButton=function(){this.prevButtonEnabled=!0,this.$prevButton.enable()},t.prototype.disableNextButton=function(){this.nextButtonEnabled=!1,this.$nextButton.disable()},t.prototype.enableNextButton=function(){this.nextButtonEnabled=!0,this.$nextButton.enable()},t.prototype.modeChanged=function(){this.setSearchFieldValue(this.extension.helper.canvasIndex),this.setTitles(),this.setTotal()},t.prototype.resize=function(){e.prototype.resize.call(this),this.extension.width()<this.extension.config.options.minWidthBreakPoint?(this.pagingToggleIsVisible()&&this.$pagingToggleButtons.hide(),this.galleryIsVisible()&&this.$galleryButton.hide()):(this.pagingToggleIsVisible()&&this.$pagingToggleButtons.show(),this.galleryIsVisible()&&this.$galleryButton.show())},t}(s.HeaderPanel);t.PagingHeaderPanel=r}),define("extensions/uv-seadragon-extension/Bounds",["require","exports"],function(e,t){"use strict";var n=function(){function e(e,t,n,i){this.x=e,this.y=t,this.w=n,this.h=i}return e.prototype.toString=function(){return this.x+","+this.y+","+this.w+","+this.h},e.fromString=function(t){var n=t.split(",");return new e(Number(n[0]),Number(n[1]),Number(n[2]),Number(n[3]))},e}();t.Bounds=n});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-shared-module/CenterPanel",["require","exports","./Shell","./BaseView"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t,!1,!0)||this}return __extends(t,e),t.prototype.create=function(){var t=this;e.prototype.create.call(this),this.$title=$('<div class="title"></div>'),this.$element.append(this.$title),this.$content=$('<div id="content" class="content"></div>'),this.$element.append(this.$content),this.$attribution=$('<div class="attribution">                                   <div class="header">                                       <div class="title"></div>                                       <div class="close"></div>                                   </div>                                   <div class="main">                                       <div class="attribution-text"></div>                                       <div class="license"></div>                                       <div class="logo"></div>                                   </div>                              </div>'),this.$attribution.find(".header .title").text(this.content.attribution),this.$content.append(this.$attribution),this.$attribution.hide(),this.$closeAttributionButton=this.$attribution.find(".header .close"),this.$closeAttributionButton.on("click",function(e){e.preventDefault(),t.$attribution.hide()}),Utils.Bools.getBool(this.options.titleEnabled,!0)||this.$title.hide()},t.prototype.updateAttribution=function(){var e=this,t=this.extension.helper.getAttribution(),n=Utils.Bools.getBool(this.options.attributionEnabled,!0);if(t&&n){this.$attribution.show();var i=this.$attribution.find(".attribution-text"),o=this.$attribution.find(".license"),s=this.$attribution.find(".logo");i.html(this.extension.sanitize(t)),i.find("img").one("load",function(){e.resize()}).each(function(){this.complete&&$(this).load()}),i.targetBlank(),i.toggleExpandText(this.options.trimAttributionCount,function(){e.resize()}),o.hide(),s.hide()}},t.prototype.resize=function(){e.prototype.resize.call(this);var t=n.Shell.$leftPanel.is(":visible")?Math.floor(n.Shell.$leftPanel.width()):0,i=n.Shell.$rightPanel.is(":visible")?Math.floor(n.Shell.$rightPanel.width()):0,o=Math.floor(this.$element.parent().width()-t-i);this.$element.css({left:t,width:o});var s;s=this.options&&this.options.titleEnabled===!1?0:this.$title.height(),this.$content.height(this.$element.height()-s),this.$content.width(this.$element.width()),this.$attribution&&this.$attribution.is(":visible")&&this.$attribution.css("top",this.$content.height()-this.$attribution.outerHeight()-this.$attribution.verticalMargins())},t}(i.BaseView);t.CenterPanel=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-seadragoncenterpanel-module/SeadragonCenterPanel",["require","exports","../uv-shared-module/BaseCommands","../../extensions/uv-seadragon-extension/Bounds","../uv-shared-module/CenterPanel","../../extensions/uv-seadragon-extension/Commands","../uv-shared-module/Metrics","../../Params"],function(e,t,n,i,o,s,a,r){"use strict";var l=function(e){function t(t){var n=e.call(this,t)||this;return n.controlsVisible=!1,n.isCreated=!1,n.isFirstLoad=!0,n.nextButtonEnabled=!1,n.prevButtonEnabled=!1,n}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("seadragonCenterPanel"),e.prototype.create.call(this),this.$viewer=$('<div id="viewer"></div>'),this.$content.prepend(this.$viewer),$.subscribe(n.BaseCommands.SETTINGS_CHANGED,function(e,n){t.viewer.gestureSettingsMouse.clickToZoom=n.clickToZoomEnabled}),$.subscribe(n.BaseCommands.OPEN_EXTERNAL_RESOURCE,function(e,n){t.whenResized(function(){t.isCreated||t.createUI(),t.openMedia(n)})}),$.subscribe(s.Commands.CLEAR_SEARCH,function(){t.whenCreated(function(){t.extension.currentSearchResultRect=null,t.clearSearchResults()})}),$.subscribe(s.Commands.VIEW_PAGE,function(){t.extension.previousSearchResultRect=null,t.extension.currentSearchResultRect=null}),$.subscribe(s.Commands.NEXT_SEARCH_RESULT,function(){t.whenCreated(function(){t.nextSearchResult()})}),$.subscribe(s.Commands.PREV_SEARCH_RESULT,function(){t.whenCreated(function(){t.prevSearchResult()})}),$.subscribe(s.Commands.ZOOM_IN,function(){t.whenCreated(function(){t.zoomIn()})}),$.subscribe(s.Commands.ZOOM_OUT,function(){t.whenCreated(function(){t.zoomOut()})}),$.subscribe(s.Commands.ROTATE,function(){t.whenCreated(function(){t.rotateRight()})}),$.subscribe(n.BaseCommands.METRIC_CHANGED,function(){t.whenCreated(function(){t.updateResponsiveView()})})},t.prototype.whenResized=function(e){var t=this;Utils.Async.waitFor(function(){return t.isResized},e)},t.prototype.whenCreated=function(e){var t=this;Utils.Async.waitFor(function(){return t.isCreated},e)},t.prototype.zoomIn=function(){this.viewer.viewport.zoomTo(2*this.viewer.viewport.getZoom(!0))},t.prototype.zoomOut=function(){this.viewer.viewport.zoomTo(.5*this.viewer.viewport.getZoom(!0))},t.prototype.rotateRight=function(){this.viewer.viewport.setRotation(this.viewer.viewport.getRotation()+90)},t.prototype.updateResponsiveView=function(){this.setNavigatorVisible(),this.extension.metric===a.Metrics.MOBILE_LANDSCAPE?(this.viewer.autoHideControls=!1,this.$viewportNavButtons.hide()):(this.viewer.autoHideControls=!0,this.$viewportNavButtons.show())},t.prototype.createUI=function(){var e=this;this.$spinner=$('<div class="spinner"></div>'),this.$content.append(this.$spinner),this.updateAttribution();var t="themes/"+this.extension.config.options.theme+"/img/uv-seadragoncenterpanel-module/";window.openSeadragonViewer=this.viewer=OpenSeadragon({id:"viewer",ajaxWithCredentials:!1,showNavigationControl:!0,showNavigator:!0,showRotationControl:!0,showHomeControl:Utils.Bools.getBool(this.config.options.showHomeControl,!1),showFullPageControl:!1,defaultZoomLevel:this.config.options.defaultZoomLevel||0,maxZoomPixelRatio:this.config.options.maxZoomPixelRatio||2,controlsFadeDelay:this.config.options.controlsFadeDelay||250,controlsFadeLength:this.config.options.controlsFadeLength||250,navigatorPosition:this.config.options.navigatorPosition||"BOTTOM_RIGHT",animationTime:this.config.options.animationTime||1.2,visibilityRatio:this.config.options.visibilityRatio||.5,constrainDuringPan:Utils.Bools.getBool(this.config.options.constrainDuringPan,!1),immediateRender:Utils.Bools.getBool(this.config.options.immediateRender,!1),blendTime:this.config.options.blendTime||0,autoHideControls:Utils.Bools.getBool(this.config.options.autoHideControls,!0),prefixUrl:t,gestureSettingsMouse:{clickToZoom:!!this.extension.config.options.clickToZoomEnabled},navImages:{zoomIn:{REST:"zoom_in.png",GROUP:"zoom_in.png",HOVER:"zoom_in.png",DOWN:"zoom_in.png"},zoomOut:{REST:"zoom_out.png",GROUP:"zoom_out.png",HOVER:"zoom_out.png",DOWN:"zoom_out.png"},home:{REST:"home.png",GROUP:"home.png",HOVER:"home.png",DOWN:"home.png"},rotateright:{REST:"rotate_right.png",GROUP:"rotate_right.png",HOVER:"rotate_right.png",DOWN:"rotate_right.png"},rotateleft:{REST:"pixel.gif",GROUP:"pixel.gif",HOVER:"pixel.gif",DOWN:"pixel.gif"},next:{REST:"pixel.gif",GROUP:"pixel.gif",HOVER:"pixel.gif",DOWN:"pixel.gif"},previous:{REST:"pixel.gif",GROUP:"pixel.gif",HOVER:"pixel.gif",DOWN:"pixel.gif"}}}),this.$zoomInButton=this.$viewer.find('div[title="Zoom in"]'),this.$zoomInButton.attr("tabindex",0),this.$zoomInButton.prop("title",this.content.zoomIn),this.$zoomInButton.addClass("zoomIn viewportNavButton"),this.$zoomOutButton=this.$viewer.find('div[title="Zoom out"]'),this.$zoomOutButton.attr("tabindex",0),this.$zoomOutButton.prop("title",this.content.zoomOut),this.$zoomOutButton.addClass("zoomOut viewportNavButton"),this.$goHomeButton=this.$viewer.find('div[title="Go home"]'),this.$goHomeButton.attr("tabindex",0),this.$goHomeButton.prop("title",this.content.goHome),this.$goHomeButton.addClass("goHome viewportNavButton"),this.$rotateButton=this.$viewer.find('div[title="Rotate right"]'),this.$rotateButton.attr("tabindex",0),this.$rotateButton.prop("title",this.content.rotateRight),this.$rotateButton.addClass("rotate viewportNavButton"),this.$viewportNavButtonsContainer=this.$viewer.find(".openseadragon-container > div:not(.openseadragon-canvas):first"),this.$viewportNavButtons=this.$viewportNavButtonsContainer.find(".viewportNavButton"),this.$canvas=$(this.viewer.canvas),this.$canvas.on("contextmenu",function(e){return!1}),this.$navigator=this.$viewer.find(".navigator"),this.setNavigatorVisible(),this.$element.on("mousemove",function(t){e.controlsVisible||(e.controlsVisible=!0,e.viewer.setControlsEnabled(!0))}),this.$element.on("mouseleave",function(t){e.controlsVisible&&(e.controlsVisible=!1,e.viewer.setControlsEnabled(!1))}),this.$element.on("mousemove",function(t){if(!e.$viewer.find(".navigator").ismouseover()){if(!e.controlsVisible)return;e.controlsVisible=!1,e.viewer.setControlsEnabled(!1)}},this.config.options.controlsFadeAfterInactive),this.viewer.addHandler("tile-drawn",function(){e.$spinner.hide()}),this.viewer.addHandler("resize",function(t){$.publish(s.Commands.SEADRAGON_RESIZE,[t]),e.viewerResize(t)}),this.viewer.addHandler("animation-start",function(e){$.publish(s.Commands.SEADRAGON_ANIMATION_START,[e])}),this.viewer.addHandler("animation",function(e){$.publish(s.Commands.SEADRAGON_ANIMATION,[e])}),this.viewer.addHandler("animation-finish",function(t){e.currentBounds=e.getViewportBounds(),e.updateVisibleSearchResultRects(),$.publish(s.Commands.SEADRAGON_ANIMATION_FINISH,[t])}),this.viewer.addHandler("rotate",function(e){$.publish(s.Commands.SEADRAGON_ROTATION,[e.degrees])}),this.title=this.extension.helper.getLabel(),this.createNavigationButtons(),this.hidePrevButton(),this.hideNextButton(),this.isCreated=!0,this.resize()},t.prototype.createNavigationButtons=function(){var e=this.extension.helper.getViewingDirection();switch(this.$prevButton=$('<div class="paging btn prev" tabindex="0"></div>'),this.$prevButton.prop("title",this.content.previous),this.$nextButton=$('<div class="paging btn next" tabindex="0"></div>'),this.$nextButton.prop("title",this.content.next),this.viewer.addControl(this.$prevButton[0],{anchor:OpenSeadragon.ControlAnchor.TOP_LEFT}),this.viewer.addControl(this.$nextButton[0],{anchor:OpenSeadragon.ControlAnchor.TOP_RIGHT}),e.toString()){case manifesto.ViewingDirection.bottomToTop().toString():case manifesto.ViewingDirection.topToBottom().toString():this.$prevButton.addClass("vertical"),this.$nextButton.addClass("vertical")}var t=this;this.$prevButton.onPressed(function(n){if(n.preventDefault(),OpenSeadragon.cancelEvent(n),t.prevButtonEnabled)switch(e.toString()){case manifesto.ViewingDirection.leftToRight().toString():case manifesto.ViewingDirection.bottomToTop().toString():
case manifesto.ViewingDirection.topToBottom().toString():$.publish(s.Commands.PREV);break;case manifesto.ViewingDirection.rightToLeft().toString():$.publish(s.Commands.NEXT)}}),this.$nextButton.onPressed(function(n){if(n.preventDefault(),OpenSeadragon.cancelEvent(n),t.nextButtonEnabled)switch(e.toString()){case manifesto.ViewingDirection.leftToRight().toString():case manifesto.ViewingDirection.bottomToTop().toString():case manifesto.ViewingDirection.topToBottom().toString():$.publish(s.Commands.NEXT);break;case manifesto.ViewingDirection.rightToLeft().toString():$.publish(s.Commands.PREV)}})},t.prototype.openMedia=function(e){var t=this;this.$spinner.show(),this.items=[],this.extension.getExternalResources(e).then(function(e){t.viewer.close(),e=t.getPagePositions(e);for(var n=0;n<e.length;n++){var i=e[n];t.viewer.addTiledImage({tileSource:i,x:i.x,y:i.y,width:i.width,success:function(n){t.items.push(n),t.items.length===e.length&&t.openPagesHandler(),t.resize()}})}})},t.prototype.getPagePositions=function(e){var t,n,i,o,s,a;if(e.length>1)if(2===e.length)this.extension.helper.isVerticallyAligned()?(i=e[0],i.y=0,o=e[1],o.y=i.height+this.config.options.pageGap):(t=e[0],t.x=0,n=e[1],n.x=t.width+this.config.options.pageGap);else if(this.extension.helper.isVerticallyAligned())if(this.extension.helper.isTopToBottom())for(var r=0;r<e.length-1;r++)s=e[r],a=e[r+1],a.y=(s.y||0)+s.height;else for(var r=e.length;r>0;r--)s=e[r],a=e[r-1],a.y=(s.y||0)-s.height;else if(this.extension.helper.isLeftToRight())for(var r=0;r<e.length-1;r++)s=e[r],a=e[r+1],a.x=(s.x||0)+s.width;else for(var r=e.length-1;r>0;r--)s=e[r],a=e[r-1],a.x=(s.x||0)-s.width;return e},t.prototype.openPagesHandler=function(){if($.publish(s.Commands.SEADRAGON_OPEN),this.extension.helper.isMultiCanvas()&&!this.extension.helper.isContinuous()){this.showPrevButton(),this.showNextButton(),$(".navigator").addClass("extraMargin");var e=this.extension.helper.getViewingDirection();e.toString()===manifesto.ViewingDirection.rightToLeft().toString()?(this.extension.helper.isFirstCanvas()?this.disableNextButton():this.enableNextButton(),this.extension.helper.isLastCanvas()?this.disablePrevButton():this.enablePrevButton()):(this.extension.helper.isFirstCanvas()?this.disablePrevButton():this.enablePrevButton(),this.extension.helper.isLastCanvas()?this.disableNextButton():this.enableNextButton())}this.setNavigatorVisible(),this.overlaySearchResults(),this.updateBounds();var t=this.getInitialSearchResultRect();this.extension.previousSearchResultRect=null,this.extension.currentSearchResultRect=null,t&&this.isZoomToSearchResultEnabled()&&this.zoomToSearchResult(t),this.isFirstLoad=!1},t.prototype.updateBounds=function(){var e=this.extension.getSettings();this.isFirstLoad?(this.initialRotation=this.extension.getParam(r.Params.rotation),this.initialRotation&&this.viewer.viewport.setRotation(parseInt(this.initialRotation)),this.initialBounds=this.extension.getParam(r.Params.xywh),this.initialBounds&&(this.initialBounds=i.Bounds.fromString(this.initialBounds),this.currentBounds=this.initialBounds,this.fitToBounds(this.currentBounds))):e.preserveViewport?this.fitToBounds(this.currentBounds):this.goHome()},t.prototype.goHome=function(){this.viewer.viewport.goHome(!0)},t.prototype.disablePrevButton=function(){this.prevButtonEnabled=!1,this.$prevButton.addClass("disabled")},t.prototype.enablePrevButton=function(){this.prevButtonEnabled=!0,this.$prevButton.removeClass("disabled")},t.prototype.hidePrevButton=function(){this.disablePrevButton(),this.$prevButton.hide()},t.prototype.showPrevButton=function(){this.enablePrevButton(),this.$prevButton.show()},t.prototype.disableNextButton=function(){this.nextButtonEnabled=!1,this.$nextButton.addClass("disabled")},t.prototype.enableNextButton=function(){this.nextButtonEnabled=!0,this.$nextButton.removeClass("disabled")},t.prototype.hideNextButton=function(){this.disableNextButton(),this.$nextButton.hide()},t.prototype.showNextButton=function(){this.enableNextButton(),this.$nextButton.show()},t.prototype.serialiseBounds=function(e){return e.x+","+e.y+","+e.width+","+e.height},t.prototype.fitToBounds=function(e,t){void 0===t&&(t=!0);var n=new OpenSeadragon.Rect;n.x=Number(e.x),n.y=Number(e.y),n.width=Number(e.w),n.height=Number(e.h),this.viewer.viewport.fitBoundsWithConstraints(n,t)},t.prototype.getCroppedImageBounds=function(){if(!this.viewer||!this.viewer.viewport)return null;var e=this.extension.helper.getCurrentCanvas(),t=this.extension.getCroppedImageDimensions(e,this.viewer),n=new i.Bounds(t.regionPos.x,t.regionPos.y,t.region.width,t.region.height);return n.toString()},t.prototype.getViewportBounds=function(){if(!this.viewer||!this.viewer.viewport)return null;var e=this.viewer.viewport.getBounds(!0),t=new i.Bounds(Math.floor(e.x),Math.floor(e.y),Math.floor(e.width),Math.floor(e.height));return t},t.prototype.viewerResize=function(e){if(e.viewport){var t=e.viewport.getCenter(!0);t&&setTimeout(function(){e.viewport.panTo(t,!0)},1)}},t.prototype.clearSearchResults=function(){this.$canvas.find(".searchOverlay").hide()},t.prototype.overlaySearchResults=function(){for(var e=this.getSearchResultsForCurrentImages(),t=0;t<e.length;t++)for(var n=e[t],i=this.getSearchOverlayRects(n),o=0;o<i.length;o++){var s=i[o],a=document.createElement("div");a.id="searchResult-"+s.canvasIndex+"-"+s.resultIndex,a.className="searchOverlay",a.title=this.extension.sanitize(s.chars),this.viewer.addOverlay(a,s)}},t.prototype.getSearchResultsForCurrentImages=function(){var e=[],t=this.extension.searchResults;if(!t.length)return e;for(var n=this.extension.getPagedIndices(),i=0;i<n.length;i++)for(var o=n[i],s=0;s<t.length;s++)if(t[s].canvasIndex===o){e.push(t[s]);break}return e},t.prototype.getSearchResultRectsForCurrentImages=function(){var e=this.getSearchResultsForCurrentImages();return e.en().selectMany(function(e){return e.rects}).toArray()},t.prototype.updateVisibleSearchResultRects=function(){for(var e=this.getSearchResultRectsForCurrentImages(),t=0;t<e.length;t++){var n=e[t],i=this.viewer.viewport.getBounds();n.isVisible=Utils.Measurements.Dimensions.hitRect(i.x,i.y,i.width,i.height,n.viewportX,n.viewportY)}},t.prototype.getSearchResultRectIndex=function(e){var t=this.getSearchResultRectsForCurrentImages();return t.indexOf(e)},t.prototype.isZoomToSearchResultEnabled=function(){return Utils.Bools.getBool(this.extension.config.options.zoomToSearchResultEnabled,!0)},t.prototype.nextSearchResult=function(){for(var e,t=this.getSearchResultRectsForCurrentImages(),n=this.getSearchResultRectIndex(this.extension.currentSearchResultRect),i=n+1;i<t.length;i++){var o=t[i];e=o;break}e&&this.isZoomToSearchResultEnabled()?o.canvasIndex>this.extension.helper.canvasIndex?(this.extension.currentSearchResultRect=o,$.publish(s.Commands.SEARCH_RESULT_CANVAS_CHANGED,[o])):this.zoomToSearchResult(o):$.publish(s.Commands.NEXT_IMAGES_SEARCH_RESULT_UNAVAILABLE)},t.prototype.prevSearchResult=function(){for(var e,t=this.getSearchResultRectsForCurrentImages(),n=this.getSearchResultRectIndex(this.extension.currentSearchResultRect),i=n-1;i>=0;i--){var o=t[i];e=o;break}e&&this.isZoomToSearchResultEnabled()?o.canvasIndex<this.extension.helper.canvasIndex?(this.extension.currentSearchResultRect=o,$.publish(s.Commands.SEARCH_RESULT_CANVAS_CHANGED,[o])):this.zoomToSearchResult(o):$.publish(s.Commands.PREV_IMAGES_SEARCH_RESULT_UNAVAILABLE)},t.prototype.getSearchResultRectByIndex=function(e){var t=this.getSearchResultRectsForCurrentImages();return t.length?t[e]:null},t.prototype.getInitialSearchResultRect=function(){var e=this,t=this.getSearchResultRectsForCurrentImages();return t.length?this.extension.previousSearchResultRect&&this.extension.previousSearchResultRect.canvasIndex>this.extension.helper.canvasIndex?t.en().where(function(t){return t.canvasIndex===e.extension.helper.canvasIndex}).last():t.en().where(function(t){return t.canvasIndex===e.extension.helper.canvasIndex}).first():null},t.prototype.zoomToSearchResult=function(e){this.extension.previousSearchResultRect=this.extension.currentSearchResultRect||e,this.extension.currentSearchResultRect=e,this.fitToBounds(new i.Bounds(e.viewportX,e.viewportY,e.width,e.height),!1),this.highlightSearchResultRect(e),$.publish(s.Commands.SEARCH_RESULT_RECT_CHANGED)},t.prototype.highlightSearchResultRect=function(e){var t=$("#searchResult-"+e.canvasIndex+"-"+e.index);t.addClass("current"),$(".searchOverlay").not(t).removeClass("current")},t.prototype.getSearchOverlayRects=function(e){var t=[],n=this.extension.resources.en().where(function(t){return t.index===e.canvasIndex}).first(),i=this.extension.resources.indexOf(n),o=(this.extension.resources[i].width,0);i>0&&(o=this.extension.resources[i-1].width);for(var s=0;s<e.rects.length;s++){var a=e.rects[s],r=a.x+o+(i>0?this.config.options.pageGap:0),l=a.y,h=a.width,c=a.height,u=new OpenSeadragon.Rect(r,l,h,c);a.viewportX=r,a.viewportY=l,u.canvasIndex=a.canvasIndex,u.resultIndex=a.index,u.chars=a.chars,t.push(u)}return t},t.prototype.resize=function(){var t=this;if(e.prototype.resize.call(this),this.$viewer.height(this.$content.height()-this.$viewer.verticalMargins()),this.$viewer.width(this.$content.width()-this.$viewer.horizontalMargins()),this.isCreated){this.$title.ellipsisFill(this.extension.sanitize(this.title)),this.$spinner.css("top",this.$content.height()/2-this.$spinner.height()/2),this.$spinner.css("left",this.$content.width()/2-this.$spinner.width()/2);var n=this.extension.helper.getViewingDirection();if(this.extension.helper.isMultiCanvas()&&this.$prevButton&&this.$nextButton){var i=Math.floor(this.$content.width()/2);switch(n.toString()){case manifesto.ViewingDirection.bottomToTop().toString():this.$prevButton.addClass("down"),this.$nextButton.addClass("up"),this.$prevButton.css("left",i-this.$prevButton.outerWidth()/2),this.$prevButton.css("top",this.$content.height()-this.$prevButton.height()),this.$nextButton.css("left",-1*i-this.$nextButton.outerWidth()/2);break;case manifesto.ViewingDirection.topToBottom().toString():this.$prevButton.css("left",i-this.$prevButton.outerWidth()/2),this.$nextButton.css("left",-1*i-this.$nextButton.outerWidth()/2),this.$nextButton.css("top",this.$content.height()-this.$nextButton.height());break;default:this.$prevButton.css("top",(this.$content.height()-this.$prevButton.height())/2),this.$nextButton.css("top",(this.$content.height()-this.$nextButton.height())/2)}}setTimeout(function(){if(t.extension.helper.isContinuous())if(t.extension.helper.isHorizontallyAligned()){var e=t.$viewer.width()-t.$viewer.rightMargin();t.$navigator.width(e)}else t.$navigator.height(t.$viewer.height())},100)}},t.prototype.setFocus=function(){this.$canvas.is(":focus")||this.extension.config.options.allowStealFocus&&this.$canvas.focus()},t.prototype.setNavigatorVisible=function(){var e=Utils.Bools.getBool(this.extension.getSettings().navigatorEnabled,!0)&&this.extension.metric!==a.Metrics.MOBILE_LANDSCAPE;this.viewer.navigator.setVisible(e),e?this.$navigator.show():this.$navigator.hide()},t}(o.CenterPanel);t.SeadragonCenterPanel=l});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-dialogues-module/SettingsDialogue",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/Dialogue"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("settingsDialogue"),e.prototype.create.call(this),this.openCommand=n.BaseCommands.SHOW_SETTINGS_DIALOGUE,this.closeCommand=n.BaseCommands.HIDE_SETTINGS_DIALOGUE,$.subscribe(this.openCommand,function(e,n){t.open()}),$.subscribe(this.closeCommand,function(e){t.close()}),this.$title=$("<h1></h1>"),this.$content.append(this.$title),this.$scroll=$('<div class="scroll"></div>'),this.$content.append(this.$scroll),this.$version=$('<div class="version"></div>'),this.$content.append(this.$version),this.$website=$('<div class="website"></div>'),this.$content.append(this.$website),this.$locale=$('<div class="setting locale"></div>'),this.$scroll.append(this.$locale),this.$localeLabel=$('<label for="locale">'+this.content.locale+"</label>"),this.$locale.append(this.$localeLabel),this.$localeDropDown=$('<select id="locale"></select>'),this.$locale.append(this.$localeDropDown),this.$title.text(this.content.title),this.$website.html(this.content.website),this.$website.targetBlank();for(var i=this.extension.getLocales(),o=0;o<i.length;o++){var s=i[o];this.$localeDropDown.append('<option value="'+s.name+'">'+s.label+"</option>")}this.$localeDropDown.val(this.extension.locale),this.$localeDropDown.change(function(){t.extension.changeLocale(t.$localeDropDown.val())}),this.extension.getLocales().length<2&&this.$locale.hide(),this.$element.hide()},t.prototype.getSettings=function(){return this.extension.getSettings()},t.prototype.updateSettings=function(e){this.extension.updateSettings(e),$.publish(n.BaseCommands.UPDATE_SETTINGS,[e])},t.prototype.open=function(){var t=this;e.prototype.open.call(this),$.getJSON("package.json",function(e){t.$version.text("v"+e.version)})},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(i.Dialogue);t.SettingsDialogue=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-seadragon-extension/SettingsDialogue",["require","exports","../../modules/uv-dialogues-module/SettingsDialogue"],function(e,t,n){"use strict";var i=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("settingsDialogue"),e.prototype.create.call(this),this.$navigatorEnabled=$('<div class="setting navigatorEnabled"></div>'),this.$scroll.append(this.$navigatorEnabled),this.$navigatorEnabledCheckbox=$('<input id="navigatorEnabled" type="checkbox" tabindex="0" />'),this.$navigatorEnabled.append(this.$navigatorEnabledCheckbox),this.$navigatorEnabledLabel=$('<label for="navigatorEnabled">'+this.content.navigatorEnabled+"</label>"),this.$navigatorEnabled.append(this.$navigatorEnabledLabel),this.$pagingEnabled=$('<div class="setting pagingEnabled"></div>'),this.$scroll.append(this.$pagingEnabled),this.$pagingEnabledCheckbox=$('<input id="pagingEnabled" type="checkbox" tabindex="0" />'),this.$pagingEnabled.append(this.$pagingEnabledCheckbox),this.$pagingEnabledLabel=$('<label for="pagingEnabled">'+this.content.pagingEnabled+"</label>"),this.$pagingEnabled.append(this.$pagingEnabledLabel),this.$clickToZoomEnabled=$('<div class="setting clickToZoom"></div>'),this.$scroll.append(this.$clickToZoomEnabled),this.$clickToZoomEnabledCheckbox=$('<input id="clickToZoomEnabled" type="checkbox" />'),this.$clickToZoomEnabled.append(this.$clickToZoomEnabledCheckbox),this.$clickToZoomEnabledLabel=$('<label for="clickToZoomEnabled">'+this.content.clickToZoomEnabled+"</label>"),this.$clickToZoomEnabled.append(this.$clickToZoomEnabledLabel),this.$preserveViewport=$('<div class="setting preserveViewport"></div>'),this.$scroll.append(this.$preserveViewport),this.$preserveViewportCheckbox=$('<input id="preserveViewport" type="checkbox" tabindex="0" />'),this.$preserveViewport.append(this.$preserveViewportCheckbox),this.$preserveViewportLabel=$('<label for="preserveViewport">'+this.content.preserveViewport+"</label>"),this.$preserveViewport.append(this.$preserveViewportLabel),this.$navigatorEnabledCheckbox.change(function(){var e={};t.$navigatorEnabledCheckbox.is(":checked")?e.navigatorEnabled=!0:e.navigatorEnabled=!1,t.updateSettings(e)}),this.$clickToZoomEnabledCheckbox.change(function(){var e={};t.$clickToZoomEnabledCheckbox.is(":checked")?e.clickToZoomEnabled=!0:e.clickToZoomEnabled=!1,t.updateSettings(e)}),this.$pagingEnabledCheckbox.change(function(){var e={};t.$pagingEnabledCheckbox.is(":checked")?e.pagingEnabled=!0:e.pagingEnabled=!1,t.updateSettings(e)}),this.$preserveViewportCheckbox.change(function(){var e={};t.$preserveViewportCheckbox.is(":checked")?e.preserveViewport=!0:e.preserveViewport=!1,t.updateSettings(e)})},t.prototype.open=function(){e.prototype.open.call(this);var t=this.getSettings();t.navigatorEnabled?this.$navigatorEnabledCheckbox.prop("checked",!0):this.$navigatorEnabledCheckbox.removeAttr("checked"),t.clickToZoomEnabled?this.$clickToZoomEnabledCheckbox.prop("checked",!0):this.$clickToZoomEnabledCheckbox.removeAttr("checked"),this.extension.helper.isPagingAvailable()?t.pagingEnabled?this.$pagingEnabledCheckbox.prop("checked",!0):this.$pagingEnabledCheckbox.removeAttr("checked"):this.$pagingEnabled.hide(),t.preserveViewport?this.$preserveViewportCheckbox.prop("checked",!0):this.$preserveViewportCheckbox.removeAttr("checked")},t}(n.SettingsDialogue);t.SettingsDialogue=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-dialogues-module/ShareDialogue",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/Dialogue"],function(e,t,n,i){"use strict";var o=function(e){function t(t){var n=e.call(this,t)||this;return n.aspectRatio=.75,n.isEmbedViewVisible=!1,n.isShareViewVisible=!1,n.maxHeight=n.maxWidth*n.aspectRatio,n.maxWidth=8e3,n.minHeight=n.minWidth*n.aspectRatio,n.minWidth=200,n}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("shareDialogue"),e.prototype.create.call(this),this.openCommand=n.BaseCommands.SHOW_SHARE_DIALOGUE,this.closeCommand=n.BaseCommands.HIDE_SHARE_DIALOGUE,$.subscribe(this.openCommand,function(e,n){t.open(n),t.isShareAvailable()?t.openShareView():t.openEmbedView()}),$.subscribe(this.closeCommand,function(e){t.close()}),$.subscribe(n.BaseCommands.SHOW_EMBED_DIALOGUE,function(e,n){t.open(n),t.openEmbedView()}),this.$tabs=$('<div class="tabs"></div>'),this.$content.append(this.$tabs),this.$shareButton=$('<a class="share tab default" tabindex="0">'+this.content.share+"</a>"),this.$shareButton.prop("title",this.content.share),this.$tabs.append(this.$shareButton),this.$embedButton=$('<a class="embed tab" tabindex="0">'+this.content.embed+"</a>"),this.$embedButton.prop("title",this.content.embed),this.$tabs.append(this.$embedButton),this.$tabsContent=$('<div class="tabsContent"></div>'),this.$content.append(this.$tabsContent),this.$footer=$('<div class="footer"></div>'),this.$content.append(this.$footer),this.$shareView=$('<div class="shareView view"></div>'),this.$tabsContent.append(this.$shareView),this.$shareHeader=$('<div class="header"></div>'),this.$shareView.append(this.$shareHeader),this.$shareLink=$('<a class="shareLink" onclick="return false;"></a>'),this.$shareView.append(this.$shareLink),this.$shareInput=$('<input class="shareInput" type="text" readonly="true" />'),this.$shareView.append(this.$shareInput),this.$shareFrame=$('<iframe class="shareFrame"></iframe>'),this.$shareView.append(this.$shareFrame),this.$embedView=$('<div class="embedView view"></div>'),this.$tabsContent.append(this.$embedView),this.$embedHeader=$('<div class="header"></div>'),this.$embedView.append(this.$embedHeader),this.$code=$('<input class="code" type="text" readonly="true" />'),this.$embedView.append(this.$code),this.$customSize=$('<div class="customSize"></div>'),this.$embedView.append(this.$customSize),this.$size=$('<span class="size">'+this.content.size+"</span>"),this.$customSize.append(this.$size),this.$customSizeDropDown=$('<select id="size"></select>'),this.$customSize.append(this.$customSizeDropDown),this.$customSizeDropDown.append('<option value="small" data-width="560" data-height="420">560 x 420</option>'),this.$customSizeDropDown.append('<option value="medium" data-width="640" data-height="480">640 x 480</option>'),this.$customSizeDropDown.append('<option value="large" data-width="800" data-height="600">800 x 600</option>'),this.$customSizeDropDown.append('<option value="custom">'+this.content.customSize+"</option>"),this.$widthInput=$('<input class="width" type="text" maxlength="10" />'),this.$customSize.append(this.$widthInput),this.$x=$('<span class="x">x</span>'),this.$customSize.append(this.$x),this.$heightInput=$('<input class="height" type="text" maxlength="10" />'),this.$customSize.append(this.$heightInput);var i=this.extension.getIIIFShareUrl();this.$iiifButton=$('<a class="imageBtn iiif" href="'+i+'" title="'+this.content.iiif+'" target="_blank"></a>'),this.$footer.append(this.$iiifButton),this.$termsOfUseButton=$('<a href="#">'+this.extension.config.content.termsOfUse+"</a>"),this.$footer.append(this.$termsOfUseButton),this.$widthInput.on("keydown",function(e){return Utils.Numbers.numericalInput(e)}),this.$heightInput.on("keydown",function(e){return Utils.Numbers.numericalInput(e)}),this.$shareInput.focus(function(){$(this).select()}),this.$code.focus(function(){$(this).select()}),this.$shareButton.onPressed(function(){t.openShareView()}),this.$embedButton.onPressed(function(){t.openEmbedView()}),this.$customSizeDropDown.change(function(){t.update()}),this.$widthInput.change(function(){t.updateHeightRatio(),t.update()}),this.$heightInput.change(function(){t.updateWidthRatio(),t.update()}),this.$termsOfUseButton.onPressed(function(){$.publish(n.BaseCommands.SHOW_TERMS_OF_USE)}),this.$element.hide(),this.update()},t.prototype.open=function(t){e.prototype.open.call(this,t),this.update()},t.prototype.getShareUrl=function(){return this.extension.getShareUrl()},t.prototype.isShareAvailable=function(){return!!this.getShareUrl()},t.prototype.update=function(){this.isShareAvailable()?this.$shareButton.show():this.$shareButton.hide();var e=this.getSelectedSize();"custom"===e.val()?(this.$widthInput.show(),this.$x.show(),this.$heightInput.show()):(this.$widthInput.hide(),this.$x.hide(),this.$heightInput.hide(),this.currentWidth=Number(e.data("width")),this.currentHeight=Number(e.data("height")),this.$widthInput.val(String(this.currentWidth)),this.$heightInput.val(String(this.currentHeight))),this.updateInstructions(),this.updateShareOptions(),this.updateShareFrame(),this.updateTermsOfUseButton()},t.prototype.updateShareOptions=function(){this.$shareInput.val(this.getShareUrl()),this.$shareLink.prop("href",this.getShareUrl()),this.$shareLink.text(this.getShareUrl()),$.browser.mobile?(this.$shareInput.hide(),this.$shareLink.show()):(this.$shareInput.show(),this.$shareLink.hide())},t.prototype.updateInstructions=function(){Utils.Bools.getBool(this.options.instructionsEnabled,!1)?(this.$shareHeader.show(),this.$embedHeader.show(),this.$shareHeader.text(this.content.shareInstructions),this.$embedHeader.text(this.content.embedInstructions)):(this.$shareHeader.hide(),this.$embedHeader.hide())},t.prototype.getSelectedSize=function(){return this.$customSizeDropDown.find(":selected")},t.prototype.updateWidthRatio=function(){this.currentHeight=Number(this.$heightInput.val()),this.currentHeight<this.minHeight?(this.currentHeight=this.minHeight,this.$heightInput.val(String(this.currentHeight))):this.currentHeight>this.maxHeight&&(this.currentHeight=this.maxHeight,this.$heightInput.val(String(this.currentHeight))),this.currentWidth=Math.floor(this.currentHeight/this.aspectRatio),this.$widthInput.val(String(this.currentWidth))},t.prototype.updateHeightRatio=function(){this.currentWidth=Number(this.$widthInput.val()),this.currentWidth<this.minWidth?(this.currentWidth=this.minWidth,this.$widthInput.val(String(this.currentWidth))):this.currentWidth>this.maxWidth&&(this.currentWidth=this.maxWidth,this.$widthInput.val(String(this.currentWidth))),this.currentHeight=Math.floor(this.currentWidth*this.aspectRatio),this.$heightInput.val(String(this.currentHeight))},t.prototype.updateShareFrame=function(){var e=this.extension.helper.getShareServiceUrl();Utils.Bools.getBool(this.config.options.shareFrameEnabled,!0)&&e?(this.$shareFrame.prop("src",e),this.$shareFrame.show()):this.$shareFrame.hide()},t.prototype.updateTermsOfUseButton=function(){var e=this.extension.helper.getAttribution();Utils.Bools.getBool(this.extension.config.options.termsOfUseEnabled,!1)&&e?this.$termsOfUseButton.show():this.$termsOfUseButton.hide()},t.prototype.openShareView=function(){this.isShareViewVisible=!0,this.isEmbedViewVisible=!1,this.$embedView.hide(),this.$shareView.show(),this.$shareButton.addClass("on default"),this.$embedButton.removeClass("on default"),this.resize()},t.prototype.openEmbedView=function(){this.isShareViewVisible=!1,this.isEmbedViewVisible=!0,this.$embedView.show(),this.$shareView.hide(),this.$shareButton.removeClass("on default"),this.$embedButton.addClass("on default"),this.resize()},t.prototype.close=function(){e.prototype.close.call(this)},t.prototype.getViews=function(){return this.$tabsContent.find(".view")},t.prototype.equaliseViewHeights=function(){this.getViews().equaliseHeight(!0)},t.prototype.resize=function(){this.equaliseViewHeights(),this.setDockedPosition()},t}(i.Dialogue);t.ShareDialogue=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-seadragon-extension/ShareDialogue",["require","exports","../../modules/uv-dialogues-module/ShareDialogue","./Commands"],function(e,t,n,i){"use strict";var o=function(e){function t(t){var n=e.call(this,t)||this;return $.subscribe(i.Commands.SEADRAGON_OPEN,function(){n.update()}),$.subscribe(i.Commands.SEADRAGON_ANIMATION_FINISH,function(){n.update()}),n}return __extends(t,e),t.prototype.create=function(){this.setConfig("shareDialogue"),e.prototype.create.call(this)},t.prototype.update=function(){e.prototype.update.call(this);var t=this.extension.getViewportBounds(),n=this.extension.getViewerRotation();this.code=this.extension.getEmbedScript(this.options.embedTemplate,this.currentWidth,this.currentHeight,t,n),this.$code.val(this.code)},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(n.ShareDialogue);t.ShareDialogue=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-seadragon-extension/Extension",["require","exports","../../modules/uv-shared-module/BaseCommands","../../modules/uv-shared-module/BaseExtension","../../modules/uv-shared-module/Bookmark","./Commands","../../modules/uv-contentleftpanel-module/ContentLeftPanel","./CroppedImageDimensions","./DownloadDialogue","../../modules/uv-dialogues-module/ExternalContentDialogue","../../modules/uv-osdmobilefooterpanel-module/MobileFooter","../../modules/uv-searchfooterpanel-module/FooterPanel","../../modules/uv-dialogues-module/HelpDialogue","../../modules/uv-shared-module/Metrics","./Mode","../../modules/uv-dialogues-module/MoreInfoDialogue","../../modules/uv-moreinforightpanel-module/MoreInfoRightPanel","../../modules/uv-multiselectdialogue-module/MultiSelectDialogue","./MultiSelectionArgs","../../modules/uv-pagingheaderpanel-module/PagingHeaderPanel","../../Params","../../modules/uv-shared-module/Point","../../modules/uv-seadragoncenterpanel-module/SeadragonCenterPanel","./SettingsDialogue","./ShareDialogue","../../modules/uv-shared-module/Shell"],function(e,t,n,i,o,s,a,r,l,h,c,u,p,d,m,g,f,v,b,E,C,y,x,S,w,B){"use strict";var D=Manifold.SearchResult,I=Utils.Measurements.Size,R=function(e){function t(t){var n=e.call(this,t)||this;return n.currentRotation=0,n.isSearching=!1,n.searchResults=[],n}return __extends(t,e),t.prototype.create=function(){var t=this;e.prototype.create.call(this);$.subscribe(n.BaseCommands.METRIC_CHANGED,function(){if(t.metric===d.Metrics.MOBILE_LANDSCAPE){var e={};e.pagingEnabled=!1,t.updateSettings(e),$.publish(n.BaseCommands.UPDATE_SETTINGS),B.Shell.$rightPanel.hide()}else B.Shell.$rightPanel.show()}),$.subscribe(s.Commands.CLEAR_SEARCH,function(e){t.searchResults=null,$.publish(s.Commands.SEARCH_RESULTS_CLEARED),t.triggerSocket(s.Commands.CLEAR_SEARCH)}),$.subscribe(n.BaseCommands.DOWN_ARROW,function(e){t.useArrowKeysToNavigate()||t.centerPanel.setFocus()}),$.subscribe(n.BaseCommands.END,function(e){t.viewPage(t.helper.getLastPageIndex())}),$.subscribe(s.Commands.FIRST,function(e){t.triggerSocket(s.Commands.FIRST),t.viewPage(t.helper.getFirstPageIndex())}),$.subscribe(s.Commands.GALLERY_DECREASE_SIZE,function(e){t.triggerSocket(s.Commands.GALLERY_DECREASE_SIZE)}),$.subscribe(s.Commands.GALLERY_INCREASE_SIZE,function(e){t.triggerSocket(s.Commands.GALLERY_INCREASE_SIZE)}),$.subscribe(s.Commands.GALLERY_THUMB_SELECTED,function(e){t.triggerSocket(s.Commands.GALLERY_THUMB_SELECTED)}),$.subscribe(n.BaseCommands.HOME,function(e){t.viewPage(t.helper.getFirstPageIndex())}),$.subscribe(s.Commands.IMAGE_SEARCH,function(e,n){t.triggerSocket(s.Commands.IMAGE_SEARCH,n),t.viewPage(n)}),$.subscribe(s.Commands.LAST,function(e){t.triggerSocket(s.Commands.LAST),t.viewPage(t.helper.getLastPageIndex())}),$.subscribe(n.BaseCommands.LEFT_ARROW,function(e){t.useArrowKeysToNavigate()?t.viewPage(t.getPrevPageIndex()):t.centerPanel.setFocus()}),$.subscribe(n.BaseCommands.LEFTPANEL_COLLAPSE_FULL_START,function(e){t.metric!==d.Metrics.MOBILE_LANDSCAPE&&B.Shell.$rightPanel.show()}),$.subscribe(n.BaseCommands.LEFTPANEL_COLLAPSE_FULL_FINISH,function(e){B.Shell.$centerPanel.show(),t.resize()}),$.subscribe(n.BaseCommands.LEFTPANEL_EXPAND_FULL_START,function(e){B.Shell.$centerPanel.hide(),B.Shell.$rightPanel.hide()}),$.subscribe(n.BaseCommands.MINUS,function(e){t.centerPanel.setFocus()}),$.subscribe(s.Commands.MODE_CHANGED,function(e,i){t.triggerSocket(s.Commands.MODE_CHANGED,i),t.mode=new m.Mode(i);var o=t.getSettings();$.publish(n.BaseCommands.SETTINGS_CHANGED,[o])}),$.subscribe(s.Commands.MULTISELECTION_MADE,function(e,n){var i=new b.MultiSelectionArgs;i.manifestUri=t.helper.iiifResourceUri,i.allCanvases=n.length===t.helper.getCanvases().length,i.canvases=n,i.format=t.config.options.multiSelectionMimeType,i.sequence=t.helper.getCurrentSequence().id,t.triggerSocket(s.Commands.MULTISELECTION_MADE,i)}),$.subscribe(s.Commands.NEXT,function(e){t.triggerSocket(s.Commands.NEXT),t.viewPage(t.getNextPageIndex())}),$.subscribe(s.Commands.NEXT_SEARCH_RESULT,function(){t.triggerSocket(s.Commands.NEXT_SEARCH_RESULT)}),$.subscribe(s.Commands.NEXT_IMAGES_SEARCH_RESULT_UNAVAILABLE,function(){t.triggerSocket(s.Commands.NEXT_IMAGES_SEARCH_RESULT_UNAVAILABLE),t.nextSearchResult()}),$.subscribe(s.Commands.PREV_IMAGES_SEARCH_RESULT_UNAVAILABLE,function(){t.triggerSocket(s.Commands.PREV_IMAGES_SEARCH_RESULT_UNAVAILABLE),t.prevSearchResult()}),$.subscribe(s.Commands.OPEN_THUMBS_VIEW,function(e){t.triggerSocket(s.Commands.OPEN_THUMBS_VIEW)}),$.subscribe(s.Commands.OPEN_TREE_VIEW,function(e){t.triggerSocket(s.Commands.OPEN_TREE_VIEW)}),$.subscribe(n.BaseCommands.PAGE_DOWN,function(e){t.viewPage(t.getNextPageIndex())}),$.subscribe(s.Commands.PAGE_SEARCH,function(e,n){t.triggerSocket(s.Commands.PAGE_SEARCH,n),t.viewLabel(n)}),$.subscribe(n.BaseCommands.PAGE_UP,function(e){t.viewPage(t.getPrevPageIndex())}),$.subscribe(s.Commands.PAGING_TOGGLED,function(e,n){
t.triggerSocket(s.Commands.PAGING_TOGGLED,n)}),$.subscribe(n.BaseCommands.PLUS,function(e){t.centerPanel.setFocus()}),$.subscribe(s.Commands.PREV,function(e){t.triggerSocket(s.Commands.PREV),t.viewPage(t.getPrevPageIndex())}),$.subscribe(s.Commands.PREV_SEARCH_RESULT,function(){t.triggerSocket(s.Commands.PREV_SEARCH_RESULT)}),$.subscribe(s.Commands.PRINT,function(){t.print()}),$.subscribe(n.BaseCommands.RIGHT_ARROW,function(e){t.useArrowKeysToNavigate()?t.viewPage(t.getNextPageIndex()):t.centerPanel.setFocus()}),$.subscribe(s.Commands.SEADRAGON_ANIMATION,function(){t.triggerSocket(s.Commands.SEADRAGON_ANIMATION)}),$.subscribe(s.Commands.SEADRAGON_ANIMATION_FINISH,function(e,n){t.centerPanel&&t.centerPanel.currentBounds&&t.setParam(C.Params.xywh,t.centerPanel.getViewportBounds().toString());var i=t.helper.getCurrentCanvas();t.triggerSocket(s.Commands.CURRENT_VIEW_URI,{cropUri:t.getCroppedImageUri(i,t.getViewer()),fullUri:t.getConfinedImageUri(i,i.getWidth())})}),$.subscribe(s.Commands.SEADRAGON_ANIMATION_START,function(){t.triggerSocket(s.Commands.SEADRAGON_ANIMATION_START)}),$.subscribe(s.Commands.SEADRAGON_OPEN,function(){t.useArrowKeysToNavigate()||t.centerPanel.setFocus()}),$.subscribe(s.Commands.SEADRAGON_RESIZE,function(){t.triggerSocket(s.Commands.SEADRAGON_RESIZE)}),$.subscribe(s.Commands.SEADRAGON_ROTATION,function(e,n){t.triggerSocket(s.Commands.SEADRAGON_ROTATION),t.currentRotation=n,t.setParam(C.Params.rotation,n)}),$.subscribe(s.Commands.SEARCH,function(e,n){t.triggerSocket(s.Commands.SEARCH,n),t.searchWithin(n)}),$.subscribe(s.Commands.SEARCH_PREVIEW_FINISH,function(e){t.triggerSocket(s.Commands.SEARCH_PREVIEW_FINISH)}),$.subscribe(s.Commands.SEARCH_PREVIEW_START,function(e){t.triggerSocket(s.Commands.SEARCH_PREVIEW_START)}),$.subscribe(s.Commands.SEARCH_RESULTS,function(e,n){t.triggerSocket(s.Commands.SEARCH_RESULTS,n)}),$.subscribe(s.Commands.SEARCH_RESULT_CANVAS_CHANGED,function(e,n){t.viewPage(n.canvasIndex)}),$.subscribe(s.Commands.SEARCH_RESULTS_EMPTY,function(e){t.triggerSocket(s.Commands.SEARCH_RESULTS_EMPTY)}),$.subscribe(n.BaseCommands.THUMB_SELECTED,function(e,n){t.viewPage(n.index)}),$.subscribe(s.Commands.TREE_NODE_SELECTED,function(e,n){t.triggerSocket(s.Commands.TREE_NODE_SELECTED,n.data.path),t.treeNodeSelected(n)}),$.subscribe(n.BaseCommands.UP_ARROW,function(e){t.useArrowKeysToNavigate()||t.centerPanel.setFocus()}),$.subscribe(n.BaseCommands.UPDATE_SETTINGS,function(e){t.viewPage(t.helper.canvasIndex,!0);var i=t.getSettings();$.publish(n.BaseCommands.SETTINGS_CHANGED,[i])}),$.subscribe(s.Commands.VIEW_PAGE,function(e,n){t.triggerSocket(s.Commands.VIEW_PAGE,n),t.viewPage(n)}),Utils.Async.waitFor(function(){return t.centerPanel&&t.centerPanel.isCreated},function(){t.checkForSearchParam(),t.checkForRotationParam()})},t.prototype.createModules=function(){e.prototype.createModules.call(this),this.isHeaderPanelEnabled()?this.headerPanel=new E.PagingHeaderPanel(B.Shell.$headerPanel):B.Shell.$headerPanel.hide(),this.isLeftPanelEnabled()?this.leftPanel=new a.ContentLeftPanel(B.Shell.$leftPanel):B.Shell.$leftPanel.hide(),this.centerPanel=new x.SeadragonCenterPanel(B.Shell.$centerPanel),this.isRightPanelEnabled()?this.rightPanel=new f.MoreInfoRightPanel(B.Shell.$rightPanel):B.Shell.$rightPanel.hide(),this.isFooterPanelEnabled()?(this.footerPanel=new u.FooterPanel(B.Shell.$footerPanel),this.mobileFooterPanel=new c.FooterPanel(B.Shell.$mobileFooterPanel)):B.Shell.$footerPanel.hide(),this.$helpDialogue=$('<div class="overlay help"></div>'),B.Shell.$overlays.append(this.$helpDialogue),this.helpDialogue=new p.HelpDialogue(this.$helpDialogue),this.$moreInfoDialogue=$('<div class="overlay moreInfo"></div>'),B.Shell.$overlays.append(this.$moreInfoDialogue),this.moreInfoDialogue=new g.MoreInfoDialogue(this.$moreInfoDialogue),this.$multiSelectDialogue=$('<div class="overlay multiSelect"></div>'),B.Shell.$overlays.append(this.$multiSelectDialogue),this.multiSelectDialogue=new v.MultiSelectDialogue(this.$multiSelectDialogue),this.$shareDialogue=$('<div class="overlay share"></div>'),B.Shell.$overlays.append(this.$shareDialogue),this.shareDialogue=new w.ShareDialogue(this.$shareDialogue),this.$downloadDialogue=$('<div class="overlay download"></div>'),B.Shell.$overlays.append(this.$downloadDialogue),this.downloadDialogue=new l.DownloadDialogue(this.$downloadDialogue),this.$settingsDialogue=$('<div class="overlay settings"></div>'),B.Shell.$overlays.append(this.$settingsDialogue),this.settingsDialogue=new S.SettingsDialogue(this.$settingsDialogue),this.$externalContentDialogue=$('<div class="overlay externalContent"></div>'),B.Shell.$overlays.append(this.$externalContentDialogue),this.externalContentDialogue=new h.ExternalContentDialogue(this.$externalContentDialogue),this.isHeaderPanelEnabled()&&this.headerPanel.init(),this.isLeftPanelEnabled()&&this.leftPanel.init(),this.isRightPanelEnabled()&&this.rightPanel.init(),this.isFooterPanelEnabled()&&this.footerPanel.init()},t.prototype.checkForSearchParam=function(){if(this.isDeepLinkingEnabled()){var e=this.getParam(C.Params.highlight);e&&(e.replace(/\+/g," ").replace(/"/g,""),$.publish(s.Commands.SEARCH,[e]))}},t.prototype.checkForRotationParam=function(){if(this.isDeepLinkingEnabled()){var e=Number(this.getParam(C.Params.rotation));e&&$.publish(s.Commands.SEADRAGON_ROTATION,[e])}},t.prototype.viewPage=function(e,t){if(-1!==e){if(this.helper.isCanvasIndexOutOfRange(e)&&(this.showMessage(this.config.content.canvasIndexOutOfRange),e=0),this.isPagingSettingEnabled()&&!t){var n=this.getPagedIndices(e);if(n.contains(this.helper.canvasIndex))return void this.viewCanvas(e)}this.viewCanvas(e)}},t.prototype.getViewer=function(){return this.centerPanel.viewer},t.prototype.getMode=function(){if(this.mode)return this.mode;switch(this.helper.getManifestType().toString()){case manifesto.ManifestType.monograph().toString():return m.Mode.page;case manifesto.ManifestType.manuscript().toString():return m.Mode.page;default:return m.Mode.image}},t.prototype.getViewportBounds=function(){if(!this.centerPanel)return null;var e=this.centerPanel.getViewportBounds();return e?e.toString():null},t.prototype.getViewerRotation=function(){return this.centerPanel?this.currentRotation:null},t.prototype.viewRange=function(e){var t=this.helper.getRangeByPath(e);if(t){var n=t.getCanvasIds()[0],i=this.helper.getCanvasIndexById(n);this.viewPage(i)}},t.prototype.viewLabel=function(e){if(!e)return this.showMessage(this.config.modules.genericDialogue.content.emptyValue),void $.publish(n.BaseCommands.CANVAS_INDEX_CHANGE_FAILED);var t=this.helper.getCanvasIndexByLabel(e);-1!=t?this.viewPage(t):(this.showMessage(this.config.modules.genericDialogue.content.pageNotFound),$.publish(n.BaseCommands.CANVAS_INDEX_CHANGE_FAILED))},t.prototype.treeNodeSelected=function(e){var t=e.data;if(t.type)switch(t.type){case manifesto.IIIFResourceType.manifest().toString():this.viewManifest(t);break;case manifesto.IIIFResourceType.collection().toString():this.viewCollection(t);break;default:this.viewRange(t.path)}},t.prototype.clearSearch=function(){this.searchResults=[],this.viewPage(this.helper.canvasIndex)},t.prototype.prevSearchResult=function(){for(var e,t=this.searchResults.length-1;t>=0;t--){var n=this.searchResults[t];if(n.canvasIndex<=this.getPrevPageIndex()){e=n,this.viewPage(e.canvasIndex);break}}},t.prototype.nextSearchResult=function(){for(var e,t=0;t<this.searchResults.length;t++){var n=this.searchResults[t];if(n.canvasIndex>=this.getNextPageIndex()){e=n,this.viewPage(n.canvasIndex);break}}},t.prototype.bookmark=function(){e.prototype.bookmark.call(this);var t=this.helper.getCurrentCanvas(),i=new o.Bookmark;i.index=this.helper.canvasIndex,i.label=Manifesto.TranslationCollection.getValue(t.getLabel()),i.path=this.getCroppedImageUri(t,this.getViewer()),i.thumb=t.getCanonicalImageUri(this.config.options.bookmarkThumbWidth),i.title=this.helper.getLabel(),i.trackingLabel=window.trackingLabel,i.type=manifesto.ElementType.image().toString(),this.triggerSocket(n.BaseCommands.BOOKMARK,i)},t.prototype.print=function(){window.print(),this.triggerSocket(s.Commands.PRINT)},t.prototype.getCroppedImageDimensions=function(e,t){if(!t)return null;if(!t.viewport)return null;if(!e.getHeight()||!e.getWidth())return null;var n=t.viewport.getBounds(!0),i=new r.CroppedImageDimensions,o=Math.floor(n.width),s=Math.floor(n.height),a=Math.floor(n.x),l=Math.floor(n.y);a+o>e.getWidth()?o=e.getWidth()-a:0>a&&(o+=a,a=0),l+s>e.getHeight()?s=e.getHeight()-l:0>l&&(s+=l,l=0),o=Math.min(o,e.getWidth()),s=Math.min(s,e.getHeight());var h=o,c=s;if(e.externalResource.data&&e.externalResource.data.profile&&e.externalResource.data.profile[1]){var u=new I(e.externalResource.data.profile[1].maxWidth,e.externalResource.data.profile[1].maxHeight);if(!_.isUndefined(u.width)&&!_.isUndefined(u.height)){if(o>u.width){var p=u.width;s=Math.round(p*(s/o)),o=p}if(s>u.height){var d=u.height;o=Math.round(o/s*d),s=d}}}return i.region=new I(h,c),i.regionPos=new y.Point(a,l),i.size=new I(o,s),i},t.prototype.getCroppedImageUri=function(e,t){if(!t)return null;if(!t.viewport)return null;var n=this.getCroppedImageDimensions(e,t),i=this.getImageBaseUri(e),o=this.getImageId(e),s=n.regionPos.x+","+n.regionPos.y+","+n.region.width+","+n.region.height,a=n.size.width+","+n.size.height,r=this.getViewerRotation(),l="default";return i+"/"+o+"/"+s+"/"+a+"/"+r+"/"+l+".jpg"},t.prototype.getConfinedImageDimensions=function(e,t){var n=new I(0,0);n.width=t;var i=Math.normalise(t,0,e.getWidth());return n.height=Math.floor(e.getHeight()*i),n},t.prototype.getConfinedImageUri=function(e,t){var n=this.getImageBaseUri(e),i=this.getImageId(e),o="full",s=this.getConfinedImageDimensions(e,t),a=s.width+","+s.height,r=this.getViewerRotation(),l="default";return n+"/"+i+"/"+o+"/"+a+"/"+r+"/"+l+".jpg"},t.prototype.getImageId=function(e){var t=this.getInfoUri(e);return t=t.substr(0,t.lastIndexOf("/")),t.substr(t.lastIndexOf("/")+1)},t.prototype.getImageBaseUri=function(e){var t=this.getInfoUri(e);return t=t.substr(0,t.lastIndexOf("/")),t.substr(0,t.lastIndexOf("/"))},t.prototype.getInfoUri=function(e){var t,n=e.getImages();if(n&&n.length)for(var i=n[0],o=i.getResource(),s=o.getServices(),a=0;a<s.length;a++){var r=s[a],l=r.id;_.endsWith(l,"/")||(l+="/"),manifesto.Utils.isImageProfile(r.getProfile())&&(t=l+"info.json")}return t||(t="lib/imageunavailable.json"),t},t.prototype.getEmbedScript=function(e,t,n,i,o){var s=this.config.uri||"",a=String.format(e,this.getSerializedLocales(),s,this.helper.iiifResourceUri,this.helper.collectionIndex,this.helper.manifestIndex,this.helper.sequenceIndex,this.helper.canvasIndex,i,o,t,n,this.embedScriptUri);return a},t.prototype.getPrevPageIndex=function(e){_.isUndefined(e)&&(e=this.helper.canvasIndex);var t;if(this.isPagingSettingEnabled()){var n=this.getPagedIndices(e);t=this.helper.isRightToLeft()?n.last()-1:n[0]-1}else t=e-1;return t},t.prototype.isSearchWithinEnabled=function(){return Utils.Bools.getBool(this.config.options.searchWithinEnabled,!1)&&this.helper.getSearchWithinService()?!0:!1},t.prototype.isPagingSettingEnabled=function(){return this.helper.isPagingAvailable()?this.getSettings().pagingEnabled:!1},t.prototype.getNextPageIndex=function(e){_.isUndefined(e)&&(e=this.helper.canvasIndex);var t;if(this.isPagingSettingEnabled()){var n=this.getPagedIndices(e);t=this.helper.isRightToLeft()?n[0]+1:n.last()+1}else t=e+1;return t>this.helper.getTotalCanvases()-1?-1:t},t.prototype.getAutoCompleteService=function(){var e=this.helper.getSearchWithinService();return e?e.getService(manifesto.ServiceProfile.autoComplete()):null},t.prototype.getAutoCompleteUri=function(){var e=this.getAutoCompleteService();return e?e.id+"?q={0}":null},t.prototype.getSearchWithinServiceUri=function(){var e=this.helper.getSearchWithinService();if(!e)return null;var t=e.id;return t+="?q={0}"},t.prototype.searchWithin=function(e){var t=this;if(!this.isSearching){this.isSearching=!0,this.searchResults=[];var n=this,i=this.getSearchWithinServiceUri();i=String.format(i,e),this.getSearchResults(i,e,this.searchResults,function(i){t.isSearching=!1,i.length?(t.searchResults=i.sort(function(e,t){return e.canvasIndex-t.canvasIndex}),$.publish(s.Commands.SEARCH_RESULTS,[{terms:e,results:i}]),n.viewPage(n.helper.canvasIndex,!0)):n.showMessage(n.config.modules.genericDialogue.content.noMatches,function(){$.publish(s.Commands.SEARCH_RESULTS_EMPTY)})})}},t.prototype.getSearchResults=function(e,t,n,i){var o=this;$.getJSON(e,function(e){e.resources&&e.resources.length&&(n=n.concat(o.parseSearchJson(e,n))),e.next?o.getSearchResults(e.next,t,n,i):i(n)})},t.prototype.parseSearchJson=function(e,t){for(var n=[],i=0;i<e.resources.length;i++){var o=e.resources[i],s=this.helper.getCanvasIndexById(o.on.match(/(.*)#/)[1]),a=new D(o,s),r=n.en().where(function(e){return e.canvasIndex===a.canvasIndex}).first();r?r.addRect(o):n.push(a)}return n.sort(function(e,t){return e.canvasIndex-t.canvasIndex}),n},t.prototype.getSearchResultRects=function(){return this.searchResults.en().selectMany(function(e){return e.rects}).toArray()},t.prototype.getCurrentSearchResultRectIndex=function(){var e=this.getSearchResultRects();return e.indexOf(this.currentSearchResultRect)},t.prototype.getTotalSearchResultRects=function(){var e=this.getSearchResultRects();return e.length},t.prototype.isFirstSearchResultRect=function(){return 0===this.getCurrentSearchResultRectIndex()},t.prototype.getLastSearchResultRectIndex=function(){return this.getTotalSearchResultRects()-1},t.prototype.getPagedIndices=function(e){_.isUndefined(e)&&(e=this.helper.canvasIndex);var t=[];return this.helper.isContinuous()?t=$.map(this.helper.getCanvases(),function(e,t){return t}):this.isPagingSettingEnabled()?(t=this.helper.isFirstCanvas(e)||this.helper.isLastCanvas(e)&&this.helper.isTotalCanvasesEven()?[e]:e%2?[e,e+1]:[e-1,e],this.helper.isRightToLeft()&&(t=t.reverse())):t.push(this.helper.canvasIndex),t},t}(i.BaseExtension);t.Extension=R}),define("extensions/uv-mediaelement-extension/Commands",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}return e}();n.namespace="mediaelementExtension.",n.MEDIA_ENDED=n.namespace+"onMediaEnded",n.MEDIA_PAUSED=n.namespace+"onMediaPaused",n.MEDIA_PLAYED=n.namespace+"onMediaPlayed",t.Commands=n});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-mediaelement-extension/DownloadDialogue",["require","exports","../../modules/uv-dialogues-module/DownloadDialogue"],function(e,t,n){"use strict";var i=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("downloadDialogue"),e.prototype.create.call(this)},t.prototype.open=function(t){e.prototype.open.call(this,t),this.addEntireFileDownloadOptions(),this.updateNoneAvailable(),this.resize()},t.prototype.isDownloadOptionAvailable=function(t){return e.prototype.isDownloadOptionAvailable.call(this,t)},t}(n.DownloadDialogue);t.DownloadDialogue=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-mediaelement-extension/ShareDialogue",["require","exports","../../modules/uv-dialogues-module/ShareDialogue"],function(e,t,n){"use strict";var i=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("shareDialogue"),e.prototype.create.call(this)},t.prototype.update=function(){e.prototype.update.call(this),this.code=this.extension.getEmbedScript(this.options.embedTemplate,this.currentWidth,this.currentHeight),this.$code.val(this.code)},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(n.ShareDialogue);t.ShareDialogue=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-mediaelementcenterpanel-module/MediaElementCenterPanel",["require","exports","../uv-shared-module/BaseCommands","../../extensions/uv-mediaelement-extension/Commands","../uv-shared-module/CenterPanel"],function(e,t,n,i,o){"use strict";var s=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("mediaelementCenterPanel"),e.prototype.create.call(this);var t=this;this.extension.isVideo()&&$.subscribe(n.BaseCommands.TOGGLE_FULLSCREEN,function(e){t.bootstrapper.isFullScreen?(t.$container.css("backgroundColor","#000"),t.player.enterFullScreen(!1)):(t.$container.css("backgroundColor","transparent"),t.player.exitFullScreen(!1))}),$.subscribe(n.BaseCommands.OPEN_EXTERNAL_RESOURCE,function(e,n){t.openMedia(n)}),this.$container=$('<div class="container"></div>'),this.$content.append(this.$container),this.title=this.extension.helper.getLabel()},t.prototype.openMedia=function(e){var t=this,n=this;this.extension.getExternalResources(e).then(function(){t.$container.empty();var e=t.extension.helper.getCurrentCanvas();t.mediaHeight=t.config.defaultHeight,t.mediaWidth=t.config.defaultWidth,t.$container.height(t.mediaHeight),t.$container.width(t.mediaWidth);var o=Utils.Dates.getTimeStamp(),s=t.extension.getPosterImageUri(),a=s?' poster="'+s+'"':"",r=[];if($.each(e.getRenderings(),function(e,t){r.push({type:t.getFormat().toString(),src:t.id})}),t.extension.isVideo())t.media=t.$container.append('<video id="'+o+'" type="video/mp4" class="mejs-uv" controls="controls" preload="none"'+a+"></video>"),t.player=new MediaElementPlayer("#"+o,{type:["video/mp4","video/webm","video/flv"],plugins:["flash"],alwaysShowControls:!1,autosizeProgress:!1,success:function(e){e.addEventListener("canplay",function(e){n.resize()}),e.addEventListener("play",function(e){$.publish(i.Commands.MEDIA_PLAYED,[Math.floor(n.player.media.currentTime)])}),e.addEventListener("pause",function(e){Math.floor(n.player.media.currentTime)!=Math.floor(n.player.media.duration)&&$.publish(i.Commands.MEDIA_PAUSED,[Math.floor(n.player.media.currentTime)])}),e.addEventListener("ended",function(e){$.publish(i.Commands.MEDIA_ENDED,[Math.floor(n.player.media.duration)])}),e.setSrc(r);try{e.load()}catch(t){}}});else{var l=0;for(var h in r)if("audio/mp3"===r[h].type){l=h;break}t.media=t.$container.append('<audio id="'+o+'" type="'+r[l].type+'" src="'+r[l].src+'" class="mejs-uv" controls="controls" preload="none"'+a+"></audio>"),t.player=new MediaElementPlayer("#"+o,{plugins:["flash"],alwaysShowControls:!1,autosizeProgress:!1,defaultVideoWidth:n.mediaWidth,defaultVideoHeight:n.mediaHeight,success:function(e){e.addEventListener("canplay",function(e){n.resize()}),e.addEventListener("play",function(e){$.publish(i.Commands.MEDIA_PLAYED,[Math.floor(n.player.media.currentTime)])}),e.addEventListener("pause",function(e){Math.floor(n.player.media.currentTime)!=Math.floor(n.player.media.duration)&&$.publish(i.Commands.MEDIA_PAUSED,[Math.floor(n.player.media.currentTime)])}),e.addEventListener("ended",function(e){$.publish(i.Commands.MEDIA_ENDED,[Math.floor(n.player.media.duration)])});try{e.load()}catch(t){}}})}t.resize()})},t.prototype.resize=function(){if(e.prototype.resize.call(this),"Firefox"===window.browserDetect.browser&&window.browserDetect.version<13)this.$container.width(this.mediaWidth),this.$container.height(this.mediaHeight);else{var t=Utils.Measurements.Dimensions.fitRect(this.mediaWidth,this.mediaHeight,this.$content.width(),this.$content.height());this.$container.height(t.height),this.$container.width(t.width)}this.player&&!this.extension.isFullScreen()&&this.player.resize();var n=Math.floor((this.$content.width()-this.$container.width())/2),i=Math.floor((this.$content.height()-this.$container.height())/2);this.$container.css({left:n,top:i}),this.$title.ellipsisFill(this.title)},t}(o.CenterPanel);t.MediaElementCenterPanel=s});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-resourcesleftpanel-module/ThumbsView",["require","exports","../uv-shared-module/ThumbsView"],function(e,t,n){"use strict";var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("resourcesLeftPanel"),e.prototype.create.call(this)},t}(n.ThumbsView);t.ThumbsView=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-resourcesleftpanel-module/ResourcesLeftPanel",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/LeftPanel","./ThumbsView"],function(e,t,n,i,o){"use strict";var s=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("resourcesLeftPanel"),e.prototype.create.call(this),this.setTitle(this.content.title),this.$tabsContent=$('<div class="tabsContent"></div>'),this.$main.append(this.$tabsContent),this.$views=$('<div class="views"></div>'),this.$tabsContent.append(this.$views),this.$thumbsView=$('<div class="thumbsView"></div>'),this.$views.append(this.$thumbsView),this.$resourcesView=$('<div class="resourcesView"></div>'),this.$resources=$("<ul></ul>"),this.$resourcesView.append(this.$resources),this.$views.append(this.$resourcesView),this.thumbsView=new o.ThumbsView(this.$thumbsView),this.dataBind()},t.prototype.dataBind=function(){this.dataBindThumbsView();var e=this.extension.helper.getResources();0===e.length&&this.$resourcesView.hide();for(var t=0;t<e.length;t++){var n=e[t],i=n.getResource(),o=$('<li><a href="'+i.id+'" target="_blank">'+Manifesto.TranslationCollection.getValue(i.getLabel())+" ("+Utils.Files.simplifyMimeType(i.getFormat().toString())+")</li>");this.$resources.append(o)}},t.prototype.dataBindThumbsView=function(){if(this.thumbsView){var e,t,n=this.extension.helper.getViewingDirection().toString();n===manifesto.ViewingDirection.topToBottom().toString()||n===manifesto.ViewingDirection.bottomToTop().toString()?(e=this.config.options.oneColThumbWidth,t=this.config.options.oneColThumbHeight):(e=this.config.options.twoColThumbWidth,t=this.config.options.twoColThumbHeight),"undefined"==typeof e&&(e=100),"undefined"==typeof t&&(t=100),this.thumbsView.thumbs=this.extension.helper.getThumbs(e,t),this.thumbsView.thumbs.length<2&&this.$thumbsView.hide(),this.thumbsView.databind()}},t.prototype.expandFullStart=function(){e.prototype.expandFullStart.call(this),$.publish(n.BaseCommands.LEFTPANEL_EXPAND_FULL_START)},t.prototype.expandFullFinish=function(){e.prototype.expandFullFinish.call(this),$.publish(n.BaseCommands.LEFTPANEL_EXPAND_FULL_FINISH)},t.prototype.collapseFullStart=function(){e.prototype.collapseFullStart.call(this),$.publish(n.BaseCommands.LEFTPANEL_COLLAPSE_FULL_START)},t.prototype.collapseFullFinish=function(){e.prototype.collapseFullFinish.call(this),$.publish(n.BaseCommands.LEFTPANEL_COLLAPSE_FULL_FINISH)},t.prototype.resize=function(){e.prototype.resize.call(this),this.$views.height(this.$main.height()),this.$resources.height(this.$main.height())},t}(i.LeftPanel);t.ResourcesLeftPanel=s});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-mediaelement-extension/SettingsDialogue",["require","exports","../../modules/uv-dialogues-module/SettingsDialogue"],function(e,t,n){"use strict";var i=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("settingsDialogue"),e.prototype.create.call(this)},t}(n.SettingsDialogue);t.SettingsDialogue=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-mediaelement-extension/Extension",["require","exports","../../modules/uv-shared-module/BaseCommands","../../modules/uv-shared-module/BaseExtension","../../modules/uv-shared-module/Bookmark","./Commands","./DownloadDialogue","./ShareDialogue","../../modules/uv-shared-module/FooterPanel","../../modules/uv-shared-module/HeaderPanel","../../modules/uv-dialogues-module/HelpDialogue","../../modules/uv-mediaelementcenterpanel-module/MediaElementCenterPanel","../../modules/uv-moreinforightpanel-module/MoreInfoRightPanel","../../modules/uv-resourcesleftpanel-module/ResourcesLeftPanel","./SettingsDialogue","../../modules/uv-shared-module/Shell"],function(e,t,n,i,o,s,a,r,l,h,c,u,p,d,m,g){"use strict";var f=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;e.prototype.create.call(this),$(window).bind("enterfullscreen",function(){$.publish(n.BaseCommands.TOGGLE_FULLSCREEN)}),$(window).bind("exitfullscreen",function(){$.publish(n.BaseCommands.TOGGLE_FULLSCREEN)}),$.subscribe(n.BaseCommands.THUMB_SELECTED,function(e,n){t.viewCanvas(n)}),$.subscribe(n.BaseCommands.LEFTPANEL_EXPAND_FULL_START,function(e){g.Shell.$centerPanel.hide(),g.Shell.$rightPanel.hide()}),$.subscribe(n.BaseCommands.LEFTPANEL_COLLAPSE_FULL_FINISH,function(e){g.Shell.$centerPanel.show(),g.Shell.$rightPanel.show(),t.resize()}),$.subscribe(s.Commands.MEDIA_ENDED,function(e){t.triggerSocket(s.Commands.MEDIA_ENDED)}),$.subscribe(s.Commands.MEDIA_PAUSED,function(e){t.triggerSocket(s.Commands.MEDIA_PAUSED)}),$.subscribe(s.Commands.MEDIA_PLAYED,function(e){t.triggerSocket(s.Commands.MEDIA_PLAYED)})},t.prototype.createModules=function(){e.prototype.createModules.call(this),this.isHeaderPanelEnabled()?this.headerPanel=new h.HeaderPanel(g.Shell.$headerPanel):g.Shell.$headerPanel.hide(),this.isLeftPanelEnabled()&&(this.leftPanel=new d.ResourcesLeftPanel(g.Shell.$leftPanel)),this.centerPanel=new u.MediaElementCenterPanel(g.Shell.$centerPanel),this.isRightPanelEnabled()&&(this.rightPanel=new p.MoreInfoRightPanel(g.Shell.$rightPanel)),this.isFooterPanelEnabled()?this.footerPanel=new l.FooterPanel(g.Shell.$footerPanel):g.Shell.$footerPanel.hide(),this.$helpDialogue=$('<div class="overlay help"></div>'),g.Shell.$overlays.append(this.$helpDialogue),this.helpDialogue=new c.HelpDialogue(this.$helpDialogue),this.$downloadDialogue=$('<div class="overlay download"></div>'),g.Shell.$overlays.append(this.$downloadDialogue),this.downloadDialogue=new a.DownloadDialogue(this.$downloadDialogue),this.$shareDialogue=$('<div class="overlay share"></div>'),g.Shell.$overlays.append(this.$shareDialogue),this.shareDialogue=new r.ShareDialogue(this.$shareDialogue),this.$settingsDialogue=$('<div class="overlay settings"></div>'),g.Shell.$overlays.append(this.$settingsDialogue),this.settingsDialogue=new m.SettingsDialogue(this.$settingsDialogue),this.isLeftPanelEnabled()&&this.leftPanel.init(),this.isRightPanelEnabled()&&this.rightPanel.init()},t.prototype.isLeftPanelEnabled=function(){return Utils.Bools.getBool(this.config.options.leftPanelEnabled,!0)&&(this.helper.isMultiCanvas()||this.helper.isMultiSequence()||this.helper.hasResources())},t.prototype.bookmark=function(){e.prototype.bookmark.call(this);var t=this.extensions.helper.getCurrentCanvas(),i=new o.Bookmark;i.index=this.helper.canvasIndex,i.label=Manifesto.TranslationCollection.getValue(t.getLabel()),i.path=this.getBookmarkUri(),i.thumb=t.getProperty("thumbnail"),i.title=this.helper.getLabel(),i.trackingLabel=window.trackingLabel,this.isVideo()?i.type=manifesto.ElementType.movingimage().toString():i.type=manifesto.ElementType.sound().toString(),this.triggerSocket(n.BaseCommands.BOOKMARK,i)},t.prototype.getEmbedScript=function(e,t,n){var i=this.config.uri||"",o=String.format(e,this.getSerializedLocales(),i,this.helper.iiifResourceUri,this.helper.collectionIndex,this.helper.manifestIndex,this.helper.sequenceIndex,this.helper.canvasIndex,t,n,this.embedScriptUri);return o},t.prototype.getPosterImageUri=function(){return this.helper.getCurrentCanvas().getProperty("thumbnail")},t.prototype.isVideo=function(){var e=this.helper.getElementType();return e.toString()===manifesto.ElementType.movingimage().toString()},t}(i.BaseExtension);t.Extension=f});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-pdf-extension/DownloadDialogue",["require","exports","../../modules/uv-dialogues-module/DownloadDialogue"],function(e,t,n){"use strict";var i=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("downloadDialogue"),e.prototype.create.call(this)},t.prototype.open=function(t){e.prototype.open.call(this,t),this.addEntireFileDownloadOptions(),this.$downloadOptions.find("li:visible").length?this.$noneAvailable.hide():this.$noneAvailable.show(),this.resize()},t.prototype.isDownloadOptionAvailable=function(t){return e.prototype.isDownloadOptionAvailable.call(this,t)},t}(n.DownloadDialogue);t.DownloadDialogue=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-pdf-extension/ShareDialogue",["require","exports","../../modules/uv-dialogues-module/ShareDialogue"],function(e,t,n){"use strict";var i=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("shareDialogue"),e.prototype.create.call(this)},t.prototype.update=function(){e.prototype.update.call(this),this.code=this.extension.getEmbedScript(this.options.embedTemplate,this.currentWidth,this.currentHeight),this.$code.val(this.code)},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(n.ShareDialogue);t.ShareDialogue=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-pdfcenterpanel-module/PDFCenterPanel",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/CenterPanel","../../Params"],function(e,t,n,i,o){
"use strict";var s=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("pdfCenterPanel"),e.prototype.create.call(this),$.subscribe(n.BaseCommands.OPEN_EXTERNAL_RESOURCE,function(e,n){t.openMedia(n)})},t.prototype.openMedia=function(e){var t=this,n=this;this.extension.getExternalResources(e).then(function(){var e=t.extension.helper.getCurrentCanvas(),i=e.id,s=window.browserDetect.browser,a=window.browserDetect.version;if("Explorer"===s&&10>a||!t.config.options.usePdfJs)new PDFObject({url:i,id:"PDF"}).embed("content");else{var r="html/uv-pdfcenterpanel-module/viewer.html";t.$content.load(r,function(){PDFJS.workerSrc="lib/pdf.worker.min.js",PDFJS.DEFAULT_URL=i;var e=1+parseInt(n.extension.getParam(o.Params.anchor))||0;PDFView.initialBookmark="page="+e,window.webViewerLoad(),t.resize()})}})},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(i.CenterPanel);t.PDFCenterPanel=s});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-pdf-extension/SettingsDialogue",["require","exports","../../modules/uv-dialogues-module/SettingsDialogue"],function(e,t,n){"use strict";var i=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("settingsDialogue"),e.prototype.create.call(this)},t}(n.SettingsDialogue);t.SettingsDialogue=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-pdf-extension/Extension",["require","exports","../../modules/uv-shared-module/BaseCommands","../../modules/uv-shared-module/BaseExtension","../../modules/uv-shared-module/Bookmark","./DownloadDialogue","./ShareDialogue","../../modules/uv-shared-module/FooterPanel","../../modules/uv-shared-module/HeaderPanel","../../modules/uv-moreinforightpanel-module/MoreInfoRightPanel","../../modules/uv-pdfcenterpanel-module/PDFCenterPanel","../../modules/uv-resourcesleftpanel-module/ResourcesLeftPanel","./SettingsDialogue","../../modules/uv-shared-module/Shell"],function(e,t,n,i,o,s,a,r,l,h,c,u,p,d){"use strict";var m=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;e.prototype.create.call(this),$.subscribe(n.BaseCommands.THUMB_SELECTED,function(e,n){t.viewCanvas(n.index)}),$.subscribe(n.BaseCommands.LEFTPANEL_EXPAND_FULL_START,function(e){d.Shell.$centerPanel.hide(),d.Shell.$rightPanel.hide()}),$.subscribe(n.BaseCommands.LEFTPANEL_COLLAPSE_FULL_FINISH,function(e){d.Shell.$centerPanel.show(),d.Shell.$rightPanel.show(),t.resize()}),$.subscribe(n.BaseCommands.SHOW_OVERLAY,function(e,n){t.IsOldIE()&&t.centerPanel.$element.hide()}),$.subscribe(n.BaseCommands.HIDE_OVERLAY,function(e,n){t.IsOldIE()&&t.centerPanel.$element.show()})},t.prototype.IsOldIE=function(){var e=window.browserDetect.browser,t=window.browserDetect.version;return"Explorer"===e&&9>=t?!0:!1},t.prototype.createModules=function(){e.prototype.createModules.call(this),this.isHeaderPanelEnabled()?this.headerPanel=new l.HeaderPanel(d.Shell.$headerPanel):d.Shell.$headerPanel.hide(),this.isLeftPanelEnabled()&&(this.leftPanel=new u.ResourcesLeftPanel(d.Shell.$leftPanel)),this.centerPanel=new c.PDFCenterPanel(d.Shell.$centerPanel),this.isRightPanelEnabled()&&(this.rightPanel=new h.MoreInfoRightPanel(d.Shell.$rightPanel)),this.isFooterPanelEnabled()?this.footerPanel=new r.FooterPanel(d.Shell.$footerPanel):d.Shell.$footerPanel.hide(),this.$downloadDialogue=$('<div class="overlay download"></div>'),d.Shell.$overlays.append(this.$downloadDialogue),this.downloadDialogue=new s.DownloadDialogue(this.$downloadDialogue),this.$shareDialogue=$('<div class="overlay share"></div>'),d.Shell.$overlays.append(this.$shareDialogue),this.shareDialogue=new a.ShareDialogue(this.$shareDialogue),this.$settingsDialogue=$('<div class="overlay settings"></div>'),d.Shell.$overlays.append(this.$settingsDialogue),this.settingsDialogue=new p.SettingsDialogue(this.$settingsDialogue),this.isLeftPanelEnabled()&&this.leftPanel.init(),this.isRightPanelEnabled()&&this.rightPanel.init()},t.prototype.bookmark=function(){e.prototype.bookmark.call(this);var t=this.helper.getCurrentCanvas(),i=new o.Bookmark;i.index=this.helper.canvasIndex,i.label=Manifesto.TranslationCollection.getValue(t.getLabel()),i.path=this.getBookmarkUri(),i.thumb=t.getProperty("thumbnail"),i.title=this.helper.getLabel(),i.trackingLabel=window.trackingLabel,i.type=manifesto.ElementType.document().toString(),this.triggerSocket(n.BaseCommands.BOOKMARK,i)},t.prototype.getEmbedScript=function(e,t,n){var i=this.config.uri||"",o=String.format(e,this.getSerializedLocales(),i,this.helper.iiifResourceUri,this.helper.collectionIndex,this.helper.manifestIndex,this.helper.sequenceIndex,this.helper.canvasIndex,t,n,this.embedScriptUri);return o},t}(i.BaseExtension);t.Extension=m});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-virtex-extension/DownloadDialogue",["require","exports","../../modules/uv-dialogues-module/DownloadDialogue"],function(e,t,n){"use strict";var i=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("downloadDialogue"),e.prototype.create.call(this)},t.prototype.open=function(t){e.prototype.open.call(this,t),this.addEntireFileDownloadOptions(),this.updateNoneAvailable(),this.resize()},t.prototype.isDownloadOptionAvailable=function(t){return e.prototype.isDownloadOptionAvailable.call(this,t)},t}(n.DownloadDialogue);t.DownloadDialogue=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-virtex-extension/ShareDialogue",["require","exports","../../modules/uv-dialogues-module/ShareDialogue"],function(e,t,n){"use strict";var i=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("shareDialogue"),e.prototype.create.call(this)},t.prototype.update=function(){e.prototype.update.call(this),this.code=this.extension.getEmbedScript(this.options.embedTemplate,this.currentWidth,this.currentHeight),this.$code.val(this.code)},t.prototype.resize=function(){e.prototype.resize.call(this)},t}(n.ShareDialogue);t.ShareDialogue=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-virtex-extension/SettingsDialogue",["require","exports","../../modules/uv-dialogues-module/SettingsDialogue"],function(e,t,n){"use strict";var i=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){this.setConfig("settingsDialogue"),e.prototype.create.call(this)},t}(n.SettingsDialogue);t.SettingsDialogue=i});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("modules/uv-virtexcenterpanel-module/VirtexCenterPanel",["require","exports","../uv-shared-module/BaseCommands","../uv-shared-module/CenterPanel"],function(e,t,n,i){"use strict";var o=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;this.setConfig("virtexCenterPanel"),e.prototype.create.call(this);var i=this;$.subscribe(n.BaseCommands.OPEN_EXTERNAL_RESOURCE,function(e,t){i.openMedia(t)}),this.$navigation=$('<div class="navigation"></div>'),this.$content.prepend(this.$navigation),this.$zoomInButton=$('<a class="imageBtn zoomIn" title="'+this.content.zoomIn+'"></a>'),this.$navigation.append(this.$zoomInButton),this.$zoomOutButton=$('<a class="imageBtn zoomOut" title="'+this.content.zoomOut+'"></a>'),this.$navigation.append(this.$zoomOutButton),this.$viewport=$('<div class="virtex"></div>'),this.$content.prepend(this.$viewport),this.title=this.extension.helper.getLabel(),this.updateAttribution(),this.$zoomInButton.on("click",function(e){e.preventDefault(),t.viewport.zoomIn()}),this.$zoomOutButton.on("click",function(e){e.preventDefault(),t.viewport.zoomOut()})},t.prototype.openMedia=function(e){var t=this;this.extension.getExternalResources(e).then(function(){t.$viewport.empty();var e=t.extension.helper.getCurrentCanvas();t.viewport=virtex.create({element:"#content .virtex",object:e.id,showStats:t.options.showStats}),t.resize()})},t.prototype.resize=function(){e.prototype.resize.call(this),this.$title.ellipsisFill(this.title),this.$viewport.width(this.$content.width()),this.$viewport.height(this.$content.height())},t}(i.CenterPanel);t.VirtexCenterPanel=o});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("extensions/uv-virtex-extension/Extension",["require","exports","../../modules/uv-shared-module/BaseCommands","../../modules/uv-shared-module/BaseExtension","../../modules/uv-shared-module/Bookmark","../../modules/uv-contentleftpanel-module/ContentLeftPanel","./DownloadDialogue","./ShareDialogue","../../modules/uv-shared-module/FooterPanel","../../modules/uv-shared-module/HeaderPanel","../../modules/uv-moreinforightpanel-module/MoreInfoRightPanel","./SettingsDialogue","../../modules/uv-shared-module/Shell","../../modules/uv-virtexcenterpanel-module/VirtexCenterPanel"],function(e,t,n,i,o,s,a,r,l,h,c,u,p,d){"use strict";var m=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.create=function(){var t=this;e.prototype.create.call(this),$.subscribe(n.BaseCommands.THUMB_SELECTED,function(e,n){t.viewCanvas(n)})},t.prototype.createModules=function(){e.prototype.createModules.call(this),this.isHeaderPanelEnabled()?this.headerPanel=new h.HeaderPanel(p.Shell.$headerPanel):p.Shell.$headerPanel.hide(),this.isLeftPanelEnabled()&&(this.leftPanel=new s.ContentLeftPanel(p.Shell.$leftPanel)),this.centerPanel=new d.VirtexCenterPanel(p.Shell.$centerPanel),this.isRightPanelEnabled()&&(this.rightPanel=new c.MoreInfoRightPanel(p.Shell.$rightPanel)),this.isFooterPanelEnabled()?this.footerPanel=new l.FooterPanel(p.Shell.$footerPanel):p.Shell.$footerPanel.hide(),this.$downloadDialogue=$('<div class="overlay download"></div>'),p.Shell.$overlays.append(this.$downloadDialogue),this.downloadDialogue=new a.DownloadDialogue(this.$downloadDialogue),this.$shareDialogue=$('<div class="overlay share"></div>'),p.Shell.$overlays.append(this.$shareDialogue),this.shareDialogue=new r.ShareDialogue(this.$shareDialogue),this.$settingsDialogue=$('<div class="overlay settings"></div>'),p.Shell.$overlays.append(this.$settingsDialogue),this.settingsDialogue=new u.SettingsDialogue(this.$settingsDialogue),this.isLeftPanelEnabled()?this.leftPanel.init():p.Shell.$leftPanel.hide(),this.isRightPanelEnabled()?this.rightPanel.init():p.Shell.$rightPanel.hide()},t.prototype.isLeftPanelEnabled=function(){return Utils.Bools.getBool(this.config.options.leftPanelEnabled,!0)&&(this.helper.isMultiCanvas()||this.helper.isMultiSequence())},t.prototype.bookmark=function(){e.prototype.bookmark.call(this);var t=this.helper.getCurrentCanvas(),i=new o.Bookmark;i.index=this.helper.canvasIndex,i.label=Manifesto.TranslationCollection.getValue(t.getLabel()),i.path=this.getBookmarkUri(),i.thumb=t.getProperty("thumbnail"),i.title=this.helper.getLabel(),i.trackingLabel=window.trackingLabel,i.type=manifesto.ElementType.physicalobject().toString(),this.triggerSocket(n.BaseCommands.BOOKMARK,i)},t.prototype.getEmbedScript=function(e,t,n){var i=this.config.uri||"",o=String.format(e,this.getSerializedLocales(),i,this.helper.iiifResourceUri,this.helper.collectionIndex,this.helper.manifestIndex,this.helper.sequenceIndex,this.helper.canvasIndex,t,n,this.embedScriptUri);return o},t}(i.BaseExtension);t.Extension=m});var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();define("UV",["require","exports","./Bootstrapper","./extensions/uv-seadragon-extension/Extension","./extensions/uv-mediaelement-extension/Extension","./extensions/uv-pdf-extension/Extension","./extensions/uv-virtex-extension/Extension"],function(e,t,n,i,o,s,a){"use strict";var r=function(e){function t(t){var n=e.call(this,t)||this;return n._init(),n._resize(),n}return __extends(t,e),t.prototype.message=function(){},t.prototype._init=function(){var t=e.prototype._init.call(this);t||console.error("UV failed to initialise");var r={};r[manifesto.ElementType.canvas().toString()]={type:i.Extension,name:"uv-seadragon-extension"},r[manifesto.ElementType.movingimage().toString()]={type:o.Extension,name:"uv-mediaelement-extension"},r[manifesto.ElementType.physicalobject().toString()]={type:a.Extension,name:"uv-virtex-extension"},r[manifesto.ElementType.sound().toString()]={type:o.Extension,name:"uv-mediaelement-extension"},r[manifesto.RenderingFormat.pdf().toString()]={type:s.Extension,name:"uv-pdf-extension"};var l=new n.Bootstrapper(r);return l.bootstrap(),t},t.prototype.data=function(){return{}},t.prototype._resize=function(){},t}(_Components.BaseComponent);t.__esModule=!0,t["default"]=r}),"function"==typeof jQuery&&define("jquery",[],function(){return jQuery});var uvReady=new Event("uvReady");require(["UV"],function(e){window.UV||(window.UV=e["default"],window.dispatchEvent(uvReady))}),define("app",function(){});
//# sourceMappingURL=app.js.map