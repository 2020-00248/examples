var __extends=this&&this.__extends||function(){var t=function(e,i){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return t(e,i)};return function(e,i){t(e,i);function r(){this.constructor=e}e.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();var __awaiter=this&&this.__awaiter||function(t,e,i,r){function n(t){return t instanceof i?t:new i((function(e){e(t)}))}return new(i||(i=Promise))((function(i,s){function o(t){try{h(r.next(t))}catch(e){s(e)}}function a(t){try{h(r["throw"](t))}catch(e){s(e)}}function h(t){t.done?i(t.value):n(t.value).then(o,a)}h((r=r.apply(t,e||[])).next())}))};var __generator=this&&this.__generator||function(t,e){var i={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return h([t,e])}}function h(o){if(r)throw new TypeError("Generator is already executing.");while(i)try{if(r=1,n&&(s=o[0]&2?n["return"]:o[0]?n["throw"]||((s=n["return"])&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;if(n=0,s)o=[o[0]&2,s.value];switch(o[0]){case 0:case 1:s=o;break;case 4:i.label++;return{value:o[1],done:false};case 5:i.label++;n=o[1];o=[0];continue;case 7:o=i.ops.pop();i.trys.pop();continue;default:if(!(s=i.trys,s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){i=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){i.label=o[1];break}if(o[0]===6&&i.label<s[1]){i.label=s[1];s=o;break}if(s&&i.label<s[2]){i.label=s[2];i.ops.push(o);break}if(s[2])i.ops.pop();i.trys.pop();continue}o=e.call(t,i)}catch(a){o=[6,a];n=0}finally{r=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};System.register(["./p-eee1b808.system.js"],(function(t){"use strict";var e,i,r,n;return{setters:[function(t){e=t.r;i=t.c;r=t.h;n=t.g}],execute:function(){var s=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function o(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t["default"]:t}function a(t,e){return e={exports:{}},t(e,e.exports),e.exports}var h=void 0;var f=function(t){return t!==h&&t!==null};var l={object:true,function:true,undefined:true};var u=function(t){if(!f(t))return false;return hasOwnProperty.call(l,typeof t)};var c=function(t){if(!u(t))return false;try{if(!t.constructor)return false;return t.constructor.prototype===t}catch(e){return false}};var d=function(t){if(typeof t!=="function")return false;if(!hasOwnProperty.call(t,"length"))return false;try{if(typeof t.length!=="number")return false;if(typeof t.call!=="function")return false;if(typeof t.apply!=="function")return false}catch(e){return false}return!c(t)};var p=/^\s*class[\s{/}]/,v=Function.prototype.toString;var g=function(t){if(!d(t))return false;if(p.test(v.call(t)))return false;return true};var m=function(){var t=Object.assign,e;if(typeof t!=="function")return false;e={foo:"raz"};t(e,{bar:"dwa"},{trzy:"trzy"});return e.foo+e.bar+e.trzy==="razdwatrzy"};var y=function(){try{return true}catch(t){return false}};var w=function(){};var b=w();var _=function(t){return t!==b&&t!==null};var x=Object.keys;var k=function(t){return x(_(t)?Object(t):t)};var E=y()?Object.keys:k;var S=function(t){if(!_(t))throw new TypeError("Cannot use null or undefined");return t};var C=Math.max;var R=function(t,e){var i,r,n=C(arguments.length,2),s;t=Object(S(t));s=function(r){try{t[r]=e[r]}catch(n){if(!i)i=n}};for(r=1;r<n;++r){e=arguments[r];E(e).forEach(s)}if(i!==undefined)throw i;return t};var T=m()?Object.assign:R;var A=Array.prototype.forEach,O=Object.create;var L=function(t,e){var i;for(i in t)e[i]=t[i]};var I=function(t){var e=O(null);A.call(arguments,(function(t){if(!_(t))return;L(Object(t),e)}));return e};var z="razdwatrzy";var P=function(){if(typeof z.contains!=="function")return false;return z.contains("dwa")===true&&z.contains("foo")===false};var N=String.prototype.indexOf;var B=function(t){return N.call(this,t,arguments[1])>-1};var D=P()?String.prototype.contains:B;var j=a((function(t){var e=t.exports=function(t,e){var i,r,n,s,o;if(arguments.length<2||typeof t!=="string"){s=e;e=t;t=null}else{s=arguments[2]}if(f(t)){i=D.call(t,"c");r=D.call(t,"e");n=D.call(t,"w")}else{i=n=true;r=false}o={value:e,configurable:i,enumerable:r,writable:n};return!s?o:T(I(s),o)};e.gs=function(t,e,i){var r,n,s,o;if(typeof t!=="string"){s=i;i=e;e=t;t=null}else{s=arguments[3]}if(!f(e)){e=undefined}else if(!g(e)){s=e;e=i=undefined}else if(!f(i)){i=undefined}else if(!g(i)){s=i;i=undefined}if(f(t)){r=D.call(t,"c");n=D.call(t,"e")}else{r=true;n=false}o={get:e,set:i,configurable:r,enumerable:n};return!s?o:T(I(s),o)}}));var U=function(t){if(typeof t!=="function")throw new TypeError(t+" is not a function");return t};var M=a((function(t,e){var i=Function.prototype.apply,r=Function.prototype.call,n=Object.create,s=Object.defineProperty,o=Object.defineProperties,a=Object.prototype.hasOwnProperty,h={configurable:true,enumerable:false,writable:true},f,l,u,c,d,p,v;f=function(t,e){var i;U(e);if(!a.call(this,"__ee__")){i=h.value=n(null);s(this,"__ee__",h);h.value=null}else{i=this.__ee__}if(!i[t])i[t]=e;else if(typeof i[t]==="object")i[t].push(e);else i[t]=[i[t],e];return this};l=function(t,e){var r,n;U(e);n=this;f.call(this,t,r=function(){u.call(n,t,r);i.call(e,this,arguments)});r.__eeOnceListener__=e;return this};u=function(t,e){var i,r,n,s;U(e);if(!a.call(this,"__ee__"))return this;i=this.__ee__;if(!i[t])return this;r=i[t];if(typeof r==="object"){for(s=0;n=r[s];++s){if(n===e||n.__eeOnceListener__===e){if(r.length===2)i[t]=r[s?0:1];else r.splice(s,1)}}}else{if(r===e||r.__eeOnceListener__===e){delete i[t]}}return this};c=function(t){var e,n,s,o,h;if(!a.call(this,"__ee__"))return;o=this.__ee__[t];if(!o)return;if(typeof o==="object"){n=arguments.length;h=new Array(n-1);for(e=1;e<n;++e)h[e-1]=arguments[e];o=o.slice();for(e=0;s=o[e];++e){i.call(s,this,h)}}else{switch(arguments.length){case 1:r.call(o,this);break;case 2:r.call(o,this,arguments[1]);break;case 3:r.call(o,this,arguments[1],arguments[2]);break;default:n=arguments.length;h=new Array(n-1);for(e=1;e<n;++e){h[e-1]=arguments[e]}i.call(o,this,h)}}};d={on:f,once:l,off:u,emit:c};p={on:j(f),once:j(l),off:j(u),emit:j(c)};v=o({},p);t.exports=e=function(t){return t==null?n(v):o(Object(t),p)};e.methods=d}));var F=typeof window!="undefined"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:false;var q=1;var W=3;var H=typeof URL!="undefined"?URL:typeof window!="undefined"?window.URL||window.webkitURL||window.mozURL:undefined;function Y(){var t=(new Date).getTime();var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var i=(t+Math.random()*16)%16|0;t=Math.floor(t/16);return(e=="x"?i:i&7|8).toString(16)}));return e}function Z(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function V(t){return!!(t&&t.nodeType==1)}function X(t){return!isNaN(parseFloat(t))&&isFinite(t)}function K(t){var e=parseFloat(t);if(X(t)===false){return false}if(typeof t==="string"&&t.indexOf(".")>-1){return true}return Math.floor(e)!==e}function G(t){var e=["Webkit","webkit","Moz","O","ms"];var i=["-webkit-","-webkit-","-moz-","-o-","-ms-"];var r=t.toLowerCase();var n=e.length;if(typeof document==="undefined"||typeof document.body.style[r]!="undefined"){return t}for(var s=0;s<n;s++){if(typeof document.body.style[i[s]+r]!="undefined"){return i[s]+r}}return t}function J(t){for(var e=1,i=arguments.length;e<i;e++){var r=arguments[e];for(var n in r){if(t[n]===void 0)t[n]=r[n]}}return t}function $(t){var e=[].slice.call(arguments,1);e.forEach((function(e){if(!e)return;Object.getOwnPropertyNames(e).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}))}));return t}function Q(t,e,i){var r=tt(t,e,i);e.splice(r,0,t);return r}function tt(t,e,i,r,n){var s=r||0;var o=n||e.length;var a=parseInt(s+(o-s)/2);var h;if(!i){i=function(t,e){if(t>e)return 1;if(t<e)return-1;if(t==e)return 0}}if(o-s<=0){return a}h=i(e[a],t);if(o-s===1){return h>=0?a:a+1}if(h===0){return a}if(h===-1){return tt(t,e,i,a,o)}else{return tt(t,e,i,s,a)}}function et(t,e,i,r,n){var s=r||0;var o=n||e.length;var a=parseInt(s+(o-s)/2);var h;if(!i){i=function(t,e){if(t>e)return 1;if(t<e)return-1;if(t==e)return 0}}if(o-s<=0){return-1}h=i(e[a],t);if(o-s===1){return h===0?a:-1}if(h===0){return a}if(h===-1){return et(t,e,i,a,o)}else{return et(t,e,i,s,a)}}function it(t){var e=window.getComputedStyle(t);var i=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"];var r=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"];var n=0;var s=0;i.forEach((function(t){n+=parseFloat(e[t])||0}));r.forEach((function(t){s+=parseFloat(e[t])||0}));return{height:s,width:n}}function rt(t){var e=window.getComputedStyle(t);var i=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"];var r=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"];var n=0;var s=0;i.forEach((function(t){n+=parseFloat(e[t])||0}));r.forEach((function(t){s+=parseFloat(e[t])||0}));return{height:s,width:n}}function nt(t){var e;var i=t.ownerDocument;if(t.nodeType==Node.TEXT_NODE){var r=i.createRange();r.selectNodeContents(t);e=r.getBoundingClientRect()}else{e=t.getBoundingClientRect()}return e}function st(){var t=window.innerWidth;var e=window.innerHeight;return{top:0,left:0,right:t,bottom:e,width:t,height:e}}function ot(t,e){var i=t.parentNode;var r=i.childNodes;var n;var s=-1;for(var o=0;o<r.length;o++){n=r[o];if(n.nodeType===e){s++}if(n==t)break}return s}function at(t){return ot(t,W)}function ht(t){return ot(t,q)}function ft(t){return["xml","opf","ncx"].indexOf(t)>-1}function lt(t,e){return new Blob([t],{type:e})}function ut(t,e){var i;var r=lt(t,e);i=H.createObjectURL(r);return i}function ct(t){return H.revokeObjectURL(t)}function dt(t,e){var i;var r;if(typeof t!=="string"){return}i=btoa(encodeURIComponent(t));r="data:"+e+";base64,"+i;return r}function pt(t){return Object.prototype.toString.call(t).slice(8,-1)}function vt(t,e,i){var r;var n;if(typeof DOMParser==="undefined"||i){n=require("xmldom").DOMParser}else{n=DOMParser}if(t.charCodeAt(0)===65279){t=t.slice(1)}r=(new n).parseFromString(t,e);return r}function gt(t,e){var i;if(!t){throw new Error("No Element Provided")}if(typeof t.querySelector!="undefined"){return t.querySelector(e)}else{i=t.getElementsByTagName(e);if(i.length){return i[0]}}}function mt(t,e){if(typeof t.querySelector!="undefined"){return t.querySelectorAll(e)}else{return t.getElementsByTagName(e)}}function yt(t,e,i){var r,n;if(typeof t.querySelector!="undefined"){e+="[";for(var s in i){e+=s+"~='"+i[s]+"'"}e+="]";return t.querySelector(e)}else{r=t.getElementsByTagName(e);n=Array.prototype.slice.call(r,0).filter((function(t){for(var e in i){if(t.getAttribute(e)===i[e]){return true}}return false}));if(n){return n[0]}}}function wt(t,e){var i=t.ownerDocument||t;if(typeof i.createTreeWalker!=="undefined"){bt(t,e,NodeFilter.SHOW_TEXT)}else{_t(t,(function(t){if(t&&t.nodeType===3){e(t)}}))}}function bt(t,e,i){var r=document.createTreeWalker(t,i,null,false);var n;while(n=r.nextNode()){e(n)}}function _t(t,e){if(e(t)){return true}t=t.firstChild;if(t){do{var i=_t(t,e);if(i){return true}t=t.nextSibling}while(t)}}function xt(t){return new Promise((function(e,i){var r=new FileReader;r.readAsDataURL(t);r.onloadend=function(){e(r.result)}}))}function kt(){var t=this;this.resolve=null;this.reject=null;this.id=Y();this.promise=new Promise((function(e,i){t.resolve=e;t.reject=i}));Object.freeze(this)}function Et(t,e,i){var r;if(typeof t.querySelector!="undefined"){r=t.querySelector(e+'[*|type="'+i+'"]')}if(!r||r.length===0){r=mt(t,e);for(var n=0;n<r.length;n++){if(r[n].getAttributeNS("http://www.idpf.org/2007/ops","type")===i||r[n].getAttribute("epub:type")===i){return r[n]}}}else{return r}}function St(t){var e=[];var i=t.childNodes;for(var r=0;r<i.length;r++){var n=i[r];if(n.nodeType===1){e.push(n)}}return e}function Ct(t){var e=[t];for(;t;t=t.parentNode){e.unshift(t)}return e}function Rt(t,e,i){var r=[];var n=t.childNodes;for(var s=0;s<n.length;s++){var o=n[s];if(o.nodeType===1&&o.nodeName.toLowerCase()===e){if(i){return o}else{r.push(o)}}}if(!i){return r}}function Tt(t,e){var i;if(t===null||e==="")return;i=t.parentNode;while(i.nodeType===1){if(i.tagName.toLowerCase()===e){return i}i=i.parentNode}}var At=function(){function t(){this.collapsed=false;this.commonAncestorContainer=undefined;this.endContainer=undefined;this.endOffset=undefined;this.startContainer=undefined;this.startOffset=undefined}t.prototype.setStart=function(t,e){this.startContainer=t;this.startOffset=e;if(!this.endContainer){this.collapse(true)}else{this.commonAncestorContainer=this._commonAncestorContainer()}this._checkCollapsed()};t.prototype.setEnd=function(t,e){this.endContainer=t;this.endOffset=e;if(!this.startContainer){this.collapse(false)}else{this.collapsed=false;this.commonAncestorContainer=this._commonAncestorContainer()}this._checkCollapsed()};t.prototype.collapse=function(t){this.collapsed=true;if(t){this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.commonAncestorContainer=this.startContainer.parentNode}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset;this.commonAncestorContainer=this.endOffset.parentNode}};t.prototype.selectNode=function(t){var e=t.parentNode;var i=Array.prototype.indexOf.call(e.childNodes,t);this.setStart(e,i);this.setEnd(e,i+1)};t.prototype.selectNodeContents=function(t){var e=t.nodeType===3?t.textContent.length:parent.childNodes.length;this.setStart(t,0);this.setEnd(t,e)};t.prototype._commonAncestorContainer=function(t,e){var i=Ct(t||this.startContainer);var r=Ct(e||this.endContainer);if(i[0]!=r[0])return undefined;for(var n=0;n<i.length;n++){if(i[n]!=r[n]){return i[n-1]}}};t.prototype._checkCollapsed=function(){if(this.startContainer===this.endContainer&&this.startOffset===this.endOffset){this.collapsed=true}else{this.collapsed=false}};t.prototype.toString=function(){};return t}();var Ot=Object.freeze({__proto__:null,requestAnimationFrame:F,uuid:Y,documentHeight:Z,isElement:V,isNumber:X,isFloat:K,prefixed:G,defaults:J,extend:$,insert:Q,locationOf:tt,indexOfSorted:et,bounds:it,borders:rt,nodeBounds:nt,windowBounds:st,indexOfNode:ot,indexOfTextNode:at,indexOfElementNode:ht,isXml:ft,createBlob:lt,createBlobUrl:ut,revokeBlobUrl:ct,createBase64Url:dt,type:pt,parse:vt,qs:gt,qsa:mt,qsp:yt,sprint:wt,treeWalker:bt,walk:_t,blob2base64:xt,defer:kt,querySelectorByType:Et,findChildren:St,parents:Ct,filterChildren:Rt,getParentByTagName:Tt,RangeObject:At});if(!Lt){var Lt={cwd:function(){return"/"}}}function It(t){if(typeof t!=="string"){throw new TypeError("Path must be a string. Received "+t)}}function zt(t,e){var i="";var r=-1;var n=0;var s;for(var o=0;o<=t.length;++o){if(o<t.length)s=t.charCodeAt(o);else if(s===47)break;else s=47;if(s===47){if(r===o-1||n===1);else if(r!==o-1&&n===2){if(i.length<2||i.charCodeAt(i.length-1)!==46||i.charCodeAt(i.length-2)!==46){if(i.length>2){var a=i.length-1;var h=a;for(;h>=0;--h){if(i.charCodeAt(h)===47)break}if(h!==a){if(h===-1)i="";else i=i.slice(0,h);r=o;n=0;continue}}else if(i.length===2||i.length===1){i="";r=o;n=0;continue}}if(e){if(i.length>0)i+="/..";else i=".."}}else{if(i.length>0)i+="/"+t.slice(r+1,o);else i=t.slice(r+1,o)}r=o;n=0}else if(s===46&&n!==-1){++n}else{n=-1}}return i}function Pt(t,e){var i=e.dir||e.root;var r=e.base||(e.name||"")+(e.ext||"");if(!i){return r}if(i===e.root){return i+r}return i+t+r}var Nt={resolve:function t(){var e="";var i=false;var r;for(var n=arguments.length-1;n>=-1&&!i;n--){var s;if(n>=0)s=arguments[n];else{if(r===undefined)r=Lt.cwd();s=r}It(s);if(s.length===0){continue}e=s+"/"+e;i=s.charCodeAt(0)===47}e=zt(e,!i);if(i){if(e.length>0)return"/"+e;else return"/"}else if(e.length>0){return e}else{return"."}},normalize:function t(e){It(e);if(e.length===0)return".";var i=e.charCodeAt(0)===47;var r=e.charCodeAt(e.length-1)===47;e=zt(e,!i);if(e.length===0&&!i)e=".";if(e.length>0&&r)e+="/";if(i)return"/"+e;return e},isAbsolute:function t(e){It(e);return e.length>0&&e.charCodeAt(0)===47},join:function t(){if(arguments.length===0)return".";var e;for(var i=0;i<arguments.length;++i){var r=arguments[i];It(r);if(r.length>0){if(e===undefined)e=r;else e+="/"+r}}if(e===undefined)return".";return Nt.normalize(e)},relative:function t(e,i){It(e);It(i);if(e===i)return"";e=Nt.resolve(e);i=Nt.resolve(i);if(e===i)return"";var r=1;for(;r<e.length;++r){if(e.charCodeAt(r)!==47)break}var n=e.length;var s=n-r;var o=1;for(;o<i.length;++o){if(i.charCodeAt(o)!==47)break}var a=i.length;var h=a-o;var f=s<h?s:h;var l=-1;var u=0;for(;u<=f;++u){if(u===f){if(h>f){if(i.charCodeAt(o+u)===47){return i.slice(o+u+1)}else if(u===0){return i.slice(o+u)}}else if(s>f){if(e.charCodeAt(r+u)===47){l=u}else if(u===0){l=0}}break}var c=e.charCodeAt(r+u);var d=i.charCodeAt(o+u);if(c!==d)break;else if(c===47)l=u}var p="";for(u=r+l+1;u<=n;++u){if(u===n||e.charCodeAt(u)===47){if(p.length===0)p+="..";else p+="/.."}}if(p.length>0)return p+i.slice(o+l);else{o+=l;if(i.charCodeAt(o)===47)++o;return i.slice(o)}},_makeLong:function t(e){return e},dirname:function t(e){It(e);if(e.length===0)return".";var i=e.charCodeAt(0);var r=i===47;var n=-1;var s=true;for(var o=e.length-1;o>=1;--o){i=e.charCodeAt(o);if(i===47){if(!s){n=o;break}}else{s=false}}if(n===-1)return r?"/":".";if(r&&n===1)return"//";return e.slice(0,n)},basename:function t(e,i){if(i!==undefined&&typeof i!=="string")throw new TypeError('"ext" argument must be a string');It(e);var r=0;var n=-1;var s=true;var o;if(i!==undefined&&i.length>0&&i.length<=e.length){if(i.length===e.length&&i===e)return"";var a=i.length-1;var h=-1;for(o=e.length-1;o>=0;--o){var f=e.charCodeAt(o);if(f===47){if(!s){r=o+1;break}}else{if(h===-1){s=false;h=o+1}if(a>=0){if(f===i.charCodeAt(a)){if(--a===-1){n=o}}else{a=-1;n=h}}}}if(r===n)n=h;else if(n===-1)n=e.length;return e.slice(r,n)}else{for(o=e.length-1;o>=0;--o){if(e.charCodeAt(o)===47){if(!s){r=o+1;break}}else if(n===-1){s=false;n=o+1}}if(n===-1)return"";return e.slice(r,n)}},extname:function t(e){It(e);var i=-1;var r=0;var n=-1;var s=true;var o=0;for(var a=e.length-1;a>=0;--a){var h=e.charCodeAt(a);if(h===47){if(!s){r=a+1;break}continue}if(n===-1){s=false;n=a+1}if(h===46){if(i===-1)i=a;else if(o!==1)o=1}else if(i!==-1){o=-1}}if(i===-1||n===-1||o===0||o===1&&i===n-1&&i===r+1){return""}return e.slice(i,n)},format:function t(e){if(e===null||typeof e!=="object"){throw new TypeError('Parameter "pathObject" must be an object, not '+typeof e)}return Pt("/",e)},parse:function t(e){It(e);var i={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return i;var r=e.charCodeAt(0);var n=r===47;var s;if(n){i.root="/";s=1}else{s=0}var o=-1;var a=0;var h=-1;var f=true;var l=e.length-1;var u=0;for(;l>=s;--l){r=e.charCodeAt(l);if(r===47){if(!f){a=l+1;break}continue}if(h===-1){f=false;h=l+1}if(r===46){if(o===-1)o=l;else if(u!==1)u=1}else if(o!==-1){u=-1}}if(o===-1||h===-1||u===0||u===1&&o===h-1&&o===a+1){if(h!==-1){if(a===0&&n)i.base=i.name=e.slice(1,h);else i.base=i.name=e.slice(a,h)}}else{if(a===0&&n){i.name=e.slice(1,o);i.base=e.slice(1,h)}else{i.name=e.slice(a,o);i.base=e.slice(a,h)}i.ext=e.slice(o,h)}if(a>0)i.dir=e.slice(0,a-1);else if(n)i.dir="/";return i},sep:"/",delimiter:":",posix:null};var Bt=Nt;var Dt=function(){function t(t){var e;var i;e=t.indexOf("://");if(e>-1){t=new URL(t).pathname}i=this.parse(t);this.path=t;if(this.isDirectory(t)){this.directory=t}else{this.directory=i.dir+"/"}this.filename=i.base;this.extension=i.ext.slice(1)}t.prototype.parse=function(t){return Bt.parse(t)};t.prototype.isAbsolute=function(t){return Bt.isAbsolute(t||this.path)};t.prototype.isDirectory=function(t){return t.charAt(t.length-1)==="/"};t.prototype.resolve=function(t){return Bt.resolve(this.directory,t)};t.prototype.relative=function(t){var e=t&&t.indexOf("://")>-1;if(e){return t}return Bt.relative(this.directory,t)};t.prototype.splitPath=function(t){return this.splitPathRe.exec(t).slice(1)};t.prototype.toString=function(){return this.path};return t}();var jt=function(){function t(t,e){var i=t.indexOf("://")>-1;var r=t;var n;this.Url=undefined;this.href=t;this.protocol="";this.origin="";this.hash="";this.hash="";this.search="";this.base=e;if(!i&&e!==false&&typeof e!=="string"&&window&&window.location){this.base=window.location.href}if(i||this.base){try{if(this.base){this.Url=new URL(t,this.base)}else{this.Url=new URL(t)}this.href=this.Url.href;this.protocol=this.Url.protocol;this.origin=this.Url.origin;this.hash=this.Url.hash;this.search=this.Url.search;r=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch(s){this.Url=undefined;if(this.base){n=new Dt(this.base);r=n.resolve(r)}}}this.Path=new Dt(r);this.directory=this.Path.directory;this.filename=this.Path.filename;this.extension=this.Path.extension}t.prototype.path=function(){return this.Path};t.prototype.resolve=function(t){var e=t.indexOf("://")>-1;var i;if(e){return t}i=Bt.resolve(this.directory,t);return this.origin+i};t.prototype.relative=function(t){return Bt.relative(t,this.directory)};t.prototype.toString=function(){return this.href};return t}();var Ut=1;var Mt=3;var Ft=9;var qt=function(){function t(e,i,r){var n;this.str="";this.base={};this.spinePos=0;this.range=false;this.path={};this.start=null;this.end=null;if(!(this instanceof t)){return new t(e,i,r)}if(typeof i==="string"){this.base=this.parseComponent(i)}else if(typeof i==="object"&&i.steps){this.base=i}n=this.checkType(e);if(n==="string"){this.str=e;return $(this,this.parse(e))}else if(n==="range"){return $(this,this.fromRange(e,this.base,r))}else if(n==="node"){return $(this,this.fromNode(e,this.base,r))}else if(n==="EpubCFI"&&e.path){return e}else if(!e){return this}else{throw new TypeError("not a valid argument for EpubCFI")}}t.prototype.checkType=function(e){if(this.isCfiString(e)){return"string"}else if(e&&typeof e==="object"&&(pt(e)==="Range"||typeof e.startContainer!="undefined")){return"range"}else if(e&&typeof e==="object"&&typeof e.nodeType!="undefined"){return"node"}else if(e&&typeof e==="object"&&e instanceof t){return"EpubCFI"}else{return false}};t.prototype.parse=function(t){var e={spinePos:-1,range:false,base:{},path:{},start:null,end:null};var i,r,n;if(typeof t!=="string"){return{spinePos:-1}}if(t.indexOf("epubcfi(")===0&&t[t.length-1]===")"){t=t.slice(8,t.length-1)}i=this.getChapterComponent(t);if(!i){return{spinePos:-1}}e.base=this.parseComponent(i);r=this.getPathComponent(t);e.path=this.parseComponent(r);n=this.getRange(t);if(n){e.range=true;e.start=this.parseComponent(n[0]);e.end=this.parseComponent(n[1])}e.spinePos=e.base.steps[1].index;return e};t.prototype.parseComponent=function(t){var e={steps:[],terminal:{offset:null,assertion:null}};var i=t.split(":");var r=i[0].split("/");var n;if(i.length>1){n=i[1];e.terminal=this.parseTerminal(n)}if(r[0]===""){r.shift()}e.steps=r.map(function(t){return this.parseStep(t)}.bind(this));return e};t.prototype.parseStep=function(t){var e,i,r,n,s;n=t.match(/\[(.*)\]/);if(n&&n[1]){s=n[1]}i=parseInt(t);if(isNaN(i)){return}if(i%2===0){e="element";r=i/2-1}else{e="text";r=(i-1)/2}return{type:e,index:r,id:s||null}};t.prototype.parseTerminal=function(t){var e,i;var r=t.match(/\[(.*)\]/);if(r&&r[1]){e=parseInt(t.split("[")[0]);i=r[1]}else{e=parseInt(t)}if(!X(e)){e=null}return{offset:e,assertion:i}};t.prototype.getChapterComponent=function(t){var e=t.split("!");return e[0]};t.prototype.getPathComponent=function(t){var e=t.split("!");if(e[1]){var i=e[1].split(",");return i[0]}};t.prototype.getRange=function(t){var e=t.split(",");if(e.length===3){return[e[1],e[2]]}return false};t.prototype.getCharecterOffsetComponent=function(t){var e=t.split(":");return e[1]||""};t.prototype.joinSteps=function(t){if(!t){return""}return t.map((function(t){var e="";if(t.type==="element"){e+=(t.index+1)*2}if(t.type==="text"){e+=1+2*t.index}if(t.id){e+="["+t.id+"]"}return e})).join("/")};t.prototype.segmentString=function(t){var e="/";e+=this.joinSteps(t.steps);if(t.terminal&&t.terminal.offset!=null){e+=":"+t.terminal.offset}if(t.terminal&&t.terminal.assertion!=null){e+="["+t.terminal.assertion+"]"}return e};t.prototype.toString=function(){var t="epubcfi(";t+=this.segmentString(this.base);t+="!";t+=this.segmentString(this.path);if(this.range&&this.start){t+=",";t+=this.segmentString(this.start)}if(this.range&&this.end){t+=",";t+=this.segmentString(this.end)}t+=")";return t};t.prototype.compare=function(e,i){var r,n;var s,o;if(typeof e==="string"){e=new t(e)}if(typeof i==="string"){i=new t(i)}if(e.spinePos>i.spinePos){return 1}if(e.spinePos<i.spinePos){return-1}if(e.range){r=e.path.steps.concat(e.start.steps);s=e.start.terminal}else{r=e.path.steps;s=e.path.terminal}if(i.range){n=i.path.steps.concat(i.start.steps);o=i.start.terminal}else{n=i.path.steps;o=i.path.terminal}for(var a=0;a<r.length;a++){if(!r[a]){return-1}if(!n[a]){return 1}if(r[a].index>n[a].index){return 1}if(r[a].index<n[a].index){return-1}}if(r.length<n.length){return-1}if(s.offset>o.offset){return 1}if(s.offset<o.offset){return-1}return 0};t.prototype.step=function(t){var e=t.nodeType===Mt?"text":"element";return{id:t.id,tagName:t.tagName,type:e,index:this.position(t)}};t.prototype.filteredStep=function(t,e){var i=this.filter(t,e);var r;if(!i){return}r=i.nodeType===Mt?"text":"element";return{id:i.id,tagName:i.tagName,type:r,index:this.filteredPosition(i,e)}};t.prototype.pathTo=function(t,e,i){var r={steps:[],terminal:{offset:null,assertion:null}};var n=t;var s;while(n&&n.parentNode&&n.parentNode.nodeType!=Ft){if(i){s=this.filteredStep(n,i)}else{s=this.step(n)}if(s){r.steps.unshift(s)}n=n.parentNode}if(e!=null&&e>=0){r.terminal.offset=e;if(r.steps[r.steps.length-1].type!="text"){r.steps.push({type:"text",index:0})}}return r};t.prototype.equalStep=function(t,e){if(!t||!e){return false}if(t.index===e.index&&t.id===e.id&&t.type===e.type){return true}return false};t.prototype.fromRange=function(t,e,i){var r={range:false,base:{},path:{},start:null,end:null};var n=t.startContainer;var s=t.endContainer;var o=t.startOffset;var a=t.endOffset;var h=false;if(i){h=n.ownerDocument.querySelector("."+i)!=null}if(typeof e==="string"){r.base=this.parseComponent(e);r.spinePos=r.base.steps[1].index}else if(typeof e==="object"){r.base=e}if(t.collapsed){if(h){o=this.patchOffset(n,o,i)}r.path=this.pathTo(n,o,i)}else{r.range=true;if(h){o=this.patchOffset(n,o,i)}r.start=this.pathTo(n,o,i);if(h){a=this.patchOffset(s,a,i)}r.end=this.pathTo(s,a,i);r.path={steps:[],terminal:null};var f=r.start.steps.length;var l;for(l=0;l<f;l++){if(this.equalStep(r.start.steps[l],r.end.steps[l])){if(l===f-1){if(r.start.terminal===r.end.terminal){r.path.steps.push(r.start.steps[l]);r.range=false}}else{r.path.steps.push(r.start.steps[l])}}else{break}}r.start.steps=r.start.steps.slice(r.path.steps.length);r.end.steps=r.end.steps.slice(r.path.steps.length)}return r};t.prototype.fromNode=function(t,e,i){var r={range:false,base:{},path:{},start:null,end:null};if(typeof e==="string"){r.base=this.parseComponent(e);r.spinePos=r.base.steps[1].index}else if(typeof e==="object"){r.base=e}r.path=this.pathTo(t,null,i);return r};t.prototype.filter=function(t,e){var i;var r;var n,s,o;var a=false;if(t.nodeType===Mt){a=true;n=t.parentNode;i=t.parentNode.classList.contains(e)}else{a=false;i=t.classList.contains(e)}if(i&&a){s=n.previousSibling;o=n.nextSibling;if(s&&s.nodeType===Mt){r=s}else if(o&&o.nodeType===Mt){r=o}if(r){return r}else{return t}}else if(i&&!a){return false}else{return t}};t.prototype.patchOffset=function(t,e,i){if(t.nodeType!=Mt){throw new Error("Anchor must be a text node")}var r=t;var n=e;if(t.parentNode.classList.contains(i)){r=t.parentNode}while(r.previousSibling){if(r.previousSibling.nodeType===Ut){if(r.previousSibling.classList.contains(i)){n+=r.previousSibling.textContent.length}else{break}}else{n+=r.previousSibling.textContent.length}r=r.previousSibling}return n};t.prototype.normalizedMap=function(t,e,i){var r={};var n=-1;var s,o=t.length;var a;var h;for(s=0;s<o;s++){a=t[s].nodeType;if(a===Ut&&t[s].classList.contains(i)){a=Mt}if(s>0&&a===Mt&&h===Mt){r[s]=n}else if(e===a){n=n+1;r[s]=n}h=a}return r};t.prototype.position=function(t){var e,i;if(t.nodeType===Ut){e=t.parentNode.children;if(!e){e=St(t.parentNode)}i=Array.prototype.indexOf.call(e,t)}else{e=this.textNodes(t.parentNode);i=e.indexOf(t)}return i};t.prototype.filteredPosition=function(t,e){var i,r,n;if(t.nodeType===Ut){i=t.parentNode.children;n=this.normalizedMap(i,Ut,e)}else{i=t.parentNode.childNodes;if(t.parentNode.classList.contains(e)){t=t.parentNode;i=t.parentNode.childNodes}n=this.normalizedMap(i,Mt,e)}r=Array.prototype.indexOf.call(i,t);return n[r]};t.prototype.stepsToXpath=function(t){var e=[".","*"];t.forEach((function(t){var i=t.index+1;if(t.id){e.push("*[position()="+i+" and @id='"+t.id+"']")}else if(t.type==="text"){e.push("text()["+i+"]")}else{e.push("*["+i+"]")}}));return e.join("/")};t.prototype.stepsToQuerySelector=function(t){var e=["html"];t.forEach((function(t){var i=t.index+1;if(t.id){e.push("#"+t.id)}else if(t.type==="text");else{e.push("*:nth-child("+i+")")}}));return e.join(">")};t.prototype.textNodes=function(t,e){return Array.prototype.slice.call(t.childNodes).filter((function(t){if(t.nodeType===Mt){return true}else if(e&&t.classList.contains(e)){return true}return false}))};t.prototype.walkToNode=function(t,e,i){var r=e||document;var n=r.documentElement;var s;var o;var a=t.length;var h;for(h=0;h<a;h++){o=t[h];if(o.type==="element"){if(o.id){n=r.getElementById(o.id)}else{s=n.children||St(n);n=s[o.index]}}else if(o.type==="text"){n=this.textNodes(n,i)[o.index]}if(!n){break}}return n};t.prototype.findNode=function(t,e,i){var r=e||document;var n;var s;if(!i&&typeof r.evaluate!="undefined"){s=this.stepsToXpath(t);n=r.evaluate(s,r,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}else if(i){n=this.walkToNode(t,r,i)}else{n=this.walkToNode(t,r)}return n};t.prototype.fixMiss=function(t,e,i,r){var n=this.findNode(t.slice(0,-1),i,r);var s=n.childNodes;var o=this.normalizedMap(s,Mt,r);var a;var h;var f=t[t.length-1].index;for(var l in o){if(!o.hasOwnProperty(l))return;if(o[l]===f){a=s[l];h=a.textContent.length;if(e>h){e=e-h}else{if(a.nodeType===Ut){n=a.childNodes[0]}else{n=a}break}}}return{container:n,offset:e}};t.prototype.toRange=function(t,e){var i=t||document;var r;var n,s,o,a;var h=this;var f,l;var u=e?i.querySelector("."+e)!=null:false;var c;if(typeof i.createRange!=="undefined"){r=i.createRange()}else{r=new At}if(h.range){n=h.start;f=h.path.steps.concat(n.steps);o=this.findNode(f,i,u?e:null);s=h.end;l=h.path.steps.concat(s.steps);a=this.findNode(l,i,u?e:null)}else{n=h.path;f=h.path.steps;o=this.findNode(h.path.steps,i,u?e:null)}if(o){try{if(n.terminal.offset!=null){r.setStart(o,n.terminal.offset)}else{r.setStart(o,0)}}catch(d){c=this.fixMiss(f,n.terminal.offset,i,u?e:null);r.setStart(c.container,c.offset)}}else{console.log("No startContainer found for",this.toString());return null}if(a){try{if(s.terminal.offset!=null){r.setEnd(a,s.terminal.offset)}else{r.setEnd(a,0)}}catch(d){c=this.fixMiss(l,h.end.terminal.offset,i,u?e:null);r.setEnd(c.container,c.offset)}}return r};t.prototype.isCfiString=function(t){if(typeof t==="string"&&t.indexOf("epubcfi(")===0&&t[t.length-1]===")"){return true}return false};t.prototype.generateChapterComponent=function(t,e,i){var r=parseInt(e),n=(t+1)*2,s="/"+n+"/";s+=(r+1)*2;if(i){s+="["+i+"]"}return s};t.prototype.collapse=function(t){if(!this.range){return}this.range=false;if(t){this.path.steps=this.path.steps.concat(this.start.steps);this.path.terminal=this.start.terminal}else{this.path.steps=this.path.steps.concat(this.end.steps);this.path.terminal=this.end.terminal}};return t}();var Wt=function(){function t(t){this.context=t||this;this.hooks=[]}t.prototype.register=function(){for(var t=0;t<arguments.length;++t){if(typeof arguments[t]==="function"){this.hooks.push(arguments[t])}else{for(var e=0;e<arguments[t].length;++e){this.hooks.push(arguments[t][e])}}}};t.prototype.deregister=function(t){var e;for(var i=0;i<this.hooks.length;i++){e=this.hooks[i];if(e===t){this.hooks.splice(i,1);break}}};t.prototype.trigger=function(){var t=arguments;var e=this.context;var i=[];this.hooks.forEach((function(r){var n=r.apply(e,t);if(n&&typeof n["then"]==="function"){i.push(n)}}));return Promise.all(i)};t.prototype.list=function(){return this.hooks};t.prototype.clear=function(){return this.hooks=[]};return t}();function Ht(t,e){var i;var r;var n=e.url;var s=n.indexOf("://")>-1;if(!t){return}r=gt(t,"head");i=gt(r,"base");if(!i){i=t.createElement("base");r.insertBefore(i,r.firstChild)}if(!s&&window&&window.location){n=window.location.origin+n}i.setAttribute("href",n)}function Yt(t,e){var i;var r;var n=e.canonical;if(!t){return}i=gt(t,"head");r=gt(i,"link[rel='canonical']");if(r){r.setAttribute("href",n)}else{r=t.createElement("link");r.setAttribute("rel","canonical");r.setAttribute("href",n);i.appendChild(r)}}function Zt(t,e){var i;var r;var n=e.idref;if(!t){return}i=gt(t,"head");r=gt(i,"link[property='dc.identifier']");if(r){r.setAttribute("content",n)}else{r=t.createElement("meta");r.setAttribute("name","dc.identifier");r.setAttribute("content",n);i.appendChild(r)}}function Vt(t,e){var i=t.querySelectorAll("a[href]");if(!i.length){return}var r=gt(t.ownerDocument,"base");var n=r?r.getAttribute("href"):undefined;var s=function(t){var i=t.getAttribute("href");if(i.indexOf("mailto:")===0){return}var r=i.indexOf("://")>-1;if(r){t.setAttribute("target","_blank")}else{var s;try{s=new jt(i,n)}catch(o){}t.onclick=function(){if(s&&s.hash){e(s.Path.path+s.hash)}else if(s){e(s.Path.path)}else{e(i)}return false}}}.bind(this);for(var o=0;o<i.length;o++){s(i[o])}}function Xt(t,e,i){e.forEach((function(e,r){if(e&&i[r]){t=t.replace(new RegExp(e,"g"),i[r])}}));return t}var Kt=function(){function t(t,e){this.idref=t.idref;this.linear=t.linear==="yes";this.properties=t.properties;this.index=t.index;this.href=t.href;this.url=t.url;this.canonical=t.canonical;this.next=t.next;this.prev=t.prev;this.cfiBase=t.cfiBase;if(e){this.hooks=e}else{this.hooks={};this.hooks.serialize=new Wt(this);this.hooks.content=new Wt(this)}this.document=undefined;this.contents=undefined;this.output=undefined}t.prototype.load=function(t){var e=t||this.request||require("./utils/request");var i=new kt;var r=i.promise;if(this.contents){i.resolve(this.contents)}else{e(this.url).then(function(t){this.document=t;this.contents=t.documentElement;return this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){i.resolve(this.contents)}.bind(this)).catch((function(t){i.reject(t)}))}return r};t.prototype.base=function(){return Ht(this.document,this)};t.prototype.render=function(t){var e=new kt;var i=e.promise;this.load(t).then(function(t){var e=typeof navigator!=="undefined"&&navigator.userAgent||"";var i=e.indexOf("Trident")>=0;var r;if(typeof XMLSerializer==="undefined"||i){r=require("xmldom/dom-parser").XMLSerializer}else{r=XMLSerializer}var n=new r;this.output=n.serializeToString(t);return this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){e.resolve(this.output)}.bind(this)).catch((function(t){e.reject(t)}));return i};t.prototype.find=function(t){var e=this;var i=[];var r=t.toLowerCase();var n=function(t){var n=t.textContent.toLowerCase();var s=e.document.createRange();var o;var a;var h=-1;var f;var l=150;while(a!=-1){a=n.indexOf(r,h+1);if(a!=-1){s=e.document.createRange();s.setStart(t,a);s.setEnd(t,a+r.length);o=e.cfiFromRange(s);if(t.textContent.length<l){f=t.textContent}else{f=t.textContent.substring(a-l/2,a+l/2);f="..."+f+"..."}i.push({cfi:o,excerpt:f})}h=a}};wt(e.document,(function(t){n(t)}));return i};t.prototype.reconcileLayoutSettings=function(t){var e={layout:t.layout,spread:t.spread,orientation:t.orientation};this.properties.forEach((function(t){var i=t.replace("rendition:","");var r=i.indexOf("-");var n,s;if(r!=-1){n=i.slice(0,r);s=i.slice(r+1);e[n]=s}}));return e};t.prototype.cfiFromRange=function(t){return new qt(t,this.cfiBase).toString()};t.prototype.cfiFromElement=function(t){return new qt(t,this.cfiBase).toString()};t.prototype.unload=function(){this.document=undefined;this.contents=undefined;this.output=undefined};t.prototype.destroy=function(){this.unload();this.hooks.serialize.clear();this.hooks.content.clear();this.hooks=undefined;this.idref=undefined;this.linear=undefined;this.properties=undefined;this.index=undefined;this.href=undefined;this.url=undefined;this.next=undefined;this.prev=undefined;this.cfiBase=undefined};return t}();var Gt=function(){function t(){this.spineItems=[];this.spineByHref={};this.spineById={};this.hooks={};this.hooks.serialize=new Wt;this.hooks.content=new Wt;this.hooks.content.register(Ht);this.hooks.content.register(Yt);this.hooks.content.register(Zt);this.epubcfi=new qt;this.loaded=false;this.items=undefined;this.manifest=undefined;this.spineNodeIndex=undefined;this.baseUrl=undefined;this.length=undefined}t.prototype.unpack=function(t,e,i){var r=this;this.items=t.spine;this.manifest=t.manifest;this.spineNodeIndex=t.spineNodeIndex;this.baseUrl=t.baseUrl||t.basePath||"";this.length=this.items.length;this.items.forEach((function(t,n){var s=r.manifest[t.idref];var o;t.index=n;t.cfiBase=r.epubcfi.generateChapterComponent(r.spineNodeIndex,t.index,t.idref);if(t.href){t.url=e(t.href,true);t.canonical=i(t.href)}if(s){t.href=s.href;t.url=e(t.href,true);t.canonical=i(t.href);if(s.properties.length){t.properties.push.apply(t.properties,s.properties)}}if(t.linear==="yes"){t.prev=function(){var e=t.index;while(e>0){var i=this.get(e-1);if(i&&i.linear){return i}e-=1}return}.bind(r);t.next=function(){var e=t.index;while(e<this.spineItems.length-1){var i=this.get(e+1);if(i&&i.linear){return i}e+=1}return}.bind(r)}else{t.prev=function(){return};t.next=function(){return}}o=new Kt(t,r.hooks);r.append(o)}));this.loaded=true};t.prototype.get=function(t){var e=0;if(typeof t==="undefined"){while(e<this.spineItems.length){var i=this.spineItems[e];if(i&&i.linear){break}e+=1}}else if(this.epubcfi.isCfiString(t)){var r=new qt(t);e=r.spinePos}else if(typeof t==="number"||isNaN(t)===false){e=t}else if(typeof t==="string"&&t.indexOf("#")===0){e=this.spineById[t.substring(1)]}else if(typeof t==="string"){t=t.split("#")[0];e=this.spineByHref[t]||this.spineByHref[encodeURI(t)]}return this.spineItems[e]||null};t.prototype.append=function(t){var e=this.spineItems.length;t.index=e;this.spineItems.push(t);this.spineByHref[decodeURI(t.href)]=e;this.spineByHref[encodeURI(t.href)]=e;this.spineByHref[t.href]=e;this.spineById[t.idref]=e;return e};t.prototype.prepend=function(t){this.spineByHref[t.href]=0;this.spineById[t.idref]=0;this.spineItems.forEach((function(t,e){t.index=e}));return 0};t.prototype.remove=function(t){var e=this.spineItems.indexOf(t);if(e>-1){delete this.spineByHref[t.href];delete this.spineById[t.idref];return this.spineItems.splice(e,1)}};t.prototype.each=function(){return this.spineItems.forEach.apply(this.spineItems,arguments)};t.prototype.first=function(){var t=0;do{var e=this.get(t);if(e&&e.linear){return e}t+=1}while(t<this.spineItems.length)};t.prototype.last=function(){var t=this.spineItems.length-1;do{var e=this.get(t);if(e&&e.linear){return e}t-=1}while(t>=0)};t.prototype.destroy=function(){this.each((function(t){return t.destroy()}));this.spineItems=undefined;this.spineByHref=undefined;this.spineById=undefined;this.hooks.serialize.clear();this.hooks.content.clear();this.hooks=undefined;this.epubcfi=undefined;this.loaded=false;this.items=undefined;this.manifest=undefined;this.spineNodeIndex=undefined;this.baseUrl=undefined;this.length=undefined};return t}();var Jt=function(){function t(t){this._q=[];this.context=t;this.tick=F;this.running=false;this.paused=false}t.prototype.enqueue=function(){var t,e;var i;var r=[].shift.call(arguments);var n=arguments;if(!r){throw new Error("No Task Provided")}if(typeof r==="function"){t=new kt;e=t.promise;i={task:r,args:n,deferred:t,promise:e}}else{i={promise:r}}this._q.push(i);if(this.paused==false&&!this.running){this.run()}return i.promise};t.prototype.dequeue=function(){var t,e,i;if(this._q.length&&!this.paused){t=this._q.shift();e=t.task;if(e){i=e.apply(this.context,t.args);if(i&&typeof i["then"]==="function"){return i.then(function(){t.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){t.deferred.reject.apply(this.context,arguments)}.bind(this))}else{t.deferred.resolve.apply(this.context,i);return t.promise}}else if(t.promise){return t.promise}}else{t=new kt;t.deferred.resolve();return t.promise}};t.prototype.dump=function(){while(this._q.length){this.dequeue()}};t.prototype.run=function(){var t=this;if(!this.running){this.running=true;this.defered=new kt}this.tick.call(window,(function(){if(t._q.length){t.dequeue().then(function(){this.run()}.bind(t))}else{t.defered.resolve();t.running=undefined}}));if(this.paused==true){this.paused=false}return this.defered.promise};t.prototype.flush=function(){if(this.running){return this.running}if(this._q.length){this.running=this.dequeue().then(function(){this.running=undefined;return this.flush()}.bind(this));return this.running}};t.prototype.clear=function(){this._q=[]};t.prototype.length=function(){return this._q.length};t.prototype.pause=function(){this.paused=true};t.prototype.stop=function(){this._q=[];this.running=false;this.paused=true};return t}();var $t="0.3";var Qt=["keydown","keyup","keypressed","mouseup","mousedown","click","touchend","touchstart","touchmove"];var te={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};var ee=function(){function t(t,e,i){this.spine=t;this.request=e;this.pause=i||100;this.q=new Jt(this);this.epubcfi=new qt;this._locations=[];this.total=0;this.break=150;this._current=0;this.currentLocation="";this._currentCfi="";this.processingTimeout=undefined}t.prototype.generate=function(t){if(t){this.break=t}this.q.pause();this.spine.each(function(t){if(t.linear){this.q.enqueue(this.process.bind(this),t)}}.bind(this));return this.q.run().then(function(){this.total=this._locations.length-1;if(this._currentCfi){this.currentLocation=this._currentCfi}return this._locations}.bind(this))};t.prototype.createRange=function(){return{startContainer:undefined,startOffset:undefined,endContainer:undefined,endOffset:undefined}};t.prototype.process=function(t){return t.load(this.request).then(function(e){var i=new kt;var r=this.parse(e,t.cfiBase);this._locations=this._locations.concat(r);t.unload();this.processingTimeout=setTimeout((function(){return i.resolve(r)}),this.pause);return i.promise}.bind(this))};t.prototype.parse=function(t,e,i){var r=[];var n;var s=t.ownerDocument;var o=gt(s,"body");var a=0;var h;var f=i||this.break;var l=function(t){var i=t.length;var s;var o=0;if(t.textContent.trim().length===0){return false}if(a==0){n=this.createRange();n.startContainer=t;n.startOffset=0}s=f-a;if(s>i){a+=i;o=i}while(o<i){s=f-a;if(a===0){o+=1;n=this.createRange();n.startContainer=t;n.startOffset=o}if(o+s>=i){a+=i-o;o=i}else{o+=s;n.endContainer=t;n.endOffset=o;var l=new qt(n,e).toString();r.push(l);a=0}}h=t};wt(o,l.bind(this));if(n&&n.startContainer&&h){n.endContainer=h;n.endOffset=h.length;var u=new qt(n,e).toString();r.push(u);a=0}return r};t.prototype.locationFromCfi=function(t){var e;if(qt.prototype.isCfiString(t)){t=new qt(t)}if(this._locations.length===0){return-1}e=tt(t,this._locations,this.epubcfi.compare);if(e>this.total){return this.total}return e};t.prototype.percentageFromCfi=function(t){if(this._locations.length===0){return null}var e=this.locationFromCfi(t);return this.percentageFromLocation(e)};t.prototype.percentageFromLocation=function(t){if(!t||!this.total){return 0}return t/this.total};t.prototype.cfiFromLocation=function(t){var e=-1;if(typeof t!="number"){t=parseInt(t)}if(t>=0&&t<this._locations.length){e=this._locations[t]}return e};t.prototype.cfiFromPercentage=function(t){var e;if(t>1){console.warn("Normalize cfiFromPercentage value to between 0 - 1")}if(t>=1){var i=new qt(this._locations[this.total]);i.collapse();return i.toString()}e=Math.ceil(this.total*t);return this.cfiFromLocation(e)};t.prototype.load=function(t){if(typeof t==="string"){this._locations=JSON.parse(t)}else{this._locations=t}this.total=this._locations.length-1;return this._locations};t.prototype.save=function(){return JSON.stringify(this._locations)};t.prototype.getCurrent=function(){return this._current};t.prototype.setCurrent=function(t){var e;if(typeof t=="string"){this._currentCfi=t}else if(typeof t=="number"){this._current=t}else{return}if(this._locations.length===0){return}if(typeof t=="string"){e=this.locationFromCfi(t);this._current=e}else{e=t}this.emit(te.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(e)})};Object.defineProperty(t.prototype,"currentLocation",{get:function(){return this._current},set:function(t){this.setCurrent(t)},enumerable:true,configurable:true});t.prototype.length=function(){return this._locations.length};t.prototype.destroy=function(){this.spine=undefined;this.request=undefined;this.pause=undefined;this.q.stop();this.q=undefined;this.epubcfi=undefined;this._locations=undefined;this.total=undefined;this.break=undefined;this._current=undefined;this.currentLocation=undefined;this._currentCfi=undefined;clearTimeout(this.processingTimeout)};return t}();M(ee.prototype);var ie=function(){function t(t){this.packagePath="";this.directory="";this.encoding="";if(t){this.parse(t)}}t.prototype.parse=function(t){var e;if(!t){throw new Error("Container File Not Found")}e=gt(t,"rootfile");if(!e){throw new Error("No RootFile Found")}this.packagePath=e.getAttribute("full-path");this.directory=Bt.dirname(this.packagePath);this.encoding=t.xmlEncoding};t.prototype.destroy=function(){this.packagePath=undefined;this.directory=undefined;this.encoding=undefined};return t}();var re=function(){function t(t){this.manifest={};this.navPath="";this.ncxPath="";this.coverPath="";this.spineNodeIndex=0;this.spine=[];this.metadata={};if(t){this.parse(t)}}t.prototype.parse=function(t){var e,i,r;if(!t){throw new Error("Package File Not Found")}e=gt(t,"metadata");if(!e){throw new Error("No Metadata Found")}i=gt(t,"manifest");if(!i){throw new Error("No Manifest Found")}r=gt(t,"spine");if(!r){throw new Error("No Spine Found")}this.manifest=this.parseManifest(i);this.navPath=this.findNavPath(i);this.ncxPath=this.findNcxPath(i,r);this.coverPath=this.findCoverPath(t);this.spineNodeIndex=ht(r);this.spine=this.parseSpine(r,this.manifest);this.uniqueIdentifier=this.findUniqueIdentifier(t);this.metadata=this.parseMetadata(e);this.metadata.direction=r.getAttribute("page-progression-direction");return{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}};t.prototype.parseMetadata=function(t){var e={};e.title=this.getElementText(t,"title");e.creator=this.getElementText(t,"creator");e.description=this.getElementText(t,"description");e.pubdate=this.getElementText(t,"date");e.publisher=this.getElementText(t,"publisher");e.identifier=this.getElementText(t,"identifier");e.language=this.getElementText(t,"language");e.rights=this.getElementText(t,"rights");e.modified_date=this.getPropertyText(t,"dcterms:modified");e.layout=this.getPropertyText(t,"rendition:layout");e.orientation=this.getPropertyText(t,"rendition:orientation");e.flow=this.getPropertyText(t,"rendition:flow");e.viewport=this.getPropertyText(t,"rendition:viewport");e.media_active_class=this.getPropertyText(t,"media:active-class");return e};t.prototype.parseManifest=function(t){var e={};var i=mt(t,"item");var r=Array.prototype.slice.call(i);r.forEach((function(t){var i=t.getAttribute("id"),r=t.getAttribute("href")||"",n=t.getAttribute("media-type")||"",s=t.getAttribute("media-overlay")||"",o=t.getAttribute("properties")||"";e[i]={href:r,type:n,overlay:s,properties:o.length?o.split(" "):[]}}));return e};t.prototype.parseSpine=function(t,e){var i=[];var r=mt(t,"itemref");var n=Array.prototype.slice.call(r);n.forEach((function(t,e){var r=t.getAttribute("idref");var n=t.getAttribute("properties")||"";var s=n.length?n.split(" "):[];var o={idref:r,linear:t.getAttribute("linear")||"yes",properties:s,index:e};i.push(o)}));return i};t.prototype.findUniqueIdentifier=function(t){var e=t.documentElement.getAttribute("unique-identifier");if(!e){return""}var i=t.getElementById(e);if(!i){return""}if(i.localName==="identifier"&&i.namespaceURI==="http://purl.org/dc/elements/1.1/"){return i.childNodes.length>0?i.childNodes[0].nodeValue.trim():""}return""};t.prototype.findNavPath=function(t){var e=yt(t,"item",{properties:"nav"});return e?e.getAttribute("href"):false};t.prototype.findNcxPath=function(t,e){var i=yt(t,"item",{"media-type":"application/x-dtbncx+xml"});var r;if(!i){r=e.getAttribute("toc");if(r){i=t.querySelector("#"+r)}}return i?i.getAttribute("href"):false};t.prototype.findCoverPath=function(t){var e=gt(t,"package");var i=e.getAttribute("version");if(i==="2.0"){var r=yt(t,"meta",{name:"cover"});if(r){var n=r.getAttribute("content");var s=t.getElementById(n);return s?s.getAttribute("href"):""}else{return false}}else{var o=yt(t,"item",{properties:"cover-image"});return o?o.getAttribute("href"):""}};t.prototype.getElementText=function(t,e){var i=t.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",e);var r;if(!i||i.length===0)return"";r=i[0];if(r.childNodes.length){return r.childNodes[0].nodeValue}return""};t.prototype.getPropertyText=function(t,e){var i=yt(t,"meta",{property:e});if(i&&i.childNodes.length){return i.childNodes[0].nodeValue}return""};t.prototype.load=function(t){var e=this;this.metadata=t.metadata;var i=t.readingOrder||t.spine;this.spine=i.map((function(t,e){t.index=e;t.linear=t.linear||"yes";return t}));t.resources.forEach((function(t,i){e.manifest[i]=t;if(t.rel&&t.rel[0]==="cover"){e.coverPath=t.href}}));this.spineNodeIndex=0;this.toc=t.toc.map((function(t,e){t.label=t.title;return t}));return{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}};t.prototype.destroy=function(){this.manifest=undefined;this.navPath=undefined;this.ncxPath=undefined;this.coverPath=undefined;this.spineNodeIndex=undefined;this.spine=undefined;this.metadata=undefined};return t}();var ne=function(){function t(t){this.toc=[];this.tocByHref={};this.tocById={};this.landmarks=[];this.landmarksByType={};this.length=0;if(t){this.parse(t)}}t.prototype.parse=function(t){var e=t.nodeType;var i;var r;if(e){i=gt(t,"html");r=gt(t,"ncx")}if(!e){this.toc=this.load(t)}else if(i){this.toc=this.parseNav(t);this.landmarks=this.parseLandmarks(t)}else if(r){this.toc=this.parseNcx(t)}this.length=0;this.unpack(this.toc)};t.prototype.unpack=function(t){var e;for(var i=0;i<t.length;i++){e=t[i];if(e.href){this.tocByHref[e.href]=i}if(e.id){this.tocById[e.id]=i}this.length++;if(e.subitems.length){this.unpack(e.subitems)}}};t.prototype.get=function(t){var e;if(!t){return this.toc}if(t.indexOf("#")===0){e=this.tocById[t.substring(1)]}else if(t in this.tocByHref){e=this.tocByHref[t]}return this.toc[e]};t.prototype.landmark=function(t){var e;if(!t){return this.landmarks}e=this.landmarksByType[t];return this.landmarks[e]};t.prototype.parseNav=function(t){var e=Et(t,"nav","toc");var i=e?mt(e,"li"):[];var r=i.length;var n;var s={};var o=[];var a,h;if(!i||r===0)return o;for(n=0;n<r;++n){a=this.navItem(i[n]);if(a){s[a.id]=a;if(!a.parent){o.push(a)}else{h=s[a.parent];h.subitems.push(a)}}}return o};t.prototype.navItem=function(t){var e=t.getAttribute("id")||undefined;var i=Rt(t,"a",true);if(!i){return}var r=i.getAttribute("href")||"";if(!e){e=r}var n=i.textContent||"";var s=[];var o=Tt(t,"li");var a;if(o){a=o.getAttribute("id");if(!a){var h=Rt(o,"a",true);a=h&&h.getAttribute("href")}}while(!a&&o){o=Tt(o,"li");if(o){a=o.getAttribute("id");if(!a){var h=Rt(o,"a",true);a=h&&h.getAttribute("href")}}}return{id:e,href:r,label:n,subitems:s,parent:a}};t.prototype.parseLandmarks=function(t){var e=Et(t,"nav","landmarks");var i=e?mt(e,"li"):[];var r=i.length;var n;var s=[];var o;if(!i||r===0)return s;for(n=0;n<r;++n){o=this.landmarkItem(i[n]);if(o){s.push(o);this.landmarksByType[o.type]=n}}return s};t.prototype.landmarkItem=function(t){var e=Rt(t,"a",true);if(!e){return}var i=e.getAttributeNS("http://www.idpf.org/2007/ops","type")||undefined;var r=e.getAttribute("href")||"";var n=e.textContent||"";return{href:r,label:n,type:i}};t.prototype.parseNcx=function(t){var e=mt(t,"navPoint");var i=e.length;var r;var n={};var s=[];var o,a;if(!e||i===0)return s;for(r=0;r<i;++r){o=this.ncxItem(e[r]);n[o.id]=o;if(!o.parent){s.push(o)}else{a=n[o.parent];a.subitems.push(o)}}return s};t.prototype.ncxItem=function(t){var e=t.getAttribute("id")||false,i=gt(t,"content"),r=i.getAttribute("src"),n=gt(t,"navLabel"),s=n.textContent?n.textContent:"",o=[],a=t.parentNode,h;if(a&&(a.nodeName==="navPoint"||a.nodeName.split(":").slice(-1)[0]==="navPoint")){h=a.getAttribute("id")}return{id:e,href:r,label:s,subitems:o,parent:h}};t.prototype.load=function(t){var e=this;return t.map((function(t){t.label=t.title;t.subitems=t.children?e.load(t.children):[];return t}))};t.prototype.forEach=function(t){return this.toc.forEach(t)};return t}();var se={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}};var oe=function(){var t,e,i,r,n={};for(t in se){if(se.hasOwnProperty(t)){for(e in se[t]){if(se[t].hasOwnProperty(e)){i=se[t][e];if(typeof i=="string"){n[i]=t+"/"+e}else{for(r=0;r<i.length;r++){n[i[r]]=t+"/"+e}}}}}}return n}();var ae="text/plain";function he(t){return t&&oe[t.split(".").pop().toLowerCase()]||ae}var fe={lookup:he};var le=function(){function t(t,e){this.settings={replacements:e&&e.replacements||"base64",archive:e&&e.archive,resolver:e&&e.resolver,request:e&&e.request};this.process(t)}t.prototype.process=function(t){this.manifest=t;this.resources=Object.keys(t).map((function(e){return t[e]}));this.replacementUrls=[];this.html=[];this.assets=[];this.css=[];this.urls=[];this.cssUrls=[];this.split();this.splitUrls()};t.prototype.split=function(){this.html=this.resources.filter((function(t){if(t.type==="application/xhtml+xml"||t.type==="text/html"){return true}}));this.assets=this.resources.filter((function(t){if(t.type!=="application/xhtml+xml"&&t.type!=="text/html"){return true}}));this.css=this.resources.filter((function(t){if(t.type==="text/css"){return true}}))};t.prototype.splitUrls=function(){this.urls=this.assets.map(function(t){return t.href}.bind(this));this.cssUrls=this.css.map((function(t){return t.href}))};t.prototype.createUrl=function(t){var e=new jt(t);var i=fe.lookup(e.filename);if(this.settings.archive){return this.settings.archive.createUrl(t,{base64:this.settings.replacements==="base64"})}else{if(this.settings.replacements==="base64"){return this.settings.request(t,"blob").then((function(t){return xt(t)})).then((function(t){return dt(t,i)}))}else{return this.settings.request(t,"blob").then((function(t){return ut(t,i)}))}}};t.prototype.replacements=function(){var t=this;if(this.settings.replacements==="none"){return new Promise(function(t){t(this.urls)}.bind(this))}var e=this.urls.map((function(e){var i=t.settings.resolver(e);return t.createUrl(i).catch((function(t){console.error(t);return null}))}));return Promise.all(e).then((function(e){t.replacementUrls=e.filter((function(t){return typeof t==="string"}));return e}))};t.prototype.replaceCss=function(t,e){var i=[];t=t||this.settings.archive;e=e||this.settings.resolver;this.cssUrls.forEach(function(r){var n=this.createCssFile(r,t,e).then(function(t){var e=this.urls.indexOf(r);if(e>-1){this.replacementUrls[e]=t}}.bind(this));i.push(n)}.bind(this));return Promise.all(i)};t.prototype.createCssFile=function(t){var e=this;var i;if(Bt.isAbsolute(t)){return new Promise((function(t){t()}))}var r=this.settings.resolver(t);var n;if(this.settings.archive){n=this.settings.archive.getText(r)}else{n=this.settings.request(r,"text")}var s=this.urls.map((function(t){var i=e.settings.resolver(t);var n=new Dt(r).relative(i);return n}));if(!n){return new Promise((function(t){t()}))}return n.then((function(t){t=Xt(t,s,e.replacementUrls);if(e.settings.replacements==="base64"){i=dt(t,"text/css")}else{i=ut(t,"text/css")}return i}),(function(t){return new Promise((function(t){t()}))}))};t.prototype.relativeTo=function(t,e){e=e||this.settings.resolver;return this.urls.map(function(i){var r=e(i);var n=new Dt(t).relative(r);return n}.bind(this))};t.prototype.get=function(t){var e=this.urls.indexOf(t);if(e===-1){return}if(this.replacementUrls.length){return new Promise(function(t,i){t(this.replacementUrls[e])}.bind(this))}else{return this.createUrl(t)}};t.prototype.substitute=function(t,e){var i;if(e){i=this.relativeTo(e)}else{i=this.urls}return Xt(t,i,this.replacementUrls)};t.prototype.destroy=function(){this.settings=undefined;this.manifest=undefined;this.resources=undefined;this.replacementUrls=undefined;this.html=undefined;this.assets=undefined;this.css=undefined;this.urls=undefined;this.cssUrls=undefined};return t}();var ue=function(){function t(t){this.pages=[];this.locations=[];this.epubcfi=new qt;this.firstPage=0;this.lastPage=0;this.totalPages=0;this.toc=undefined;this.ncx=undefined;if(t){this.pageList=this.parse(t)}if(this.pageList&&this.pageList.length){this.process(this.pageList)}}t.prototype.parse=function(t){var e=gt(t,"html");var i=gt(t,"ncx");if(e){return this.parseNav(t)}else if(i){return this.parseNcx(t)}};t.prototype.parseNav=function(t){var e=Et(t,"nav","page-list");var i=e?mt(e,"li"):[];var r=i.length;var n;var s=[];var o;if(!i||r===0)return s;for(n=0;n<r;++n){o=this.item(i[n]);s.push(o)}return s};t.prototype.parseNcx=function(t){var e=[];var i=0;var r;var n;var s;var o=0;n=gt(t,"pageList");if(!n)return e;s=mt(n,"pageTarget");o=s.length;if(!s||s.length===0){return e}for(i=0;i<o;++i){r=this.ncxItem(s[i]);e.push(r)}return e};t.prototype.ncxItem=function(t){var e=gt(t,"navLabel");var i=gt(e,"text");var r=i.textContent;var n=gt(t,"content");var s=n.getAttribute("src");var o=parseInt(r,10);return{href:s,page:o}};t.prototype.item=function(t){var e=gt(t,"a"),i=e.getAttribute("href")||"",r=e.textContent||"",n=parseInt(r),s=i.indexOf("epubcfi"),o,a,h;if(s!=-1){o=i.split("#");a=o[0];h=o.length>1?o[1]:false;return{cfi:h,href:i,packageUrl:a,page:n}}else{return{href:i,page:n}}};t.prototype.process=function(t){t.forEach((function(t){this.pages.push(t.page);if(t.cfi){this.locations.push(t.cfi)}}),this);this.firstPage=parseInt(this.pages[0]);this.lastPage=parseInt(this.pages[this.pages.length-1]);this.totalPages=this.lastPage-this.firstPage};t.prototype.pageFromCfi=function(t){var e=-1;if(this.locations.length===0){return-1}var i=et(t,this.locations,this.epubcfi.compare);if(i!=-1){e=this.pages[i]}else{i=tt(t,this.locations,this.epubcfi.compare);e=i-1>=0?this.pages[i-1]:this.pages[0];if(e!==undefined);else{e=-1}}return e};t.prototype.cfiFromPage=function(t){var e=-1;if(typeof t!="number"){t=parseInt(t)}var i=this.pages.indexOf(t);if(i!=-1){e=this.locations[i]}return e};t.prototype.pageFromPercentage=function(t){var e=Math.round(this.totalPages*t);return e};t.prototype.percentageFromPage=function(t){var e=(t-this.firstPage)/this.totalPages;return Math.round(e*1e3)/1e3};t.prototype.percentageFromCfi=function(t){var e=this.pageFromCfi(t);var i=this.percentageFromPage(e);return i};t.prototype.destroy=function(){this.pages=undefined;this.locations=undefined;this.epubcfi=undefined;this.pageList=undefined;this.toc=undefined;this.ncx=undefined};return t}();var ce=function(){function t(t){this.settings=t;this.name=t.layout||"reflowable";this._spread=t.spread==="none"?false:true;this._minSpreadWidth=t.minSpreadWidth||800;this._evenSpreads=t.evenSpreads||false;if(t.flow==="scrolled"||t.flow==="scrolled-continuous"||t.flow==="scrolled-doc"){this._flow="scrolled"}else{this._flow="paginated"}this.width=0;this.height=0;this.spreadWidth=0;this.delta=0;this.columnWidth=0;this.gap=0;this.divisor=1;this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}t.prototype.flow=function(t){if(typeof t!="undefined"){if(t==="scrolled"||t==="scrolled-continuous"||t==="scrolled-doc"){this._flow="scrolled"}else{this._flow="paginated"}this.update({flow:this._flow})}return this._flow};t.prototype.spread=function(t,e){if(t){this._spread=t==="none"?false:true;this.update({spread:this._spread})}if(e>=0){this._minSpreadWidth=e}return this._spread};t.prototype.calculate=function(t,e,i){var r=1;var n=i||0;var s=t;var o=e;var a=Math.floor(s/12);var h;var f;var l;var u;if(this._spread&&s>=this._minSpreadWidth){r=2}else{r=1}if(this.name==="reflowable"&&this._flow==="paginated"&&!(i>=0)){n=a%2===0?a:a-1}if(this.name==="pre-paginated"){n=0}if(r>1){h=s/r-n;l=h+n}else{h=s;l=s}if(this.name==="pre-paginated"&&r>1){s=h}f=h*r+n;u=s;this.width=s;this.height=o;this.spreadWidth=f;this.pageWidth=l;this.delta=u;this.columnWidth=h;this.gap=n;this.divisor=r;this.update({width:s,height:o,spreadWidth:f,pageWidth:l,delta:u,columnWidth:h,gap:n,divisor:r})};t.prototype.format=function(t){var e;if(this.name==="pre-paginated"){e=t.fit(this.columnWidth,this.height)}else if(this._flow==="paginated"){e=t.columns(this.width,this.height,this.columnWidth,this.gap)}else{e=t.size(this.width,null)}return e};t.prototype.count=function(t,e){var i,r;if(this.name==="pre-paginated"){i=1;r=1}else if(this._flow==="paginated"){e=e||this.delta;i=Math.ceil(t/e);r=i*this.divisor}else{e=e||this.height;i=Math.ceil(t/e);r=i}return{spreads:i,pages:r}};t.prototype.update=function(t){var e=this;Object.keys(t).forEach((function(i){if(e.props[i]===t[i]){delete t[i]}}));if(Object.keys(t).length>0){var i=$(this.props,t);this.emit(te.LAYOUT.UPDATED,i,t)}};return t}();M(ce.prototype);var de=function(){function t(t){this.rendition=t;this._themes={default:{rules:{},url:"",serialized:""}};this._overrides={};this._current="default";this._injected=[];this.rendition.hooks.content.register(this.inject.bind(this));this.rendition.hooks.content.register(this.overrides.bind(this))}t.prototype.register=function(){if(arguments.length===0){return}if(arguments.length===1&&typeof arguments[0]==="object"){return this.registerThemes(arguments[0])}if(arguments.length===1&&typeof arguments[0]==="string"){return this.default(arguments[0])}if(arguments.length===2&&typeof arguments[1]==="string"){return this.registerUrl(arguments[0],arguments[1])}if(arguments.length===2&&typeof arguments[1]==="object"){return this.registerRules(arguments[0],arguments[1])}};t.prototype.default=function(t){if(!t){return}if(typeof t==="string"){return this.registerUrl("default",t)}if(typeof t==="object"){return this.registerRules("default",t)}};t.prototype.registerThemes=function(t){for(var e in t){if(t.hasOwnProperty(e)){if(typeof t[e]==="string"){this.registerUrl(e,t[e])}else{this.registerRules(e,t[e])}}}};t.prototype.registerUrl=function(t,e){var i=new jt(e);this._themes[t]={url:i.toString()};if(this._injected[t]){this.update(t)}};t.prototype.registerRules=function(t,e){this._themes[t]={rules:e};if(this._injected[t]){this.update(t)}};t.prototype.select=function(t){var e=this._current;var i;this._current=t;this.update(t);i=this.rendition.getContents();i.forEach((function(i){i.removeClass(e);i.addClass(t)}))};t.prototype.update=function(t){var e=this;var i=this.rendition.getContents();i.forEach((function(i){e.add(t,i)}))};t.prototype.inject=function(t){var e=[];var i=this._themes;var r;for(var n in i){if(i.hasOwnProperty(n)&&(n===this._current||n==="default")){r=i[n];if(r.rules&&Object.keys(r.rules).length>0||r.url&&e.indexOf(r.url)===-1){this.add(n,t)}this._injected.push(n)}}if(this._current!="default"){t.addClass(this._current)}};t.prototype.add=function(t,e){var i=this._themes[t];if(!i||!e){return}if(i.url){e.addStylesheet(i.url)}else if(i.serialized);else if(i.rules){e.addStylesheetRules(i.rules);i.injected=true}};t.prototype.override=function(t,e,i){var r=this;var n=this.rendition.getContents();this._overrides[t]={value:e,priority:i===true};n.forEach((function(e){e.css(t,r._overrides[t].value,r._overrides[t].priority)}))};t.prototype.removeOverride=function(t){var e=this.rendition.getContents();delete this._overrides[t];e.forEach((function(e){e.css(t)}))};t.prototype.overrides=function(t){var e=this._overrides;for(var i in e){if(e.hasOwnProperty(i)){t.css(i,e[i].value,e[i].priority)}}};t.prototype.fontSize=function(t){this.override("font-size",t)};t.prototype.font=function(t){this.override("font-family",t,true)};t.prototype.destroy=function(){this.rendition=undefined;this._themes=undefined;this._overrides=undefined;this._current=undefined;this._injected=undefined};return t}();var pe=function(){function t(t,e,i,r){this.layout=t;this.horizontal=i==="horizontal"?true:false;this.direction=e||"ltr";this._dev=r}t.prototype.section=function(t){var e=this.findRanges(t);var i=this.rangeListToCfiList(t.section.cfiBase,e);return i};t.prototype.page=function(t,e,i,r){var n=t&&t.document?t.document.body:false;var s;if(!n){return}s=this.rangePairToCfiPair(e,{start:this.findStart(n,i,r),end:this.findEnd(n,i,r)});if(this._dev===true){var o=t.document;var a=new qt(s.start).toRange(o);var h=new qt(s.end).toRange(o);var f=o.defaultView.getSelection();var l=o.createRange();f.removeAllRanges();l.setStart(a.startContainer,a.startOffset);l.setEnd(h.endContainer,h.endOffset);f.addRange(l)}return s};t.prototype.walk=function(t,e){if(t&&t.nodeType===Node.TEXT_NODE){return}var i={acceptNode:function(t){if(t.data.trim().length>0){return NodeFilter.FILTER_ACCEPT}else{return NodeFilter.FILTER_REJECT}}};var r=i.acceptNode;r.acceptNode=i.acceptNode;var n=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,r,false);var s;var o;while(s=n.nextNode()){o=e(s);if(o)break}return o};t.prototype.findRanges=function(t){var e=[];var i=t.contents.scrollWidth();var r=Math.ceil(i/this.layout.spreadWidth);var n=r*this.layout.divisor;var s=this.layout.columnWidth;var o=this.layout.gap;var a,h;for(var f=0;f<n.pages;f++){a=(s+o)*f;h=s*(f+1)+o*f;e.push({start:this.findStart(t.document.body,a,h),end:this.findEnd(t.document.body,a,h)})}return e};t.prototype.findStart=function(t,e,i){var r=this;var n=[t];var s;var o;var a=t;while(n.length){s=n.shift();o=this.walk(s,(function(t){var s,o,h,f;var l;l=nt(t);if(r.horizontal&&r.direction==="ltr"){s=r.horizontal?l.left:l.top;o=r.horizontal?l.right:l.bottom;if(s>=e&&s<=i){return t}else if(o>e){return t}else{a=t;n.push(t)}}else if(r.horizontal&&r.direction==="rtl"){s=l.left;o=l.right;if(o<=i&&o>=e){return t}else if(s<i){return t}else{a=t;n.push(t)}}else{h=l.top;f=l.bottom;if(h>=e&&h<=i){return t}else if(f>e){return t}else{a=t;n.push(t)}}}));if(o){return this.findTextStartRange(o,e,i)}}return this.findTextStartRange(a,e,i)};t.prototype.findEnd=function(t,e,i){var r=this;var n=[t];var s;var o=t;var a;while(n.length){s=n.shift();a=this.walk(s,(function(t){var s,a,h,f;var l;l=nt(t);if(r.horizontal&&r.direction==="ltr"){s=Math.round(l.left);a=Math.round(l.right);if(s>i&&o){return o}else if(a>i){return t}else{o=t;n.push(t)}}else if(r.horizontal&&r.direction==="rtl"){s=Math.round(r.horizontal?l.left:l.top);a=Math.round(r.horizontal?l.right:l.bottom);if(a<e&&o){return o}else if(s<e){return t}else{o=t;n.push(t)}}else{h=Math.round(l.top);f=Math.round(l.bottom);if(h>i&&o){return o}else if(f>i){return t}else{o=t;n.push(t)}}}));if(a){return this.findTextEndRange(a,e,i)}}return this.findTextEndRange(o,e,i)};t.prototype.findTextStartRange=function(t,e,i){var r=this.splitTextNodeIntoRanges(t);var n;var s;var o,a,h;for(var f=0;f<r.length;f++){n=r[f];s=n.getBoundingClientRect();if(this.horizontal&&this.direction==="ltr"){o=s.left;if(o>=e){return n}}else if(this.horizontal&&this.direction==="rtl"){h=s.right;if(h<=i){return n}}else{a=s.top;if(a>=e){return n}}}return r[0]};t.prototype.findTextEndRange=function(t,e,i){var r=this.splitTextNodeIntoRanges(t);var n;var s;var o;var a,h,f,l;for(var u=0;u<r.length;u++){s=r[u];o=s.getBoundingClientRect();if(this.horizontal&&this.direction==="ltr"){a=o.left;h=o.right;if(a>i&&n){return n}else if(h>i){return s}}else if(this.horizontal&&this.direction==="rtl"){a=o.left;h=o.right;if(h<e&&n){return n}else if(a<e){return s}}else{f=o.top;l=o.bottom;if(f>i&&n){return n}else if(l>i){return s}}n=s}return r[r.length-1]};t.prototype.splitTextNodeIntoRanges=function(t,e){var i=[];var r=t.textContent||"";var n=r.trim();var s;var o=t.ownerDocument;var a=e||" ";var h=n.indexOf(a);if(h===-1||t.nodeType!=Node.TEXT_NODE){s=o.createRange();s.selectNodeContents(t);return[s]}s=o.createRange();s.setStart(t,0);s.setEnd(t,h);i.push(s);s=false;while(h!=-1){h=n.indexOf(a,h+1);if(h>0){if(s){s.setEnd(t,h);i.push(s)}s=o.createRange();s.setStart(t,h+1)}}if(s){s.setEnd(t,n.length);i.push(s)}return i};t.prototype.rangePairToCfiPair=function(t,e){var i=e.start;var r=e.end;i.collapse(true);r.collapse(false);var n=new qt(i,t).toString();var s=new qt(r,t).toString();return{start:n,end:s}};t.prototype.rangeListToCfiList=function(t,e){var i=[];var r;for(var n=0;n<e.length;n++){r=this.rangePairToCfiPair(t,e[n]);i.push(r)}return i};t.prototype.axis=function(t){if(t){this.horizontal=t==="horizontal"?true:false}return this.horizontal};return t}();var ve=typeof navigator!=="undefined";var ge=ve&&/Chrome/.test(navigator.userAgent);var me=ve&&!ge&&/AppleWebKit/.test(navigator.userAgent);var ye=1;var we=function(){function t(t,e,i,r){this.epubcfi=new qt;this.document=t;this.documentElement=this.document.documentElement;this.content=e||this.document.body;this.window=this.document.defaultView;this._size={width:0,height:0};this.sectionIndex=r||0;this.cfiBase=i||"";this.epubReadingSystem("epub.js",$t);this.listeners()}Object.defineProperty(t,"listenedEvents",{get:function(){return Qt},enumerable:true,configurable:true});t.prototype.width=function(t){var e=this.content;if(t&&X(t)){t=t+"px"}if(t){e.style.width=t}return this.window.getComputedStyle(e)["width"]};t.prototype.height=function(t){var e=this.content;if(t&&X(t)){t=t+"px"}if(t){e.style.height=t}return this.window.getComputedStyle(e)["height"]};t.prototype.contentWidth=function(t){var e=this.content||this.document.body;if(t&&X(t)){t=t+"px"}if(t){e.style.width=t}return this.window.getComputedStyle(e)["width"]};t.prototype.contentHeight=function(t){var e=this.content||this.document.body;if(t&&X(t)){t=t+"px"}if(t){e.style.height=t}return this.window.getComputedStyle(e)["height"]};t.prototype.textWidth=function(){var t;var e;var i=this.document.createRange();var r=this.content||this.document.body;var n=rt(r);i.selectNodeContents(r);t=i.getBoundingClientRect();e=t.width;if(n&&n.width){e+=n.width}return Math.round(e)};t.prototype.textHeight=function(){var t;var e;var i=this.document.createRange();var r=this.content||this.document.body;var n=rt(r);i.selectNodeContents(r);t=i.getBoundingClientRect();e=t.height;if(e&&n.height){e+=n.height}if(e&&t.top){e+=t.top}return Math.round(e)};t.prototype.scrollWidth=function(){var t=this.documentElement.scrollWidth;return t};t.prototype.scrollHeight=function(){var t=this.documentElement.scrollHeight;return t};t.prototype.overflow=function(t){if(t){this.documentElement.style.overflow=t}return this.window.getComputedStyle(this.documentElement)["overflow"]};t.prototype.overflowX=function(t){if(t){this.documentElement.style.overflowX=t}return this.window.getComputedStyle(this.documentElement)["overflowX"]};t.prototype.overflowY=function(t){if(t){this.documentElement.style.overflowY=t}return this.window.getComputedStyle(this.documentElement)["overflowY"]};t.prototype.css=function(t,e,i){var r=this.content||this.document.body;if(e){r.style.setProperty(t,e,i?"important":"")}else{r.style.removeProperty(t)}return this.window.getComputedStyle(r)[t]};t.prototype.viewport=function(t){var e=this.document.querySelector("meta[name='viewport']");var i={width:undefined,height:undefined,scale:undefined,minimum:undefined,maximum:undefined,scalable:undefined};var r=[];var n={};if(e&&e.hasAttribute("content")){var s=e.getAttribute("content");var o=s.match(/width\s*=\s*([^,]*)/);var a=s.match(/height\s*=\s*([^,]*)/);var h=s.match(/initial-scale\s*=\s*([^,]*)/);var f=s.match(/minimum-scale\s*=\s*([^,]*)/);var l=s.match(/maximum-scale\s*=\s*([^,]*)/);var u=s.match(/user-scalable\s*=\s*([^,]*)/);if(o&&o.length&&typeof o[1]!=="undefined"){i.width=o[1]}if(a&&a.length&&typeof a[1]!=="undefined"){i.height=a[1]}if(h&&h.length&&typeof h[1]!=="undefined"){i.scale=h[1]}if(f&&f.length&&typeof f[1]!=="undefined"){i.minimum=f[1]}if(l&&l.length&&typeof l[1]!=="undefined"){i.maximum=l[1]}if(u&&u.length&&typeof u[1]!=="undefined"){i.scalable=u[1]}}n=J(t||{},i);if(t){if(n.width){r.push("width="+n.width)}if(n.height){r.push("height="+n.height)}if(n.scale){r.push("initial-scale="+n.scale)}if(n.scalable==="no"){r.push("minimum-scale="+n.scale);r.push("maximum-scale="+n.scale);r.push("user-scalable="+n.scalable)}else{if(n.scalable){r.push("user-scalable="+n.scalable)}if(n.minimum){r.push("minimum-scale="+n.minimum)}if(n.maximum){r.push("minimum-scale="+n.maximum)}}if(!e){e=this.document.createElement("meta");e.setAttribute("name","viewport");this.document.querySelector("head").appendChild(e)}e.setAttribute("content",r.join(", "));this.window.scrollTo(0,0)}return n};t.prototype.expand=function(){this.emit(te.CONTENTS.EXPAND)};t.prototype.listeners=function(){this.imageLoadListeners();this.mediaQueryListeners();this.addEventListeners();this.addSelectionListeners();this.resizeListeners();this.linksHandler()};t.prototype.removeListeners=function(){this.removeEventListeners();this.removeSelectionListeners();clearTimeout(this.expanding)};t.prototype.resizeCheck=function(){var t=this.textWidth();var e=this.textHeight();if(t!=this._size.width||e!=this._size.height){this._size={width:t,height:e};this.onResize&&this.onResize(this._size);this.emit(te.CONTENTS.RESIZE,this._size)}};t.prototype.resizeListeners=function(){clearTimeout(this.expanding);requestAnimationFrame(this.resizeCheck.bind(this))};t.prototype.transitionListeners=function(){var t=this.content;t.style["transitionProperty"]="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height";t.style["transitionDuration"]="0.001ms";t.style["transitionTimingFunction"]="linear";t.style["transitionDelay"]="0";this._resizeCheck=this.resizeCheck.bind(this);this.document.addEventListener("transitionend",this._resizeCheck)};t.prototype.mediaQueryListeners=function(){var t=this.document.styleSheets;var e=function(t){if(t.matches&&!this._expanding){setTimeout(this.expand.bind(this),1)}}.bind(this);for(var i=0;i<t.length;i+=1){var r;try{r=t[i].cssRules}catch(o){return}if(!r)return;for(var n=0;n<r.length;n+=1){if(r[n].media){var s=this.window.matchMedia(r[n].media.mediaText);s.addListener(e)}}}};t.prototype.resizeObservers=function(){var t=this;this.observer=new MutationObserver((function(e){t.resizeCheck()}));var e={attributes:true,childList:true,characterData:true,subtree:true};this.observer.observe(this.document,e)};t.prototype.imageLoadListeners=function(){var t=this.document.querySelectorAll("img");var e;for(var i=0;i<t.length;i++){e=t[i];if(typeof e.naturalWidth!=="undefined"&&e.naturalWidth===0){e.onload=this.expand.bind(this)}}};t.prototype.fontLoadListeners=function(){if(!this.document||!this.document.fonts){return}this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))};t.prototype.root=function(){if(!this.document)return null;return this.document.documentElement};t.prototype.locationOf=function(t,e){var i;var r={left:0,top:0};if(!this.document)return r;if(this.epubcfi.isCfiString(t)){var n=new qt(t).toRange(this.document,e);if(n){try{if(!n.endContainer||n.startContainer==n.endContainer&&n.startOffset==n.endOffset){var s=n.startContainer.textContent.indexOf(" ",n.startOffset);if(s==-1){s=n.startContainer.textContent.length}n.setEnd(n.startContainer,s)}}catch(l){console.error("setting end offset to start container length failed",l)}if(n.startContainer.nodeType===Node.ELEMENT_NODE){i=n.startContainer.getBoundingClientRect();r.left=i.left;r.top=i.top}else{if(me){var o=n.startContainer;var a=new Range;try{if(o.nodeType===ye){i=o.getBoundingClientRect()}else if(n.startOffset+2<o.length){a.setStart(o,n.startOffset);a.setEnd(o,n.startOffset+2);i=a.getBoundingClientRect()}else if(n.startOffset-2>0){a.setStart(o,n.startOffset-2);a.setEnd(o,n.startOffset);i=a.getBoundingClientRect()}else{i=o.parentNode.getBoundingClientRect()}}catch(l){console.error(l,l.stack)}}else{i=n.getBoundingClientRect()}}}}else if(typeof t==="string"&&t.indexOf("#")>-1){var h=t.substring(t.indexOf("#")+1);var f=this.document.getElementById(h);if(f){if(me){var a=new Range;a.selectNode(f);i=a.getBoundingClientRect()}else{i=f.getBoundingClientRect()}}}if(i){r.left=i.left;r.top=i.top}return r};t.prototype.addStylesheet=function(t){return new Promise(function(e,i){var r;var n=false;if(!this.document){e(false);return}r=this.document.querySelector("link[href='"+t+"']");if(r){e(true);return}r=this.document.createElement("link");r.type="text/css";r.rel="stylesheet";r.href=t;r.onload=r.onreadystatechange=function(){if(!n&&(!this.readyState||this.readyState=="complete")){n=true;setTimeout((function(){e(true)}),1)}};this.document.head.appendChild(r)}.bind(this))};t.prototype.addStylesheetRules=function(t){var e;var i;var r="epubjs-inserted-css";if(!this.document||!t||t.length===0)return;e=this.document.getElementById("#"+r);if(!e){e=this.document.createElement("style");e.id=r}this.document.head.appendChild(e);i=e.sheet;if(Object.prototype.toString.call(t)==="[object Array]"){for(var n=0,s=t.length;n<s;n++){var o=1,a=t[n],h=t[n][0],f="";if(Object.prototype.toString.call(a[1][0])==="[object Array]"){a=a[1];o=0}for(var l=a.length;o<l;o++){var u=a[o];f+=u[0]+":"+u[1]+(u[2]?" !important":"")+";\n"}i.insertRule(h+"{"+f+"}",i.cssRules.length)}}else{var c=Object.keys(t);c.forEach((function(e){var r=t[e];if(Array.isArray(r)){r.forEach((function(t){var r=Object.keys(t);var n=r.map((function(e){return e+":"+t[e]})).join(";");i.insertRule(e+"{"+n+"}",i.cssRules.length)}))}else{var n=Object.keys(r);var s=n.map((function(t){return t+":"+r[t]})).join(";");i.insertRule(e+"{"+s+"}",i.cssRules.length)}}))}};t.prototype.addScript=function(t){return new Promise(function(e,i){var r;var n=false;if(!this.document){e(false);return}r=this.document.createElement("script");r.type="text/javascript";r.async=true;r.src=t;r.onload=r.onreadystatechange=function(){if(!n&&(!this.readyState||this.readyState=="complete")){n=true;setTimeout((function(){e(true)}),1)}};this.document.head.appendChild(r)}.bind(this))};t.prototype.addClass=function(t){var e;if(!this.document)return;e=this.content||this.document.body;if(e){e.classList.add(t)}};t.prototype.removeClass=function(t){var e;if(!this.document)return;e=this.content||this.document.body;if(e){e.classList.remove(t)}};t.prototype.addEventListeners=function(){if(!this.document){return}this._triggerEvent=this.triggerEvent.bind(this);Qt.forEach((function(t){this.document.addEventListener(t,this._triggerEvent,{passive:true})}),this)};t.prototype.removeEventListeners=function(){if(!this.document){return}Qt.forEach((function(t){this.document.removeEventListener(t,this._triggerEvent,{passive:true})}),this);this._triggerEvent=undefined};t.prototype.triggerEvent=function(t){this.emit(t.type,t)};t.prototype.addSelectionListeners=function(){if(!this.document){return}this._onSelectionChange=this.onSelectionChange.bind(this);this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:true})};t.prototype.removeSelectionListeners=function(){if(!this.document){return}this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:true});this._onSelectionChange=undefined};t.prototype.onSelectionChange=function(t){if(this.selectionEndTimeout){clearTimeout(this.selectionEndTimeout)}this.selectionEndTimeout=setTimeout(function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}.bind(this),250)};t.prototype.triggerSelectedEvent=function(t){var e,i;if(t&&t.rangeCount>0){e=t.getRangeAt(0);if(!e.collapsed){i=new qt(e,this.cfiBase).toString();this.emit(te.CONTENTS.SELECTED,i);this.emit(te.CONTENTS.SELECTED_RANGE,e)}}};t.prototype.range=function(t,e){var i=new qt(t);return i.toRange(this.document,e)};t.prototype.cfiFromRange=function(t,e){return new qt(t,this.cfiBase,e).toString()};t.prototype.cfiFromNode=function(t,e){return new qt(t,this.cfiBase,e).toString()};t.prototype.map=function(t){var e=new pe(t);return e.section()};t.prototype.size=function(t,e){var i={scale:1,scalable:"no"};this.layoutStyle("scrolling");if(t>=0){this.width(t);i.width=t;this.css("padding","0 "+t/12+"px")}if(e>=0){this.height(e);i.height=e}this.css("margin","0");this.css("box-sizing","border-box");this.viewport(i)};t.prototype.columns=function(t,e,i,r){var n=G("column-axis");var s=G("column-gap");var o=G("column-width");var a=G("column-fill");var h=this.writingMode();var f=h.indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated");if(this.content.dir==="rtl"){this.direction("rtl")}this.width(t);this.height(e);this.viewport({width:t,height:e,scale:1,scalable:"no"});this.css("overflow-y","hidden");this.css("margin","0",true);if(f==="vertical"){this.css("padding-top",r/2+"px",true);this.css("padding-bottom",r/2+"px",true);this.css("padding-left","20px");this.css("padding-right","20px")}else{this.css("padding-top","20px");this.css("padding-bottom","20px");this.css("padding-left",r/2+"px",true);this.css("padding-right",r/2+"px",true)}this.css("box-sizing","border-box");this.css("max-width","inherit");this.css(n,"horizontal");this.css(a,"auto");this.css(s,r+"px");this.css(o,i+"px");this.css("-webkit-line-box-contain","block glyphs replaced")};t.prototype.scaler=function(t,e,i){var r="scale("+t+")";var n="";this.css("transform-origin","top left");if(e>=0||i>=0){n=" translate("+(e||0)+"px, "+(i||0)+"px )"}this.css("transform",r+n)};t.prototype.fit=function(t,e){var i=this.viewport();var r=parseInt(i.width);var n=parseInt(i.height);var s=t/r;var o=e/n;var a=s<o?s:o;this.layoutStyle("paginated");this.width(r);this.height(n);this.overflow("hidden");this.scaler(a,0,0);this.css("background-size",r*a+"px "+n*a+"px");this.css("background-color","transparent")};t.prototype.direction=function(t){if(this.documentElement){this.documentElement.style["direction"]=t}};t.prototype.mapPage=function(t,e,i,r,n){var s=new pe(e,n);return s.page(this,t,i,r)};t.prototype.linksHandler=function(){var t=this;Vt(this.content,(function(e){t.emit(te.CONTENTS.LINK_CLICKED,e)}))};t.prototype.writingMode=function(t){var e=G("writing-mode");if(t&&this.documentElement){this.documentElement.style[e]=t}return this.window.getComputedStyle(this.documentElement)[e]||""};t.prototype.layoutStyle=function(t){if(t){this._layoutStyle=t;navigator.epubReadingSystem.layoutStyle=this._layoutStyle}return this._layoutStyle||"paginated"};t.prototype.epubReadingSystem=function(t,e){navigator.epubReadingSystem={name:t,version:e,layoutStyle:this.layoutStyle(),hasFeature:function(t){switch(t){case"dom-manipulation":return true;case"layout-changes":return true;case"touch-events":return true;case"mouse-events":return true;case"keyboard-events":return true;case"spine-scripting":return false;default:return false}}};return navigator.epubReadingSystem};t.prototype.destroy=function(){if(this.observer){this.observer.disconnect()}this.document.removeEventListener("transitionend",this._resizeCheck);this.removeListeners()};return t}();M(we.prototype);var be=function(){function t(t){this.rendition=t;this.highlights=[];this.underlines=[];this.marks=[];this._annotations={};this._annotationsBySectionIndex={};this.rendition.hooks.render.register(this.inject.bind(this));this.rendition.hooks.unloaded.register(this.clear.bind(this))}t.prototype.add=function(t,e,i,r,n,s){var o=encodeURI(e+t);var a=new qt(e);var h=a.spinePos;var f=new _e({type:t,cfiRange:e,data:i,sectionIndex:h,cb:r,className:n,styles:s});this._annotations[o]=f;if(h in this._annotationsBySectionIndex){this._annotationsBySectionIndex[h].push(o)}else{this._annotationsBySectionIndex[h]=[o]}var l=this.rendition.views();l.forEach((function(t){if(f.sectionIndex===t.index){f.attach(t)}}));return f};t.prototype.remove=function(t,e){var i=this;var r=encodeURI(t+e);if(r in this._annotations){var n=this._annotations[r];if(e&&n.type!==e){return}var s=this.rendition.views();s.forEach((function(t){i._removeFromAnnotationBySectionIndex(n.sectionIndex,r);if(n.sectionIndex===t.index){n.detach(t)}}));delete this._annotations[r]}};t.prototype._removeFromAnnotationBySectionIndex=function(t,e){this._annotationsBySectionIndex[t]=this._annotationsAt(t).filter((function(t){return t!==e}))};t.prototype._annotationsAt=function(t){return this._annotationsBySectionIndex[t]};t.prototype.highlight=function(t,e,i,r,n){return this.add("highlight",t,e,i,r,n)};t.prototype.underline=function(t,e,i,r,n){return this.add("underline",t,e,i,r,n)};t.prototype.mark=function(t,e,i){return this.add("mark",t,e,i)};t.prototype.each=function(){return this._annotations.forEach.apply(this._annotations,arguments)};t.prototype.inject=function(t){var e=this;var i=t.index;if(i in this._annotationsBySectionIndex){var r=this._annotationsBySectionIndex[i];r.forEach((function(i){var r=e._annotations[i];r.attach(t)}))}};t.prototype.clear=function(t){var e=this;var i=t.index;if(i in this._annotationsBySectionIndex){var r=this._annotationsBySectionIndex[i];r.forEach((function(i){var r=e._annotations[i];r.detach(t)}))}};t.prototype.show=function(){};t.prototype.hide=function(){};return t}();var _e=function(){function t(t){var e=t.type,i=t.cfiRange,r=t.data,n=t.sectionIndex,s=t.cb,o=t.className,a=t.styles;this.type=e;this.cfiRange=i;this.data=r;this.sectionIndex=n;this.mark=undefined;this.cb=s;this.className=o;this.styles=a}t.prototype.update=function(t){this.data=t};t.prototype.attach=function(t){var e=this,i=e.cfiRange,r=e.data,n=e.type,s=e.mark,o=e.cb,a=e.className,h=e.styles;var f;if(n==="highlight"){f=t.highlight(i,r,o,a,h)}else if(n==="underline"){f=t.underline(i,r,o,a,h)}else if(n==="mark"){f=t.mark(i,r,o)}this.mark=f;this.emit(te.ANNOTATION.ATTACH,f);return f};t.prototype.detach=function(t){var e=this,i=e.cfiRange,r=e.type;var n;if(t){if(r==="highlight"){n=t.unhighlight(i)}else if(r==="underline"){n=t.ununderline(i)}else if(r==="mark"){n=t.unmark(i)}}this.mark=undefined;this.emit(te.ANNOTATION.DETACH,n);return n};t.prototype.text=function(){};return t}();M(_e.prototype);var xe=a((function(t,e){Object.defineProperty(e,"__esModule",{value:true});e.createElement=i;function i(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}e.default={createElement:i}}));o(xe);var ke=a((function(t,e){Object.defineProperty(e,"__esModule",{value:true});e.proxyMouse=i;e.clone=r;e.default={proxyMouse:i};function i(t,e){function i(i){for(var s=e.length-1;s>=0;s--){var o=e[s];var a=i.clientX;var h=i.clientY;if(i.touches&&i.touches.length){a=i.touches[0].clientX;h=i.touches[0].clientY}if(!n(o,t,a,h)){continue}o.dispatchEvent(r(i));break}}if(t.nodeName==="iframe"||t.nodeName==="IFRAME"){try{this.target=t.contentDocument}catch(nl){this.target=t}}else{this.target=t}var s=["mouseup","mousedown","click","touchstart"];for(var o=0;o<s.length;o++){var a=s[o];this.target.addEventListener(a,(function(t){return i(t)}),false)}}function r(t){var e=Object.assign({},t,{bubbles:false});try{return new MouseEvent(t.type,e)}catch(nl){var i=document.createEvent("MouseEvents");i.initMouseEvent(t.type,false,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget);return i}}function n(t,e,i,r){var n=e.getBoundingClientRect();function s(t,e,i){var r=t.top-n.top;var s=t.left-n.left;var o=r+t.height;var a=s+t.width;return r<=i&&s<=e&&o>i&&a>e}var o=t.getBoundingClientRect();if(!s(o,i,r)){return false}var a=t.getClientRects();for(var h=0,f=a.length;h<f;h++){if(s(a[h],i,r)){return true}}return false}}));o(ke);var Ee=a((function(t,e){Object.defineProperty(e,"__esModule",{value:true});e.Underline=e.Highlight=e.Mark=e.Pane=undefined;var i=function t(e,i,r){if(e===null)e=Function.prototype;var n=Object.getOwnPropertyDescriptor(e,i);if(n===undefined){var s=Object.getPrototypeOf(e);if(s===null){return undefined}else{return t(s,i,r)}}else if("value"in n){return n.value}else{var o=n.get;if(o===undefined){return undefined}return o.call(r)}};var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(t,r.key,r)}}return function(e,i,r){if(i)t(e.prototype,i);if(r)t(e,r);return e}}();var n=o(xe);var s=o(ke);function o(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!t){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e&&(typeof e==="object"||typeof e==="function")?e:t}function h(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof e)}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}});if(e)Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e}function f(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}var l=e.Pane=function(){function t(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:document.body;f(this,t);this.target=e;this.element=n.default.createElement("svg");this.marks=[];this.element.style.position="absolute";this.element.setAttribute("pointer-events","none");s.default.proxyMouse(this.target,this.marks);this.container=i;this.container.appendChild(this.element);this.render()}r(t,[{key:"addMark",value:function t(e){var i=n.default.createElement("g");this.element.appendChild(i);e.bind(i,this.container);this.marks.push(e);e.render();return e}},{key:"removeMark",value:function t(e){var i=this.marks.indexOf(e);if(i===-1){return}var r=e.unbind();this.element.removeChild(r);this.marks.splice(i,1)}},{key:"render",value:function t(){v(this.element,p(this.target,this.container));var e=true;var i=false;var r=undefined;try{for(var n=this.marks[Symbol.iterator](),s;!(e=(s=n.next()).done);e=true){var o=s.value;o.render()}}catch(nl){i=true;r=nl}finally{try{if(!e&&n.return){n.return()}}finally{if(i){throw r}}}}}]);return t}();var u=e.Mark=function(){function t(){f(this,t);this.element=null}r(t,[{key:"bind",value:function t(e,i){this.element=e;this.container=i}},{key:"unbind",value:function t(){var e=this.element;this.element=null;return e}},{key:"render",value:function t(){}},{key:"dispatchEvent",value:function t(e){if(!this.element)return;this.element.dispatchEvent(e)}},{key:"getBoundingClientRect",value:function t(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function t(){var e=[];var i=this.element.firstChild;while(i){e.push(i.getBoundingClientRect());i=i.nextSibling}return e}},{key:"filteredRanges",value:function t(){var e=Array.from(this.range.getClientRects());return e.filter((function(t){for(var i=0;i<e.length;i++){if(e[i]===t){return true}var r=g(e[i],t);if(r){return false}}return true}))}}]);return t}();var c=e.Highlight=function(t){h(e,t);function e(t,i,r,n){f(this,e);var s=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));s.range=t;s.className=i;s.data=r||{};s.attributes=n||{};return s}r(e,[{key:"bind",value:function t(r,n){i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,r,n);for(var s in this.data){if(this.data.hasOwnProperty(s)){this.element.dataset[s]=this.data[s]}}for(var s in this.attributes){if(this.attributes.hasOwnProperty(s)){this.element.setAttribute(s,this.attributes[s])}}if(this.className){this.element.classList.add(this.className)}}},{key:"render",value:function t(){while(this.element.firstChild){this.element.removeChild(this.element.firstChild)}var e=this.element.ownerDocument.createDocumentFragment();var i=this.filteredRanges();var r=this.element.getBoundingClientRect();var s=this.container.getBoundingClientRect();for(var o=0,a=i.length;o<a;o++){var h=i[o];var f=n.default.createElement("rect");f.setAttribute("x",h.left-r.left+s.left);f.setAttribute("y",h.top-r.top+s.top);f.setAttribute("height",h.height);f.setAttribute("width",h.width);e.appendChild(f)}this.element.appendChild(e)}}]);return e}(u);var d=e.Underline=function(t){h(e,t);function e(t,i,r,n){f(this,e);return a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,r,n))}r(e,[{key:"render",value:function t(){while(this.element.firstChild){this.element.removeChild(this.element.firstChild)}var e=this.element.ownerDocument.createDocumentFragment();var i=this.filteredRanges();var r=this.element.getBoundingClientRect();var s=this.container.getBoundingClientRect();for(var o=0,a=i.length;o<a;o++){var h=i[o];var f=n.default.createElement("rect");f.setAttribute("x",h.left-r.left+s.left);f.setAttribute("y",h.top-r.top+s.top);f.setAttribute("height",h.height);f.setAttribute("width",h.width);f.setAttribute("fill","none");var l=n.default.createElement("line");l.setAttribute("x1",h.left-r.left+s.left);l.setAttribute("x2",h.left-r.left+s.left+h.width);l.setAttribute("y1",h.top-r.top+s.top+h.height-1);l.setAttribute("y2",h.top-r.top+s.top+h.height-1);l.setAttribute("stroke-width",1);l.setAttribute("stroke","black");l.setAttribute("stroke-linecap","square");e.appendChild(f);e.appendChild(l)}this.element.appendChild(e)}}]);return e}(c);function p(t,e){var i=e.getBoundingClientRect();var r=t.getBoundingClientRect();return{top:r.top-i.top,left:r.left-i.left,height:t.scrollHeight,width:t.scrollWidth}}function v(t,e){t.style.setProperty("top",e.top+"px","important");t.style.setProperty("left",e.left+"px","important");t.style.setProperty("height",e.height+"px","important");t.style.setProperty("width",e.width+"px","important")}function g(t,e){return e.right<=t.right&&e.left>=t.left&&e.top>=t.top&&e.bottom<=t.bottom}}));o(Ee);var Se=Ee.Underline;var Ce=Ee.Highlight;var Re=Ee.Pane;var Te=function(){function t(t,e){this.settings=$({ignoreClass:"",axis:e.layout&&e.layout.props.flow==="scrolled"?"vertical":"horizontal",direction:undefined,width:0,height:0,layout:undefined,globalLayoutProperties:{},method:undefined},e||{});this.id="epubjs-view-"+Y();this.section=t;this.index=t.index;this.element=this.container(this.settings.axis);this.added=false;this.displayed=false;this.rendered=false;this.fixedWidth=0;this.fixedHeight=0;this.epubcfi=new qt;this.layout=this.settings.layout;this.pane=undefined;this.highlights={};this.underlines={};this.marks={}}t.prototype.container=function(t){var e=document.createElement("div");e.classList.add("epub-view");e.style.height="0px";e.style.width="0px";e.style.overflow="hidden";e.style.position="relative";e.style.display="block";if(t&&t=="horizontal"){e.style.flex="none"}else{e.style.flex="initial"}return e};t.prototype.create=function(){if(this.iframe){return this.iframe}if(!this.element){this.element=this.createContainer()}this.iframe=document.createElement("iframe");this.iframe.id=this.id;this.iframe.scrolling="no";this.iframe.style.overflow="hidden";this.iframe.seamless="seamless";this.iframe.style.border="none";this.iframe.setAttribute("enable-annotation","true");this.resizing=true;this.element.style.visibility="hidden";this.iframe.style.visibility="hidden";this.iframe.style.width="0";this.iframe.style.height="0";this._width=0;this._height=0;this.element.setAttribute("ref",this.index);this.added=true;this.elementBounds=it(this.element);if("srcdoc"in this.iframe){this.supportsSrcdoc=true}else{this.supportsSrcdoc=false}if(!this.settings.method){this.settings.method=this.supportsSrcdoc?"srcdoc":"write"}return this.iframe};t.prototype.render=function(t,e){this.create();this.size();if(!this.sectionRender){this.sectionRender=this.section.render(t)}return this.sectionRender.then(function(t){return this.load(t)}.bind(this)).then(function(){var t=this;this.layout.format(this.contents);var e=this.contents.writingMode();var i=e.indexOf("vertical")===0?"vertical":"horizontal";this.setAxis(i);this.emit(te.VIEWS.AXIS,i);this.addListeners();return new Promise((function(e,i){t.expand();e()}))}.bind(this),function(t){this.emit(te.VIEWS.LOAD_ERROR,t);return new Promise((function(e,i){i(t)}))}.bind(this)).then(function(){this.emit(te.VIEWS.RENDERED,this.section)}.bind(this))};t.prototype.reset=function(){if(this.iframe){this.iframe.style.width="0";this.iframe.style.height="0";this._width=0;this._height=0;this._textWidth=undefined;this._contentWidth=undefined;this._textHeight=undefined;this._contentHeight=undefined}this._needsReframe=true};t.prototype.size=function(t,e){var i=t||this.settings.width;var r=e||this.settings.height;if(this.layout.name==="pre-paginated"){this.lock("both",i,r)}else if(this.settings.axis==="horizontal"){this.lock("height",i,r)}else{this.lock("width",i,r)}this.settings.width=i;this.settings.height=r};t.prototype.lock=function(t,e,i){var r=rt(this.element);var n;if(this.iframe){n=rt(this.iframe)}else{n={width:0,height:0}}if(t=="width"&&X(e)){this.lockedWidth=e-r.width-n.width}if(t=="height"&&X(i)){this.lockedHeight=i-r.height-n.height}if(t==="both"&&X(e)&&X(i)){this.lockedWidth=e-r.width-n.width;this.lockedHeight=i-r.height-n.height}if(this.displayed&&this.iframe){this.expand()}};t.prototype.expand=function(t){var e=this.lockedWidth;var i=this.lockedHeight;var r;if(!this.iframe||this._expanding)return;this._expanding=true;if(this.layout.name==="pre-paginated"){e=this.layout.columnWidth;i=this.layout.height}else if(this.settings.axis==="horizontal"){e=this.contents.textWidth();if(e%this.layout.pageWidth>0){e=Math.ceil(e/this.layout.pageWidth)*this.layout.pageWidth}if(this.settings.forceEvenPages){r=e/this.layout.pageWidth;if(this.layout.divisor>1&&this.layout.name==="reflowable"&&r%2>0){e+=this.layout.pageWidth}}}else if(this.settings.axis==="vertical"){i=this.contents.textHeight()}if(this._needsReframe||e!=this._width||i!=this._height){this.reframe(e,i)}this._expanding=false};t.prototype.reframe=function(t,e){var i=this;var r;if(X(t)){this.element.style.width=t+"px";this.iframe.style.width=t+"px";this._width=t}if(X(e)){this.element.style.height=e+"px";this.iframe.style.height=e+"px";this._height=e}var n=this.prevBounds?t-this.prevBounds.width:t;var s=this.prevBounds?e-this.prevBounds.height:e;r={width:t,height:e,widthDelta:n,heightDelta:s};this.pane&&this.pane.render();requestAnimationFrame((function(){var t;for(var e in i.marks){if(i.marks.hasOwnProperty(e)){t=i.marks[e];i.placeMark(t.element,t.range)}}}));this.onResize(this,r);this.emit(te.VIEWS.RESIZED,r);this.prevBounds=r;this.elementBounds=it(this.element)};t.prototype.load=function(t){var e=new kt;var i=e.promise;if(!this.iframe){e.reject(new Error("No Iframe Available"));return i}this.iframe.onload=function(t){this.onLoad(t,e)}.bind(this);if(this.settings.method==="blobUrl"){this.blobUrl=ut(t,"application/xhtml+xml");this.iframe.src=this.blobUrl;this.element.appendChild(this.iframe)}else if(this.settings.method==="srcdoc"){this.iframe.srcdoc=t;this.element.appendChild(this.iframe)}else{this.element.appendChild(this.iframe);this.document=this.iframe.contentDocument;if(!this.document){e.reject(new Error("No Document Available"));return i}this.iframe.contentDocument.open();if(window.MSApp&&MSApp.execUnsafeLocalFunction){var r=this;MSApp.execUnsafeLocalFunction((function(){r.iframe.contentDocument.write(t)}))}else{this.iframe.contentDocument.write(t)}this.iframe.contentDocument.close()}return i};t.prototype.onLoad=function(t,e){var i=this;this.window=this.iframe.contentWindow;this.document=this.iframe.contentDocument;this.contents=new we(this.document,this.document.body,this.section.cfiBase,this.section.index);this.rendering=false;var r=this.document.querySelector("link[rel='canonical']");if(r){r.setAttribute("href",this.section.canonical)}else{r=this.document.createElement("link");r.setAttribute("rel","canonical");r.setAttribute("href",this.section.canonical);this.document.querySelector("head").appendChild(r)}this.contents.on(te.CONTENTS.EXPAND,(function(){if(i.displayed&&i.iframe){i.expand();if(i.contents){i.layout.format(i.contents)}}}));this.contents.on(te.CONTENTS.RESIZE,(function(t){if(i.displayed&&i.iframe){i.expand();if(i.contents){i.layout.format(i.contents)}}}));e.resolve(this.contents)};t.prototype.setLayout=function(t){this.layout=t;if(this.contents){this.layout.format(this.contents);this.expand()}};t.prototype.setAxis=function(t){if(this.layout.props.flow==="scrolled"){t="vertical"}this.settings.axis=t;if(t=="horizontal"){this.element.style.flex="none"}else{this.element.style.flex="initial"}this.size()};t.prototype.addListeners=function(){};t.prototype.removeListeners=function(t){};t.prototype.display=function(t){var e=new kt;if(!this.displayed){this.render(t).then(function(){this.emit(te.VIEWS.DISPLAYED,this);this.onDisplayed(this);this.displayed=true;e.resolve(this)}.bind(this),(function(t){e.reject(t,this)}))}else{e.resolve(this)}return e.promise};t.prototype.show=function(){this.element.style.visibility="visible";if(this.iframe){this.iframe.style.visibility="visible";this.iframe.style.transform="translateZ(0)";this.iframe.style.transform=null}this.emit(te.VIEWS.SHOWN,this)};t.prototype.hide=function(){this.element.style.visibility="hidden";this.iframe.style.visibility="hidden";this.stopExpanding=true;this.emit(te.VIEWS.HIDDEN,this)};t.prototype.offset=function(){return{top:this.element.offsetTop,left:this.element.offsetLeft}};t.prototype.width=function(){return this._width};t.prototype.height=function(){return this._height};t.prototype.position=function(){return this.element.getBoundingClientRect()};t.prototype.locationOf=function(t){var e=this.iframe.getBoundingClientRect();var i=this.contents.locationOf(t,this.settings.ignoreClass);return{left:i.left,top:i.top}};t.prototype.onDisplayed=function(t){};t.prototype.onResize=function(t,e){};t.prototype.bounds=function(t){if(t||!this.elementBounds){this.elementBounds=it(this.element)}return this.elementBounds};t.prototype.highlight=function(t,e,i,r,n){var s=this;if(e===void 0){e={}}if(r===void 0){r="epubjs-hl"}if(n===void 0){n={}}if(!this.contents){return}var o=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},n);var a=this.contents.range(t);var h=function(){s.emit(te.VIEWS.MARK_CLICKED,t,e)};e["epubcfi"]=t;if(!this.pane){this.pane=new Re(this.iframe,this.element)}var f=new Ce(a,r,e,o);var l=this.pane.addMark(f);this.highlights[t]={mark:l,element:l.element,listeners:[h,i]};l.element.setAttribute("ref",r);l.element.addEventListener("click",h);l.element.addEventListener("touchstart",h);if(i){l.element.addEventListener("click",i);l.element.addEventListener("touchstart",i)}return l};t.prototype.underline=function(t,e,i,r,n){var s=this;if(e===void 0){e={}}if(r===void 0){r="epubjs-ul"}if(n===void 0){n={}}if(!this.contents){return}var o=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},n);var a=this.contents.range(t);var h=function(){s.emit(te.VIEWS.MARK_CLICKED,t,e)};e["epubcfi"]=t;if(!this.pane){this.pane=new Re(this.iframe,this.element)}var f=new Se(a,r,e,o);var l=this.pane.addMark(f);this.underlines[t]={mark:l,element:l.element,listeners:[h,i]};l.element.setAttribute("ref",r);l.element.addEventListener("click",h);l.element.addEventListener("touchstart",h);if(i){l.element.addEventListener("click",i);l.element.addEventListener("touchstart",i)}return l};t.prototype.mark=function(t,e,i){var r=this;if(e===void 0){e={}}if(!this.contents){return}if(t in this.marks){var n=this.marks[t];return n}var s=this.contents.range(t);if(!s){return}var o=s.commonAncestorContainer;var a=o.nodeType===1?o:o.parentNode;var h=function(i){r.emit(te.VIEWS.MARK_CLICKED,t,e)};if(s.collapsed&&o.nodeType===1){s=new Range;s.selectNodeContents(o)}else if(s.collapsed){s=new Range;s.selectNodeContents(a)}var f=this.document.createElement("a");f.setAttribute("ref","epubjs-mk");f.style.position="absolute";f.dataset["epubcfi"]=t;if(e){Object.keys(e).forEach((function(t){f.dataset[t]=e[t]}))}if(i){f.addEventListener("click",i);f.addEventListener("touchstart",i)}f.addEventListener("click",h);f.addEventListener("touchstart",h);this.placeMark(f,s);this.element.appendChild(f);this.marks[t]={element:f,range:s,listeners:[h,i]};return a};t.prototype.placeMark=function(t,e){var i,r,n;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){var s=e.getBoundingClientRect();i=s.top;r=s.right}else{var o=e.getClientRects();var a=void 0;for(var h=0;h!=o.length;h++){a=o[h];if(!n||a.left<n){n=a.left;r=Math.ceil(n/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2;i=a.top}}}t.style.top=i+"px";t.style.left=r+"px"};t.prototype.unhighlight=function(t){var e;if(t in this.highlights){e=this.highlights[t];this.pane.removeMark(e.mark);e.listeners.forEach((function(t){if(t){e.element.removeEventListener("click",t);e.element.removeEventListener("touchstart",t)}}));delete this.highlights[t]}};t.prototype.ununderline=function(t){var e;if(t in this.underlines){e=this.underlines[t];this.pane.removeMark(e.mark);e.listeners.forEach((function(t){if(t){e.element.removeEventListener("click",t);e.element.removeEventListener("touchstart",t)}}));delete this.underlines[t]}};t.prototype.unmark=function(t){var e;if(t in this.marks){e=this.marks[t];this.element.removeChild(e.element);e.listeners.forEach((function(t){if(t){e.element.removeEventListener("click",t);e.element.removeEventListener("touchstart",t)}}));delete this.marks[t]}};t.prototype.destroy=function(){for(var t in this.highlights){this.unhighlight(t)}for(var t in this.underlines){this.ununderline(t)}for(var t in this.marks){this.unmark(t)}if(this.blobUrl){ct(this.blobUrl)}if(this.displayed){this.displayed=false;this.removeListeners();this.contents.destroy();this.stopExpanding=true;this.element.removeChild(this.iframe);this.iframe=undefined;this.contents=undefined;this._textWidth=null;this._textHeight=null;this._width=null;this._height=null}};return t}();M(Te.prototype);function Ae(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Oe=Ae;var Le=typeof s=="object"&&s&&s.Object===Object&&s;var Ie=Le;var ze=typeof self=="object"&&self&&self.Object===Object&&self;var Pe=Ie||ze||Function("return this")();var Ne=Pe;var Be=function(){return Ne.Date.now()};var De=Be;var je=Ne.Symbol;var Ue=je;var Me=Object.prototype;var Fe=Me.hasOwnProperty;var qe=Me.toString;var We=Ue?Ue.toStringTag:undefined;function He(t){var e=Fe.call(t,We),i=t[We];try{t[We]=undefined;var r=true}catch(s){}var n=qe.call(t);if(r){if(e){t[We]=i}else{delete t[We]}}return n}var Ye=He;var Ze=Object.prototype;var Ve=Ze.toString;function Xe(t){return Ve.call(t)}var Ke=Xe;var Ge="[object Null]",Je="[object Undefined]";var $e=Ue?Ue.toStringTag:undefined;function Qe(t){if(t==null){return t===undefined?Je:Ge}return $e&&$e in Object(t)?Ye(t):Ke(t)}var ti=Qe;function ei(t){return t!=null&&typeof t=="object"}var ii=ei;var ri="[object Symbol]";function ni(t){return typeof t=="symbol"||ii(t)&&ti(t)==ri}var si=ni;var oi=0/0;var ai=/^\s+|\s+$/g;var hi=/^[-+]0x[0-9a-f]+$/i;var fi=/^0b[01]+$/i;var li=/^0o[0-7]+$/i;var ui=parseInt;function ci(t){if(typeof t=="number"){return t}if(si(t)){return oi}if(Oe(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Oe(e)?e+"":e}if(typeof t!="string"){return t===0?t:+t}t=t.replace(ai,"");var i=fi.test(t);return i||li.test(t)?ui(t.slice(2),i?2:8):hi.test(t)?oi:+t}var di=ci;var pi="Expected a function";var vi=Math.max,gi=Math.min;function mi(t,e,i){var r,n,s,o,a,h,f=0,l=false,u=false,c=true;if(typeof t!="function"){throw new TypeError(pi)}e=di(e)||0;if(Oe(i)){l=!!i.leading;u="maxWait"in i;s=u?vi(di(i.maxWait)||0,e):s;c="trailing"in i?!!i.trailing:c}function d(e){var i=r,s=n;r=n=undefined;f=e;o=t.apply(s,i);return o}function p(t){f=t;a=setTimeout(m,e);return l?d(t):o}function v(t){var i=t-h,r=t-f,n=e-i;return u?gi(n,s-r):n}function g(t){var i=t-h,r=t-f;return h===undefined||i>=e||i<0||u&&r>=s}function m(){var t=De();if(g(t)){return y(t)}a=setTimeout(m,v(t))}function y(t){a=undefined;if(c&&r){return d(t)}r=n=undefined;return o}function w(){if(a!==undefined){clearTimeout(a)}f=0;r=h=n=a=undefined}function b(){return a===undefined?o:y(De())}function _(){var t=De(),i=g(t);r=arguments;n=this;h=t;if(i){if(a===undefined){return p(h)}if(u){clearTimeout(a);a=setTimeout(m,e);return d(h)}}if(a===undefined){a=setTimeout(m,e)}return o}_.cancel=w;_.flush=b;return _}var yi=mi;var wi="Expected a function";function bi(t,e,i){var r=true,n=true;if(typeof t!="function"){throw new TypeError(wi)}if(Oe(i)){r="leading"in i?!!i.leading:r;n="trailing"in i?!!i.trailing:n}return yi(t,e,{leading:r,maxWait:e,trailing:n})}var _i=bi;var xi=function(){function t(t){this.settings=t||{};this.id="epubjs-container-"+Y();this.container=this.create(this.settings);if(this.settings.hidden){this.wrapper=this.wrap(this.container)}}t.prototype.create=function(t){var e=t.height;var i=t.width;var r=t.overflow||false;var n=t.axis||"vertical";var s=t.direction;$(this.settings,t);if(t.height&&X(t.height)){e=t.height+"px"}if(t.width&&X(t.width)){i=t.width+"px"}var o=document.createElement("div");o.id=this.id;o.classList.add("epub-container");o.style.wordSpacing="0";o.style.lineHeight="0";o.style.verticalAlign="top";o.style.position="relative";if(n==="horizontal"){o.style.display="flex";o.style.flexDirection="row";o.style.flexWrap="nowrap"}if(i){o.style.width=i}if(e){o.style.height=e}if(r){if(r==="scroll"&&n==="vertical"){o.style["overflow-y"]=r;o.style["overflow-x"]="hidden"}else if(r==="scroll"&&n==="horizontal"){o.style["overflow-y"]="hidden";o.style["overflow-x"]=r}else{o.style["overflow"]=r}}if(s){o.dir=s;o.style["direction"]=s}if(s&&this.settings.fullsize){document.body.style["direction"]=s}return o};t.prototype.wrap=function(t){var e=document.createElement("div");e.style.visibility="hidden";e.style.overflow="hidden";e.style.width="0";e.style.height="0";e.appendChild(t);return e};t.prototype.getElement=function(t){var e;if(V(t)){e=t}else if(typeof t==="string"){e=document.getElementById(t)}if(!e){throw new Error("Not an Element")}return e};t.prototype.attachTo=function(t){var e=this.getElement(t);var i;if(!e){return}if(this.settings.hidden){i=this.wrapper}else{i=this.container}e.appendChild(i);this.element=e;return e};t.prototype.getContainer=function(){return this.container};t.prototype.onResize=function(t){if(!X(this.settings.width)||!X(this.settings.height)){this.resizeFunc=_i(t,50);window.addEventListener("resize",this.resizeFunc,false)}};t.prototype.onOrientationChange=function(t){this.orientationChangeFunc=t;window.addEventListener("orientationchange",this.orientationChangeFunc,false)};t.prototype.size=function(t,e){var i;var r=t||this.settings.width;var n=e||this.settings.height;if(t===null){i=this.element.getBoundingClientRect();if(i.width){t=Math.floor(i.width);this.container.style.width=t+"px"}}else{if(X(t)){this.container.style.width=t+"px"}else{this.container.style.width=t}}if(e===null){i=i||this.element.getBoundingClientRect();if(i.height){e=i.height;this.container.style.height=e+"px"}}else{if(X(e)){this.container.style.height=e+"px"}else{this.container.style.height=e}}if(!X(t)){t=this.container.clientWidth}if(!X(e)){e=this.container.clientHeight}this.containerStyles=window.getComputedStyle(this.container);this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};var s=st();var o=window.getComputedStyle(document.body);var a={left:parseFloat(o["padding-left"])||0,right:parseFloat(o["padding-right"])||0,top:parseFloat(o["padding-top"])||0,bottom:parseFloat(o["padding-bottom"])||0};if(!r){t=s.width-a.left-a.right}if(this.settings.fullsize&&!n||!n){e=s.height-a.top-a.bottom}return{width:t-this.containerPadding.left-this.containerPadding.right,height:e-this.containerPadding.top-this.containerPadding.bottom}};t.prototype.bounds=function(){var t;if(this.container.style.overflow!=="visible"){t=this.container&&this.container.getBoundingClientRect()}if(!t||!t.width||!t.height){return st()}else{return t}};t.prototype.getSheet=function(){var t=document.createElement("style");t.appendChild(document.createTextNode(""));document.head.appendChild(t);return t.sheet};t.prototype.addStyleRules=function(t,e){var i="#"+this.id+" ";var r="";if(!this.sheet){this.sheet=this.getSheet()}e.forEach((function(t){for(var e in t){if(t.hasOwnProperty(e)){r+=e+":"+t[e]+";"}}}));this.sheet.insertRule(i+t+" {"+r+"}",0)};t.prototype.axis=function(t){if(t==="horizontal"){this.container.style.display="flex";this.container.style.flexDirection="row";this.container.style.flexWrap="nowrap"}else{this.container.style.display="block"}this.settings.axis=t};t.prototype.direction=function(t){if(this.container){this.container.dir=t;this.container.style["direction"]=t}if(this.settings.fullsize){document.body.style["direction"]=t}this.settings.dir=t};t.prototype.overflow=function(t){if(this.container){if(t==="scroll"&&this.settings.axis==="vertical"){this.container.style["overflow-y"]=t;this.container.style["overflow-x"]="hidden"}else if(t==="scroll"&&this.settings.axis==="horizontal"){this.container.style["overflow-y"]="hidden";this.container.style["overflow-x"]=t}else{this.container.style["overflow"]=t}}this.settings.overflow=t};t.prototype.destroy=function(){if(this.element){if(this.element.contains(this.container)){this.element.removeChild(this.container)}window.removeEventListener("resize",this.resizeFunc);window.removeEventListener("orientationChange",this.orientationChangeFunc)}};return t}();var ki=function(){function t(t){this.container=t;this._views=[];this.length=0;this.hidden=false}t.prototype.all=function(){return this._views};t.prototype.first=function(){return this._views[0]};t.prototype.last=function(){return this._views[this._views.length-1]};t.prototype.indexOf=function(t){return this._views.indexOf(t)};t.prototype.slice=function(){return this._views.slice.apply(this._views,arguments)};t.prototype.get=function(t){return this._views[t]};t.prototype.append=function(t){this._views.push(t);if(this.container){this.container.appendChild(t.element)}this.length++;return t};t.prototype.prepend=function(t){this._views.unshift(t);if(this.container){this.container.insertBefore(t.element,this.container.firstChild)}this.length++;return t};t.prototype.insert=function(t,e){this._views.splice(e,0,t);if(this.container){if(e<this.container.children.length){this.container.insertBefore(t.element,this.container.children[e])}else{this.container.appendChild(t.element)}}this.length++;return t};t.prototype.remove=function(t){var e=this._views.indexOf(t);if(e>-1){this._views.splice(e,1)}this.destroy(t);this.length--};t.prototype.destroy=function(t){if(t.displayed){t.destroy()}if(this.container){this.container.removeChild(t.element)}t=null};t.prototype.forEach=function(){return this._views.forEach.apply(this._views,arguments)};t.prototype.clear=function(){var t;var e=this.length;if(!this.length)return;for(var i=0;i<e;i++){t=this._views[i];this.destroy(t)}this._views=[];this.length=0};t.prototype.find=function(t){var e;var i=this.length;for(var r=0;r<i;r++){e=this._views[r];if(e.displayed&&e.section.index==t.index){return e}}};t.prototype.displayed=function(){var t=[];var e;var i=this.length;for(var r=0;r<i;r++){e=this._views[r];if(e.displayed){t.push(e)}}return t};t.prototype.show=function(){var t;var e=this.length;for(var i=0;i<e;i++){t=this._views[i];if(t.displayed){t.show()}}this.hidden=false};t.prototype.hide=function(){var t;var e=this.length;for(var i=0;i<e;i++){t=this._views[i];if(t.displayed){t.hide()}}this.hidden=true};return t}();var Ei=function(){function t(t){this.name="default";this.optsSettings=t.settings;this.View=t.view;this.request=t.request;this.renditionQueue=t.queue;this.q=new Jt(this);this.settings=$(this.settings||{},{infinite:true,hidden:false,width:undefined,height:undefined,axis:undefined,flow:"scrolled",ignoreClass:"",fullsize:undefined});$(this.settings,t.settings||{});this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:true};this.rendered=false}t.prototype.render=function(t,e){var i=t.tagName;if(typeof this.settings.fullsize==="undefined"&&i&&(i.toLowerCase()=="body"||i.toLowerCase()=="html")){this.settings.fullsize=true}if(this.settings.fullsize){this.settings.overflow="visible";this.overflow=this.settings.overflow}this.settings.size=e;this.stage=new xi({width:e.width,height:e.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction});this.stage.attachTo(t);this.container=this.stage.getContainer();this.views=new ki(this.container);this._bounds=this.bounds();this._stageSize=this.stage.size();this.viewSettings.width=this._stageSize.width;this.viewSettings.height=this._stageSize.height;this.stage.onResize(this.onResized.bind(this));this.stage.onOrientationChange(this.onOrientationChange.bind(this));this.addEventListeners();if(this.layout){this.updateLayout()}this.rendered=true};t.prototype.addEventListeners=function(){var t;window.addEventListener("unload",function(t){this.destroy()}.bind(this));if(!this.settings.fullsize){t=this.container}else{t=window}this._onScroll=this.onScroll.bind(this);t.addEventListener("scroll",this._onScroll)};t.prototype.removeEventListeners=function(){var t;if(!this.settings.fullsize){t=this.container}else{t=window}t.removeEventListener("scroll",this._onScroll);this._onScroll=undefined};t.prototype.destroy=function(){clearTimeout(this.orientationTimeout);clearTimeout(this.resizeTimeout);clearTimeout(this.afterScrolled);this.clear();this.removeEventListeners();this.stage.destroy();this.rendered=false};t.prototype.onOrientationChange=function(t){var e=window.orientation;if(this.optsSettings.resizeOnOrientationChange){this.resize()}clearTimeout(this.orientationTimeout);this.orientationTimeout=setTimeout(function(){this.orientationTimeout=undefined;if(this.optsSettings.resizeOnOrientationChange){this.resize()}this.emit(te.MANAGERS.ORIENTATION_CHANGE,e)}.bind(this),500)};t.prototype.onResized=function(t){this.resize()};t.prototype.resize=function(t,e,i){var r=this.stage.size(t,e);this.winBounds=st();if(this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=undefined;return}if(this._stageSize&&this._stageSize.width===r.width&&this._stageSize.height===r.height){return}this._stageSize=r;this._bounds=this.bounds();this.clear();this.viewSettings.width=this._stageSize.width;this.viewSettings.height=this._stageSize.height;this.updateLayout();this.emit(te.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},i)};t.prototype.createView=function(t){return new this.View(t,this.viewSettings)};t.prototype.display=function(t,e){var i=new kt;var r=i.promise;if(e===t.href||X(e)){e=undefined}var n=this.views.find(t);if(n&&t){var s=n.offset();if(this.settings.direction==="ltr"){this.scrollTo(s.left,s.top,true)}else{var o=n.width();this.scrollTo(s.left+o,s.top,true)}if(e){var a=n.locationOf(e);this.moveTo(a)}i.resolve();return r}this.clear();this.add(t).then(function(t){if(e){var i=t.locationOf(e);this.moveTo(i)}}.bind(this),(function(t){i.reject(t)})).then(function(){var e;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&t.index>0){e=t.next();if(e){return this.add(e)}}}.bind(this)).then(function(){this.views.show();i.resolve()}.bind(this));return r};t.prototype.afterDisplayed=function(t){this.emit(te.MANAGERS.ADDED,t)};t.prototype.afterResized=function(t){this.emit(te.MANAGERS.RESIZE,t.section)};t.prototype.moveTo=function(t){var e=0,i=0;if(!this.isPaginated){i=t.top}else{e=Math.floor(t.left/this.layout.delta)*this.layout.delta;if(e+this.layout.delta>this.container.scrollWidth){e=this.container.scrollWidth-this.layout.delta}}this.scrollTo(e,i,true)};t.prototype.add=function(t){var e=this;var i=this.createView(t);this.views.append(i);i.onDisplayed=this.afterDisplayed.bind(this);i.onResize=this.afterResized.bind(this);i.on(te.VIEWS.AXIS,(function(t){e.updateAxis(t)}));return i.display(this.request)};t.prototype.append=function(t){var e=this;var i=this.createView(t);this.views.append(i);i.onDisplayed=this.afterDisplayed.bind(this);i.onResize=this.afterResized.bind(this);i.on(te.VIEWS.AXIS,(function(t){e.updateAxis(t)}));return i.display(this.request)};t.prototype.prepend=function(t){var e=this;var i=this.createView(t);i.on(te.VIEWS.RESIZED,(function(t){e.counter(t)}));this.views.prepend(i);i.onDisplayed=this.afterDisplayed.bind(this);i.onResize=this.afterResized.bind(this);i.on(te.VIEWS.AXIS,(function(t){e.updateAxis(t)}));return i.display(this.request)};t.prototype.counter=function(t){if(this.settings.axis==="vertical"){this.scrollBy(0,t.heightDelta,true)}else{this.scrollBy(t.widthDelta,0,true)}};t.prototype.next=function(){var t;var e;var i=this.settings.direction;if(!this.views.length)return;if(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")){this.scrollLeft=this.container.scrollLeft;e=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta;if(e<=this.container.scrollWidth){this.scrollBy(this.layout.delta,0,true)}else{t=this.views.last().section.next()}}else if(this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"){this.scrollLeft=this.container.scrollLeft;e=this.container.scrollLeft;if(e>0){this.scrollBy(this.layout.delta,0,true)}else{t=this.views.last().section.next()}}else if(this.isPaginated&&this.settings.axis==="vertical"){this.scrollTop=this.container.scrollTop;var r=this.container.scrollTop+this.container.offsetHeight;if(r<this.container.scrollHeight){this.scrollBy(0,this.layout.height,true)}else{t=this.views.last().section.next()}}else{t=this.views.last().section.next()}if(t){this.clear();return this.append(t).then(function(){var e;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){e=t.next();if(e){return this.append(e)}}}.bind(this),(function(t){return t})).then(function(){this.views.show()}.bind(this))}};t.prototype.prev=function(){var t;var e;var i=this.settings.direction;if(!this.views.length)return;if(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")){this.scrollLeft=this.container.scrollLeft;e=this.container.scrollLeft;if(e>0){this.scrollBy(-this.layout.delta,0,true)}else{t=this.views.first().section.prev()}}else if(this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"){this.scrollLeft=this.container.scrollLeft;e=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta;if(e<=this.container.scrollWidth){this.scrollBy(-this.layout.delta,0,true)}else{t=this.views.first().section.prev()}}else if(this.isPaginated&&this.settings.axis==="vertical"){this.scrollTop=this.container.scrollTop;var r=this.container.scrollTop;if(r>0){this.scrollBy(0,-this.layout.height,true)}else{t=this.views.first().section.prev()}}else{t=this.views.first().section.prev()}if(t){this.clear();return this.prepend(t).then(function(){var e;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){e=t.prev();if(e){return this.prepend(e)}}}.bind(this),(function(t){return t})).then(function(){if(this.isPaginated&&this.settings.axis==="horizontal"){if(this.settings.direction==="rtl"){this.scrollTo(0,0,true)}else{this.scrollTo(this.container.scrollWidth-this.layout.delta,0,true)}}this.views.show()}.bind(this))}};t.prototype.current=function(){var t=this.visible();if(t.length){return t[t.length-1]}return null};t.prototype.clear=function(){if(this.views){this.views.hide();this.scrollTo(0,0,true);this.views.clear()}};t.prototype.currentLocation=function(){if(this.settings.axis==="vertical"){this.location=this.scrolledLocation()}else{this.location=this.paginatedLocation()}return this.location};t.prototype.scrolledLocation=function(){var t=this;var e=this.visible();var i=this.container.getBoundingClientRect();var r=i.height<window.innerHeight?i.height:window.innerHeight;var n=0;var s=0;if(this.settings.fullsize){n=window.scrollY}var o=e.map((function(e){var o=e.section,a=o.index,h=o.href;var f=e.position();var l=e.height();var u=n+i.top-f.top+s;var c=u+r-s;if(c>l){c=l;s=c-u}var d=t.layout.count(l,r).pages;var p=Math.ceil(u/r);var v=[];var g=Math.ceil(c/r);v=[];for(var m=p;m<=g;m++){var y=m+1;v.push(y)}var w=t.mapping.page(e.contents,e.section.cfiBase,u,c);return{index:a,href:h,pages:v,totalPages:d,mapping:w}}));return o};t.prototype.paginatedLocation=function(){var t=this;var e=this.visible();var i=this.container.getBoundingClientRect();var r=0;var n=0;if(this.settings.fullsize){r=window.scrollX}var s=e.map((function(e){var s=e.section,o=s.index,a=s.href;var h=e.offset().left;var f=e.position().left;var l=e.width();var u=r+i.left-f+n;var c=u+t.layout.width-n;var d=t.mapping.page(e.contents,e.section.cfiBase,u,c);var p=t.layout.count(l).pages;var v=Math.floor(u/t.layout.pageWidth);var g=[];var m=Math.floor(c/t.layout.pageWidth);if(v<0){v=0;m=m+1}if(t.settings.direction==="rtl"){var y=v;v=p-m;m=p-y}for(var w=v+1;w<=m;w++){var b=w;g.push(b)}return{index:o,href:a,pages:g,totalPages:p,mapping:d}}));return s};t.prototype.isVisible=function(t,e,i,r){var n=t.position();var s=r||this.bounds();if(this.settings.axis==="horizontal"&&n.right>s.left-e&&n.left<s.right+i){return true}else if(this.settings.axis==="vertical"&&n.bottom>s.top-e&&n.top<s.bottom+i){return true}return false};t.prototype.visible=function(){var t=this.bounds();var e=this.views.displayed();var i=e.length;var r=[];var n;var s;for(var o=0;o<i;o++){s=e[o];n=this.isVisible(s,0,0,t);if(n===true){r.push(s)}}return r};t.prototype.scrollBy=function(t,e,i){var r=this.settings.direction==="rtl"?-1:1;if(i){this.ignore=true}if(!this.settings.fullsize){if(t)this.container.scrollLeft+=t*r;if(e)this.container.scrollTop+=e}else{window.scrollBy(t*r,e*r)}this.scrolled=true};t.prototype.scrollTo=function(t,e,i){if(i){this.ignore=true}if(!this.settings.fullsize){this.container.scrollLeft=t;this.container.scrollTop=e}else{window.scrollTo(t,e)}this.scrolled=true};t.prototype.onScroll=function(){var t;var e;if(!this.settings.fullsize){t=this.container.scrollTop;e=this.container.scrollLeft}else{t=window.scrollY;e=window.scrollX}this.scrollTop=t;this.scrollLeft=e;if(!this.ignore){this.emit(te.MANAGERS.SCROLL,{top:t,left:e});clearTimeout(this.afterScrolled);this.afterScrolled=setTimeout(function(){this.emit(te.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20)}else{this.ignore=false}};t.prototype.bounds=function(){var t;t=this.stage.bounds();return t};t.prototype.applyLayout=function(t){this.layout=t;this.updateLayout()};t.prototype.updateLayout=function(){if(!this.stage){return}this._stageSize=this.stage.size();if(!this.isPaginated){this.layout.calculate(this._stageSize.width,this._stageSize.height)}else{this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap);this.settings.offset=this.layout.delta}this.viewSettings.width=this.layout.width;this.viewSettings.height=this.layout.height;this.setLayout(this.layout)};t.prototype.setLayout=function(t){this.viewSettings.layout=t;this.mapping=new pe(t.props,this.settings.direction,this.settings.axis);if(this.views){this.views.forEach((function(e){if(e){e.setLayout(t)}}))}};t.prototype.updateAxis=function(t,e){if(!this.isPaginated){t="vertical"}if(!e&&t===this.settings.axis){return}this.settings.axis=t;this.stage&&this.stage.axis(t);this.viewSettings.axis=t;if(this.mapping){this.mapping=new pe(this.layout.props,this.settings.direction,this.settings.axis)}if(this.layout){if(t==="vertical"){this.layout.spread("none")}else{this.layout.spread(this.layout.settings.spread)}}};t.prototype.updateFlow=function(t,e){if(e===void 0){e="auto"}var i=t==="paginated"||t==="auto";this.isPaginated=i;if(t==="scrolled-doc"||t==="scrolled-continuous"||t==="scrolled"){this.updateAxis("vertical")}else{this.updateAxis("horizontal")}this.viewSettings.flow=t;if(!this.settings.overflow){this.overflow=i?"hidden":e}else{this.overflow=this.settings.overflow}this.stage&&this.stage.overflow(this.overflow);this.updateLayout()};t.prototype.getContents=function(){var t=[];if(!this.views){return t}this.views.forEach((function(e){var i=e&&e.contents;if(i){t.push(i)}}));return t};t.prototype.direction=function(t){if(t===void 0){t="ltr"}this.settings.direction=t;this.stage&&this.stage.direction(t);this.viewSettings.direction=t;this.updateLayout()};t.prototype.isRendered=function(){return this.rendered};return t}();M(Ei.prototype);var Si=Math.PI/2;var Ci={easeOutSine:function(t){return Math.sin(t*Si)},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInOutQuint:function(t){if((t/=.5)<1){return.5*Math.pow(t,5)}return.5*(Math.pow(t-2,5)+2)},easeInCubic:function(t){return Math.pow(t,3)}};var Ri=function(){function t(t,e){this.settings=$({duration:80,minVelocity:.2,minDistance:10,easing:Ci["easeInCubic"]},e||{});this.supportsTouch=this.supportsTouch();if(this.supportsTouch){this.setup(t)}}t.prototype.setup=function(t){this.manager=t;this.layout=this.manager.layout;this.fullsize=this.manager.settings.fullsize;if(this.fullsize){this.element=this.manager.stage.element;this.scroller=window;this.disableScroll()}else{this.element=this.manager.stage.container;this.scroller=this.element;this.element.style["WebkitOverflowScrolling"]="touch"}this.manager.settings.offset=this.layout.width;this.manager.settings.afterScrolledTimeout=this.settings.duration*2;this.isVertical=this.manager.settings.axis==="vertical";if(!this.manager.isPaginated||this.isVertical){return}this.touchCanceler=false;this.resizeCanceler=false;this.snapping=false;this.startTouchX=undefined;this.startTouchY=undefined;this.startTime=undefined;this.endTouchX=undefined;this.endTouchY=undefined;this.endTime=undefined;this.addListeners()};t.prototype.supportsTouch=function(){if("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch){return true}return false};t.prototype.disableScroll=function(){this.element.style.overflow="hidden"};t.prototype.enableScroll=function(){this.element.style.overflow=""};t.prototype.addListeners=function(){this._onResize=this.onResize.bind(this);window.addEventListener("resize",this._onResize);this._onScroll=this.onScroll.bind(this);this.scroller.addEventListener("scroll",this._onScroll);this._onTouchStart=this.onTouchStart.bind(this);this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:true});this.on("touchstart",this._onTouchStart);this._onTouchMove=this.onTouchMove.bind(this);this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:true});this.on("touchmove",this._onTouchMove);this._onTouchEnd=this.onTouchEnd.bind(this);this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:true});this.on("touchend",this._onTouchEnd);this._afterDisplayed=this.afterDisplayed.bind(this);this.manager.on(te.MANAGERS.ADDED,this._afterDisplayed)};t.prototype.removeListeners=function(){window.removeEventListener("resize",this._onResize);this._onResize=undefined;this.scroller.removeEventListener("scroll",this._onScroll);this._onScroll=undefined;this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:true});this.off("touchstart",this._onTouchStart);this._onTouchStart=undefined;this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:true});this.off("touchmove",this._onTouchMove);this._onTouchMove=undefined;this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:true});this.off("touchend",this._onTouchEnd);this._onTouchEnd=undefined;this.manager.off(te.MANAGERS.ADDED,this._afterDisplayed);this._afterDisplayed=undefined};t.prototype.afterDisplayed=function(t){var e=this;var i=t.contents;["touchstart","touchmove","touchend"].forEach((function(t){i.on(t,(function(t){return e.triggerViewEvent(t,i)}))}))};t.prototype.triggerViewEvent=function(t,e){this.emit(t.type,t,e)};t.prototype.onScroll=function(t){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft;this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop};t.prototype.onResize=function(t){this.resizeCanceler=true};t.prototype.onTouchStart=function(t){var e=t.touches[0],i=e.screenX,r=e.screenY;if(this.fullsize){this.enableScroll()}this.touchCanceler=true;if(!this.startTouchX){this.startTouchX=i;this.startTouchY=r;this.startTime=this.now()}this.endTouchX=i;this.endTouchY=r;this.endTime=this.now()};t.prototype.onTouchMove=function(t){var e=t.touches[0],i=e.screenX,r=e.screenY;var n=Math.abs(r-this.endTouchY);this.touchCanceler=true;if(!this.fullsize&&n<10){this.element.scrollLeft-=i-this.endTouchX}this.endTouchX=i;this.endTouchY=r;this.endTime=this.now()};t.prototype.onTouchEnd=function(t){if(this.fullsize){this.disableScroll()}this.touchCanceler=false;var e=this.wasSwiped();if(e!==0){this.snap(e)}else{this.snap()}this.startTouchX=undefined;this.startTouchY=undefined;this.startTime=undefined;this.endTouchX=undefined;this.endTouchY=undefined;this.endTime=undefined};t.prototype.wasSwiped=function(){var t=this.layout.pageWidth*this.layout.divisor;var e=this.endTouchX-this.startTouchX;var i=Math.abs(e);var r=this.endTime-this.startTime;var n=e/r;var s=this.settings.minVelocity;if(i<=this.settings.minDistance||i>=t){return 0}if(n>s){return-1}else if(n<-s){return 1}};t.prototype.needsSnap=function(){var t=this.scrollLeft;var e=this.layout.pageWidth*this.layout.divisor;return t%e!==0};t.prototype.snap=function(t){if(t===void 0){t=0}var e=this.scrollLeft;var i=this.layout.pageWidth*this.layout.divisor;var r=Math.round(e/i)*i;if(t){r+=t*i}return this.smoothScrollTo(r)};t.prototype.smoothScrollTo=function(t){var e=new kt;var i=this.scrollLeft;var r=this.now();var n=this.settings.duration;var s=this.settings.easing;this.snapping=true;function o(){var a=this.now();var h=Math.min(1,(a-r)/n);var f=s(h);if(this.touchCanceler||this.resizeCanceler){this.resizeCanceler=false;this.snapping=false;e.resolve();return}if(h<1){window.requestAnimationFrame(o.bind(this));this.scrollTo(i+(t-i)*h,0)}else{this.scrollTo(t,0);this.snapping=false;e.resolve()}}o.call(this);return e.promise};t.prototype.scrollTo=function(t,e){if(t===void 0){t=0}if(e===void 0){e=0}if(this.fullsize){window.scroll(t,e)}else{this.scroller.scrollLeft=t;this.scroller.scrollTop=e}};t.prototype.now=function(){return"now"in window.performance?performance.now():(new Date).getTime()};t.prototype.destroy=function(){if(!this.scroller){return}if(this.fullsize){this.enableScroll()}this.removeListeners();this.scroller=undefined};return t}();M(Ri.prototype);var Ti=function(t){__extends(e,t);function e(e){var i=t.call(this,e)||this;i.name="continuous";i.settings=$(i.settings||{},{infinite:true,overflow:undefined,axis:undefined,flow:"scrolled",offset:500,offsetDelta:250,width:undefined,height:undefined,snap:false,afterScrolledTimeout:10});$(i.settings,e.settings||{});if(e.settings.gap!="undefined"&&e.settings.gap===0){i.settings.gap=e.settings.gap}i.viewSettings={ignoreClass:i.settings.ignoreClass,axis:i.settings.axis,flow:i.settings.flow,layout:i.layout,width:0,height:0,forceEvenPages:false};i.scrollTop=0;i.scrollLeft=0;return i}e.prototype.display=function(t,e){return Ei.prototype.display.call(this,t,e).then(function(){return this.fill()}.bind(this))};e.prototype.fill=function(t){var e=this;var i=t||new kt;this.q.enqueue((function(){return e.check()})).then((function(t){if(t){e.fill(i)}else{i.resolve()}}));return i.promise};e.prototype.moveTo=function(t){var e=0,i=0;if(!this.isPaginated){i=t.top}else{e=Math.floor(t.left/this.layout.delta)*this.layout.delta}if(e>0||i>0){this.scrollBy(e,i,true)}};e.prototype.afterResized=function(t){this.emit(te.MANAGERS.RESIZE,t.section)};e.prototype.removeShownListeners=function(t){t.onDisplayed=function(){}};e.prototype.add=function(t){var e=this;var i=this.createView(t);this.views.append(i);i.on(te.VIEWS.RESIZED,(function(t){i.expanded=true}));i.on(te.VIEWS.AXIS,(function(t){e.updateAxis(t)}));i.onDisplayed=this.afterDisplayed.bind(this);i.onResize=this.afterResized.bind(this);return i.display(this.request)};e.prototype.append=function(t){var e=this;var i=this.createView(t);i.on(te.VIEWS.RESIZED,(function(t){i.expanded=true}));i.on(te.VIEWS.AXIS,(function(t){e.updateAxis(t)}));this.views.append(i);i.onDisplayed=this.afterDisplayed.bind(this);return i};e.prototype.prepend=function(t){var e=this;var i=this.createView(t);i.on(te.VIEWS.RESIZED,(function(t){e.counter(t);i.expanded=true}));i.on(te.VIEWS.AXIS,(function(t){e.updateAxis(t)}));this.views.prepend(i);i.onDisplayed=this.afterDisplayed.bind(this);return i};e.prototype.counter=function(t){if(this.settings.axis==="vertical"){this.scrollBy(0,t.heightDelta,true)}else{this.scrollBy(t.widthDelta,0,true)}};e.prototype.update=function(t){var e=this.bounds();var i=this.views.all();var r=i.length;var n=typeof t!="undefined"?t:this.settings.offset||0;var s;var o;var a=new kt;var h=[];for(var f=0;f<r;f++){o=i[f];s=this.isVisible(o,n,n,e);if(s===true){if(!o.displayed){var l=o.display(this.request).then((function(t){t.show()}),(function(t){o.hide()}));h.push(l)}else{o.show()}}else{this.q.enqueue(o.destroy.bind(o));clearTimeout(this.trimTimeout);this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250)}}if(h.length){return Promise.all(h).catch((function(t){a.reject(t)}))}else{a.resolve();return a.promise}};e.prototype.check=function(t,e){var i=this;var r=new kt;var n=[];var s=this.settings.axis==="horizontal";var o=this.settings.offset||0;if(t&&s){o=t}if(e&&!s){o=e}var a=this._bounds;var h=this.settings.direction==="rtl";var f=s&&h?-1:1;var l=s?this.scrollLeft:this.scrollTop*f;var u=s?Math.floor(a.width):a.height;var c=s?this.container.scrollWidth:this.container.scrollHeight;var d=function(){var t=i.views.first();var e=t&&t.section.prev();if(e){n.push(i.prepend(e))}};var p=function(){var t=i.views.last();var e=t&&t.section.next();if(e){n.push(i.append(e))}};if(l+u+o>=c){if(s&&h){d()}else{p()}}if(l-o<0){if(s&&h){p()}else{d()}}var v=n.map((function(t){return t.displayed}));if(n.length){return Promise.all(v).then((function(){if(i.layout.name==="pre-paginated"&&i.layout.props.spread){return i.check()}})).then((function(){return i.update(o)}),(function(t){return t}))}else{this.q.enqueue(function(){this.update()}.bind(this));r.resolve(false);return r.promise}};e.prototype.trim=function(){var t=new kt;var e=this.views.displayed();var i=e[0];var r=e[e.length-1];var n=this.views.indexOf(i);var s=this.views.indexOf(r);var o=this.views.slice(0,n);var a=this.views.slice(s+1);for(var h=0;h<o.length-1;h++){this.erase(o[h],o)}for(var f=1;f<a.length;f++){this.erase(a[f])}t.resolve();return t.promise};e.prototype.erase=function(t,e){var i;var r;if(!this.settings.fullsize){i=this.container.scrollTop;r=this.container.scrollLeft}else{i=window.scrollY;r=window.scrollX}var n=t.bounds();this.views.remove(t);if(e){if(this.settings.axis==="vertical"){this.scrollTo(0,i-n.height,true)}else{this.scrollTo(r-Math.floor(n.width),0,true)}}};e.prototype.addEventListeners=function(t){window.addEventListener("unload",function(t){this.ignore=true;this.destroy()}.bind(this));this.addScrollListeners();if(this.isPaginated&&this.settings.snap){this.snapper=new Ri(this,this.settings.snap&&typeof this.settings.snap==="object"&&this.settings.snap)}};e.prototype.addScrollListeners=function(){var t;this.tick=F;if(!this.settings.fullsize){this.prevScrollTop=this.container.scrollTop;this.prevScrollLeft=this.container.scrollLeft}else{this.prevScrollTop=window.scrollY;this.prevScrollLeft=window.scrollX}this.scrollDeltaVert=0;this.scrollDeltaHorz=0;if(!this.settings.fullsize){t=this.container;this.scrollTop=this.container.scrollTop;this.scrollLeft=this.container.scrollLeft}else{t=window;this.scrollTop=window.scrollY;this.scrollLeft=window.scrollX}this._onScroll=this.onScroll.bind(this);t.addEventListener("scroll",this._onScroll);this._scrolled=yi(this.scrolled.bind(this),30);this.didScroll=false};e.prototype.removeEventListeners=function(){var t;if(!this.settings.fullsize){t=this.container}else{t=window}t.removeEventListener("scroll",this._onScroll);this._onScroll=undefined};e.prototype.onScroll=function(){var t;var e;var i=this.settings.direction==="rtl"?-1:1;if(!this.settings.fullsize){t=this.container.scrollTop;e=this.container.scrollLeft}else{t=window.scrollY*i;e=window.scrollX*i}this.scrollTop=t;this.scrollLeft=e;if(!this.ignore){this._scrolled()}else{this.ignore=false}this.scrollDeltaVert+=Math.abs(t-this.prevScrollTop);this.scrollDeltaHorz+=Math.abs(e-this.prevScrollLeft);this.prevScrollTop=t;this.prevScrollLeft=e;clearTimeout(this.scrollTimeout);this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0;this.scrollDeltaHorz=0}.bind(this),150);clearTimeout(this.afterScrolled);this.didScroll=false};e.prototype.scrolled=function(){this.q.enqueue(function(){this.check()}.bind(this));this.emit(te.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft});clearTimeout(this.afterScrolled);this.afterScrolled=setTimeout(function(){if(this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()){return}this.emit(te.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)};e.prototype.next=function(){var t=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;if(!this.views.length)return;if(this.isPaginated&&this.settings.axis==="horizontal"){this.scrollBy(t,0,true)}else{this.scrollBy(0,this.layout.height,true)}this.q.enqueue(function(){this.check()}.bind(this))};e.prototype.prev=function(){var t=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;if(!this.views.length)return;if(this.isPaginated&&this.settings.axis==="horizontal"){this.scrollBy(-t,0,true)}else{this.scrollBy(0,-this.layout.height,true)}this.q.enqueue(function(){this.check()}.bind(this))};e.prototype.updateFlow=function(e){if(this.rendered&&this.snapper){this.snapper.destroy();this.snapper=undefined}t.prototype.updateFlow.call(this,e,"scroll");if(this.rendered&&this.isPaginated&&this.settings.snap){this.snapper=new Ri(this,this.settings.snap&&typeof this.settings.snap==="object"&&this.settings.snap)}};e.prototype.destroy=function(){t.prototype.destroy.call(this);if(this.snapper){this.snapper.destroy()}};return e}(Ei);var Ai=function(){function t(t,e){this.settings=$(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:true,script:null,snap:false});$(this.settings,e);if(typeof this.settings.manager==="object"){this.manager=this.settings.manager}this.book=t;this.hooks={};this.hooks.display=new Wt(this);this.hooks.serialize=new Wt(this);this.hooks.content=new Wt(this);this.hooks.unloaded=new Wt(this);this.hooks.layout=new Wt(this);this.hooks.render=new Wt(this);this.hooks.show=new Wt(this);this.hooks.content.register(this.handleLinks.bind(this));this.hooks.content.register(this.passEvents.bind(this));this.hooks.content.register(this.adjustImages.bind(this));this.book.spine.hooks.content.register(this.injectIdentifier.bind(this));if(this.settings.stylesheet){this.book.spine.hooks.content.register(this.injectStylesheet.bind(this))}if(this.settings.script){this.book.spine.hooks.content.register(this.injectScript.bind(this))}this.themes=new de(this);this.annotations=new be(this);this.epubcfi=new qt;this.q=new Jt(this);this.location=undefined;this.q.enqueue(this.book.opened);this.starting=new kt;this.started=this.starting.promise;this.q.enqueue(this.start)}t.prototype.setManager=function(t){this.manager=t};t.prototype.requireManager=function(t){var e;if(typeof t==="string"&&t==="default"){e=Ei}else if(typeof t==="string"&&t==="continuous"){e=Ti}else{e=t}return e};t.prototype.requireView=function(t){var e;if(typeof t=="string"&&t==="iframe"){e=Te}else{e=t}return e};t.prototype.start=function(){if(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")){this.settings.layout="pre-paginated"}if(!this.manager){this.ViewManager=this.requireManager(this.settings.manager);this.View=this.requireView(this.settings.view);this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})}this.direction(this.book.package.metadata.direction);this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata);this.flow(this.settings.globalLayoutProperties.flow);this.layout(this.settings.globalLayoutProperties);this.manager.on(te.MANAGERS.ADDED,this.afterDisplayed.bind(this));this.manager.on(te.MANAGERS.REMOVED,this.afterRemoved.bind(this));this.manager.on(te.MANAGERS.RESIZED,this.onResized.bind(this));this.manager.on(te.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this));this.manager.on(te.MANAGERS.SCROLLED,this.reportLocation.bind(this));this.emit(te.RENDITION.STARTED);this.starting.resolve()};t.prototype.attachTo=function(t){return this.q.enqueue(function(){this.manager.render(t,{width:this.settings.width,height:this.settings.height});this.emit(te.RENDITION.ATTACHED)}.bind(this))};t.prototype.display=function(t){if(this.displaying){this.displaying.resolve()}return this.q.enqueue(this._display,t)};t.prototype._display=function(t){var e=this;if(!this.book){return}var i=this.epubcfi.isCfiString(t);var r=new kt;var n=r.promise;var s;this.displaying=r;if(this.book.locations.length()&&K(t)){t=this.book.locations.cfiFromPercentage(parseFloat(t))}s=this.book.spine.get(t);if(!s){r.reject(new Error("No Section Found"));return n}this.manager.display(s,t).then((function(){r.resolve(s);e.displaying=undefined;e.emit(te.RENDITION.DISPLAYED,s);e.reportLocation()}),(function(t){e.emit(te.RENDITION.DISPLAY_ERROR,t)}));return n};t.prototype.afterDisplayed=function(t){var e=this;t.on(te.VIEWS.MARK_CLICKED,(function(i,r){return e.triggerMarkEvent(i,r,t.contents)}));this.hooks.render.trigger(t,this).then((function(){if(t.contents){e.hooks.content.trigger(t.contents,e).then((function(){e.emit(te.RENDITION.RENDERED,t.section,t)}))}else{e.emit(te.RENDITION.RENDERED,t.section,t)}}))};t.prototype.afterRemoved=function(t){var e=this;this.hooks.unloaded.trigger(t,this).then((function(){e.emit(te.RENDITION.REMOVED,t.section,t)}))};t.prototype.onResized=function(t,e){this.emit(te.RENDITION.RESIZED,{width:t.width,height:t.height},e);if(this.location&&this.location.start){this.display(e||this.location.start.cfi)}};t.prototype.onOrientationChange=function(t){this.emit(te.RENDITION.ORIENTATION_CHANGE,t)};t.prototype.moveTo=function(t){this.manager.moveTo(t)};t.prototype.resize=function(t,e,i){if(t){this.settings.width=t}if(e){this.settings.height=e}this.manager.resize(t,e,i)};t.prototype.clear=function(){this.manager.clear()};t.prototype.next=function(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))};t.prototype.prev=function(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))};t.prototype.determineLayoutProperties=function(t){var e;var i=this.settings.layout||t.layout||"reflowable";var r=this.settings.spread||t.spread||"auto";var n=this.settings.orientation||t.orientation||"auto";var s=this.settings.flow||t.flow||"auto";var o=t.viewport||"";var a=this.settings.minSpreadWidth||t.minSpreadWidth||800;var h=this.settings.direction||t.direction||"ltr";e={layout:i,spread:r,orientation:n,flow:s,viewport:o,minSpreadWidth:a,direction:h};return e};t.prototype.flow=function(t){var e=t;if(t==="scrolled"||t==="scrolled-doc"||t==="scrolled-continuous"){e="scrolled"}if(t==="auto"||t==="paginated"){e="paginated"}this.settings.flow=t;if(this._layout){this._layout.flow(e)}if(this.manager&&this._layout){this.manager.applyLayout(this._layout)}if(this.manager){this.manager.updateFlow(e)}if(this.manager&&this.manager.isRendered()&&this.location){this.manager.clear();this.display(this.location.start.cfi)}};t.prototype.layout=function(t){var e=this;if(t){this._layout=new ce(t);this._layout.spread(t.spread,this.settings.minSpreadWidth);this._layout.on(te.LAYOUT.UPDATED,(function(t,i){e.emit(te.RENDITION.LAYOUT,t,i)}))}if(this.manager&&this._layout){this.manager.applyLayout(this._layout)}return this._layout};t.prototype.spread=function(t,e){this.settings.spread=t;if(e){this.settings.minSpreadWidth=e}if(this._layout){this._layout.spread(t,e)}if(this.manager&&this.manager.isRendered()){this.manager.updateLayout()}};t.prototype.direction=function(t){this.settings.direction=t||"ltr";if(this.manager){this.manager.direction(this.settings.direction)}if(this.manager&&this.manager.isRendered()&&this.location){this.manager.clear();this.display(this.location.start.cfi)}};t.prototype.reportLocation=function(){return this.q.enqueue(function t(){requestAnimationFrame(function t(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then==="function"){e.then(function(t){var e=this.located(t);if(!e||!e.start||!e.end){return}this.location=e;this.emit(te.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage});this.emit(te.RENDITION.RELOCATED,this.location)}.bind(this))}else if(e){var i=this.located(e);if(!i||!i.start||!i.end){return}this.location=i;this.emit(te.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage});this.emit(te.RENDITION.RELOCATED,this.location)}}.bind(this))}.bind(this))};t.prototype.currentLocation=function(){var t=this.manager.currentLocation();if(t&&t.then&&typeof t.then==="function"){t.then(function(t){var e=this.located(t);return e}.bind(this))}else if(t){var e=this.located(t);return e}};t.prototype.located=function(t){if(!t.length){return{}}var e=t[0];var i=t[t.length-1];var r={start:{index:e.index,href:e.href,cfi:e.mapping.start,displayed:{page:e.pages[0]||1,total:e.totalPages}},end:{index:i.index,href:i.href,cfi:i.mapping.end,displayed:{page:i.pages[i.pages.length-1]||1,total:i.totalPages}}};var n=this.book.locations.locationFromCfi(e.mapping.start);var s=this.book.locations.locationFromCfi(i.mapping.end);if(n!=null){r.start.location=n;r.start.percentage=this.book.locations.percentageFromLocation(n)}if(s!=null){r.end.location=s;r.end.percentage=this.book.locations.percentageFromLocation(s)}var o=this.book.pageList.pageFromCfi(e.mapping.start);var a=this.book.pageList.pageFromCfi(i.mapping.end);if(o!=-1){r.start.page=o}if(a!=-1){r.end.page=a}if(i.index===this.book.spine.last().index&&r.end.displayed.page>=r.end.displayed.total){r.atEnd=true}if(e.index===this.book.spine.first().index&&r.start.displayed.page===1){r.atStart=true}return r};t.prototype.destroy=function(){this.manager&&this.manager.destroy();this.book=undefined};t.prototype.passEvents=function(t){var e=this;Qt.forEach((function(i){t.on(i,(function(i){return e.triggerViewEvent(i,t)}))}));t.on(te.CONTENTS.SELECTED,(function(i){return e.triggerSelectedEvent(i,t)}))};t.prototype.triggerViewEvent=function(t,e){this.emit(t.type,t,e)};t.prototype.triggerSelectedEvent=function(t,e){this.emit(te.RENDITION.SELECTED,t,e)};t.prototype.triggerMarkEvent=function(t,e,i){this.emit(te.RENDITION.MARK_CLICKED,t,e,i)};t.prototype.getRange=function(t,e){var i=new qt(t);var r=this.manager.visible().filter((function(t){if(i.spinePos===t.index)return true}));if(r.length){return r[0].contents.range(i,e)}};t.prototype.adjustImages=function(t){if(this._layout.name==="pre-paginated"){return new Promise((function(t){t()}))}var e=t.window.getComputedStyle(t.content,null);var i=(t.content.offsetHeight-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)))*.95;var r=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight);t.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-r+"px":"100%")+"!important","max-height":i+"px"+"!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-r+"px":"100%")+"!important","max-height":i+"px"+"!important","page-break-inside":"avoid","break-inside":"avoid"}});return new Promise((function(t,e){setTimeout((function(){t()}),1)}))};t.prototype.getContents=function(){return this.manager?this.manager.getContents():[]};t.prototype.views=function(){var t=this.manager?this.manager.views:undefined;return t||[]};t.prototype.handleLinks=function(t){var e=this;if(t){t.on(te.CONTENTS.LINK_CLICKED,(function(t){var i=e.book.path.relative(t);e.display(i)}))}};t.prototype.injectStylesheet=function(t,e){var i=t.createElement("link");i.setAttribute("type","text/css");i.setAttribute("rel","stylesheet");i.setAttribute("href",this.settings.stylesheet);t.getElementsByTagName("head")[0].appendChild(i)};t.prototype.injectScript=function(t,e){var i=t.createElement("script");i.setAttribute("type","text/javascript");i.setAttribute("src",this.settings.script);i.textContent=" ";t.getElementsByTagName("head")[0].appendChild(i)};t.prototype.injectIdentifier=function(t,e){var i=this.book.packaging.metadata.identifier;var r=t.createElement("meta");r.setAttribute("name","dc.relation.ispartof");if(i){r.setAttribute("content",i)}t.getElementsByTagName("head")[0].appendChild(r)};return t}();M(Ai.prototype);function Oi(t,e,i,r){var n=typeof window!="undefined"?window.URL:false;var s=n?"blob":"arraybuffer";var o=new kt;var a=new XMLHttpRequest;var h=XMLHttpRequest.prototype;var f;if(!("overrideMimeType"in h)){Object.defineProperty(h,"overrideMimeType",{value:function t(){}})}if(i){a.withCredentials=true}a.onreadystatechange=u;a.onerror=l;a.open("GET",t,true);for(f in r){a.setRequestHeader(f,r[f])}if(e=="json"){a.setRequestHeader("Accept","application/json")}if(!e){e=new Dt(t).extension}if(e=="blob"){a.responseType=s}if(ft(e)){a.overrideMimeType("text/xml")}if(e=="binary"){a.responseType="arraybuffer"}a.send();function l(t){o.reject(t)}function u(){if(this.readyState===XMLHttpRequest.DONE){var t=false;if(this.responseType===""||this.responseType==="document"){t=this.responseXML}if(this.status===200||this.status===0||t){var i;if(!this.response&&!t){o.reject({status:this.status,message:"Empty Response",stack:(new Error).stack});return o.promise}if(this.status===403){o.reject({status:this.status,response:this.response,message:"Forbidden",stack:(new Error).stack});return o.promise}if(t){i=this.responseXML}else if(ft(e)){i=vt(this.response,"text/xml")}else if(e=="xhtml"){i=vt(this.response,"application/xhtml+xml")}else if(e=="html"||e=="htm"){i=vt(this.response,"text/html")}else if(e=="json"){i=JSON.parse(this.response)}else if(e=="blob"){if(n){i=this.response}else{i=new Blob([this.response])}}else{i=this.response}o.resolve(i)}else{o.reject({status:this.status,message:this.response,stack:(new Error).stack})}}}return o.promise}var Li=typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};var Ii=[];var zi=[];var Pi=typeof Uint8Array!=="undefined"?Uint8Array:Array;var Ni=false;function Bi(){Ni=true;var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var e=0,i=t.length;e<i;++e){Ii[e]=t[e];zi[t.charCodeAt(e)]=e}zi["-".charCodeAt(0)]=62;zi["_".charCodeAt(0)]=63}function Di(t){if(!Ni){Bi()}var e,i,r,n,s,o;var a=t.length;if(a%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}s=t[a-2]==="="?2:t[a-1]==="="?1:0;o=new Pi(a*3/4-s);r=s>0?a-4:a;var h=0;for(e=0,i=0;e<r;e+=4,i+=3){n=zi[t.charCodeAt(e)]<<18|zi[t.charCodeAt(e+1)]<<12|zi[t.charCodeAt(e+2)]<<6|zi[t.charCodeAt(e+3)];o[h++]=n>>16&255;o[h++]=n>>8&255;o[h++]=n&255}if(s===2){n=zi[t.charCodeAt(e)]<<2|zi[t.charCodeAt(e+1)]>>4;o[h++]=n&255}else if(s===1){n=zi[t.charCodeAt(e)]<<10|zi[t.charCodeAt(e+1)]<<4|zi[t.charCodeAt(e+2)]>>2;o[h++]=n>>8&255;o[h++]=n&255}return o}function ji(t){return Ii[t>>18&63]+Ii[t>>12&63]+Ii[t>>6&63]+Ii[t&63]}function Ui(t,e,i){var r;var n=[];for(var s=e;s<i;s+=3){r=(t[s]<<16)+(t[s+1]<<8)+t[s+2];n.push(ji(r))}return n.join("")}function Mi(t){if(!Ni){Bi()}var e;var i=t.length;var r=i%3;var n="";var s=[];var o=16383;for(var a=0,h=i-r;a<h;a+=o){s.push(Ui(t,a,a+o>h?h:a+o))}if(r===1){e=t[i-1];n+=Ii[e>>2];n+=Ii[e<<4&63];n+="=="}else if(r===2){e=(t[i-2]<<8)+t[i-1];n+=Ii[e>>10];n+=Ii[e>>4&63];n+=Ii[e<<2&63];n+="="}s.push(n);return s.join("")}function Fi(t,e,i,r,n){var s,o;var a=n*8-r-1;var h=(1<<a)-1;var f=h>>1;var l=-7;var u=i?n-1:0;var c=i?-1:1;var d=t[e+u];u+=c;s=d&(1<<-l)-1;d>>=-l;l+=a;for(;l>0;s=s*256+t[e+u],u+=c,l-=8){}o=s&(1<<-l)-1;s>>=-l;l+=r;for(;l>0;o=o*256+t[e+u],u+=c,l-=8){}if(s===0){s=1-f}else if(s===h){return o?NaN:(d?-1:1)*Infinity}else{o=o+Math.pow(2,r);s=s-f}return(d?-1:1)*o*Math.pow(2,s-r)}function qi(t,e,i,r,n,s){var o,a,h;var f=s*8-n-1;var l=(1<<f)-1;var u=l>>1;var c=n===23?Math.pow(2,-24)-Math.pow(2,-77):0;var d=r?0:s-1;var p=r?1:-1;var v=e<0||e===0&&1/e<0?1:0;e=Math.abs(e);if(isNaN(e)||e===Infinity){a=isNaN(e)?1:0;o=l}else{o=Math.floor(Math.log(e)/Math.LN2);if(e*(h=Math.pow(2,-o))<1){o--;h*=2}if(o+u>=1){e+=c/h}else{e+=c*Math.pow(2,1-u)}if(e*h>=2){o++;h/=2}if(o+u>=l){a=0;o=l}else if(o+u>=1){a=(e*h-1)*Math.pow(2,n);o=o+u}else{a=e*Math.pow(2,u-1)*Math.pow(2,n);o=0}}for(;n>=8;t[i+d]=a&255,d+=p,a/=256,n-=8){}o=o<<n|a;f+=n;for(;f>0;t[i+d]=o&255,d+=p,o/=256,f-=8){}t[i+d-p]|=v*128}var Wi={}.toString;var Hi=Array.isArray||function(t){return Wi.call(t)=="[object Array]"};
/*!
             * The buffer module from node.js, for the browser.
             *
             * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
             * @license  MIT
             */var Yi=50;Xi.TYPED_ARRAY_SUPPORT=Li.TYPED_ARRAY_SUPPORT!==undefined?Li.TYPED_ARRAY_SUPPORT:true;function Zi(){return Xi.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Vi(t,e){if(Zi()<e){throw new RangeError("Invalid typed array length")}if(Xi.TYPED_ARRAY_SUPPORT){t=new Uint8Array(e);t.__proto__=Xi.prototype}else{if(t===null){t=new Xi(e)}t.length=e}return t}function Xi(t,e,i){if(!Xi.TYPED_ARRAY_SUPPORT&&!(this instanceof Xi)){return new Xi(t,e,i)}if(typeof t==="number"){if(typeof e==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return $i(this,t)}return Ki(this,t,e,i)}Xi.poolSize=8192;Xi._augment=function(t){t.__proto__=Xi.prototype;return t};function Ki(t,e,i,r){if(typeof e==="number"){throw new TypeError('"value" argument must not be a number')}if(typeof ArrayBuffer!=="undefined"&&e instanceof ArrayBuffer){return er(t,e,i,r)}if(typeof e==="string"){return Qi(t,e,i)}return ir(t,e)}Xi.from=function(t,e,i){return Ki(null,t,e,i)};if(Xi.TYPED_ARRAY_SUPPORT){Xi.prototype.__proto__=Uint8Array.prototype;Xi.__proto__=Uint8Array}function Gi(t){if(typeof t!=="number"){throw new TypeError('"size" argument must be a number')}else if(t<0){throw new RangeError('"size" argument must not be negative')}}function Ji(t,e,i,r){Gi(e);if(e<=0){return Vi(t,e)}if(i!==undefined){return typeof r==="string"?Vi(t,e).fill(i,r):Vi(t,e).fill(i)}return Vi(t,e)}Xi.alloc=function(t,e,i){return Ji(null,t,e,i)};function $i(t,e){Gi(e);t=Vi(t,e<0?0:rr(e)|0);if(!Xi.TYPED_ARRAY_SUPPORT){for(var i=0;i<e;++i){t[i]=0}}return t}Xi.allocUnsafe=function(t){return $i(null,t)};Xi.allocUnsafeSlow=function(t){return $i(null,t)};function Qi(t,e,i){if(typeof i!=="string"||i===""){i="utf8"}if(!Xi.isEncoding(i)){throw new TypeError('"encoding" must be a valid string encoding')}var r=sr(e,i)|0;t=Vi(t,r);var n=t.write(e,i);if(n!==r){t=t.slice(0,n)}return t}function tr(t,e){var i=e.length<0?0:rr(e.length)|0;t=Vi(t,i);for(var r=0;r<i;r+=1){t[r]=e[r]&255}return t}function er(t,e,i,r){if(i<0||e.byteLength<i){throw new RangeError("'offset' is out of bounds")}if(e.byteLength<i+(r||0)){throw new RangeError("'length' is out of bounds")}if(i===undefined&&r===undefined){e=new Uint8Array(e)}else if(r===undefined){e=new Uint8Array(e,i)}else{e=new Uint8Array(e,i,r)}if(Xi.TYPED_ARRAY_SUPPORT){t=e;t.__proto__=Xi.prototype}else{t=tr(t,e)}return t}function ir(t,e){if(nr(e)){var i=rr(e.length)|0;t=Vi(t,i);if(t.length===0){return t}e.copy(t,0,0,i);return t}if(e){if(typeof ArrayBuffer!=="undefined"&&e.buffer instanceof ArrayBuffer||"length"in e){if(typeof e.length!=="number"||Mr(e.length)){return Vi(t,0)}return tr(t,e)}if(e.type==="Buffer"&&Hi(e.data)){return tr(t,e.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function rr(t){if(t>=Zi()){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+Zi().toString(16)+" bytes")}return t|0}Xi.isBuffer=Fr;function nr(t){return!!(t!=null&&t._isBuffer)}Xi.compare=function t(e,i){if(!nr(e)||!nr(i)){throw new TypeError("Arguments must be Buffers")}if(e===i)return 0;var r=e.length;var n=i.length;for(var s=0,o=Math.min(r,n);s<o;++s){if(e[s]!==i[s]){r=e[s];n=i[s];break}}if(r<n)return-1;if(n<r)return 1;return 0};Xi.isEncoding=function t(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Xi.concat=function t(e,i){if(!Hi(e)){throw new TypeError('"list" argument must be an Array of Buffers')}if(e.length===0){return Xi.alloc(0)}var r;if(i===undefined){i=0;for(r=0;r<e.length;++r){i+=e[r].length}}var n=Xi.allocUnsafe(i);var s=0;for(r=0;r<e.length;++r){var o=e[r];if(!nr(o)){throw new TypeError('"list" argument must be an Array of Buffers')}o.copy(n,s);s+=o.length}return n};function sr(t,e){if(nr(t)){return t.length}if(typeof ArrayBuffer!=="undefined"&&typeof ArrayBuffer.isView==="function"&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer)){return t.byteLength}if(typeof t!=="string"){t=""+t}var i=t.length;if(i===0)return 0;var r=false;for(;;){switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case undefined:return Nr(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i*2;case"hex":return i>>>1;case"base64":return jr(t).length;default:if(r)return Nr(t).length;e=(""+e).toLowerCase();r=true}}}Xi.byteLength=sr;function or(t,e,i){var r=false;if(e===undefined||e<0){e=0}if(e>this.length){return""}if(i===undefined||i>this.length){i=this.length}if(i<=0){return""}i>>>=0;e>>>=0;if(i<=e){return""}if(!t)t="utf8";while(true){switch(t){case"hex":return xr(this,e,i);case"utf8":case"utf-8":return mr(this,e,i);case"ascii":return br(this,e,i);case"latin1":case"binary":return _r(this,e,i);case"base64":return gr(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return kr(this,e,i);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase();r=true}}}Xi.prototype._isBuffer=true;function ar(t,e,i){var r=t[e];t[e]=t[i];t[i]=r}Xi.prototype.swap16=function t(){var e=this.length;if(e%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var i=0;i<e;i+=2){ar(this,i,i+1)}return this};Xi.prototype.swap32=function t(){var e=this.length;if(e%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var i=0;i<e;i+=4){ar(this,i,i+3);ar(this,i+1,i+2)}return this};Xi.prototype.swap64=function t(){var e=this.length;if(e%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var i=0;i<e;i+=8){ar(this,i,i+7);ar(this,i+1,i+6);ar(this,i+2,i+5);ar(this,i+3,i+4)}return this};Xi.prototype.toString=function t(){var e=this.length|0;if(e===0)return"";if(arguments.length===0)return mr(this,0,e);return or.apply(this,arguments)};Xi.prototype.equals=function t(e){if(!nr(e))throw new TypeError("Argument must be a Buffer");if(this===e)return true;return Xi.compare(this,e)===0};Xi.prototype.inspect=function t(){var e="";var i=Yi;if(this.length>0){e=this.toString("hex",0,i).match(/.{2}/g).join(" ");if(this.length>i)e+=" ... "}return"<Buffer "+e+">"};Xi.prototype.compare=function t(e,i,r,n,s){if(!nr(e)){throw new TypeError("Argument must be a Buffer")}if(i===undefined){i=0}if(r===undefined){r=e?e.length:0}if(n===undefined){n=0}if(s===undefined){s=this.length}if(i<0||r>e.length||n<0||s>this.length){throw new RangeError("out of range index")}if(n>=s&&i>=r){return 0}if(n>=s){return-1}if(i>=r){return 1}i>>>=0;r>>>=0;n>>>=0;s>>>=0;if(this===e)return 0;var o=s-n;var a=r-i;var h=Math.min(o,a);var f=this.slice(n,s);var l=e.slice(i,r);for(var u=0;u<h;++u){if(f[u]!==l[u]){o=f[u];a=l[u];break}}if(o<a)return-1;if(a<o)return 1;return 0};function hr(t,e,i,r,n){if(t.length===0)return-1;if(typeof i==="string"){r=i;i=0}else if(i>2147483647){i=2147483647}else if(i<-2147483648){i=-2147483648}i=+i;if(isNaN(i)){i=n?0:t.length-1}if(i<0)i=t.length+i;if(i>=t.length){if(n)return-1;else i=t.length-1}else if(i<0){if(n)i=0;else return-1}if(typeof e==="string"){e=Xi.from(e,r)}if(nr(e)){if(e.length===0){return-1}return fr(t,e,i,r,n)}else if(typeof e==="number"){e=e&255;if(Xi.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf==="function"){if(n){return Uint8Array.prototype.indexOf.call(t,e,i)}else{return Uint8Array.prototype.lastIndexOf.call(t,e,i)}}return fr(t,[e],i,r,n)}throw new TypeError("val must be string, number or Buffer")}function fr(t,e,i,r,n){var s=1;var o=t.length;var a=e.length;if(r!==undefined){r=String(r).toLowerCase();if(r==="ucs2"||r==="ucs-2"||r==="utf16le"||r==="utf-16le"){if(t.length<2||e.length<2){return-1}s=2;o/=2;a/=2;i/=2}}function h(t,e){if(s===1){return t[e]}else{return t.readUInt16BE(e*s)}}var f;if(n){var l=-1;for(f=i;f<o;f++){if(h(t,f)===h(e,l===-1?0:f-l)){if(l===-1)l=f;if(f-l+1===a)return l*s}else{if(l!==-1)f-=f-l;l=-1}}}else{if(i+a>o)i=o-a;for(f=i;f>=0;f--){var u=true;for(var c=0;c<a;c++){if(h(t,f+c)!==h(e,c)){u=false;break}}if(u)return f}}return-1}Xi.prototype.includes=function t(e,i,r){return this.indexOf(e,i,r)!==-1};Xi.prototype.indexOf=function t(e,i,r){return hr(this,e,i,r,true)};Xi.prototype.lastIndexOf=function t(e,i,r){return hr(this,e,i,r,false)};function lr(t,e,i,r){i=Number(i)||0;var n=t.length-i;if(!r){r=n}else{r=Number(r);if(r>n){r=n}}var s=e.length;if(s%2!==0)throw new TypeError("Invalid hex string");if(r>s/2){r=s/2}for(var o=0;o<r;++o){var a=parseInt(e.substr(o*2,2),16);if(isNaN(a))return o;t[i+o]=a}return o}function ur(t,e,i,r){return Ur(Nr(e,t.length-i),t,i,r)}function cr(t,e,i,r){return Ur(Br(e),t,i,r)}function dr(t,e,i,r){return cr(t,e,i,r)}function pr(t,e,i,r){return Ur(jr(e),t,i,r)}function vr(t,e,i,r){return Ur(Dr(e,t.length-i),t,i,r)}Xi.prototype.write=function t(e,i,r,n){if(i===undefined){n="utf8";r=this.length;i=0}else if(r===undefined&&typeof i==="string"){n=i;r=this.length;i=0}else if(isFinite(i)){i=i|0;if(isFinite(r)){r=r|0;if(n===undefined)n="utf8"}else{n=r;r=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var s=this.length-i;if(r===undefined||r>s)r=s;if(e.length>0&&(r<0||i<0)||i>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!n)n="utf8";var o=false;for(;;){switch(n){case"hex":return lr(this,e,i,r);case"utf8":case"utf-8":return ur(this,e,i,r);case"ascii":return cr(this,e,i,r);case"latin1":case"binary":return dr(this,e,i,r);case"base64":return pr(this,e,i,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return vr(this,e,i,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase();o=true}}};Xi.prototype.toJSON=function t(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function gr(t,e,i){if(e===0&&i===t.length){return Mi(t)}else{return Mi(t.slice(e,i))}}function mr(t,e,i){i=Math.min(t.length,i);var r=[];var n=e;while(n<i){var s=t[n];var o=null;var a=s>239?4:s>223?3:s>191?2:1;if(n+a<=i){var h,f,l,u;switch(a){case 1:if(s<128){o=s}break;case 2:h=t[n+1];if((h&192)===128){u=(s&31)<<6|h&63;if(u>127){o=u}}break;case 3:h=t[n+1];f=t[n+2];if((h&192)===128&&(f&192)===128){u=(s&15)<<12|(h&63)<<6|f&63;if(u>2047&&(u<55296||u>57343)){o=u}}break;case 4:h=t[n+1];f=t[n+2];l=t[n+3];if((h&192)===128&&(f&192)===128&&(l&192)===128){u=(s&15)<<18|(h&63)<<12|(f&63)<<6|l&63;if(u>65535&&u<1114112){o=u}}}}if(o===null){o=65533;a=1}else if(o>65535){o-=65536;r.push(o>>>10&1023|55296);o=56320|o&1023}r.push(o);n+=a}return wr(r)}var yr=4096;function wr(t){var e=t.length;if(e<=yr){return String.fromCharCode.apply(String,t)}var i="";var r=0;while(r<e){i+=String.fromCharCode.apply(String,t.slice(r,r+=yr))}return i}function br(t,e,i){var r="";i=Math.min(t.length,i);for(var n=e;n<i;++n){r+=String.fromCharCode(t[n]&127)}return r}function _r(t,e,i){var r="";i=Math.min(t.length,i);for(var n=e;n<i;++n){r+=String.fromCharCode(t[n])}return r}function xr(t,e,i){var r=t.length;if(!e||e<0)e=0;if(!i||i<0||i>r)i=r;var n="";for(var s=e;s<i;++s){n+=Pr(t[s])}return n}function kr(t,e,i){var r=t.slice(e,i);var n="";for(var s=0;s<r.length;s+=2){n+=String.fromCharCode(r[s]+r[s+1]*256)}return n}Xi.prototype.slice=function t(e,i){var r=this.length;e=~~e;i=i===undefined?r:~~i;if(e<0){e+=r;if(e<0)e=0}else if(e>r){e=r}if(i<0){i+=r;if(i<0)i=0}else if(i>r){i=r}if(i<e)i=e;var n;if(Xi.TYPED_ARRAY_SUPPORT){n=this.subarray(e,i);n.__proto__=Xi.prototype}else{var s=i-e;n=new Xi(s,undefined);for(var o=0;o<s;++o){n[o]=this[o+e]}}return n};function Er(t,e,i){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}Xi.prototype.readUIntLE=function t(e,i,r){e=e|0;i=i|0;if(!r)Er(e,i,this.length);var n=this[e];var s=1;var o=0;while(++o<i&&(s*=256)){n+=this[e+o]*s}return n};Xi.prototype.readUIntBE=function t(e,i,r){e=e|0;i=i|0;if(!r){Er(e,i,this.length)}var n=this[e+--i];var s=1;while(i>0&&(s*=256)){n+=this[e+--i]*s}return n};Xi.prototype.readUInt8=function t(e,i){if(!i)Er(e,1,this.length);return this[e]};Xi.prototype.readUInt16LE=function t(e,i){if(!i)Er(e,2,this.length);return this[e]|this[e+1]<<8};Xi.prototype.readUInt16BE=function t(e,i){if(!i)Er(e,2,this.length);return this[e]<<8|this[e+1]};Xi.prototype.readUInt32LE=function t(e,i){if(!i)Er(e,4,this.length);return(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};Xi.prototype.readUInt32BE=function t(e,i){if(!i)Er(e,4,this.length);return this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};Xi.prototype.readIntLE=function t(e,i,r){e=e|0;i=i|0;if(!r)Er(e,i,this.length);var n=this[e];var s=1;var o=0;while(++o<i&&(s*=256)){n+=this[e+o]*s}s*=128;if(n>=s)n-=Math.pow(2,8*i);return n};Xi.prototype.readIntBE=function t(e,i,r){e=e|0;i=i|0;if(!r)Er(e,i,this.length);var n=i;var s=1;var o=this[e+--n];while(n>0&&(s*=256)){o+=this[e+--n]*s}s*=128;if(o>=s)o-=Math.pow(2,8*i);return o};Xi.prototype.readInt8=function t(e,i){if(!i)Er(e,1,this.length);if(!(this[e]&128))return this[e];return(255-this[e]+1)*-1};Xi.prototype.readInt16LE=function t(e,i){if(!i)Er(e,2,this.length);var r=this[e]|this[e+1]<<8;return r&32768?r|4294901760:r};Xi.prototype.readInt16BE=function t(e,i){if(!i)Er(e,2,this.length);var r=this[e+1]|this[e]<<8;return r&32768?r|4294901760:r};Xi.prototype.readInt32LE=function t(e,i){if(!i)Er(e,4,this.length);return this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};Xi.prototype.readInt32BE=function t(e,i){if(!i)Er(e,4,this.length);return this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};Xi.prototype.readFloatLE=function t(e,i){if(!i)Er(e,4,this.length);return Fi(this,e,true,23,4)};Xi.prototype.readFloatBE=function t(e,i){if(!i)Er(e,4,this.length);return Fi(this,e,false,23,4)};Xi.prototype.readDoubleLE=function t(e,i){if(!i)Er(e,8,this.length);return Fi(this,e,true,52,8)};Xi.prototype.readDoubleBE=function t(e,i){if(!i)Er(e,8,this.length);return Fi(this,e,false,52,8)};function Sr(t,e,i,r,n,s){if(!nr(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(i+r>t.length)throw new RangeError("Index out of range")}Xi.prototype.writeUIntLE=function t(e,i,r,n){e=+e;i=i|0;r=r|0;if(!n){var s=Math.pow(2,8*r)-1;Sr(this,e,i,r,s,0)}var o=1;var a=0;this[i]=e&255;while(++a<r&&(o*=256)){this[i+a]=e/o&255}return i+r};Xi.prototype.writeUIntBE=function t(e,i,r,n){e=+e;i=i|0;r=r|0;if(!n){var s=Math.pow(2,8*r)-1;Sr(this,e,i,r,s,0)}var o=r-1;var a=1;this[i+o]=e&255;while(--o>=0&&(a*=256)){this[i+o]=e/a&255}return i+r};Xi.prototype.writeUInt8=function t(e,i,r){e=+e;i=i|0;if(!r)Sr(this,e,i,1,255,0);if(!Xi.TYPED_ARRAY_SUPPORT)e=Math.floor(e);this[i]=e&255;return i+1};function Cr(t,e,i,r){if(e<0)e=65535+e+1;for(var n=0,s=Math.min(t.length-i,2);n<s;++n){t[i+n]=(e&255<<8*(r?n:1-n))>>>(r?n:1-n)*8}}Xi.prototype.writeUInt16LE=function t(e,i,r){e=+e;i=i|0;if(!r)Sr(this,e,i,2,65535,0);if(Xi.TYPED_ARRAY_SUPPORT){this[i]=e&255;this[i+1]=e>>>8}else{Cr(this,e,i,true)}return i+2};Xi.prototype.writeUInt16BE=function t(e,i,r){e=+e;i=i|0;if(!r)Sr(this,e,i,2,65535,0);if(Xi.TYPED_ARRAY_SUPPORT){this[i]=e>>>8;this[i+1]=e&255}else{Cr(this,e,i,false)}return i+2};function Rr(t,e,i,r){if(e<0)e=4294967295+e+1;for(var n=0,s=Math.min(t.length-i,4);n<s;++n){t[i+n]=e>>>(r?n:3-n)*8&255}}Xi.prototype.writeUInt32LE=function t(e,i,r){e=+e;i=i|0;if(!r)Sr(this,e,i,4,4294967295,0);if(Xi.TYPED_ARRAY_SUPPORT){this[i+3]=e>>>24;this[i+2]=e>>>16;this[i+1]=e>>>8;this[i]=e&255}else{Rr(this,e,i,true)}return i+4};Xi.prototype.writeUInt32BE=function t(e,i,r){e=+e;i=i|0;if(!r)Sr(this,e,i,4,4294967295,0);if(Xi.TYPED_ARRAY_SUPPORT){this[i]=e>>>24;this[i+1]=e>>>16;this[i+2]=e>>>8;this[i+3]=e&255}else{Rr(this,e,i,false)}return i+4};Xi.prototype.writeIntLE=function t(e,i,r,n){e=+e;i=i|0;if(!n){var s=Math.pow(2,8*r-1);Sr(this,e,i,r,s-1,-s)}var o=0;var a=1;var h=0;this[i]=e&255;while(++o<r&&(a*=256)){if(e<0&&h===0&&this[i+o-1]!==0){h=1}this[i+o]=(e/a>>0)-h&255}return i+r};Xi.prototype.writeIntBE=function t(e,i,r,n){e=+e;i=i|0;if(!n){var s=Math.pow(2,8*r-1);Sr(this,e,i,r,s-1,-s)}var o=r-1;var a=1;var h=0;this[i+o]=e&255;while(--o>=0&&(a*=256)){if(e<0&&h===0&&this[i+o+1]!==0){h=1}this[i+o]=(e/a>>0)-h&255}return i+r};Xi.prototype.writeInt8=function t(e,i,r){e=+e;i=i|0;if(!r)Sr(this,e,i,1,127,-128);if(!Xi.TYPED_ARRAY_SUPPORT)e=Math.floor(e);if(e<0)e=255+e+1;this[i]=e&255;return i+1};Xi.prototype.writeInt16LE=function t(e,i,r){e=+e;i=i|0;if(!r)Sr(this,e,i,2,32767,-32768);if(Xi.TYPED_ARRAY_SUPPORT){this[i]=e&255;this[i+1]=e>>>8}else{Cr(this,e,i,true)}return i+2};Xi.prototype.writeInt16BE=function t(e,i,r){e=+e;i=i|0;if(!r)Sr(this,e,i,2,32767,-32768);if(Xi.TYPED_ARRAY_SUPPORT){this[i]=e>>>8;this[i+1]=e&255}else{Cr(this,e,i,false)}return i+2};Xi.prototype.writeInt32LE=function t(e,i,r){e=+e;i=i|0;if(!r)Sr(this,e,i,4,2147483647,-2147483648);if(Xi.TYPED_ARRAY_SUPPORT){this[i]=e&255;this[i+1]=e>>>8;this[i+2]=e>>>16;this[i+3]=e>>>24}else{Rr(this,e,i,true)}return i+4};Xi.prototype.writeInt32BE=function t(e,i,r){e=+e;i=i|0;if(!r)Sr(this,e,i,4,2147483647,-2147483648);if(e<0)e=4294967295+e+1;if(Xi.TYPED_ARRAY_SUPPORT){this[i]=e>>>24;this[i+1]=e>>>16;this[i+2]=e>>>8;this[i+3]=e&255}else{Rr(this,e,i,false)}return i+4};function Tr(t,e,i,r,n,s){if(i+r>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function Ar(t,e,i,r,n){if(!n){Tr(t,e,i,4)}qi(t,e,i,r,23,4);return i+4}Xi.prototype.writeFloatLE=function t(e,i,r){return Ar(this,e,i,true,r)};Xi.prototype.writeFloatBE=function t(e,i,r){return Ar(this,e,i,false,r)};function Or(t,e,i,r,n){if(!n){Tr(t,e,i,8)}qi(t,e,i,r,52,8);return i+8}Xi.prototype.writeDoubleLE=function t(e,i,r){return Or(this,e,i,true,r)};Xi.prototype.writeDoubleBE=function t(e,i,r){return Or(this,e,i,false,r)};Xi.prototype.copy=function t(e,i,r,n){if(!r)r=0;if(!n&&n!==0)n=this.length;if(i>=e.length)i=e.length;if(!i)i=0;if(n>0&&n<r)n=r;if(n===r)return 0;if(e.length===0||this.length===0)return 0;if(i<0){throw new RangeError("targetStart out of bounds")}if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");if(n>this.length)n=this.length;if(e.length-i<n-r){n=e.length-i+r}var s=n-r;var o;if(this===e&&r<i&&i<n){for(o=s-1;o>=0;--o){e[o+i]=this[o+r]}}else if(s<1e3||!Xi.TYPED_ARRAY_SUPPORT){for(o=0;o<s;++o){e[o+i]=this[o+r]}}else{Uint8Array.prototype.set.call(e,this.subarray(r,r+s),i)}return s};Xi.prototype.fill=function t(e,i,r,n){if(typeof e==="string"){if(typeof i==="string"){n=i;i=0;r=this.length}else if(typeof r==="string"){n=r;r=this.length}if(e.length===1){var s=e.charCodeAt(0);if(s<256){e=s}}if(n!==undefined&&typeof n!=="string"){throw new TypeError("encoding must be a string")}if(typeof n==="string"&&!Xi.isEncoding(n)){throw new TypeError("Unknown encoding: "+n)}}else if(typeof e==="number"){e=e&255}if(i<0||this.length<i||this.length<r){throw new RangeError("Out of range index")}if(r<=i){return this}i=i>>>0;r=r===undefined?this.length:r>>>0;if(!e)e=0;var o;if(typeof e==="number"){for(o=i;o<r;++o){this[o]=e}}else{var a=nr(e)?e:Nr(new Xi(e,n).toString());var h=a.length;for(o=0;o<r-i;++o){this[o+i]=a[o%h]}}return this};var Lr=/[^+\/0-9A-Za-z-_]/g;function Ir(t){t=zr(t).replace(Lr,"");if(t.length<2)return"";while(t.length%4!==0){t=t+"="}return t}function zr(t){if(t.trim)return t.trim();return t.replace(/^\s+|\s+$/g,"")}function Pr(t){if(t<16)return"0"+t.toString(16);return t.toString(16)}function Nr(t,e){e=e||Infinity;var i;var r=t.length;var n=null;var s=[];for(var o=0;o<r;++o){i=t.charCodeAt(o);if(i>55295&&i<57344){if(!n){if(i>56319){if((e-=3)>-1)s.push(239,191,189);continue}else if(o+1===r){if((e-=3)>-1)s.push(239,191,189);continue}n=i;continue}if(i<56320){if((e-=3)>-1)s.push(239,191,189);n=i;continue}i=(n-55296<<10|i-56320)+65536}else if(n){if((e-=3)>-1)s.push(239,191,189)}n=null;if(i<128){if((e-=1)<0)break;s.push(i)}else if(i<2048){if((e-=2)<0)break;s.push(i>>6|192,i&63|128)}else if(i<65536){if((e-=3)<0)break;s.push(i>>12|224,i>>6&63|128,i&63|128)}else if(i<1114112){if((e-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else{throw new Error("Invalid code point")}}return s}function Br(t){var e=[];for(var i=0;i<t.length;++i){e.push(t.charCodeAt(i)&255)}return e}function Dr(t,e){var i,r,n;var s=[];for(var o=0;o<t.length;++o){if((e-=2)<0)break;i=t.charCodeAt(o);r=i>>8;n=i%256;s.push(n);s.push(r)}return s}function jr(t){return Di(Ir(t))}function Ur(t,e,i,r){for(var n=0;n<r;++n){if(n+i>=e.length||n>=t.length)break;e[n+i]=t[n]}return n}function Mr(t){return t!==t}function Fr(t){return t!=null&&(!!t._isBuffer||qr(t)||Wr(t))}function qr(t){return!!t.constructor&&typeof t.constructor.isBuffer==="function"&&t.constructor.isBuffer(t)}function Wr(t){return typeof t.readFloatLE==="function"&&typeof t.slice==="function"&&qr(t.slice(0,0))}function Hr(){}Hr.prototype=Object.create(null);function Yr(){Yr.init.call(this)}Yr.EventEmitter=Yr;Yr.usingDomains=false;Yr.prototype.domain=undefined;Yr.prototype._events=undefined;Yr.prototype._maxListeners=undefined;Yr.defaultMaxListeners=10;Yr.init=function(){this.domain=null;if(!this._events||this._events===Object.getPrototypeOf(this)._events){this._events=new Hr;this._eventsCount=0}this._maxListeners=this._maxListeners||undefined};Yr.prototype.setMaxListeners=function t(e){if(typeof e!=="number"||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');this._maxListeners=e;return this};function Zr(t){if(t._maxListeners===undefined)return Yr.defaultMaxListeners;return t._maxListeners}Yr.prototype.getMaxListeners=function t(){return Zr(this)};function Vr(t,e,i){if(e)t.call(i);else{var r=t.length;var n=nn(t,r);for(var s=0;s<r;++s)n[s].call(i)}}function Xr(t,e,i,r){if(e)t.call(i,r);else{var n=t.length;var s=nn(t,n);for(var o=0;o<n;++o)s[o].call(i,r)}}function Kr(t,e,i,r,n){if(e)t.call(i,r,n);else{var s=t.length;var o=nn(t,s);for(var a=0;a<s;++a)o[a].call(i,r,n)}}function Gr(t,e,i,r,n,s){if(e)t.call(i,r,n,s);else{var o=t.length;var a=nn(t,o);for(var h=0;h<o;++h)a[h].call(i,r,n,s)}}function Jr(t,e,i,r){if(e)t.apply(i,r);else{var n=t.length;var s=nn(t,n);for(var o=0;o<n;++o)s[o].apply(i,r)}}Yr.prototype.emit=function t(e){var i,r,n,s,o,a,h;var f=e==="error";a=this._events;if(a)f=f&&a.error==null;else if(!f)return false;h=this.domain;if(f){i=arguments[1];if(h){if(!i)i=new Error('Uncaught, unspecified "error" event');i.domainEmitter=this;i.domain=h;i.domainThrown=false;h.emit("error",i)}else if(i instanceof Error){throw i}else{var l=new Error('Uncaught, unspecified "error" event. ('+i+")");l.context=i;throw l}return false}r=a[e];if(!r)return false;var u=typeof r==="function";n=arguments.length;switch(n){case 1:Vr(r,u,this);break;case 2:Xr(r,u,this,arguments[1]);break;case 3:Kr(r,u,this,arguments[1],arguments[2]);break;case 4:Gr(r,u,this,arguments[1],arguments[2],arguments[3]);break;default:s=new Array(n-1);for(o=1;o<n;o++)s[o-1]=arguments[o];Jr(r,u,this,s)}return true};function $r(t,e,i,r){var n;var s;var o;if(typeof i!=="function")throw new TypeError('"listener" argument must be a function');s=t._events;if(!s){s=t._events=new Hr;t._eventsCount=0}else{if(s.newListener){t.emit("newListener",e,i.listener?i.listener:i);s=t._events}o=s[e]}if(!o){o=s[e]=i;++t._eventsCount}else{if(typeof o==="function"){o=s[e]=r?[i,o]:[o,i]}else{if(r){o.unshift(i)}else{o.push(i)}}if(!o.warned){n=Zr(t);if(n&&n>0&&o.length>n){o.warned=true;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+e+" listeners added. "+"Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning";a.emitter=t;a.type=e;a.count=o.length;Qr(a)}}}return t}function Qr(t){typeof console.warn==="function"?console.warn(t):console.log(t)}Yr.prototype.addListener=function t(e,i){return $r(this,e,i,false)};Yr.prototype.on=Yr.prototype.addListener;Yr.prototype.prependListener=function t(e,i){return $r(this,e,i,true)};function tn(t,e,i){var r=false;function n(){t.removeListener(e,n);if(!r){r=true;i.apply(t,arguments)}}n.listener=i;return n}Yr.prototype.once=function t(e,i){if(typeof i!=="function")throw new TypeError('"listener" argument must be a function');this.on(e,tn(this,e,i));return this};Yr.prototype.prependOnceListener=function t(e,i){if(typeof i!=="function")throw new TypeError('"listener" argument must be a function');this.prependListener(e,tn(this,e,i));return this};Yr.prototype.removeListener=function t(e,i){var r,n,s,o,a;if(typeof i!=="function")throw new TypeError('"listener" argument must be a function');n=this._events;if(!n)return this;r=n[e];if(!r)return this;if(r===i||r.listener&&r.listener===i){if(--this._eventsCount===0)this._events=new Hr;else{delete n[e];if(n.removeListener)this.emit("removeListener",e,r.listener||i)}}else if(typeof r!=="function"){s=-1;for(o=r.length;o-- >0;){if(r[o]===i||r[o].listener&&r[o].listener===i){a=r[o].listener;s=o;break}}if(s<0)return this;if(r.length===1){r[0]=undefined;if(--this._eventsCount===0){this._events=new Hr;return this}else{delete n[e]}}else{rn(r,s)}if(n.removeListener)this.emit("removeListener",e,a||i)}return this};Yr.prototype.removeAllListeners=function t(e){var i,r;r=this._events;if(!r)return this;if(!r.removeListener){if(arguments.length===0){this._events=new Hr;this._eventsCount=0}else if(r[e]){if(--this._eventsCount===0)this._events=new Hr;else delete r[e]}return this}if(arguments.length===0){var n=Object.keys(r);for(var s=0,o;s<n.length;++s){o=n[s];if(o==="removeListener")continue;this.removeAllListeners(o)}this.removeAllListeners("removeListener");this._events=new Hr;this._eventsCount=0;return this}i=r[e];if(typeof i==="function"){this.removeListener(e,i)}else if(i){do{this.removeListener(e,i[i.length-1])}while(i[0])}return this};Yr.prototype.listeners=function t(e){var i;var r;var n=this._events;if(!n)r=[];else{i=n[e];if(!i)r=[];else if(typeof i==="function")r=[i.listener||i];else r=sn(i)}return r};Yr.listenerCount=function(t,e){if(typeof t.listenerCount==="function"){return t.listenerCount(e)}else{return en.call(t,e)}};Yr.prototype.listenerCount=en;function en(t){var e=this._events;if(e){var i=e[t];if(typeof i==="function"){return 1}else if(i){return i.length}}return 0}Yr.prototype.eventNames=function t(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function rn(t,e){for(var i=e,r=i+1,n=t.length;r<n;i+=1,r+=1)t[i]=t[r];t.pop()}function nn(t,e){var i=new Array(e);while(e--)i[e]=t[e];return i}function sn(t){var e=new Array(t.length);for(var i=0;i<e.length;++i){e[i]=t[i].listener||t[i]}return e}function on(){throw new Error("setTimeout has not been defined")}function an(){throw new Error("clearTimeout has not been defined")}var hn=on;var fn=an;if(typeof Li.setTimeout==="function"){hn=setTimeout}if(typeof Li.clearTimeout==="function"){fn=clearTimeout}function ln(t){if(hn===setTimeout){return setTimeout(t,0)}if((hn===on||!hn)&&setTimeout){hn=setTimeout;return setTimeout(t,0)}try{return hn(t,0)}catch(e){try{return hn.call(null,t,0)}catch(e){return hn.call(this,t,0)}}}function un(t){if(fn===clearTimeout){return clearTimeout(t)}if((fn===an||!fn)&&clearTimeout){fn=clearTimeout;return clearTimeout(t)}try{return fn(t)}catch(e){try{return fn.call(null,t)}catch(e){return fn.call(this,t)}}}var cn=[];var dn=false;var pn;var vn=-1;function gn(){if(!dn||!pn){return}dn=false;if(pn.length){cn=pn.concat(cn)}else{vn=-1}if(cn.length){mn()}}function mn(){if(dn){return}var t=ln(gn);dn=true;var e=cn.length;while(e){pn=cn;cn=[];while(++vn<e){if(pn){pn[vn].run()}}vn=-1;e=cn.length}pn=null;dn=false;un(t)}function yn(t){var e=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){e[i-1]=arguments[i]}}cn.push(new wn(t,e));if(cn.length===1&&!dn){ln(mn)}}function wn(t,e){this.fun=t;this.array=e}wn.prototype.run=function(){this.fun.apply(null,this.array)};var bn;if(typeof Object.create==="function"){bn=function t(e,i){e.super_=i;e.prototype=Object.create(i.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}})}}else{bn=function t(e,i){e.super_=i;var r=function(){};r.prototype=i.prototype;e.prototype=new r;e.prototype.constructor=e}}var _n=bn;var xn=/%[sdj%]/g;function kn(t){if(!qn(t)){var e=[];for(var i=0;i<arguments.length;i++){e.push(Tn(arguments[i]))}return e.join(" ")}var i=1;var r=arguments;var n=r.length;var s=String(t).replace(xn,(function(t){if(t==="%%")return"%";if(i>=n)return t;switch(t){case"%s":return String(r[i++]);case"%d":return Number(r[i++]);case"%j":try{return JSON.stringify(r[i++])}catch(e){return"[Circular]"}default:return t}}));for(var o=r[i];i<n;o=r[++i]){if(Mn(o)||!Yn(o)){s+=" "+o}else{s+=" "+Tn(o)}}return s}function En(t,e){if(Wn(Li.process)){return function(){return En(t,e).apply(this,arguments)}}var i=false;function r(){if(!i){{console.error(e)}i=true}return t.apply(this,arguments)}return r}var Sn={};var Cn;function Rn(t){if(Wn(Cn))Cn="";t=t.toUpperCase();if(!Sn[t]){if(new RegExp("\\b"+t+"\\b","i").test(Cn)){var e=0;Sn[t]=function(){var i=kn.apply(null,arguments);console.error("%s %d: %s",t,e,i)}}else{Sn[t]=function(){}}}return Sn[t]}function Tn(t,e){var i={seen:[],stylize:On};if(arguments.length>=3)i.depth=arguments[2];if(arguments.length>=4)i.colors=arguments[3];if(Un(e)){i.showHidden=e}else if(e){Gn(i,e)}if(Wn(i.showHidden))i.showHidden=false;if(Wn(i.depth))i.depth=2;if(Wn(i.colors))i.colors=false;if(Wn(i.customInspect))i.customInspect=true;if(i.colors)i.stylize=An;return In(i,t,i.depth)}Tn.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Tn.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function An(t,e){var i=Tn.styles[e];if(i){return"["+Tn.colors[i][0]+"m"+t+"["+Tn.colors[i][1]+"m"}else{return t}}function On(t,e){return t}function Ln(t){var e={};t.forEach((function(t,i){e[t]=true}));return e}function In(t,e,i){if(t.customInspect&&e&&Xn(e.inspect)&&e.inspect!==Tn&&!(e.constructor&&e.constructor.prototype===e)){var r=e.inspect(i,t);if(!qn(r)){r=In(t,r,i)}return r}var n=zn(t,e);if(n){return n}var s=Object.keys(e);var o=Ln(s);if(t.showHidden){s=Object.getOwnPropertyNames(e)}if(Vn(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0)){return Pn(e)}if(s.length===0){if(Xn(e)){var a=e.name?": "+e.name:"";return t.stylize("[Function"+a+"]","special")}if(Hn(e)){return t.stylize(RegExp.prototype.toString.call(e),"regexp")}if(Zn(e)){return t.stylize(Date.prototype.toString.call(e),"date")}if(Vn(e)){return Pn(e)}}var h="",f=false,l=["{","}"];if(jn(e)){f=true;l=["[","]"]}if(Xn(e)){var u=e.name?": "+e.name:"";h=" [Function"+u+"]"}if(Hn(e)){h=" "+RegExp.prototype.toString.call(e)}if(Zn(e)){h=" "+Date.prototype.toUTCString.call(e)}if(Vn(e)){h=" "+Pn(e)}if(s.length===0&&(!f||e.length==0)){return l[0]+h+l[1]}if(i<0){if(Hn(e)){return t.stylize(RegExp.prototype.toString.call(e),"regexp")}else{return t.stylize("[Object]","special")}}t.seen.push(e);var c;if(f){c=Nn(t,e,i,o,s)}else{c=s.map((function(r){return Bn(t,e,i,o,r,f)}))}t.seen.pop();return Dn(c,h,l)}function zn(t,e){if(Wn(e))return t.stylize("undefined","undefined");if(qn(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}if(Fn(e))return t.stylize(""+e,"number");if(Un(e))return t.stylize(""+e,"boolean");if(Mn(e))return t.stylize("null","null")}function Pn(t){return"["+Error.prototype.toString.call(t)+"]"}function Nn(t,e,i,r,n){var s=[];for(var o=0,a=e.length;o<a;++o){if(Jn(e,String(o))){s.push(Bn(t,e,i,r,String(o),true))}else{s.push("")}}n.forEach((function(n){if(!n.match(/^\d+$/)){s.push(Bn(t,e,i,r,n,true))}}));return s}function Bn(t,e,i,r,n,s){var o,a,h;h=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]};if(h.get){if(h.set){a=t.stylize("[Getter/Setter]","special")}else{a=t.stylize("[Getter]","special")}}else{if(h.set){a=t.stylize("[Setter]","special")}}if(!Jn(r,n)){o="["+n+"]"}if(!a){if(t.seen.indexOf(h.value)<0){if(Mn(i)){a=In(t,h.value,null)}else{a=In(t,h.value,i-1)}if(a.indexOf("\n")>-1){if(s){a=a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2)}else{a="\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")}}}else{a=t.stylize("[Circular]","special")}}if(Wn(o)){if(s&&n.match(/^\d+$/)){return a}o=JSON.stringify(""+n);if(o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){o=o.substr(1,o.length-2);o=t.stylize(o,"name")}else{o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");o=t.stylize(o,"string")}}return o+": "+a}function Dn(t,e,i){var r=t.reduce((function(t,e){if(e.indexOf("\n")>=0);return t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(r>60){return i[0]+(e===""?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1]}return i[0]+e+" "+t.join(", ")+" "+i[1]}function jn(t){return Array.isArray(t)}function Un(t){return typeof t==="boolean"}function Mn(t){return t===null}function Fn(t){return typeof t==="number"}function qn(t){return typeof t==="string"}function Wn(t){return t===void 0}function Hn(t){return Yn(t)&&Kn(t)==="[object RegExp]"}function Yn(t){return typeof t==="object"&&t!==null}function Zn(t){return Yn(t)&&Kn(t)==="[object Date]"}function Vn(t){return Yn(t)&&(Kn(t)==="[object Error]"||t instanceof Error)}function Xn(t){return typeof t==="function"}function Kn(t){return Object.prototype.toString.call(t)}function Gn(t,e){if(!e||!Yn(e))return t;var i=Object.keys(e);var r=i.length;while(r--){t[i[r]]=e[i[r]]}return t}function Jn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $n(){this.head=null;this.tail=null;this.length=0}$n.prototype.push=function(t){var e={data:t,next:null};if(this.length>0)this.tail.next=e;else this.head=e;this.tail=e;++this.length};$n.prototype.unshift=function(t){var e={data:t,next:this.head};if(this.length===0)this.tail=e;this.head=e;++this.length};$n.prototype.shift=function(){if(this.length===0)return;var t=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return t};$n.prototype.clear=function(){this.head=this.tail=null;this.length=0};$n.prototype.join=function(t){if(this.length===0)return"";var e=this.head;var i=""+e.data;while(e=e.next){i+=t+e.data}return i};$n.prototype.concat=function(t){if(this.length===0)return Xi.alloc(0);if(this.length===1)return this.head.data;var e=Xi.allocUnsafe(t>>>0);var i=this.head;var r=0;while(i){i.data.copy(e,r);r+=i.data.length;i=i.next}return e};var Qn=Xi.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function ts(t){if(t&&!Qn(t)){throw new Error("Unknown encoding: "+t)}}function es(t){this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,"");ts(t);switch(this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2;this.detectIncompleteChar=rs;break;case"base64":this.surrogateSize=3;this.detectIncompleteChar=ns;break;default:this.write=is;return}this.charBuffer=new Xi(6);this.charReceived=0;this.charLength=0}es.prototype.write=function(t){var e="";while(this.charLength){var i=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;t.copy(this.charBuffer,this.charReceived,0,i);this.charReceived+=i;if(this.charReceived<this.charLength){return""}t=t.slice(i,t.length);e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=e.charCodeAt(e.length-1);if(r>=55296&&r<=56319){this.charLength+=this.surrogateSize;e="";continue}this.charReceived=this.charLength=0;if(t.length===0){return e}break}this.detectIncompleteChar(t);var n=t.length;if(this.charLength){t.copy(this.charBuffer,0,t.length-this.charReceived,n);n-=this.charReceived}e+=t.toString(this.encoding,0,n);var n=e.length-1;var r=e.charCodeAt(n);if(r>=55296&&r<=56319){var s=this.surrogateSize;this.charLength+=s;this.charReceived+=s;this.charBuffer.copy(this.charBuffer,s,0,s);t.copy(this.charBuffer,0,0,s);return e.substring(0,n)}return e};es.prototype.detectIncompleteChar=function(t){var e=t.length>=3?3:t.length;for(;e>0;e--){var i=t[t.length-e];if(e==1&&i>>5==6){this.charLength=2;break}if(e<=2&&i>>4==14){this.charLength=3;break}if(e<=3&&i>>3==30){this.charLength=4;break}}this.charReceived=e};es.prototype.end=function(t){var e="";if(t&&t.length)e=this.write(t);if(this.charReceived){var i=this.charReceived;var r=this.charBuffer;var n=this.encoding;e+=r.slice(0,i).toString(n)}return e};function is(t){return t.toString(this.encoding)}function rs(t){this.charReceived=t.length%2;this.charLength=this.charReceived?2:0}function ns(t){this.charReceived=t.length%3;this.charLength=this.charReceived?3:0}fs.ReadableState=hs;var ss=Rn("stream");_n(fs,Yr);function os(t,e,i){if(typeof t.prependListener==="function"){return t.prependListener(e,i)}else{if(!t._events||!t._events[e])t.on(e,i);else if(Array.isArray(t._events[e]))t._events[e].unshift(i);else t._events[e]=[i,t._events[e]]}}function as(t,e){return t.listeners(e).length}function hs(t,e){t=t||{};this.objectMode=!!t.objectMode;if(e instanceof ro)this.objectMode=this.objectMode||!!t.readableObjectMode;var i=t.highWaterMark;var r=this.objectMode?16:16*1024;this.highWaterMark=i||i===0?i:r;this.highWaterMark=~~this.highWaterMark;this.buffer=new $n;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.defaultEncoding=t.defaultEncoding||"utf8";this.ranOut=false;this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(t.encoding){this.decoder=new es(t.encoding);this.encoding=t.encoding}}function fs(t){if(!(this instanceof fs))return new fs(t);this._readableState=new hs(t,this);this.readable=true;if(t&&typeof t.read==="function")this._read=t.read;Yr.call(this)}fs.prototype.push=function(t,e){var i=this._readableState;if(!i.objectMode&&typeof t==="string"){e=e||i.defaultEncoding;if(e!==i.encoding){t=Xi.from(t,e);e=""}}return ls(this,i,t,e,false)};fs.prototype.unshift=function(t){var e=this._readableState;return ls(this,e,t,"",true)};fs.prototype.isPaused=function(){return this._readableState.flowing===false};function ls(t,e,i,r,n){var s=vs(e,i);if(s){t.emit("error",s)}else if(i===null){e.reading=false;gs(t,e)}else if(e.objectMode||i&&i.length>0){if(e.ended&&!n){var o=new Error("stream.push() after EOF");t.emit("error",o)}else if(e.endEmitted&&n){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else{var h;if(e.decoder&&!n&&!r){i=e.decoder.write(i);h=!e.objectMode&&i.length===0}if(!n)e.reading=false;if(!h){if(e.flowing&&e.length===0&&!e.sync){t.emit("data",i);t.read(0)}else{e.length+=e.objectMode?1:i.length;if(n)e.buffer.unshift(i);else e.buffer.push(i);if(e.needReadable)ms(t)}}ws(t,e)}}else if(!n){e.reading=false}return us(e)}function us(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}fs.prototype.setEncoding=function(t){this._readableState.decoder=new es(t);this._readableState.encoding=t;return this};var cs=8388608;function ds(t){if(t>=cs){t=cs}else{t--;t|=t>>>1;t|=t>>>2;t|=t>>>4;t|=t>>>8;t|=t>>>16;t++}return t}function ps(t,e){if(t<=0||e.length===0&&e.ended)return 0;if(e.objectMode)return 1;if(t!==t){if(e.flowing&&e.length)return e.buffer.head.data.length;else return e.length}if(t>e.highWaterMark)e.highWaterMark=ds(t);if(t<=e.length)return t;if(!e.ended){e.needReadable=true;return 0}return e.length}fs.prototype.read=function(t){ss("read",t);t=parseInt(t,10);var e=this._readableState;var i=t;if(t!==0)e.emittedReadable=false;if(t===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended)){ss("read: emitReadable",e.length,e.ended);if(e.length===0&&e.ended)Os(this);else ms(this);return null}t=ps(t,e);if(t===0&&e.ended){if(e.length===0)Os(this);return null}var r=e.needReadable;ss("need readable",r);if(e.length===0||e.length-t<e.highWaterMark){r=true;ss("length less than watermark",r)}if(e.ended||e.reading){r=false;ss("reading or ended",r)}else if(r){ss("do read");e.reading=true;e.sync=true;if(e.length===0)e.needReadable=true;this._read(e.highWaterMark);e.sync=false;if(!e.reading)t=ps(i,e)}var n;if(t>0)n=Cs(t,e);else n=null;if(n===null){e.needReadable=true;t=0}else{e.length-=t}if(e.length===0){if(!e.ended)e.needReadable=true;if(i!==t&&e.ended)Os(this)}if(n!==null)this.emit("data",n);return n};function vs(t,e){var i=null;if(!Xi.isBuffer(e)&&typeof e!=="string"&&e!==null&&e!==undefined&&!t.objectMode){i=new TypeError("Invalid non-string/buffer chunk")}return i}function gs(t,e){if(e.ended)return;if(e.decoder){var i=e.decoder.end();if(i&&i.length){e.buffer.push(i);e.length+=e.objectMode?1:i.length}}e.ended=true;ms(t)}function ms(t){var e=t._readableState;e.needReadable=false;if(!e.emittedReadable){ss("emitReadable",e.flowing);e.emittedReadable=true;if(e.sync)yn(ys,t);else ys(t)}}function ys(t){ss("emit readable");t.emit("readable");Ss(t)}function ws(t,e){if(!e.readingMore){e.readingMore=true;yn(bs,t,e)}}function bs(t,e){var i=e.length;while(!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark){ss("maybeReadMore read 0");t.read(0);if(i===e.length)break;else i=e.length}e.readingMore=false}fs.prototype._read=function(t){this.emit("error",new Error("not implemented"))};fs.prototype.pipe=function(t,e){var i=this;var r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t);break}r.pipesCount+=1;ss("pipe count=%d opts=%j",r.pipesCount,e);var n=!e||e.end!==false;var s=n?a:l;if(r.endEmitted)yn(s);else i.once("end",s);t.on("unpipe",o);function o(t){ss("onunpipe");if(t===i){l()}}function a(){ss("onend");t.end()}var h=_s(i);t.on("drain",h);var f=false;function l(){ss("cleanup");t.removeListener("close",p);t.removeListener("finish",v);t.removeListener("drain",h);t.removeListener("error",d);t.removeListener("unpipe",o);i.removeListener("end",a);i.removeListener("end",l);i.removeListener("data",c);f=true;if(r.awaitDrain&&(!t._writableState||t._writableState.needDrain))h()}var u=false;i.on("data",c);function c(e){ss("ondata");u=false;var n=t.write(e);if(false===n&&!u){if((r.pipesCount===1&&r.pipes===t||r.pipesCount>1&&zs(r.pipes,t)!==-1)&&!f){ss("false write response, pause",i._readableState.awaitDrain);i._readableState.awaitDrain++;u=true}i.pause()}}function d(e){ss("onerror",e);g();t.removeListener("error",d);if(as(t,"error")===0)t.emit("error",e)}os(t,"error",d);function p(){t.removeListener("finish",v);g()}t.once("close",p);function v(){ss("onfinish");t.removeListener("close",p);g()}t.once("finish",v);function g(){ss("unpipe");i.unpipe(t)}t.emit("pipe",i);if(!r.flowing){ss("pipe resume");i.resume()}return t};function _s(t){return function(){var e=t._readableState;ss("pipeOnDrain",e.awaitDrain);if(e.awaitDrain)e.awaitDrain--;if(e.awaitDrain===0&&t.listeners("data").length){e.flowing=true;Ss(t)}}}fs.prototype.unpipe=function(t){var e=this._readableState;if(e.pipesCount===0)return this;if(e.pipesCount===1){if(t&&t!==e.pipes)return this;if(!t)t=e.pipes;e.pipes=null;e.pipesCount=0;e.flowing=false;if(t)t.emit("unpipe",this);return this}if(!t){var i=e.pipes;var r=e.pipesCount;e.pipes=null;e.pipesCount=0;e.flowing=false;for(var n=0;n<r;n++){i[n].emit("unpipe",this)}return this}var s=zs(e.pipes,t);if(s===-1)return this;e.pipes.splice(s,1);e.pipesCount-=1;if(e.pipesCount===1)e.pipes=e.pipes[0];t.emit("unpipe",this);return this};fs.prototype.on=function(t,e){var i=Yr.prototype.on.call(this,t,e);if(t==="data"){if(this._readableState.flowing!==false)this.resume()}else if(t==="readable"){var r=this._readableState;if(!r.endEmitted&&!r.readableListening){r.readableListening=r.needReadable=true;r.emittedReadable=false;if(!r.reading){yn(xs,this)}else if(r.length){ms(this)}}}return i};fs.prototype.addListener=fs.prototype.on;function xs(t){ss("readable nexttick read 0");t.read(0)}fs.prototype.resume=function(){var t=this._readableState;if(!t.flowing){ss("resume");t.flowing=true;ks(this,t)}return this};function ks(t,e){if(!e.resumeScheduled){e.resumeScheduled=true;yn(Es,t,e)}}function Es(t,e){if(!e.reading){ss("resume read 0");t.read(0)}e.resumeScheduled=false;e.awaitDrain=0;t.emit("resume");Ss(t);if(e.flowing&&!e.reading)t.read(0)}fs.prototype.pause=function(){ss("call pause flowing=%j",this._readableState.flowing);if(false!==this._readableState.flowing){ss("pause");this._readableState.flowing=false;this.emit("pause")}return this};function Ss(t){var e=t._readableState;ss("flow",e.flowing);while(e.flowing&&t.read()!==null){}}fs.prototype.wrap=function(t){var e=this._readableState;var i=false;var r=this;t.on("end",(function(){ss("wrapped end");if(e.decoder&&!e.ended){var t=e.decoder.end();if(t&&t.length)r.push(t)}r.push(null)}));t.on("data",(function(n){ss("wrapped data");if(e.decoder)n=e.decoder.write(n);if(e.objectMode&&(n===null||n===undefined))return;else if(!e.objectMode&&(!n||!n.length))return;var s=r.push(n);if(!s){i=true;t.pause()}}));for(var n in t){if(this[n]===undefined&&typeof t[n]==="function"){this[n]=function(e){return function(){return t[e].apply(t,arguments)}}(n)}}var s=["error","close","destroy","pause","resume"];Is(s,(function(e){t.on(e,r.emit.bind(r,e))}));r._read=function(e){ss("wrapped _read",e);if(i){i=false;t.resume()}};return r};fs._fromList=Cs;function Cs(t,e){if(e.length===0)return null;var i;if(e.objectMode)i=e.buffer.shift();else if(!t||t>=e.length){if(e.decoder)i=e.buffer.join("");else if(e.buffer.length===1)i=e.buffer.head.data;else i=e.buffer.concat(e.length);e.buffer.clear()}else{i=Rs(t,e.buffer,e.decoder)}return i}function Rs(t,e,i){var r;if(t<e.head.data.length){r=e.head.data.slice(0,t);e.head.data=e.head.data.slice(t)}else if(t===e.head.data.length){r=e.shift()}else{r=i?Ts(t,e):As(t,e)}return r}function Ts(t,e){var i=e.head;var r=1;var n=i.data;t-=n.length;while(i=i.next){var s=i.data;var o=t>s.length?s.length:t;if(o===s.length)n+=s;else n+=s.slice(0,t);t-=o;if(t===0){if(o===s.length){++r;if(i.next)e.head=i.next;else e.head=e.tail=null}else{e.head=i;i.data=s.slice(o)}break}++r}e.length-=r;return n}function As(t,e){var i=Xi.allocUnsafe(t);var r=e.head;var n=1;r.data.copy(i);t-=r.data.length;while(r=r.next){var s=r.data;var o=t>s.length?s.length:t;s.copy(i,i.length-t,0,o);t-=o;if(t===0){if(o===s.length){++n;if(r.next)e.head=r.next;else e.head=e.tail=null}else{e.head=r;r.data=s.slice(o)}break}++n}e.length-=n;return i}function Os(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');if(!e.endEmitted){e.ended=true;yn(Ls,e,t)}}function Ls(t,e){if(!t.endEmitted&&t.length===0){t.endEmitted=true;e.readable=false;e.emit("end")}}function Is(t,e){for(var i=0,r=t.length;i<r;i++){e(t[i],i)}}function zs(t,e){for(var i=0,r=t.length;i<r;i++){if(t[i]===e)return i}return-1}Ds.WritableState=Bs;_n(Ds,Yr);function Ps(){}function Ns(t,e,i){this.chunk=t;this.encoding=e;this.callback=i;this.next=null}function Bs(t,e){Object.defineProperty(this,"buffer",{get:En((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.")});t=t||{};this.objectMode=!!t.objectMode;if(e instanceof ro)this.objectMode=this.objectMode||!!t.writableObjectMode;var i=t.highWaterMark;var r=this.objectMode?16:16*1024;this.highWaterMark=i||i===0?i:r;this.highWaterMark=~~this.highWaterMark;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;var n=t.decodeStrings===false;this.decodeStrings=!n;this.defaultEncoding=t.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(t){Ys(e,t)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.bufferedRequestCount=0;this.corkedRequestsFree=new Qs(this)}Bs.prototype.getBuffer=function t(){var e=this.bufferedRequest;var i=[];while(e){i.push(e);e=e.next}return i};function Ds(t){if(!(this instanceof Ds)&&!(this instanceof ro))return new Ds(t);this._writableState=new Bs(t,this);this.writable=true;if(t){if(typeof t.write==="function")this._write=t.write;if(typeof t.writev==="function")this._writev=t.writev}Yr.call(this)}Ds.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function js(t,e){var i=new Error("write after end");t.emit("error",i);yn(e,i)}function Us(t,e,i,r){var n=true;var s=false;if(i===null){s=new TypeError("May not write null values to stream")}else if(!Xi.isBuffer(i)&&typeof i!=="string"&&i!==undefined&&!e.objectMode){s=new TypeError("Invalid non-string/buffer chunk")}if(s){t.emit("error",s);yn(r,s);n=false}return n}Ds.prototype.write=function(t,e,i){var r=this._writableState;var n=false;if(typeof e==="function"){i=e;e=null}if(Xi.isBuffer(t))e="buffer";else if(!e)e=r.defaultEncoding;if(typeof i!=="function")i=Ps;if(r.ended)js(this,i);else if(Us(this,r,t,i)){r.pendingcb++;n=Fs(this,r,t,e,i)}return n};Ds.prototype.cork=function(){var t=this._writableState;t.corked++};Ds.prototype.uncork=function(){var t=this._writableState;if(t.corked){t.corked--;if(!t.writing&&!t.corked&&!t.finished&&!t.bufferProcessing&&t.bufferedRequest)Xs(this,t)}};Ds.prototype.setDefaultEncoding=function t(e){if(typeof e==="string")e=e.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);this._writableState.defaultEncoding=e;return this};function Ms(t,e,i){if(!t.objectMode&&t.decodeStrings!==false&&typeof e==="string"){e=Xi.from(e,i)}return e}function Fs(t,e,i,r,n){i=Ms(e,i,r);if(Xi.isBuffer(i))r="buffer";var s=e.objectMode?1:i.length;e.length+=s;var o=e.length<e.highWaterMark;if(!o)e.needDrain=true;if(e.writing||e.corked){var a=e.lastBufferedRequest;e.lastBufferedRequest=new Ns(i,r,n);if(a){a.next=e.lastBufferedRequest}else{e.bufferedRequest=e.lastBufferedRequest}e.bufferedRequestCount+=1}else{qs(t,e,false,s,i,r,n)}return o}function qs(t,e,i,r,n,s,o){e.writelen=r;e.writecb=o;e.writing=true;e.sync=true;if(i)t._writev(n,e.onwrite);else t._write(n,s,e.onwrite);e.sync=false}function Ws(t,e,i,r,n){--e.pendingcb;if(i)yn(n,r);else n(r);t._writableState.errorEmitted=true;t.emit("error",r)}function Hs(t){t.writing=false;t.writecb=null;t.length-=t.writelen;t.writelen=0}function Ys(t,e){var i=t._writableState;var r=i.sync;var n=i.writecb;Hs(i);if(e)Ws(t,i,r,e,n);else{var s=Ks(i);if(!s&&!i.corked&&!i.bufferProcessing&&i.bufferedRequest){Xs(t,i)}if(r){yn(Zs,t,i,s,n)}else{Zs(t,i,s,n)}}}function Zs(t,e,i,r){if(!i)Vs(t,e);e.pendingcb--;r();Js(t,e)}function Vs(t,e){if(e.length===0&&e.needDrain){e.needDrain=false;t.emit("drain")}}function Xs(t,e){e.bufferProcessing=true;var i=e.bufferedRequest;if(t._writev&&i&&i.next){var r=e.bufferedRequestCount;var n=new Array(r);var s=e.corkedRequestsFree;s.entry=i;var o=0;while(i){n[o]=i;i=i.next;o+=1}qs(t,e,true,e.length,n,"",s.finish);e.pendingcb++;e.lastBufferedRequest=null;if(s.next){e.corkedRequestsFree=s.next;s.next=null}else{e.corkedRequestsFree=new Qs(e)}}else{while(i){var a=i.chunk;var h=i.encoding;var f=i.callback;var l=e.objectMode?1:a.length;qs(t,e,false,l,a,h,f);i=i.next;if(e.writing){break}}if(i===null)e.lastBufferedRequest=null}e.bufferedRequestCount=0;e.bufferedRequest=i;e.bufferProcessing=false}Ds.prototype._write=function(t,e,i){i(new Error("not implemented"))};Ds.prototype._writev=null;Ds.prototype.end=function(t,e,i){var r=this._writableState;if(typeof t==="function"){i=t;t=null;e=null}else if(typeof e==="function"){i=e;e=null}if(t!==null&&t!==undefined)this.write(t,e);if(r.corked){r.corked=1;this.uncork()}if(!r.ending&&!r.finished)$s(this,r,i)};function Ks(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function Gs(t,e){if(!e.prefinished){e.prefinished=true;t.emit("prefinish")}}function Js(t,e){var i=Ks(e);if(i){if(e.pendingcb===0){Gs(t,e);e.finished=true;t.emit("finish")}else{Gs(t,e)}}return i}function $s(t,e,i){e.ending=true;Js(t,e);if(i){if(e.finished)yn(i);else t.once("finish",i)}e.ended=true;t.writable=false}function Qs(t){var e=this;this.next=null;this.entry=null;this.finish=function(i){var r=e.entry;e.entry=null;while(r){var n=r.callback;t.pendingcb--;n(i);r=r.next}if(t.corkedRequestsFree){t.corkedRequestsFree.next=e}else{t.corkedRequestsFree=e}}}_n(ro,fs);var to=Object.keys(Ds.prototype);for(var eo=0;eo<to.length;eo++){var io=to[eo];if(!ro.prototype[io])ro.prototype[io]=Ds.prototype[io]}function ro(t){if(!(this instanceof ro))return new ro(t);fs.call(this,t);Ds.call(this,t);if(t&&t.readable===false)this.readable=false;if(t&&t.writable===false)this.writable=false;this.allowHalfOpen=true;if(t&&t.allowHalfOpen===false)this.allowHalfOpen=false;this.once("end",no)}function no(){if(this.allowHalfOpen||this._writableState.ended)return;yn(so,this)}function so(t){t.end()}_n(ho,ro);function oo(t){this.afterTransform=function(e,i){return ao(t,e,i)};this.needTransform=false;this.transforming=false;this.writecb=null;this.writechunk=null;this.writeencoding=null}function ao(t,e,i){var r=t._transformState;r.transforming=false;var n=r.writecb;if(!n)return t.emit("error",new Error("no writecb in Transform class"));r.writechunk=null;r.writecb=null;if(i!==null&&i!==undefined)t.push(i);n(e);var s=t._readableState;s.reading=false;if(s.needReadable||s.length<s.highWaterMark){t._read(s.highWaterMark)}}function ho(t){if(!(this instanceof ho))return new ho(t);ro.call(this,t);this._transformState=new oo(this);var e=this;this._readableState.needReadable=true;this._readableState.sync=false;if(t){if(typeof t.transform==="function")this._transform=t.transform;if(typeof t.flush==="function")this._flush=t.flush}this.once("prefinish",(function(){if(typeof this._flush==="function")this._flush((function(t){fo(e,t)}));else fo(e)}))}ho.prototype.push=function(t,e){this._transformState.needTransform=false;return ro.prototype.push.call(this,t,e)};ho.prototype._transform=function(t,e,i){throw new Error("Not implemented")};ho.prototype._write=function(t,e,i){var r=this._transformState;r.writecb=i;r.writechunk=t;r.writeencoding=e;if(!r.transforming){var n=this._readableState;if(r.needTransform||n.needReadable||n.length<n.highWaterMark)this._read(n.highWaterMark)}};ho.prototype._read=function(t){var e=this._transformState;if(e.writechunk!==null&&e.writecb&&!e.transforming){e.transforming=true;this._transform(e.writechunk,e.writeencoding,e.afterTransform)}else{e.needTransform=true}};function fo(t,e){if(e)return t.emit("error",e);var i=t._writableState;var r=t._transformState;if(i.length)throw new Error("Calling transform done when ws.length != 0");if(r.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}_n(lo,ho);function lo(t){if(!(this instanceof lo))return new lo(t);ho.call(this,t)}lo.prototype._transform=function(t,e,i){i(null,t)};_n(uo,Yr);uo.Readable=fs;uo.Writable=Ds;uo.Duplex=ro;uo.Transform=ho;uo.PassThrough=lo;uo.Stream=uo;function uo(){Yr.call(this)}uo.prototype.pipe=function(t,e){var i=this;function r(e){if(t.writable){if(false===t.write(e)&&i.pause){i.pause()}}}i.on("data",r);function n(){if(i.readable&&i.resume){i.resume()}}t.on("drain",n);if(!t._isStdio&&(!e||e.end!==false)){i.on("end",o);i.on("close",a)}var s=false;function o(){if(s)return;s=true;t.end()}function a(){if(s)return;s=true;if(typeof t.destroy==="function")t.destroy()}function h(t){f();if(Yr.listenerCount(this,"error")===0){throw t}}i.on("error",h);t.on("error",h);function f(){i.removeListener("data",r);t.removeListener("drain",n);i.removeListener("end",o);i.removeListener("close",a);i.removeListener("error",h);t.removeListener("error",h);i.removeListener("end",f);i.removeListener("close",f);t.removeListener("close",f)}i.on("end",f);i.on("close",f);t.on("close",f);t.emit("pipe",i);return t};var co=uo;var po=a((function(t,e){e.base64=true;e.array=true;e.string=true;e.arraybuffer=typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined";e.nodebuffer=typeof Xi!=="undefined";e.uint8array=typeof Uint8Array!=="undefined";if(typeof ArrayBuffer==="undefined"){e.blob=false}else{var i=new ArrayBuffer(0);try{e.blob=new Blob([i],{type:"application/zip"}).size===0}catch(s){try{var r=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder;var n=new r;n.append(i);e.blob=n.getBlob("application/zip").size===0}catch(s){e.blob=false}}}try{e.nodestream=!!co.Readable}catch(s){e.nodestream=false}}));var vo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var go=function(t){var e=[];var i,r,n,s,o,a,h;var f=0,l=t.length,u=l;var c=Go.getTypeOf(t)!=="string";while(f<t.length){u=l-f;if(!c){i=t.charCodeAt(f++);r=f<l?t.charCodeAt(f++):0;n=f<l?t.charCodeAt(f++):0}else{i=t[f++];r=f<l?t[f++]:0;n=f<l?t[f++]:0}s=i>>2;o=(i&3)<<4|r>>4;a=u>1?(r&15)<<2|n>>6:64;h=u>2?n&63:64;e.push(vo.charAt(s)+vo.charAt(o)+vo.charAt(a)+vo.charAt(h))}return e.join("")};var mo=function(t){var e,i,r;var n,s,o,a;var h=0,f=0;var l="data:";if(t.substr(0,l.length)===l){throw new Error("Invalid base64 input, it looks like a data url.")}t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");var u=t.length*3/4;if(t.charAt(t.length-1)===vo.charAt(64)){u--}if(t.charAt(t.length-2)===vo.charAt(64)){u--}if(u%1!==0){throw new Error("Invalid base64 input, bad content length.")}var c;if(po.uint8array){c=new Uint8Array(u|0)}else{c=new Array(u|0)}while(h<t.length){n=vo.indexOf(t.charAt(h++));s=vo.indexOf(t.charAt(h++));o=vo.indexOf(t.charAt(h++));a=vo.indexOf(t.charAt(h++));e=n<<2|s>>4;i=(s&15)<<4|o>>2;r=(o&3)<<6|a;c[f++]=e;if(o!==64){c[f++]=i}if(a!==64){c[f++]=r}}return c};var yo={encode:go,decode:mo};var wo={isNode:typeof Xi!=="undefined",newBufferFrom:function(t,e){if(Xi.from&&Xi.from!==Uint8Array.from){return Xi.from(t,e)}else{if(typeof t==="number"){throw new Error('The "data" argument must not be a number')}return new Xi(t,e)}},allocBuffer:function(t){if(Xi.alloc){return Xi.alloc(t)}else{var e=new Xi(t);e.fill(0);return e}},isBuffer:function(t){return Xi.isBuffer(t)},isStream:function(t){return t&&typeof t.on==="function"&&typeof t.pause==="function"&&typeof t.resume==="function"}};var bo=typeof setImmediate==="function"?setImmediate:function t(){var e=[].slice.apply(arguments);e.splice(1,0,0);setTimeout.apply(null,e)};var _o=s.MutationObserver||s.WebKitMutationObserver;var xo;{if(_o){var ko=0;var Eo=new _o(Ao);var So=s.document.createTextNode("");Eo.observe(So,{characterData:true});xo=function(){So.data=ko=++ko%2}}else if(!s.setImmediate&&typeof s.MessageChannel!=="undefined"){var Co=new s.MessageChannel;Co.port1.onmessage=Ao;xo=function(){Co.port2.postMessage(0)}}else if("document"in s&&"onreadystatechange"in s.document.createElement("script")){xo=function(){var t=s.document.createElement("script");t.onreadystatechange=function(){Ao();t.onreadystatechange=null;t.parentNode.removeChild(t);t=null};s.document.documentElement.appendChild(t)}}else{xo=function(){setTimeout(Ao,0)}}}var Ro;var To=[];function Ao(){Ro=true;var t,e;var i=To.length;while(i){e=To;To=[];t=-1;while(++t<i){e[t]()}i=To.length}Ro=false}var Oo=Lo;function Lo(t){if(To.push(t)===1&&!Ro){xo()}}function Io(){}var zo={};var Po=["REJECTED"];var No=["FULFILLED"];var Bo=["PENDING"];var Do=jo;function jo(t){if(typeof t!=="function"){throw new TypeError("resolver must be a function")}this.state=Bo;this.queue=[];this.outcome=void 0;if(t!==Io){qo(this,t)}}jo.prototype["finally"]=function(t){if(typeof t!=="function"){return this}var e=this.constructor;return this.then(i,r);function i(i){function r(){return i}return e.resolve(t()).then(r)}function r(i){function r(){throw i}return e.resolve(t()).then(r)}};jo.prototype["catch"]=function(t){return this.then(null,t)};jo.prototype.then=function(t,e){if(typeof t!=="function"&&this.state===No||typeof e!=="function"&&this.state===Po){return this}var i=new this.constructor(Io);if(this.state!==Bo){var r=this.state===No?t:e;Mo(i,r,this.outcome)}else{this.queue.push(new Uo(i,t,e))}return i};function Uo(t,e,i){this.promise=t;if(typeof e==="function"){this.onFulfilled=e;this.callFulfilled=this.otherCallFulfilled}if(typeof i==="function"){this.onRejected=i;this.callRejected=this.otherCallRejected}}Uo.prototype.callFulfilled=function(t){zo.resolve(this.promise,t)};Uo.prototype.otherCallFulfilled=function(t){Mo(this.promise,this.onFulfilled,t)};Uo.prototype.callRejected=function(t){zo.reject(this.promise,t)};Uo.prototype.otherCallRejected=function(t){Mo(this.promise,this.onRejected,t)};function Mo(t,e,i){Oo((function(){var r;try{r=e(i)}catch(n){return zo.reject(t,n)}if(r===t){zo.reject(t,new TypeError("Cannot resolve promise with itself"))}else{zo.resolve(t,r)}}))}zo.resolve=function(t,e){var i=Wo(Fo,e);if(i.status==="error"){return zo.reject(t,i.value)}var r=i.value;if(r){qo(t,r)}else{t.state=No;t.outcome=e;var n=-1;var s=t.queue.length;while(++n<s){t.queue[n].callFulfilled(e)}}return t};zo.reject=function(t,e){t.state=Po;t.outcome=e;var i=-1;var r=t.queue.length;while(++i<r){t.queue[i].callRejected(e)}return t};function Fo(t){var e=t&&t.then;if(t&&(typeof t==="object"||typeof t==="function")&&typeof e==="function"){return function i(){e.apply(t,arguments)}}}function qo(t,e){var i=false;function r(e){if(i){return}i=true;zo.reject(t,e)}function n(e){if(i){return}i=true;zo.resolve(t,e)}function s(){e(n,r)}var o=Wo(s);if(o.status==="error"){r(o.value)}}function Wo(t,e){var i={};try{i.value=t(e);i.status="success"}catch(r){i.status="error";i.value=r}return i}jo.resolve=Ho;function Ho(t){if(t instanceof this){return t}return zo.resolve(new this(Io),t)}jo.reject=Yo;function Yo(t){var e=new this(Io);return zo.reject(e,t)}jo.all=Zo;function Zo(t){var e=this;if(Object.prototype.toString.call(t)!=="[object Array]"){return this.reject(new TypeError("must be an array"))}var i=t.length;var r=false;if(!i){return this.resolve([])}var n=new Array(i);var s=0;var o=-1;var a=new this(Io);while(++o<i){h(t[o],o)}return a;function h(t,o){e.resolve(t).then(h,(function(t){if(!r){r=true;zo.reject(a,t)}}));function h(t){n[o]=t;if(++s===i&&!r){r=true;zo.resolve(a,n)}}}}jo.race=Vo;function Vo(t){var e=this;if(Object.prototype.toString.call(t)!=="[object Array]"){return this.reject(new TypeError("must be an array"))}var i=t.length;var r=false;if(!i){return this.resolve([])}var n=-1;var s=new this(Io);while(++n<i){o(t[n])}return s;function o(t){e.resolve(t).then((function(t){if(!r){r=true;zo.resolve(s,t)}}),(function(t){if(!r){r=true;zo.reject(s,t)}}))}}var Xo=null;if(typeof Promise!=="undefined"){Xo=Promise}else{Xo=Do}var Ko={Promise:Xo};var Go=a((function(t,e){function i(t){var e=null;if(po.uint8array){e=new Uint8Array(t.length)}else{e=new Array(t.length)}return n(t,e)}e.newBlob=function(t,i){e.checkSupport("blob");try{return new Blob([t],{type:i})}catch(s){try{var r=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder;var n=new r;n.append(t);return n.getBlob(i)}catch(s){throw new Error("Bug : can't construct the Blob.")}}};function r(t){return t}function n(t,e){for(var i=0;i<t.length;++i){e[i]=t.charCodeAt(i)&255}return e}var s={stringifyByChunk:function(t,e,i){var r=[],n=0,s=t.length;if(s<=i){return String.fromCharCode.apply(null,t)}while(n<s){if(e==="array"||e==="nodebuffer"){r.push(String.fromCharCode.apply(null,t.slice(n,Math.min(n+i,s))))}else{r.push(String.fromCharCode.apply(null,t.subarray(n,Math.min(n+i,s))))}n+=i}return r.join("")},stringifyByChar:function(t){var e="";for(var i=0;i<t.length;i++){e+=String.fromCharCode(t[i])}return e},applyCanBeUsed:{uint8array:function(){try{return po.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(t){return false}}(),nodebuffer:function(){try{return po.nodebuffer&&String.fromCharCode.apply(null,wo.allocBuffer(1)).length===1}catch(t){return false}}()}};function o(t){var i=65536,r=e.getTypeOf(t),n=true;if(r==="uint8array"){n=s.applyCanBeUsed.uint8array}else if(r==="nodebuffer"){n=s.applyCanBeUsed.nodebuffer}if(n){while(i>1){try{return s.stringifyByChunk(t,r,i)}catch(o){i=Math.floor(i/2)}}}return s.stringifyByChar(t)}e.applyFromCharCode=o;function a(t,e){for(var i=0;i<t.length;i++){e[i]=t[i]}return e}var h={};h["string"]={string:r,array:function(t){return n(t,new Array(t.length))},arraybuffer:function(t){return h["string"]["uint8array"](t).buffer},uint8array:function(t){return n(t,new Uint8Array(t.length))},nodebuffer:function(t){return n(t,wo.allocBuffer(t.length))}};h["array"]={string:o,array:r,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return wo.newBufferFrom(t)}};h["arraybuffer"]={string:function(t){return o(new Uint8Array(t))},array:function(t){return a(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:r,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return wo.newBufferFrom(new Uint8Array(t))}};h["uint8array"]={string:o,array:function(t){return a(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:r,nodebuffer:function(t){return wo.newBufferFrom(t)}};h["nodebuffer"]={string:o,array:function(t){return a(t,new Array(t.length))},arraybuffer:function(t){return h["nodebuffer"]["uint8array"](t).buffer},uint8array:function(t){return a(t,new Uint8Array(t.length))},nodebuffer:r};e.transformTo=function(t,i){if(!i){i=""}if(!t){return i}e.checkSupport(t);var r=e.getTypeOf(i);var n=h[r][t](i);return n};e.getTypeOf=function(t){if(typeof t==="string"){return"string"}if(Object.prototype.toString.call(t)==="[object Array]"){return"array"}if(po.nodebuffer&&wo.isBuffer(t)){return"nodebuffer"}if(po.uint8array&&t instanceof Uint8Array){return"uint8array"}if(po.arraybuffer&&t instanceof ArrayBuffer){return"arraybuffer"}};e.checkSupport=function(t){var e=po[t.toLowerCase()];if(!e){throw new Error(t+" is not supported by this platform")}};e.MAX_VALUE_16BITS=65535;e.MAX_VALUE_32BITS=-1;e.pretty=function(t){var e="",i,r;for(r=0;r<(t||"").length;r++){i=t.charCodeAt(r);e+="\\x"+(i<16?"0":"")+i.toString(16).toUpperCase()}return e};e.delay=function(t,e,i){bo((function(){t.apply(i||null,e||[])}))};e.inherits=function(t,e){var i=function(){};i.prototype=e.prototype;t.prototype=new i};e.extend=function(){var t={},e,i;for(e=0;e<arguments.length;e++){for(i in arguments[e]){if(arguments[e].hasOwnProperty(i)&&typeof t[i]==="undefined"){t[i]=arguments[e][i]}}}return t};e.prepareContent=function(t,r,n,s,o){var a=Ko.Promise.resolve(r).then((function(t){var e=po.blob&&(t instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t))!==-1);if(e&&typeof FileReader!=="undefined"){return new Ko.Promise((function(e,i){var r=new FileReader;r.onload=function(t){e(t.target.result)};r.onerror=function(t){i(t.target.error)};r.readAsArrayBuffer(t)}))}else{return t}}));return a.then((function(r){var a=e.getTypeOf(r);if(!a){return Ko.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it "+"in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}if(a==="arraybuffer"){r=e.transformTo("uint8array",r)}else if(a==="string"){if(o){r=yo.decode(r)}else if(n){if(s!==true){r=i(r)}}}return r}))}}));function Jo(t){this.name=t||"default";this.streamInfo={};this.generatedError=null;this.extraStreamInfo={};this.isPaused=true;this.isFinished=false;this.isLocked=false;this._listeners={data:[],end:[],error:[]};this.previous=null}Jo.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished){return false}this.flush();try{this.emit("end");this.cleanUp();this.isFinished=true}catch(t){this.emit("error",t)}return true},error:function(t){if(this.isFinished){return false}if(this.isPaused){this.generatedError=t}else{this.isFinished=true;this.emit("error",t);if(this.previous){this.previous.error(t)}this.cleanUp()}return true},on:function(t,e){this._listeners[t].push(e);return this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null;this._listeners=[]},emit:function(t,e){if(this._listeners[t]){for(var i=0;i<this._listeners[t].length;i++){this._listeners[t][i].call(this,e)}}},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked){throw new Error("The stream '"+this+"' has already been used.")}this.streamInfo=t.streamInfo;this.mergeStreamInfo();this.previous=t;var e=this;t.on("data",(function(t){e.processChunk(t)}));t.on("end",(function(){e.end()}));t.on("error",(function(t){e.error(t)}));return this},pause:function(){if(this.isPaused||this.isFinished){return false}this.isPaused=true;if(this.previous){this.previous.pause()}return true},resume:function(){if(!this.isPaused||this.isFinished){return false}this.isPaused=false;var t=false;if(this.generatedError){this.error(this.generatedError);t=true}if(this.previous){this.previous.resume()}return!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){this.extraStreamInfo[t]=e;this.mergeStreamInfo();return this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo){if(!this.extraStreamInfo.hasOwnProperty(t)){continue}this.streamInfo[t]=this.extraStreamInfo[t]}},lock:function(){if(this.isLocked){throw new Error("The stream '"+this+"' has already been used.")}this.isLocked=true;if(this.previous){this.previous.lock()}},toString:function(){var t="Worker "+this.name;if(this.previous){return this.previous+" -> "+t}else{return t}}};var $o=Jo;var Qo=a((function(t,e){var i=new Array(256);for(var r=0;r<256;r++){i[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1}i[254]=i[254]=1;var n=function(t){var e,i,r,n,s,o=t.length,a=0;for(n=0;n<o;n++){i=t.charCodeAt(n);if((i&64512)===55296&&n+1<o){r=t.charCodeAt(n+1);if((r&64512)===56320){i=65536+(i-55296<<10)+(r-56320);n++}}a+=i<128?1:i<2048?2:i<65536?3:4}if(po.uint8array){e=new Uint8Array(a)}else{e=new Array(a)}for(s=0,n=0;s<a;n++){i=t.charCodeAt(n);if((i&64512)===55296&&n+1<o){r=t.charCodeAt(n+1);if((r&64512)===56320){i=65536+(i-55296<<10)+(r-56320);n++}}if(i<128){e[s++]=i}else if(i<2048){e[s++]=192|i>>>6;e[s++]=128|i&63}else if(i<65536){e[s++]=224|i>>>12;e[s++]=128|i>>>6&63;e[s++]=128|i&63}else{e[s++]=240|i>>>18;e[s++]=128|i>>>12&63;e[s++]=128|i>>>6&63;e[s++]=128|i&63}}return e};var s=function(t,e){var r;e=e||t.length;if(e>t.length){e=t.length}r=e-1;while(r>=0&&(t[r]&192)===128){r--}if(r<0){return e}if(r===0){return e}return r+i[t[r]]>e?r:e};var o=function(t){var e,r,n,s;var o=t.length;var a=new Array(o*2);for(r=0,e=0;e<o;){n=t[e++];if(n<128){a[r++]=n;continue}s=i[n];if(s>4){a[r++]=65533;e+=s-1;continue}n&=s===2?31:s===3?15:7;while(s>1&&e<o){n=n<<6|t[e++]&63;s--}if(s>1){a[r++]=65533;continue}if(n<65536){a[r++]=n}else{n-=65536;a[r++]=55296|n>>10&1023;a[r++]=56320|n&1023}}if(a.length!==r){if(a.subarray){a=a.subarray(0,r)}else{a.length=r}}return Go.applyFromCharCode(a)};e.utf8encode=function t(e){if(po.nodebuffer){return wo.newBufferFrom(e,"utf-8")}return n(e)};e.utf8decode=function t(e){if(po.nodebuffer){return Go.transformTo("nodebuffer",e).toString("utf-8")}e=Go.transformTo(po.uint8array?"uint8array":"array",e);return o(e)};function a(){$o.call(this,"utf-8 decode");this.leftOver=null}Go.inherits(a,$o);a.prototype.processChunk=function(t){var i=Go.transformTo(po.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(po.uint8array){var r=i;i=new Uint8Array(r.length+this.leftOver.length);i.set(this.leftOver,0);i.set(r,this.leftOver.length)}else{i=this.leftOver.concat(i)}this.leftOver=null}var n=s(i);var o=i;if(n!==i.length){if(po.uint8array){o=i.subarray(0,n);this.leftOver=i.subarray(n,i.length)}else{o=i.slice(0,n);this.leftOver=i.slice(n,i.length)}}this.push({data:e.utf8decode(o),meta:t.meta})};a.prototype.flush=function(){if(this.leftOver&&this.leftOver.length){this.push({data:e.utf8decode(this.leftOver),meta:{}});this.leftOver=null}};e.Utf8DecodeWorker=a;function h(){$o.call(this,"utf-8 encode")}Go.inherits(h,$o);h.prototype.processChunk=function(t){this.push({data:e.utf8encode(t.data),meta:t.meta})};e.Utf8EncodeWorker=h}));function ta(t){$o.call(this,"ConvertWorker to "+t);this.destType=t}Go.inherits(ta,$o);ta.prototype.processChunk=function(t){this.push({data:Go.transformTo(this.destType,t.data),meta:t.meta})};var ea=ta;var ia=co.Readable;Go.inherits(ra,ia);function ra(t,e,i){ia.call(this,e);this._helper=t;var r=this;t.on("data",(function(t,e){if(!r.push(t)){r._helper.pause()}if(i){i(e)}})).on("error",(function(t){r.emit("error",t)})).on("end",(function(){r.push(null)}))}ra.prototype._read=function(){this._helper.resume()};var na=ra;var sa=null;if(po.nodestream){try{sa=na}catch(zp){}}function oa(t,e,i){switch(t){case"blob":return Go.newBlob(Go.transformTo("arraybuffer",e),i);case"base64":return yo.encode(e);default:return Go.transformTo(t,e)}}function aa(t,e){var i,r=0,n=null,s=0;for(i=0;i<e.length;i++){s+=e[i].length}switch(t){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":n=new Uint8Array(s);for(i=0;i<e.length;i++){n.set(e[i],r);r+=e[i].length}return n;case"nodebuffer":return Xi.concat(e);default:throw new Error("concat : unsupported type '"+t+"'")}}function ha(t,e){return new Ko.Promise((function(i,r){var n=[];var s=t._internalType,o=t._outputType,a=t._mimeType;t.on("data",(function(t,i){n.push(t);if(e){e(i)}})).on("error",(function(t){n=[];r(t)})).on("end",(function(){try{var t=oa(o,aa(s,n),a);i(t)}catch(zp){r(zp)}n=[]})).resume()}))}function fa(t,e,i){var r=e;switch(e){case"blob":case"arraybuffer":r="uint8array";break;case"base64":r="string";break}try{this._internalType=r;this._outputType=e;this._mimeType=i;Go.checkSupport(r);this._worker=t.pipe(new ea(r));t.lock()}catch(zp){this._worker=new $o("error");this._worker.error(zp)}}fa.prototype={accumulate:function(t){return ha(this,t)},on:function(t,e){var i=this;if(t==="data"){this._worker.on(t,(function(t){e.call(i,t.data,t.meta)}))}else{this._worker.on(t,(function(){Go.delay(e,arguments,i)}))}return this},resume:function(){Go.delay(this._worker.resume,[],this._worker);return this},pause:function(){this._worker.pause();return this},toNodejsStream:function(t){Go.checkSupport("nodestream");if(this._outputType!=="nodebuffer"){throw new Error(this._outputType+" is not supported by this method")}return new sa(this,{objectMode:this._outputType!=="nodebuffer"},t)}};var la=fa;var ua=false;var ca=false;var da=false;var pa=true;var va=null;var ga=null;var ma=null;var ya=null;var wa=null;var ba=null;var _a={base64:ua,binary:ca,dir:da,createFolders:pa,date:va,compression:ga,compressionOptions:ma,comment:ya,unixPermissions:wa,dosPermissions:ba};var xa=16*1024;function ka(t){$o.call(this,"DataWorker");var e=this;this.dataIsReady=false;this.index=0;this.max=0;this.data=null;this.type="";this._tickScheduled=false;t.then((function(t){e.dataIsReady=true;e.data=t;e.max=t&&t.length||0;e.type=Go.getTypeOf(t);if(!e.isPaused){e._tickAndRepeat()}}),(function(t){e.error(t)}))}Go.inherits(ka,$o);ka.prototype.cleanUp=function(){$o.prototype.cleanUp.call(this);this.data=null};ka.prototype.resume=function(){if(!$o.prototype.resume.call(this)){return false}if(!this._tickScheduled&&this.dataIsReady){this._tickScheduled=true;Go.delay(this._tickAndRepeat,[],this)}return true};ka.prototype._tickAndRepeat=function(){this._tickScheduled=false;if(this.isPaused||this.isFinished){return}this._tick();if(!this.isFinished){Go.delay(this._tickAndRepeat,[],this);this._tickScheduled=true}};ka.prototype._tick=function(){if(this.isPaused||this.isFinished){return false}var t=xa;var e=null,i=Math.min(this.max,this.index+t);if(this.index>=this.max){return this.end()}else{switch(this.type){case"string":e=this.data.substring(this.index,i);break;case"uint8array":e=this.data.subarray(this.index,i);break;case"array":case"nodebuffer":e=this.data.slice(this.index,i);break}this.index=i;return this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})}};var Ea=ka;function Sa(t){$o.call(this,"DataLengthProbe for "+t);this.propName=t;this.withStreamInfo(t,0)}Go.inherits(Sa,$o);Sa.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}$o.prototype.processChunk.call(this,t)};var Ca=Sa;function Ra(){var t,e=[];for(var i=0;i<256;i++){t=i;for(var r=0;r<8;r++){t=t&1?3988292384^t>>>1:t>>>1}e[i]=t}return e}var Ta=Ra();function Aa(t,e,i,r){var n=Ta,s=r+i;t=t^-1;for(var o=r;o<s;o++){t=t>>>8^n[(t^e[o])&255]}return t^-1}function Oa(t,e,i,r){var n=Ta,s=r+i;t=t^-1;for(var o=r;o<s;o++){t=t>>>8^n[(t^e.charCodeAt(o))&255]}return t^-1}var La=function t(e,i){if(typeof e==="undefined"||!e.length){return 0}var r=Go.getTypeOf(e)!=="string";if(r){return Aa(i|0,e,e.length,0)}else{return Oa(i|0,e,e.length,0)}};function Ia(){$o.call(this,"Crc32Probe");this.withStreamInfo("crc32",0)}Go.inherits(Ia,$o);Ia.prototype.processChunk=function(t){this.streamInfo.crc32=La(t.data,this.streamInfo.crc32||0);this.push(t)};var za=Ia;function Pa(t,e,i,r,n){this.compressedSize=t;this.uncompressedSize=e;this.crc32=i;this.compression=r;this.compressedContent=n}Pa.prototype={getContentWorker:function(){var t=new Ea(Ko.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new Ca("data_length"));var e=this;t.on("end",(function(){if(this.streamInfo["data_length"]!==e.uncompressedSize){throw new Error("Bug : uncompressed data size mismatch")}}));return t},getCompressedWorker:function(){return new Ea(Ko.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}};Pa.createWorkerFrom=function(t,e,i){return t.pipe(new za).pipe(new Ca("uncompressedSize")).pipe(e.compressWorker(i)).pipe(new Ca("compressedSize")).withStreamInfo("compression",e)};var Na=Pa;var Ba=function(t,e,i){this.name=t;this.dir=i.dir;this.date=i.date;this.comment=i.comment;this.unixPermissions=i.unixPermissions;this.dosPermissions=i.dosPermissions;this._data=e;this._dataBinary=i.binary;this.options={compression:i.compression,compressionOptions:i.compressionOptions}};Ba.prototype={internalStream:function(t){var e=null,i="string";try{if(!t){throw new Error("No output type specified.")}i=t.toLowerCase();var r=i==="string"||i==="text";if(i==="binarystring"||i==="text"){i="string"}e=this._decompressWorker();var n=!this._dataBinary;if(n&&!r){e=e.pipe(new Qo.Utf8EncodeWorker)}if(!n&&r){e=e.pipe(new Qo.Utf8DecodeWorker)}}catch(zp){e=new $o("error");e.error(zp)}return new la(e,i,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof Na&&this._data.compression.magic===t.magic){return this._data.getCompressedWorker()}else{var i=this._decompressWorker();if(!this._dataBinary){i=i.pipe(new Qo.Utf8EncodeWorker)}return Na.createWorkerFrom(i,t,e)}},_decompressWorker:function(){if(this._data instanceof Na){return this._data.getContentWorker()}else if(this._data instanceof $o){return this._data}else{return new Ea(this._data)}}};var Da=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"];var ja=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")};for(var Ua=0;Ua<Da.length;Ua++){Ba.prototype[Da[Ua]]=ja}var Ma=Ba;var Fa=a((function(t,e){var i=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){var e=Array.prototype.slice.call(arguments,1);while(e.length){var i=e.shift();if(!i){continue}if(typeof i!=="object"){throw new TypeError(i+"must be non-object")}for(var n in i){if(r(i,n)){t[n]=i[n]}}}return t};e.shrinkBuf=function(t,e){if(t.length===e){return t}if(t.subarray){return t.subarray(0,e)}t.length=e;return t};var n={arraySet:function(t,e,i,r,n){if(e.subarray&&t.subarray){t.set(e.subarray(i,i+r),n);return}for(var s=0;s<r;s++){t[n+s]=e[i+s]}},flattenChunks:function(t){var e,i,r,n,s,o;r=0;for(e=0,i=t.length;e<i;e++){r+=t[e].length}o=new Uint8Array(r);n=0;for(e=0,i=t.length;e<i;e++){s=t[e];o.set(s,n);n+=s.length}return o}};var s={arraySet:function(t,e,i,r,n){for(var s=0;s<r;s++){t[n+s]=e[i+s]}},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){if(t){e.Buf8=Uint8Array;e.Buf16=Uint16Array;e.Buf32=Int32Array;e.assign(e,n)}else{e.Buf8=Array;e.Buf16=Array;e.Buf32=Array;e.assign(e,s)}};e.setTyped(i)}));var qa=4;var Wa=0;var Ha=1;var Ya=2;function Za(t){var e=t.length;while(--e>=0){t[e]=0}}var Va=0;var Xa=1;var Ka=2;var Ga=3;var Ja=258;var $a=29;var Qa=256;var th=Qa+1+$a;var eh=30;var ih=19;var rh=2*th+1;var nh=15;var sh=16;var oh=7;var ah=256;var hh=16;var fh=17;var lh=18;var uh=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];var ch=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var dh=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];var ph=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var vh=512;var gh=new Array((th+2)*2);Za(gh);var mh=new Array(eh*2);Za(mh);var yh=new Array(vh);Za(yh);var wh=new Array(Ja-Ga+1);Za(wh);var bh=new Array($a);Za(bh);var _h=new Array(eh);Za(_h);function xh(t,e,i,r,n){this.static_tree=t;this.extra_bits=e;this.extra_base=i;this.elems=r;this.max_length=n;this.has_stree=t&&t.length}var kh;var Eh;var Sh;function Ch(t,e){this.dyn_tree=t;this.max_code=0;this.stat_desc=e}function Rh(t){return t<256?yh[t]:yh[256+(t>>>7)]}function Th(t,e){t.pending_buf[t.pending++]=e&255;t.pending_buf[t.pending++]=e>>>8&255}function Ah(t,e,i){if(t.bi_valid>sh-i){t.bi_buf|=e<<t.bi_valid&65535;Th(t,t.bi_buf);t.bi_buf=e>>sh-t.bi_valid;t.bi_valid+=i-sh}else{t.bi_buf|=e<<t.bi_valid&65535;t.bi_valid+=i}}function Oh(t,e,i){Ah(t,i[e*2],i[e*2+1])}function Lh(t,e){var i=0;do{i|=t&1;t>>>=1;i<<=1}while(--e>0);return i>>>1}function Ih(t){if(t.bi_valid===16){Th(t,t.bi_buf);t.bi_buf=0;t.bi_valid=0}else if(t.bi_valid>=8){t.pending_buf[t.pending++]=t.bi_buf&255;t.bi_buf>>=8;t.bi_valid-=8}}function zh(t,e){var i=e.dyn_tree;var r=e.max_code;var n=e.stat_desc.static_tree;var s=e.stat_desc.has_stree;var o=e.stat_desc.extra_bits;var a=e.stat_desc.extra_base;var h=e.stat_desc.max_length;var f;var l,u;var c;var d;var p;var v=0;for(c=0;c<=nh;c++){t.bl_count[c]=0}i[t.heap[t.heap_max]*2+1]=0;for(f=t.heap_max+1;f<rh;f++){l=t.heap[f];c=i[i[l*2+1]*2+1]+1;if(c>h){c=h;v++}i[l*2+1]=c;if(l>r){continue}t.bl_count[c]++;d=0;if(l>=a){d=o[l-a]}p=i[l*2];t.opt_len+=p*(c+d);if(s){t.static_len+=p*(n[l*2+1]+d)}}if(v===0){return}do{c=h-1;while(t.bl_count[c]===0){c--}t.bl_count[c]--;t.bl_count[c+1]+=2;t.bl_count[h]--;v-=2}while(v>0);for(c=h;c!==0;c--){l=t.bl_count[c];while(l!==0){u=t.heap[--f];if(u>r){continue}if(i[u*2+1]!==c){t.opt_len+=(c-i[u*2+1])*i[u*2];i[u*2+1]=c}l--}}}function Ph(t,e,i){var r=new Array(nh+1);var n=0;var s;var o;for(s=1;s<=nh;s++){r[s]=n=n+i[s-1]<<1}for(o=0;o<=e;o++){var a=t[o*2+1];if(a===0){continue}t[o*2]=Lh(r[a]++,a)}}function Nh(){var t;var e;var i;var r;var n;var s=new Array(nh+1);i=0;for(r=0;r<$a-1;r++){bh[r]=i;for(t=0;t<1<<uh[r];t++){wh[i++]=r}}wh[i-1]=r;n=0;for(r=0;r<16;r++){_h[r]=n;for(t=0;t<1<<ch[r];t++){yh[n++]=r}}n>>=7;for(;r<eh;r++){_h[r]=n<<7;for(t=0;t<1<<ch[r]-7;t++){yh[256+n++]=r}}for(e=0;e<=nh;e++){s[e]=0}t=0;while(t<=143){gh[t*2+1]=8;t++;s[8]++}while(t<=255){gh[t*2+1]=9;t++;s[9]++}while(t<=279){gh[t*2+1]=7;t++;s[7]++}while(t<=287){gh[t*2+1]=8;t++;s[8]++}Ph(gh,th+1,s);for(t=0;t<eh;t++){mh[t*2+1]=5;mh[t*2]=Lh(t,5)}kh=new xh(gh,uh,Qa+1,th,nh);Eh=new xh(mh,ch,0,eh,nh);Sh=new xh(new Array(0),dh,0,ih,oh)}function Bh(t){var e;for(e=0;e<th;e++){t.dyn_ltree[e*2]=0}for(e=0;e<eh;e++){t.dyn_dtree[e*2]=0}for(e=0;e<ih;e++){t.bl_tree[e*2]=0}t.dyn_ltree[ah*2]=1;t.opt_len=t.static_len=0;t.last_lit=t.matches=0}function Dh(t){if(t.bi_valid>8){Th(t,t.bi_buf)}else if(t.bi_valid>0){t.pending_buf[t.pending++]=t.bi_buf}t.bi_buf=0;t.bi_valid=0}function jh(t,e,i,r){Dh(t);if(r){Th(t,i);Th(t,~i)}Fa.arraySet(t.pending_buf,t.window,e,i,t.pending);t.pending+=i}function Uh(t,e,i,r){var n=e*2;var s=i*2;return t[n]<t[s]||t[n]===t[s]&&r[e]<=r[i]}function Mh(t,e,i){var r=t.heap[i];var n=i<<1;while(n<=t.heap_len){if(n<t.heap_len&&Uh(e,t.heap[n+1],t.heap[n],t.depth)){n++}if(Uh(e,r,t.heap[n],t.depth)){break}t.heap[i]=t.heap[n];i=n;n<<=1}t.heap[i]=r}function Fh(t,e,i){var r;var n;var s=0;var o;var a;if(t.last_lit!==0){do{r=t.pending_buf[t.d_buf+s*2]<<8|t.pending_buf[t.d_buf+s*2+1];n=t.pending_buf[t.l_buf+s];s++;if(r===0){Oh(t,n,e)}else{o=wh[n];Oh(t,o+Qa+1,e);a=uh[o];if(a!==0){n-=bh[o];Ah(t,n,a)}r--;o=Rh(r);Oh(t,o,i);a=ch[o];if(a!==0){r-=_h[o];Ah(t,r,a)}}}while(s<t.last_lit)}Oh(t,ah,e)}function qh(t,e){var i=e.dyn_tree;var r=e.stat_desc.static_tree;var n=e.stat_desc.has_stree;var s=e.stat_desc.elems;var o,a;var h=-1;var f;t.heap_len=0;t.heap_max=rh;for(o=0;o<s;o++){if(i[o*2]!==0){t.heap[++t.heap_len]=h=o;t.depth[o]=0}else{i[o*2+1]=0}}while(t.heap_len<2){f=t.heap[++t.heap_len]=h<2?++h:0;i[f*2]=1;t.depth[f]=0;t.opt_len--;if(n){t.static_len-=r[f*2+1]}}e.max_code=h;for(o=t.heap_len>>1;o>=1;o--){Mh(t,i,o)}f=s;do{o=t.heap[1];t.heap[1]=t.heap[t.heap_len--];Mh(t,i,1);a=t.heap[1];t.heap[--t.heap_max]=o;t.heap[--t.heap_max]=a;i[f*2]=i[o*2]+i[a*2];t.depth[f]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1;i[o*2+1]=i[a*2+1]=f;t.heap[1]=f++;Mh(t,i,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1];zh(t,e);Ph(i,h,t.bl_count)}function Wh(t,e,i){var r;var n=-1;var s;var o=e[0*2+1];var a=0;var h=7;var f=4;if(o===0){h=138;f=3}e[(i+1)*2+1]=65535;for(r=0;r<=i;r++){s=o;o=e[(r+1)*2+1];if(++a<h&&s===o){continue}else if(a<f){t.bl_tree[s*2]+=a}else if(s!==0){if(s!==n){t.bl_tree[s*2]++}t.bl_tree[hh*2]++}else if(a<=10){t.bl_tree[fh*2]++}else{t.bl_tree[lh*2]++}a=0;n=s;if(o===0){h=138;f=3}else if(s===o){h=6;f=3}else{h=7;f=4}}}function Hh(t,e,i){var r;var n=-1;var s;var o=e[0*2+1];var a=0;var h=7;var f=4;if(o===0){h=138;f=3}for(r=0;r<=i;r++){s=o;o=e[(r+1)*2+1];if(++a<h&&s===o){continue}else if(a<f){do{Oh(t,s,t.bl_tree)}while(--a!==0)}else if(s!==0){if(s!==n){Oh(t,s,t.bl_tree);a--}Oh(t,hh,t.bl_tree);Ah(t,a-3,2)}else if(a<=10){Oh(t,fh,t.bl_tree);Ah(t,a-3,3)}else{Oh(t,lh,t.bl_tree);Ah(t,a-11,7)}a=0;n=s;if(o===0){h=138;f=3}else if(s===o){h=6;f=3}else{h=7;f=4}}}function Yh(t){var e;Wh(t,t.dyn_ltree,t.l_desc.max_code);Wh(t,t.dyn_dtree,t.d_desc.max_code);qh(t,t.bl_desc);for(e=ih-1;e>=3;e--){if(t.bl_tree[ph[e]*2+1]!==0){break}}t.opt_len+=3*(e+1)+5+5+4;return e}function Zh(t,e,i,r){var n;Ah(t,e-257,5);Ah(t,i-1,5);Ah(t,r-4,4);for(n=0;n<r;n++){Ah(t,t.bl_tree[ph[n]*2+1],3)}Hh(t,t.dyn_ltree,e-1);Hh(t,t.dyn_dtree,i-1)}function Vh(t){var e=4093624447;var i;for(i=0;i<=31;i++,e>>>=1){if(e&1&&t.dyn_ltree[i*2]!==0){return Wa}}if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0){return Ha}for(i=32;i<Qa;i++){if(t.dyn_ltree[i*2]!==0){return Ha}}return Wa}var Xh=false;function Kh(t){if(!Xh){Nh();Xh=true}t.l_desc=new Ch(t.dyn_ltree,kh);t.d_desc=new Ch(t.dyn_dtree,Eh);t.bl_desc=new Ch(t.bl_tree,Sh);t.bi_buf=0;t.bi_valid=0;Bh(t)}function Gh(t,e,i,r){Ah(t,(Va<<1)+(r?1:0),3);jh(t,e,i,true)}function Jh(t){Ah(t,Xa<<1,3);Oh(t,ah,gh);Ih(t)}function $h(t,e,i,r){var n,s;var o=0;if(t.level>0){if(t.strm.data_type===Ya){t.strm.data_type=Vh(t)}qh(t,t.l_desc);qh(t,t.d_desc);o=Yh(t);n=t.opt_len+3+7>>>3;s=t.static_len+3+7>>>3;if(s<=n){n=s}}else{n=s=i+5}if(i+4<=n&&e!==-1){Gh(t,e,i,r)}else if(t.strategy===qa||s===n){Ah(t,(Xa<<1)+(r?1:0),3);Fh(t,gh,mh)}else{Ah(t,(Ka<<1)+(r?1:0),3);Zh(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1);Fh(t,t.dyn_ltree,t.dyn_dtree)}Bh(t);if(r){Dh(t)}}function Qh(t,e,i){t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255;t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255;t.pending_buf[t.l_buf+t.last_lit]=i&255;t.last_lit++;if(e===0){t.dyn_ltree[i*2]++}else{t.matches++;e--;t.dyn_ltree[(wh[i]+Qa+1)*2]++;t.dyn_dtree[Rh(e)*2]++}return t.last_lit===t.lit_bufsize-1}var tf=Kh;var ef=Gh;var rf=$h;var nf=Qh;var sf=Jh;var of={_tr_init:tf,_tr_stored_block:ef,_tr_flush_block:rf,_tr_tally:nf,_tr_align:sf};function af(t,e,i,r){var n=t&65535|0,s=t>>>16&65535|0,o=0;while(i!==0){o=i>2e3?2e3:i;i-=o;do{n=n+e[r++]|0;s=s+n|0}while(--o);n%=65521;s%=65521}return n|s<<16|0}var hf=af;function ff(){var t,e=[];for(var i=0;i<256;i++){t=i;for(var r=0;r<8;r++){t=t&1?3988292384^t>>>1:t>>>1}e[i]=t}return e}var lf=ff();function uf(t,e,i,r){var n=lf,s=r+i;t^=-1;for(var o=r;o<s;o++){t=t>>>8^n[(t^e[o])&255]}return t^-1}var cf=uf;var df={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};var pf=0;var vf=1;var gf=3;var mf=4;var yf=5;var wf=0;var bf=1;var _f=-2;var xf=-3;var kf=-5;var Ef=-1;var Sf=1;var Cf=2;var Rf=3;var Tf=4;var Af=0;var Of=2;var Lf=8;var If=9;var zf=15;var Pf=8;var Nf=29;var Bf=256;var Df=Bf+1+Nf;var jf=30;var Uf=19;var Mf=2*Df+1;var Ff=15;var qf=3;var Wf=258;var Hf=Wf+qf+1;var Yf=32;var Zf=42;var Vf=69;var Xf=73;var Kf=91;var Gf=103;var Jf=113;var $f=666;var Qf=1;var tl=2;var el=3;var il=4;var rl=3;function nl(t,e){t.msg=df[e];return e}function sl(t){return(t<<1)-(t>4?9:0)}function ol(t){var e=t.length;while(--e>=0){t[e]=0}}function al(t){var e=t.state;var i=e.pending;if(i>t.avail_out){i=t.avail_out}if(i===0){return}Fa.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out);t.next_out+=i;e.pending_out+=i;t.total_out+=i;t.avail_out-=i;e.pending-=i;if(e.pending===0){e.pending_out=0}}function hl(t,e){of._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e);t.block_start=t.strstart;al(t.strm)}function fl(t,e){t.pending_buf[t.pending++]=e}function ll(t,e){t.pending_buf[t.pending++]=e>>>8&255;t.pending_buf[t.pending++]=e&255}function ul(t,e,i,r){var n=t.avail_in;if(n>r){n=r}if(n===0){return 0}t.avail_in-=n;Fa.arraySet(e,t.input,t.next_in,n,i);if(t.state.wrap===1){t.adler=hf(t.adler,e,n,i)}else if(t.state.wrap===2){t.adler=cf(t.adler,e,n,i)}t.next_in+=n;t.total_in+=n;return n}function cl(t,e){var i=t.max_chain_length;var r=t.strstart;var n;var s;var o=t.prev_length;var a=t.nice_match;var h=t.strstart>t.w_size-Hf?t.strstart-(t.w_size-Hf):0;var f=t.window;var l=t.w_mask;var u=t.prev;var c=t.strstart+Wf;var d=f[r+o-1];var p=f[r+o];if(t.prev_length>=t.good_match){i>>=2}if(a>t.lookahead){a=t.lookahead}do{n=e;if(f[n+o]!==p||f[n+o-1]!==d||f[n]!==f[r]||f[++n]!==f[r+1]){continue}r+=2;n++;do{}while(f[++r]===f[++n]&&f[++r]===f[++n]&&f[++r]===f[++n]&&f[++r]===f[++n]&&f[++r]===f[++n]&&f[++r]===f[++n]&&f[++r]===f[++n]&&f[++r]===f[++n]&&r<c);s=Wf-(c-r);r=c-Wf;if(s>o){t.match_start=e;o=s;if(s>=a){break}d=f[r+o-1];p=f[r+o]}}while((e=u[e&l])>h&&--i!==0);if(o<=t.lookahead){return o}return t.lookahead}function dl(t){var e=t.w_size;var i,r,n,s,o;do{s=t.window_size-t.lookahead-t.strstart;if(t.strstart>=e+(e-Hf)){Fa.arraySet(t.window,t.window,e,e,0);t.match_start-=e;t.strstart-=e;t.block_start-=e;r=t.hash_size;i=r;do{n=t.head[--i];t.head[i]=n>=e?n-e:0}while(--r);r=e;i=r;do{n=t.prev[--i];t.prev[i]=n>=e?n-e:0}while(--r);s+=e}if(t.strm.avail_in===0){break}r=ul(t.strm,t.window,t.strstart+t.lookahead,s);t.lookahead+=r;if(t.lookahead+t.insert>=qf){o=t.strstart-t.insert;t.ins_h=t.window[o];t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;while(t.insert){t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+qf-1])&t.hash_mask;t.prev[o&t.w_mask]=t.head[t.ins_h];t.head[t.ins_h]=o;o++;t.insert--;if(t.lookahead+t.insert<qf){break}}}}while(t.lookahead<Hf&&t.strm.avail_in!==0)}function pl(t,e){var i=65535;if(i>t.pending_buf_size-5){i=t.pending_buf_size-5}for(;;){if(t.lookahead<=1){dl(t);if(t.lookahead===0&&e===pf){return Qf}if(t.lookahead===0){break}}t.strstart+=t.lookahead;t.lookahead=0;var r=t.block_start+i;if(t.strstart===0||t.strstart>=r){t.lookahead=t.strstart-r;t.strstart=r;hl(t,false);if(t.strm.avail_out===0){return Qf}}if(t.strstart-t.block_start>=t.w_size-Hf){hl(t,false);if(t.strm.avail_out===0){return Qf}}}t.insert=0;if(e===mf){hl(t,true);if(t.strm.avail_out===0){return el}return il}if(t.strstart>t.block_start){hl(t,false);if(t.strm.avail_out===0){return Qf}}return Qf}function vl(t,e){var i;var r;for(;;){if(t.lookahead<Hf){dl(t);if(t.lookahead<Hf&&e===pf){return Qf}if(t.lookahead===0){break}}i=0;if(t.lookahead>=qf){t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+qf-1])&t.hash_mask;i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h];t.head[t.ins_h]=t.strstart}if(i!==0&&t.strstart-i<=t.w_size-Hf){t.match_length=cl(t,i)}if(t.match_length>=qf){r=of._tr_tally(t,t.strstart-t.match_start,t.match_length-qf);t.lookahead-=t.match_length;if(t.match_length<=t.max_lazy_match&&t.lookahead>=qf){t.match_length--;do{t.strstart++;t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+qf-1])&t.hash_mask;i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h];t.head[t.ins_h]=t.strstart}while(--t.match_length!==0);t.strstart++}else{t.strstart+=t.match_length;t.match_length=0;t.ins_h=t.window[t.strstart];t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask}}else{r=of._tr_tally(t,0,t.window[t.strstart]);t.lookahead--;t.strstart++}if(r){hl(t,false);if(t.strm.avail_out===0){return Qf}}}t.insert=t.strstart<qf-1?t.strstart:qf-1;if(e===mf){hl(t,true);if(t.strm.avail_out===0){return el}return il}if(t.last_lit){hl(t,false);if(t.strm.avail_out===0){return Qf}}return tl}function gl(t,e){var i;var r;var n;for(;;){if(t.lookahead<Hf){dl(t);if(t.lookahead<Hf&&e===pf){return Qf}if(t.lookahead===0){break}}i=0;if(t.lookahead>=qf){t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+qf-1])&t.hash_mask;i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h];t.head[t.ins_h]=t.strstart}t.prev_length=t.match_length;t.prev_match=t.match_start;t.match_length=qf-1;if(i!==0&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-Hf){t.match_length=cl(t,i);if(t.match_length<=5&&(t.strategy===Sf||t.match_length===qf&&t.strstart-t.match_start>4096)){t.match_length=qf-1}}if(t.prev_length>=qf&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-qf;r=of._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-qf);t.lookahead-=t.prev_length-1;t.prev_length-=2;do{if(++t.strstart<=n){t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+qf-1])&t.hash_mask;i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h];t.head[t.ins_h]=t.strstart}}while(--t.prev_length!==0);t.match_available=0;t.match_length=qf-1;t.strstart++;if(r){hl(t,false);if(t.strm.avail_out===0){return Qf}}}else if(t.match_available){r=of._tr_tally(t,0,t.window[t.strstart-1]);if(r){hl(t,false)}t.strstart++;t.lookahead--;if(t.strm.avail_out===0){return Qf}}else{t.match_available=1;t.strstart++;t.lookahead--}}if(t.match_available){r=of._tr_tally(t,0,t.window[t.strstart-1]);t.match_available=0}t.insert=t.strstart<qf-1?t.strstart:qf-1;if(e===mf){hl(t,true);if(t.strm.avail_out===0){return el}return il}if(t.last_lit){hl(t,false);if(t.strm.avail_out===0){return Qf}}return tl}function ml(t,e){var i;var r;var n,s;var o=t.window;for(;;){if(t.lookahead<=Wf){dl(t);if(t.lookahead<=Wf&&e===pf){return Qf}if(t.lookahead===0){break}}t.match_length=0;if(t.lookahead>=qf&&t.strstart>0){n=t.strstart-1;r=o[n];if(r===o[++n]&&r===o[++n]&&r===o[++n]){s=t.strstart+Wf;do{}while(r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&n<s);t.match_length=Wf-(s-n);if(t.match_length>t.lookahead){t.match_length=t.lookahead}}}if(t.match_length>=qf){i=of._tr_tally(t,1,t.match_length-qf);t.lookahead-=t.match_length;t.strstart+=t.match_length;t.match_length=0}else{i=of._tr_tally(t,0,t.window[t.strstart]);t.lookahead--;t.strstart++}if(i){hl(t,false);if(t.strm.avail_out===0){return Qf}}}t.insert=0;if(e===mf){hl(t,true);if(t.strm.avail_out===0){return el}return il}if(t.last_lit){hl(t,false);if(t.strm.avail_out===0){return Qf}}return tl}function yl(t,e){var i;for(;;){if(t.lookahead===0){dl(t);if(t.lookahead===0){if(e===pf){return Qf}break}}t.match_length=0;i=of._tr_tally(t,0,t.window[t.strstart]);t.lookahead--;t.strstart++;if(i){hl(t,false);if(t.strm.avail_out===0){return Qf}}}t.insert=0;if(e===mf){hl(t,true);if(t.strm.avail_out===0){return el}return il}if(t.last_lit){hl(t,false);if(t.strm.avail_out===0){return Qf}}return tl}function wl(t,e,i,r,n){this.good_length=t;this.max_lazy=e;this.nice_length=i;this.max_chain=r;this.func=n}var bl;bl=[new wl(0,0,0,0,pl),new wl(4,4,8,4,vl),new wl(4,5,16,8,vl),new wl(4,6,32,32,vl),new wl(4,4,16,16,gl),new wl(8,16,32,32,gl),new wl(8,16,128,128,gl),new wl(8,32,128,256,gl),new wl(32,128,258,1024,gl),new wl(32,258,258,4096,gl)];function _l(t){t.window_size=2*t.w_size;ol(t.head);t.max_lazy_match=bl[t.level].max_lazy;t.good_match=bl[t.level].good_length;t.nice_match=bl[t.level].nice_length;t.max_chain_length=bl[t.level].max_chain;t.strstart=0;t.block_start=0;t.lookahead=0;t.insert=0;t.match_length=t.prev_length=qf-1;t.match_available=0;t.ins_h=0}function xl(){this.strm=null;this.status=0;this.pending_buf=null;this.pending_buf_size=0;this.pending_out=0;this.pending=0;this.wrap=0;this.gzhead=null;this.gzindex=0;this.method=Lf;this.last_flush=-1;this.w_size=0;this.w_bits=0;this.w_mask=0;this.window=null;this.window_size=0;this.prev=null;this.head=null;this.ins_h=0;this.hash_size=0;this.hash_bits=0;this.hash_mask=0;this.hash_shift=0;this.block_start=0;this.match_length=0;this.prev_match=0;this.match_available=0;this.strstart=0;this.match_start=0;this.lookahead=0;this.prev_length=0;this.max_chain_length=0;this.max_lazy_match=0;this.level=0;this.strategy=0;this.good_match=0;this.nice_match=0;this.dyn_ltree=new Fa.Buf16(Mf*2);this.dyn_dtree=new Fa.Buf16((2*jf+1)*2);this.bl_tree=new Fa.Buf16((2*Uf+1)*2);ol(this.dyn_ltree);ol(this.dyn_dtree);ol(this.bl_tree);this.l_desc=null;this.d_desc=null;this.bl_desc=null;this.bl_count=new Fa.Buf16(Ff+1);this.heap=new Fa.Buf16(2*Df+1);ol(this.heap);this.heap_len=0;this.heap_max=0;this.depth=new Fa.Buf16(2*Df+1);ol(this.depth);this.l_buf=0;this.lit_bufsize=0;this.last_lit=0;this.d_buf=0;this.opt_len=0;this.static_len=0;this.matches=0;this.insert=0;this.bi_buf=0;this.bi_valid=0}function kl(t){var e;if(!t||!t.state){return nl(t,_f)}t.total_in=t.total_out=0;t.data_type=Of;e=t.state;e.pending=0;e.pending_out=0;if(e.wrap<0){e.wrap=-e.wrap}e.status=e.wrap?Zf:Jf;t.adler=e.wrap===2?0:1;e.last_flush=pf;of._tr_init(e);return wf}function El(t){var e=kl(t);if(e===wf){_l(t.state)}return e}function Sl(t,e){if(!t||!t.state){return _f}if(t.state.wrap!==2){return _f}t.state.gzhead=e;return wf}function Cl(t,e,i,r,n,s){if(!t){return _f}var o=1;if(e===Ef){e=6}if(r<0){o=0;r=-r}else if(r>15){o=2;r-=16}if(n<1||n>If||i!==Lf||r<8||r>15||e<0||e>9||s<0||s>Tf){return nl(t,_f)}if(r===8){r=9}var a=new xl;t.state=a;a.strm=t;a.wrap=o;a.gzhead=null;a.w_bits=r;a.w_size=1<<a.w_bits;a.w_mask=a.w_size-1;a.hash_bits=n+7;a.hash_size=1<<a.hash_bits;a.hash_mask=a.hash_size-1;a.hash_shift=~~((a.hash_bits+qf-1)/qf);a.window=new Fa.Buf8(a.w_size*2);a.head=new Fa.Buf16(a.hash_size);a.prev=new Fa.Buf16(a.w_size);a.lit_bufsize=1<<n+6;a.pending_buf_size=a.lit_bufsize*4;a.pending_buf=new Fa.Buf8(a.pending_buf_size);a.d_buf=1*a.lit_bufsize;a.l_buf=(1+2)*a.lit_bufsize;a.level=e;a.strategy=s;a.method=i;return El(t)}function Rl(t,e){return Cl(t,e,Lf,zf,Pf,Af)}function Tl(t,e){var i,r;var n,s;if(!t||!t.state||e>yf||e<0){return t?nl(t,_f):_f}r=t.state;if(!t.output||!t.input&&t.avail_in!==0||r.status===$f&&e!==mf){return nl(t,t.avail_out===0?kf:_f)}r.strm=t;i=r.last_flush;r.last_flush=e;if(r.status===Zf){if(r.wrap===2){t.adler=0;fl(r,31);fl(r,139);fl(r,8);if(!r.gzhead){fl(r,0);fl(r,0);fl(r,0);fl(r,0);fl(r,0);fl(r,r.level===9?2:r.strategy>=Cf||r.level<2?4:0);fl(r,rl);r.status=Jf}else{fl(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(!r.gzhead.extra?0:4)+(!r.gzhead.name?0:8)+(!r.gzhead.comment?0:16));fl(r,r.gzhead.time&255);fl(r,r.gzhead.time>>8&255);fl(r,r.gzhead.time>>16&255);fl(r,r.gzhead.time>>24&255);fl(r,r.level===9?2:r.strategy>=Cf||r.level<2?4:0);fl(r,r.gzhead.os&255);if(r.gzhead.extra&&r.gzhead.extra.length){fl(r,r.gzhead.extra.length&255);fl(r,r.gzhead.extra.length>>8&255)}if(r.gzhead.hcrc){t.adler=cf(t.adler,r.pending_buf,r.pending,0)}r.gzindex=0;r.status=Vf}}else{var o=Lf+(r.w_bits-8<<4)<<8;var a=-1;if(r.strategy>=Cf||r.level<2){a=0}else if(r.level<6){a=1}else if(r.level===6){a=2}else{a=3}o|=a<<6;if(r.strstart!==0){o|=Yf}o+=31-o%31;r.status=Jf;ll(r,o);if(r.strstart!==0){ll(r,t.adler>>>16);ll(r,t.adler&65535)}t.adler=1}}if(r.status===Vf){if(r.gzhead.extra){n=r.pending;while(r.gzindex<(r.gzhead.extra.length&65535)){if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n){t.adler=cf(t.adler,r.pending_buf,r.pending-n,n)}al(t);n=r.pending;if(r.pending===r.pending_buf_size){break}}fl(r,r.gzhead.extra[r.gzindex]&255);r.gzindex++}if(r.gzhead.hcrc&&r.pending>n){t.adler=cf(t.adler,r.pending_buf,r.pending-n,n)}if(r.gzindex===r.gzhead.extra.length){r.gzindex=0;r.status=Xf}}else{r.status=Xf}}if(r.status===Xf){if(r.gzhead.name){n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n){t.adler=cf(t.adler,r.pending_buf,r.pending-n,n)}al(t);n=r.pending;if(r.pending===r.pending_buf_size){s=1;break}}if(r.gzindex<r.gzhead.name.length){s=r.gzhead.name.charCodeAt(r.gzindex++)&255}else{s=0}fl(r,s)}while(s!==0);if(r.gzhead.hcrc&&r.pending>n){t.adler=cf(t.adler,r.pending_buf,r.pending-n,n)}if(s===0){r.gzindex=0;r.status=Kf}}else{r.status=Kf}}if(r.status===Kf){if(r.gzhead.comment){n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n){t.adler=cf(t.adler,r.pending_buf,r.pending-n,n)}al(t);n=r.pending;if(r.pending===r.pending_buf_size){s=1;break}}if(r.gzindex<r.gzhead.comment.length){s=r.gzhead.comment.charCodeAt(r.gzindex++)&255}else{s=0}fl(r,s)}while(s!==0);if(r.gzhead.hcrc&&r.pending>n){t.adler=cf(t.adler,r.pending_buf,r.pending-n,n)}if(s===0){r.status=Gf}}else{r.status=Gf}}if(r.status===Gf){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size){al(t)}if(r.pending+2<=r.pending_buf_size){fl(r,t.adler&255);fl(r,t.adler>>8&255);t.adler=0;r.status=Jf}}else{r.status=Jf}}if(r.pending!==0){al(t);if(t.avail_out===0){r.last_flush=-1;return wf}}else if(t.avail_in===0&&sl(e)<=sl(i)&&e!==mf){return nl(t,kf)}if(r.status===$f&&t.avail_in!==0){return nl(t,kf)}if(t.avail_in!==0||r.lookahead!==0||e!==pf&&r.status!==$f){var h=r.strategy===Cf?yl(r,e):r.strategy===Rf?ml(r,e):bl[r.level].func(r,e);if(h===el||h===il){r.status=$f}if(h===Qf||h===el){if(t.avail_out===0){r.last_flush=-1}return wf}if(h===tl){if(e===vf){of._tr_align(r)}else if(e!==yf){of._tr_stored_block(r,0,0,false);if(e===gf){ol(r.head);if(r.lookahead===0){r.strstart=0;r.block_start=0;r.insert=0}}}al(t);if(t.avail_out===0){r.last_flush=-1;return wf}}}if(e!==mf){return wf}if(r.wrap<=0){return bf}if(r.wrap===2){fl(r,t.adler&255);fl(r,t.adler>>8&255);fl(r,t.adler>>16&255);fl(r,t.adler>>24&255);fl(r,t.total_in&255);fl(r,t.total_in>>8&255);fl(r,t.total_in>>16&255);fl(r,t.total_in>>24&255)}else{ll(r,t.adler>>>16);ll(r,t.adler&65535)}al(t);if(r.wrap>0){r.wrap=-r.wrap}return r.pending!==0?wf:bf}function Al(t){var e;if(!t||!t.state){return _f}e=t.state.status;if(e!==Zf&&e!==Vf&&e!==Xf&&e!==Kf&&e!==Gf&&e!==Jf&&e!==$f){return nl(t,_f)}t.state=null;return e===Jf?nl(t,xf):wf}function Ol(t,e){var i=e.length;var r;var n,s;var o;var a;var h;var f;var l;if(!t||!t.state){return _f}r=t.state;o=r.wrap;if(o===2||o===1&&r.status!==Zf||r.lookahead){return _f}if(o===1){t.adler=hf(t.adler,e,i,0)}r.wrap=0;if(i>=r.w_size){if(o===0){ol(r.head);r.strstart=0;r.block_start=0;r.insert=0}l=new Fa.Buf8(r.w_size);Fa.arraySet(l,e,i-r.w_size,r.w_size,0);e=l;i=r.w_size}a=t.avail_in;h=t.next_in;f=t.input;t.avail_in=i;t.next_in=0;t.input=e;dl(r);while(r.lookahead>=qf){n=r.strstart;s=r.lookahead-(qf-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+qf-1])&r.hash_mask;r.prev[n&r.w_mask]=r.head[r.ins_h];r.head[r.ins_h]=n;n++}while(--s);r.strstart=n;r.lookahead=qf-1;dl(r)}r.strstart+=r.lookahead;r.block_start=r.strstart;r.insert=r.lookahead;r.lookahead=0;r.match_length=r.prev_length=qf-1;r.match_available=0;t.next_in=h;t.input=f;t.avail_in=a;r.wrap=o;return wf}var Ll=Rl;var Il=Cl;var zl=El;var Pl=kl;var Nl=Sl;var Bl=Tl;var Dl=Al;var jl=Ol;var Ul="pako deflate (from Nodeca project)";var Ml={deflateInit:Ll,deflateInit2:Il,deflateReset:zl,deflateResetKeep:Pl,deflateSetHeader:Nl,deflate:Bl,deflateEnd:Dl,deflateSetDictionary:jl,deflateInfo:Ul};var Fl=true;var ql=true;try{String.fromCharCode.apply(null,[0])}catch(Pp){Fl=false}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Pp){ql=false}var Wl=new Fa.Buf8(256);for(var Hl=0;Hl<256;Hl++){Wl[Hl]=Hl>=252?6:Hl>=248?5:Hl>=240?4:Hl>=224?3:Hl>=192?2:1}Wl[254]=Wl[254]=1;var Yl=function(t){var e,i,r,n,s,o=t.length,a=0;for(n=0;n<o;n++){i=t.charCodeAt(n);if((i&64512)===55296&&n+1<o){r=t.charCodeAt(n+1);if((r&64512)===56320){i=65536+(i-55296<<10)+(r-56320);n++}}a+=i<128?1:i<2048?2:i<65536?3:4}e=new Fa.Buf8(a);for(s=0,n=0;s<a;n++){i=t.charCodeAt(n);if((i&64512)===55296&&n+1<o){r=t.charCodeAt(n+1);if((r&64512)===56320){i=65536+(i-55296<<10)+(r-56320);n++}}if(i<128){e[s++]=i}else if(i<2048){e[s++]=192|i>>>6;e[s++]=128|i&63}else if(i<65536){e[s++]=224|i>>>12;e[s++]=128|i>>>6&63;e[s++]=128|i&63}else{e[s++]=240|i>>>18;e[s++]=128|i>>>12&63;e[s++]=128|i>>>6&63;e[s++]=128|i&63}}return e};function Zl(t,e){if(e<65534){if(t.subarray&&ql||!t.subarray&&Fl){return String.fromCharCode.apply(null,Fa.shrinkBuf(t,e))}}var i="";for(var r=0;r<e;r++){i+=String.fromCharCode(t[r])}return i}var Vl=function(t){return Zl(t,t.length)};var Xl=function(t){var e=new Fa.Buf8(t.length);for(var i=0,r=e.length;i<r;i++){e[i]=t.charCodeAt(i)}return e};var Kl=function(t,e){var i,r,n,s;var o=e||t.length;var a=new Array(o*2);for(r=0,i=0;i<o;){n=t[i++];if(n<128){a[r++]=n;continue}s=Wl[n];if(s>4){a[r++]=65533;i+=s-1;continue}n&=s===2?31:s===3?15:7;while(s>1&&i<o){n=n<<6|t[i++]&63;s--}if(s>1){a[r++]=65533;continue}if(n<65536){a[r++]=n}else{n-=65536;a[r++]=55296|n>>10&1023;a[r++]=56320|n&1023}}return Zl(a,r)};var Gl=function(t,e){var i;e=e||t.length;if(e>t.length){e=t.length}i=e-1;while(i>=0&&(t[i]&192)===128){i--}if(i<0){return e}if(i===0){return e}return i+Wl[t[i]]>e?i:e};var Jl={string2buf:Yl,buf2binstring:Vl,binstring2buf:Xl,buf2string:Kl,utf8border:Gl};function $l(){this.input=null;this.next_in=0;this.avail_in=0;this.total_in=0;this.output=null;this.next_out=0;this.avail_out=0;this.total_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}var Ql=$l;var tu=Object.prototype.toString;var eu=0;var iu=4;var ru=0;var nu=1;var su=2;var ou=-1;var au=0;var hu=8;function fu(t){if(!(this instanceof fu))return new fu(t);this.options=Fa.assign({level:ou,method:hu,chunkSize:16384,windowBits:15,memLevel:8,strategy:au,to:""},t||{});var e=this.options;if(e.raw&&e.windowBits>0){e.windowBits=-e.windowBits}else if(e.gzip&&e.windowBits>0&&e.windowBits<16){e.windowBits+=16}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new Ql;this.strm.avail_out=0;var i=Ml.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==ru){throw new Error(df[i])}if(e.header){Ml.deflateSetHeader(this.strm,e.header)}if(e.dictionary){var r;if(typeof e.dictionary==="string"){r=Jl.string2buf(e.dictionary)}else if(tu.call(e.dictionary)==="[object ArrayBuffer]"){r=new Uint8Array(e.dictionary)}else{r=e.dictionary}i=Ml.deflateSetDictionary(this.strm,r);if(i!==ru){throw new Error(df[i])}this._dict_set=true}}fu.prototype.push=function(t,e){var i=this.strm;var r=this.options.chunkSize;var n,s;if(this.ended){return false}s=e===~~e?e:e===true?iu:eu;if(typeof t==="string"){i.input=Jl.string2buf(t)}else if(tu.call(t)==="[object ArrayBuffer]"){i.input=new Uint8Array(t)}else{i.input=t}i.next_in=0;i.avail_in=i.input.length;do{if(i.avail_out===0){i.output=new Fa.Buf8(r);i.next_out=0;i.avail_out=r}n=Ml.deflate(i,s);if(n!==nu&&n!==ru){this.onEnd(n);this.ended=true;return false}if(i.avail_out===0||i.avail_in===0&&(s===iu||s===su)){if(this.options.to==="string"){this.onData(Jl.buf2binstring(Fa.shrinkBuf(i.output,i.next_out)))}else{this.onData(Fa.shrinkBuf(i.output,i.next_out))}}}while((i.avail_in>0||i.avail_out===0)&&n!==nu);if(s===iu){n=Ml.deflateEnd(this.strm);this.onEnd(n);this.ended=true;return n===ru}if(s===su){this.onEnd(ru);i.avail_out=0;return true}return true};fu.prototype.onData=function(t){this.chunks.push(t)};fu.prototype.onEnd=function(t){if(t===ru){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=Fa.flattenChunks(this.chunks)}}this.chunks=[];this.err=t;this.msg=this.strm.msg};function lu(t,e){var i=new fu(e);i.push(t,true);if(i.err){throw i.msg||df[i.err]}return i.result}function uu(t,e){e=e||{};e.raw=true;return lu(t,e)}function cu(t,e){e=e||{};e.gzip=true;return lu(t,e)}var du=fu;var pu=lu;var vu=uu;var gu=cu;var mu={Deflate:du,deflate:pu,deflateRaw:vu,gzip:gu};var yu=30;var wu=12;var bu=function t(e,i){var r;var n;var s;var o;var a;var h;var f;var l;var u;var c;var d;var p;var v;var g;var m;var y;var w;var b;var _;var x;var k;var E;var S;var C,R;r=e.state;n=e.next_in;C=e.input;s=n+(e.avail_in-5);o=e.next_out;R=e.output;a=o-(i-e.avail_out);h=o+(e.avail_out-257);f=r.dmax;l=r.wsize;u=r.whave;c=r.wnext;d=r.window;p=r.hold;v=r.bits;g=r.lencode;m=r.distcode;y=(1<<r.lenbits)-1;w=(1<<r.distbits)-1;t:do{if(v<15){p+=C[n++]<<v;v+=8;p+=C[n++]<<v;v+=8}b=g[p&y];e:for(;;){_=b>>>24;p>>>=_;v-=_;_=b>>>16&255;if(_===0){R[o++]=b&65535}else if(_&16){x=b&65535;_&=15;if(_){if(v<_){p+=C[n++]<<v;v+=8}x+=p&(1<<_)-1;p>>>=_;v-=_}if(v<15){p+=C[n++]<<v;v+=8;p+=C[n++]<<v;v+=8}b=m[p&w];i:for(;;){_=b>>>24;p>>>=_;v-=_;_=b>>>16&255;if(_&16){k=b&65535;_&=15;if(v<_){p+=C[n++]<<v;v+=8;if(v<_){p+=C[n++]<<v;v+=8}}k+=p&(1<<_)-1;if(k>f){e.msg="invalid distance too far back";r.mode=yu;break t}p>>>=_;v-=_;_=o-a;if(k>_){_=k-_;if(_>u){if(r.sane){e.msg="invalid distance too far back";r.mode=yu;break t}}E=0;S=d;if(c===0){E+=l-_;if(_<x){x-=_;do{R[o++]=d[E++]}while(--_);E=o-k;S=R}}else if(c<_){E+=l+c-_;_-=c;if(_<x){x-=_;do{R[o++]=d[E++]}while(--_);E=0;if(c<x){_=c;x-=_;do{R[o++]=d[E++]}while(--_);E=o-k;S=R}}}else{E+=c-_;if(_<x){x-=_;do{R[o++]=d[E++]}while(--_);E=o-k;S=R}}while(x>2){R[o++]=S[E++];R[o++]=S[E++];R[o++]=S[E++];x-=3}if(x){R[o++]=S[E++];if(x>1){R[o++]=S[E++]}}}else{E=o-k;do{R[o++]=R[E++];R[o++]=R[E++];R[o++]=R[E++];x-=3}while(x>2);if(x){R[o++]=R[E++];if(x>1){R[o++]=R[E++]}}}}else if((_&64)===0){b=m[(b&65535)+(p&(1<<_)-1)];continue i}else{e.msg="invalid distance code";r.mode=yu;break t}break}}else if((_&64)===0){b=g[(b&65535)+(p&(1<<_)-1)];continue e}else if(_&32){r.mode=wu;break t}else{e.msg="invalid literal/length code";r.mode=yu;break t}break}}while(n<s&&o<h);x=v>>3;n-=x;v-=x<<3;p&=(1<<v)-1;e.next_in=n;e.next_out=o;e.avail_in=n<s?5+(s-n):5-(n-s);e.avail_out=o<h?257+(h-o):257-(o-h);r.hold=p;r.bits=v;return};var _u=15;var xu=852;var ku=592;var Eu=0;var Su=1;var Cu=2;var Ru=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var Tu=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78];var Au=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0];var Ou=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];var Lu=function t(e,i,r,n,s,o,a,h){var f=h.bits;var l=0;var u=0;var c=0,d=0;var p=0;var v=0;var g=0;var m=0;var y=0;var w=0;var b;var _;var x;var k;var E;var S=null;var C=0;var R;var T=new Fa.Buf16(_u+1);var A=new Fa.Buf16(_u+1);var O=null;var L=0;var I,z,P;for(l=0;l<=_u;l++){T[l]=0}for(u=0;u<n;u++){T[i[r+u]]++}p=f;for(d=_u;d>=1;d--){if(T[d]!==0){break}}if(p>d){p=d}if(d===0){s[o++]=1<<24|64<<16|0;s[o++]=1<<24|64<<16|0;h.bits=1;return 0}for(c=1;c<d;c++){if(T[c]!==0){break}}if(p<c){p=c}m=1;for(l=1;l<=_u;l++){m<<=1;m-=T[l];if(m<0){return-1}}if(m>0&&(e===Eu||d!==1)){return-1}A[1]=0;for(l=1;l<_u;l++){A[l+1]=A[l]+T[l]}for(u=0;u<n;u++){if(i[r+u]!==0){a[A[i[r+u]]++]=u}}if(e===Eu){S=O=a;R=19}else if(e===Su){S=Ru;C-=257;O=Tu;L-=257;R=256}else{S=Au;O=Ou;R=-1}w=0;u=0;l=c;E=o;v=p;g=0;x=-1;y=1<<p;k=y-1;if(e===Su&&y>xu||e===Cu&&y>ku){return 1}for(;;){I=l-g;if(a[u]<R){z=0;P=a[u]}else if(a[u]>R){z=O[L+a[u]];P=S[C+a[u]]}else{z=32+64;P=0}b=1<<l-g;_=1<<v;c=_;do{_-=b;s[E+(w>>g)+_]=I<<24|z<<16|P|0}while(_!==0);b=1<<l-1;while(w&b){b>>=1}if(b!==0){w&=b-1;w+=b}else{w=0}u++;if(--T[l]===0){if(l===d){break}l=i[r+a[u]]}if(l>p&&(w&k)!==x){if(g===0){g=p}E+=c;v=l-g;m=1<<v;while(v+g<d){m-=T[v+g];if(m<=0){break}v++;m<<=1}y+=1<<v;if(e===Su&&y>xu||e===Cu&&y>ku){return 1}x=w&k;s[x]=p<<24|v<<16|E-o|0}}if(w!==0){s[E+w]=l-g<<24|64<<16|0}h.bits=p;return 0};var Iu=0;var zu=1;var Pu=2;var Nu=4;var Bu=5;var Du=6;var ju=0;var Uu=1;var Mu=2;var Fu=-2;var qu=-3;var Wu=-4;var Hu=-5;var Yu=8;var Zu=1;var Vu=2;var Xu=3;var Ku=4;var Gu=5;var Ju=6;var $u=7;var Qu=8;var tc=9;var ec=10;var ic=11;var rc=12;var nc=13;var sc=14;var oc=15;var ac=16;var hc=17;var fc=18;var lc=19;var uc=20;var cc=21;var dc=22;var pc=23;var vc=24;var gc=25;var mc=26;var yc=27;var wc=28;var bc=29;var _c=30;var xc=31;var kc=32;var Ec=852;var Sc=592;var Cc=15;var Rc=Cc;function Tc(t){return(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24)}function Ac(){this.mode=0;this.last=false;this.wrap=0;this.havedict=false;this.flags=0;this.dmax=0;this.check=0;this.total=0;this.head=null;this.wbits=0;this.wsize=0;this.whave=0;this.wnext=0;this.window=null;this.hold=0;this.bits=0;this.length=0;this.offset=0;this.extra=0;this.lencode=null;this.distcode=null;this.lenbits=0;this.distbits=0;this.ncode=0;this.nlen=0;this.ndist=0;this.have=0;this.next=null;this.lens=new Fa.Buf16(320);this.work=new Fa.Buf16(288);this.lendyn=null;this.distdyn=null;this.sane=0;this.back=0;this.was=0}function Oc(t){var e;if(!t||!t.state){return Fu}e=t.state;t.total_in=t.total_out=e.total=0;t.msg="";if(e.wrap){t.adler=e.wrap&1}e.mode=Zu;e.last=0;e.havedict=0;e.dmax=32768;e.head=null;e.hold=0;e.bits=0;e.lencode=e.lendyn=new Fa.Buf32(Ec);e.distcode=e.distdyn=new Fa.Buf32(Sc);e.sane=1;e.back=-1;return ju}function Lc(t){var e;if(!t||!t.state){return Fu}e=t.state;e.wsize=0;e.whave=0;e.wnext=0;return Oc(t)}function Ic(t,e){var i;var r;if(!t||!t.state){return Fu}r=t.state;if(e<0){i=0;e=-e}else{i=(e>>4)+1;if(e<48){e&=15}}if(e&&(e<8||e>15)){return Fu}if(r.window!==null&&r.wbits!==e){r.window=null}r.wrap=i;r.wbits=e;return Lc(t)}function zc(t,e){var i;var r;if(!t){return Fu}r=new Ac;t.state=r;r.window=null;i=Ic(t,e);if(i!==ju){t.state=null}return i}function Pc(t){return zc(t,Rc)}var Nc=true;var Bc,Dc;function jc(t){if(Nc){var e;Bc=new Fa.Buf32(512);Dc=new Fa.Buf32(32);e=0;while(e<144){t.lens[e++]=8}while(e<256){t.lens[e++]=9}while(e<280){t.lens[e++]=7}while(e<288){t.lens[e++]=8}Lu(zu,t.lens,0,288,Bc,0,t.work,{bits:9});e=0;while(e<32){t.lens[e++]=5}Lu(Pu,t.lens,0,32,Dc,0,t.work,{bits:5});Nc=false}t.lencode=Bc;t.lenbits=9;t.distcode=Dc;t.distbits=5}function Uc(t,e,i,r){var n;var s=t.state;if(s.window===null){s.wsize=1<<s.wbits;s.wnext=0;s.whave=0;s.window=new Fa.Buf8(s.wsize)}if(r>=s.wsize){Fa.arraySet(s.window,e,i-s.wsize,s.wsize,0);s.wnext=0;s.whave=s.wsize}else{n=s.wsize-s.wnext;if(n>r){n=r}Fa.arraySet(s.window,e,i-r,n,s.wnext);r-=n;if(r){Fa.arraySet(s.window,e,i-r,r,0);s.wnext=r;s.whave=s.wsize}else{s.wnext+=n;if(s.wnext===s.wsize){s.wnext=0}if(s.whave<s.wsize){s.whave+=n}}}return 0}function Mc(t,e){var i;var r,n;var s;var o;var a,h;var f;var l;var u,c;var d;var p;var v;var g=0;var m,y,w;var b,_,x;var k;var E;var S=new Fa.Buf8(4);var C;var R;var T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0){return Fu}i=t.state;if(i.mode===rc){i.mode=nc}o=t.next_out;n=t.output;h=t.avail_out;s=t.next_in;r=t.input;a=t.avail_in;f=i.hold;l=i.bits;u=a;c=h;E=ju;t:for(;;){switch(i.mode){case Zu:if(i.wrap===0){i.mode=nc;break}while(l<16){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}if(i.wrap&2&&f===35615){i.check=0;S[0]=f&255;S[1]=f>>>8&255;i.check=cf(i.check,S,2,0);f=0;l=0;i.mode=Vu;break}i.flags=0;if(i.head){i.head.done=false}if(!(i.wrap&1)||(((f&255)<<8)+(f>>8))%31){t.msg="incorrect header check";i.mode=_c;break}if((f&15)!==Yu){t.msg="unknown compression method";i.mode=_c;break}f>>>=4;l-=4;k=(f&15)+8;if(i.wbits===0){i.wbits=k}else if(k>i.wbits){t.msg="invalid window size";i.mode=_c;break}i.dmax=1<<k;t.adler=i.check=1;i.mode=f&512?ec:rc;f=0;l=0;break;case Vu:while(l<16){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}i.flags=f;if((i.flags&255)!==Yu){t.msg="unknown compression method";i.mode=_c;break}if(i.flags&57344){t.msg="unknown header flags set";i.mode=_c;break}if(i.head){i.head.text=f>>8&1}if(i.flags&512){S[0]=f&255;S[1]=f>>>8&255;i.check=cf(i.check,S,2,0)}f=0;l=0;i.mode=Xu;case Xu:while(l<32){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}if(i.head){i.head.time=f}if(i.flags&512){S[0]=f&255;S[1]=f>>>8&255;S[2]=f>>>16&255;S[3]=f>>>24&255;i.check=cf(i.check,S,4,0)}f=0;l=0;i.mode=Ku;case Ku:while(l<16){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}if(i.head){i.head.xflags=f&255;i.head.os=f>>8}if(i.flags&512){S[0]=f&255;S[1]=f>>>8&255;i.check=cf(i.check,S,2,0)}f=0;l=0;i.mode=Gu;case Gu:if(i.flags&1024){while(l<16){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}i.length=f;if(i.head){i.head.extra_len=f}if(i.flags&512){S[0]=f&255;S[1]=f>>>8&255;i.check=cf(i.check,S,2,0)}f=0;l=0}else if(i.head){i.head.extra=null}i.mode=Ju;case Ju:if(i.flags&1024){d=i.length;if(d>a){d=a}if(d){if(i.head){k=i.head.extra_len-i.length;if(!i.head.extra){i.head.extra=new Array(i.head.extra_len)}Fa.arraySet(i.head.extra,r,s,d,k)}if(i.flags&512){i.check=cf(i.check,r,d,s)}a-=d;s+=d;i.length-=d}if(i.length){break t}}i.length=0;i.mode=$u;case $u:if(i.flags&2048){if(a===0){break t}d=0;do{k=r[s+d++];if(i.head&&k&&i.length<65536){i.head.name+=String.fromCharCode(k)}}while(k&&d<a);if(i.flags&512){i.check=cf(i.check,r,d,s)}a-=d;s+=d;if(k){break t}}else if(i.head){i.head.name=null}i.length=0;i.mode=Qu;case Qu:if(i.flags&4096){if(a===0){break t}d=0;do{k=r[s+d++];if(i.head&&k&&i.length<65536){i.head.comment+=String.fromCharCode(k)}}while(k&&d<a);if(i.flags&512){i.check=cf(i.check,r,d,s)}a-=d;s+=d;if(k){break t}}else if(i.head){i.head.comment=null}i.mode=tc;case tc:if(i.flags&512){while(l<16){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}if(f!==(i.check&65535)){t.msg="header crc mismatch";i.mode=_c;break}f=0;l=0}if(i.head){i.head.hcrc=i.flags>>9&1;i.head.done=true}t.adler=i.check=0;i.mode=rc;break;case ec:while(l<32){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}t.adler=i.check=Tc(f);f=0;l=0;i.mode=ic;case ic:if(i.havedict===0){t.next_out=o;t.avail_out=h;t.next_in=s;t.avail_in=a;i.hold=f;i.bits=l;return Mu}t.adler=i.check=1;i.mode=rc;case rc:if(e===Bu||e===Du){break t}case nc:if(i.last){f>>>=l&7;l-=l&7;i.mode=yc;break}while(l<3){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}i.last=f&1;f>>>=1;l-=1;switch(f&3){case 0:i.mode=sc;break;case 1:jc(i);i.mode=uc;if(e===Du){f>>>=2;l-=2;break t}break;case 2:i.mode=hc;break;case 3:t.msg="invalid block type";i.mode=_c}f>>>=2;l-=2;break;case sc:f>>>=l&7;l-=l&7;while(l<32){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}if((f&65535)!==(f>>>16^65535)){t.msg="invalid stored block lengths";i.mode=_c;break}i.length=f&65535;f=0;l=0;i.mode=oc;if(e===Du){break t}case oc:i.mode=ac;case ac:d=i.length;if(d){if(d>a){d=a}if(d>h){d=h}if(d===0){break t}Fa.arraySet(n,r,s,d,o);a-=d;s+=d;h-=d;o+=d;i.length-=d;break}i.mode=rc;break;case hc:while(l<14){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}i.nlen=(f&31)+257;f>>>=5;l-=5;i.ndist=(f&31)+1;f>>>=5;l-=5;i.ncode=(f&15)+4;f>>>=4;l-=4;if(i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols";i.mode=_c;break}i.have=0;i.mode=fc;case fc:while(i.have<i.ncode){while(l<3){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}i.lens[T[i.have++]]=f&7;f>>>=3;l-=3}while(i.have<19){i.lens[T[i.have++]]=0}i.lencode=i.lendyn;i.lenbits=7;C={bits:i.lenbits};E=Lu(Iu,i.lens,0,19,i.lencode,0,i.work,C);i.lenbits=C.bits;if(E){t.msg="invalid code lengths set";i.mode=_c;break}i.have=0;i.mode=lc;case lc:while(i.have<i.nlen+i.ndist){for(;;){g=i.lencode[f&(1<<i.lenbits)-1];m=g>>>24;y=g>>>16&255;w=g&65535;if(m<=l){break}if(a===0){break t}a--;f+=r[s++]<<l;l+=8}if(w<16){f>>>=m;l-=m;i.lens[i.have++]=w}else{if(w===16){R=m+2;while(l<R){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}f>>>=m;l-=m;if(i.have===0){t.msg="invalid bit length repeat";i.mode=_c;break}k=i.lens[i.have-1];d=3+(f&3);f>>>=2;l-=2}else if(w===17){R=m+3;while(l<R){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}f>>>=m;l-=m;k=0;d=3+(f&7);f>>>=3;l-=3}else{R=m+7;while(l<R){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}f>>>=m;l-=m;k=0;d=11+(f&127);f>>>=7;l-=7}if(i.have+d>i.nlen+i.ndist){t.msg="invalid bit length repeat";i.mode=_c;break}while(d--){i.lens[i.have++]=k}}}if(i.mode===_c){break}if(i.lens[256]===0){t.msg="invalid code -- missing end-of-block";i.mode=_c;break}i.lenbits=9;C={bits:i.lenbits};E=Lu(zu,i.lens,0,i.nlen,i.lencode,0,i.work,C);i.lenbits=C.bits;if(E){t.msg="invalid literal/lengths set";i.mode=_c;break}i.distbits=6;i.distcode=i.distdyn;C={bits:i.distbits};E=Lu(Pu,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,C);i.distbits=C.bits;if(E){t.msg="invalid distances set";i.mode=_c;break}i.mode=uc;if(e===Du){break t}case uc:i.mode=cc;case cc:if(a>=6&&h>=258){t.next_out=o;t.avail_out=h;t.next_in=s;t.avail_in=a;i.hold=f;i.bits=l;bu(t,c);o=t.next_out;n=t.output;h=t.avail_out;s=t.next_in;r=t.input;a=t.avail_in;f=i.hold;l=i.bits;if(i.mode===rc){i.back=-1}break}i.back=0;for(;;){g=i.lencode[f&(1<<i.lenbits)-1];m=g>>>24;y=g>>>16&255;w=g&65535;if(m<=l){break}if(a===0){break t}a--;f+=r[s++]<<l;l+=8}if(y&&(y&240)===0){b=m;_=y;x=w;for(;;){g=i.lencode[x+((f&(1<<b+_)-1)>>b)];m=g>>>24;y=g>>>16&255;w=g&65535;if(b+m<=l){break}if(a===0){break t}a--;f+=r[s++]<<l;l+=8}f>>>=b;l-=b;i.back+=b}f>>>=m;l-=m;i.back+=m;i.length=w;if(y===0){i.mode=mc;break}if(y&32){i.back=-1;i.mode=rc;break}if(y&64){t.msg="invalid literal/length code";i.mode=_c;break}i.extra=y&15;i.mode=dc;case dc:if(i.extra){R=i.extra;while(l<R){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}i.length+=f&(1<<i.extra)-1;f>>>=i.extra;l-=i.extra;i.back+=i.extra}i.was=i.length;i.mode=pc;case pc:for(;;){g=i.distcode[f&(1<<i.distbits)-1];m=g>>>24;y=g>>>16&255;w=g&65535;if(m<=l){break}if(a===0){break t}a--;f+=r[s++]<<l;l+=8}if((y&240)===0){b=m;_=y;x=w;for(;;){g=i.distcode[x+((f&(1<<b+_)-1)>>b)];m=g>>>24;y=g>>>16&255;w=g&65535;if(b+m<=l){break}if(a===0){break t}a--;f+=r[s++]<<l;l+=8}f>>>=b;l-=b;i.back+=b}f>>>=m;l-=m;i.back+=m;if(y&64){t.msg="invalid distance code";i.mode=_c;break}i.offset=w;i.extra=y&15;i.mode=vc;case vc:if(i.extra){R=i.extra;while(l<R){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}i.offset+=f&(1<<i.extra)-1;f>>>=i.extra;l-=i.extra;i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back";i.mode=_c;break}i.mode=gc;case gc:if(h===0){break t}d=c-h;if(i.offset>d){d=i.offset-d;if(d>i.whave){if(i.sane){t.msg="invalid distance too far back";i.mode=_c;break}}if(d>i.wnext){d-=i.wnext;p=i.wsize-d}else{p=i.wnext-d}if(d>i.length){d=i.length}v=i.window}else{v=n;p=o-i.offset;d=i.length}if(d>h){d=h}h-=d;i.length-=d;do{n[o++]=v[p++]}while(--d);if(i.length===0){i.mode=cc}break;case mc:if(h===0){break t}n[o++]=i.length;h--;i.mode=cc;break;case yc:if(i.wrap){while(l<32){if(a===0){break t}a--;f|=r[s++]<<l;l+=8}c-=h;t.total_out+=c;i.total+=c;if(c){t.adler=i.check=i.flags?cf(i.check,n,c,o-c):hf(i.check,n,c,o-c)}c=h;if((i.flags?f:Tc(f))!==i.check){t.msg="incorrect data check";i.mode=_c;break}f=0;l=0}i.mode=wc;case wc:if(i.wrap&&i.flags){while(l<32){if(a===0){break t}a--;f+=r[s++]<<l;l+=8}if(f!==(i.total&4294967295)){t.msg="incorrect length check";i.mode=_c;break}f=0;l=0}i.mode=bc;case bc:E=Uu;break t;case _c:E=qu;break t;case xc:return Wu;case kc:default:return Fu}}t.next_out=o;t.avail_out=h;t.next_in=s;t.avail_in=a;i.hold=f;i.bits=l;if(i.wsize||c!==t.avail_out&&i.mode<_c&&(i.mode<yc||e!==Nu)){if(Uc(t,t.output,t.next_out,c-t.avail_out));}u-=t.avail_in;c-=t.avail_out;t.total_in+=u;t.total_out+=c;i.total+=c;if(i.wrap&&c){t.adler=i.check=i.flags?cf(i.check,n,c,t.next_out-c):hf(i.check,n,c,t.next_out-c)}t.data_type=i.bits+(i.last?64:0)+(i.mode===rc?128:0)+(i.mode===uc||i.mode===oc?256:0);if((u===0&&c===0||e===Nu)&&E===ju){E=Hu}return E}function Fc(t){if(!t||!t.state){return Fu}var e=t.state;if(e.window){e.window=null}t.state=null;return ju}function qc(t,e){var i;if(!t||!t.state){return Fu}i=t.state;if((i.wrap&2)===0){return Fu}i.head=e;e.done=false;return ju}function Wc(t,e){var i=e.length;var r;var n;var s;if(!t||!t.state){return Fu}r=t.state;if(r.wrap!==0&&r.mode!==ic){return Fu}if(r.mode===ic){n=1;n=hf(n,e,i,0);if(n!==r.check){return qu}}s=Uc(t,e,i,i);if(s){r.mode=xc;return Wu}r.havedict=1;return ju}var Hc=Lc;var Yc=Ic;var Zc=Oc;var Vc=Pc;var Xc=zc;var Kc=Mc;var Gc=Fc;var Jc=qc;var $c=Wc;var Qc="pako inflate (from Nodeca project)";var td={inflateReset:Hc,inflateReset2:Yc,inflateResetKeep:Zc,inflateInit:Vc,inflateInit2:Xc,inflate:Kc,inflateEnd:Gc,inflateGetHeader:Jc,inflateSetDictionary:$c,inflateInfo:Qc};var ed={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function id(){this.text=0;this.time=0;this.xflags=0;this.os=0;this.extra=null;this.extra_len=0;this.name="";this.comment="";this.hcrc=0;this.done=false}var rd=id;var nd=Object.prototype.toString;function sd(t){if(!(this instanceof sd))return new sd(t);this.options=Fa.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;if(e.raw&&e.windowBits>=0&&e.windowBits<16){e.windowBits=-e.windowBits;if(e.windowBits===0){e.windowBits=-15}}if(e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)){e.windowBits+=32}if(e.windowBits>15&&e.windowBits<48){if((e.windowBits&15)===0){e.windowBits|=15}}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new Ql;this.strm.avail_out=0;var i=td.inflateInit2(this.strm,e.windowBits);if(i!==ed.Z_OK){throw new Error(df[i])}this.header=new rd;td.inflateGetHeader(this.strm,this.header);if(e.dictionary){if(typeof e.dictionary==="string"){e.dictionary=Jl.string2buf(e.dictionary)}else if(nd.call(e.dictionary)==="[object ArrayBuffer]"){e.dictionary=new Uint8Array(e.dictionary)}if(e.raw){i=td.inflateSetDictionary(this.strm,e.dictionary);if(i!==ed.Z_OK){throw new Error(df[i])}}}}sd.prototype.push=function(t,e){var i=this.strm;var r=this.options.chunkSize;var n=this.options.dictionary;var s,o;var a,h,f;var l=false;if(this.ended){return false}o=e===~~e?e:e===true?ed.Z_FINISH:ed.Z_NO_FLUSH;if(typeof t==="string"){i.input=Jl.binstring2buf(t)}else if(nd.call(t)==="[object ArrayBuffer]"){i.input=new Uint8Array(t)}else{i.input=t}i.next_in=0;i.avail_in=i.input.length;do{if(i.avail_out===0){i.output=new Fa.Buf8(r);i.next_out=0;i.avail_out=r}s=td.inflate(i,ed.Z_NO_FLUSH);if(s===ed.Z_NEED_DICT&&n){s=td.inflateSetDictionary(this.strm,n)}if(s===ed.Z_BUF_ERROR&&l===true){s=ed.Z_OK;l=false}if(s!==ed.Z_STREAM_END&&s!==ed.Z_OK){this.onEnd(s);this.ended=true;return false}if(i.next_out){if(i.avail_out===0||s===ed.Z_STREAM_END||i.avail_in===0&&(o===ed.Z_FINISH||o===ed.Z_SYNC_FLUSH)){if(this.options.to==="string"){a=Jl.utf8border(i.output,i.next_out);h=i.next_out-a;f=Jl.buf2string(i.output,a);i.next_out=h;i.avail_out=r-h;if(h){Fa.arraySet(i.output,i.output,a,h,0)}this.onData(f)}else{this.onData(Fa.shrinkBuf(i.output,i.next_out))}}}if(i.avail_in===0&&i.avail_out===0){l=true}}while((i.avail_in>0||i.avail_out===0)&&s!==ed.Z_STREAM_END);if(s===ed.Z_STREAM_END){o=ed.Z_FINISH}if(o===ed.Z_FINISH){s=td.inflateEnd(this.strm);this.onEnd(s);this.ended=true;return s===ed.Z_OK}if(o===ed.Z_SYNC_FLUSH){this.onEnd(ed.Z_OK);i.avail_out=0;return true}return true};sd.prototype.onData=function(t){this.chunks.push(t)};sd.prototype.onEnd=function(t){if(t===ed.Z_OK){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=Fa.flattenChunks(this.chunks)}}this.chunks=[];this.err=t;this.msg=this.strm.msg};function od(t,e){var i=new sd(e);i.push(t,true);if(i.err){throw i.msg||df[i.err]}return i.result}function ad(t,e){e=e||{};e.raw=true;return od(t,e)}var hd=sd;var fd=od;var ld=ad;var ud=od;var cd={Inflate:hd,inflate:fd,inflateRaw:ld,ungzip:ud};var dd=Fa.assign;var pd={};dd(pd,mu,cd,ed);var vd=pd;var gd=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Uint32Array!=="undefined";var md=gd?"uint8array":"array";var yd="\b\0";function wd(t,e){$o.call(this,"FlateWorker/"+t);this._pako=null;this._pakoAction=t;this._pakoOptions=e;this.meta={}}Go.inherits(wd,$o);wd.prototype.processChunk=function(t){this.meta=t.meta;if(this._pako===null){this._createPako()}this._pako.push(Go.transformTo(md,t.data),false)};wd.prototype.flush=function(){$o.prototype.flush.call(this);if(this._pako===null){this._createPako()}this._pako.push([],true)};wd.prototype.cleanUp=function(){$o.prototype.cleanUp.call(this);this._pako=null};wd.prototype._createPako=function(){this._pako=new vd[this._pakoAction]({raw:true,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}};var bd=function(t){return new wd("Deflate",t)};var _d=function(){return new wd("Inflate",{})};var xd={magic:yd,compressWorker:bd,uncompressWorker:_d};var kd={magic:"\0\0",compressWorker:function(t){return new $o("STORE compression")},uncompressWorker:function(){return new $o("STORE decompression")}};var Ed=xd;var Sd={STORE:kd,DEFLATE:Ed};var Cd="PK";var Rd="PK";var Td="PK";var Ad="PK";var Od="PK";var Ld="PK\b";var Id={LOCAL_FILE_HEADER:Cd,CENTRAL_FILE_HEADER:Rd,CENTRAL_DIRECTORY_END:Td,ZIP64_CENTRAL_DIRECTORY_LOCATOR:Ad,ZIP64_CENTRAL_DIRECTORY_END:Od,DATA_DESCRIPTOR:Ld};var zd=function(t,e){var i="",r;for(r=0;r<e;r++){i+=String.fromCharCode(t&255);t=t>>>8}return i};var Pd=function(t,e){var i=t;if(!t){i=e?16893:33204}return(i&65535)<<16};var Nd=function(t,e){return(t||0)&63};var Bd=function(t,e,i,r,n,s){var o=t["file"],a=t["compression"],h=s!==Qo.utf8encode,f=Go.transformTo("string",s(o.name)),l=Go.transformTo("string",Qo.utf8encode(o.name)),u=o.comment,c=Go.transformTo("string",s(u)),d=Go.transformTo("string",Qo.utf8encode(u)),p=l.length!==o.name.length,v=d.length!==u.length,g,m,y="",w="",b="",_=o.dir,x=o.date;var k={crc32:0,compressedSize:0,uncompressedSize:0};if(!e||i){k.crc32=t["crc32"];k.compressedSize=t["compressedSize"];k.uncompressedSize=t["uncompressedSize"]}var E=0;if(e){E|=8}if(!h&&(p||v)){E|=2048}var S=0;var C=0;if(_){S|=16}if(n==="UNIX"){C=798;S|=Pd(o.unixPermissions,_)}else{C=20;S|=Nd(o.dosPermissions)}g=x.getUTCHours();g=g<<6;g=g|x.getUTCMinutes();g=g<<5;g=g|x.getUTCSeconds()/2;m=x.getUTCFullYear()-1980;m=m<<4;m=m|x.getUTCMonth()+1;m=m<<5;m=m|x.getUTCDate();if(p){w=zd(1,1)+zd(La(f),4)+l;y+="up"+zd(w.length,2)+w}if(v){b=zd(1,1)+zd(La(c),4)+d;y+="uc"+zd(b.length,2)+b}var R="";R+="\n\0";R+=zd(E,2);R+=a.magic;R+=zd(g,2);R+=zd(m,2);R+=zd(k.crc32,4);R+=zd(k.compressedSize,4);R+=zd(k.uncompressedSize,4);R+=zd(f.length,2);R+=zd(y.length,2);var T=Id.LOCAL_FILE_HEADER+R+f+y;var A=Id.CENTRAL_FILE_HEADER+zd(C,2)+R+zd(c.length,2)+"\0\0"+"\0\0"+zd(S,4)+zd(r,4)+f+y+c;return{fileRecord:T,dirRecord:A}};var Dd=function(t,e,i,r,n){var s="";var o=Go.transformTo("string",n(r));s=Id.CENTRAL_DIRECTORY_END+"\0\0"+"\0\0"+zd(t,2)+zd(t,2)+zd(e,4)+zd(i,4)+zd(o.length,2)+o;return s};var jd=function(t){var e="";e=Id.DATA_DESCRIPTOR+zd(t["crc32"],4)+zd(t["compressedSize"],4)+zd(t["uncompressedSize"],4);return e};function Ud(t,e,i,r){$o.call(this,"ZipFileWorker");this.bytesWritten=0;this.zipComment=e;this.zipPlatform=i;this.encodeFileName=r;this.streamFiles=t;this.accumulate=false;this.contentBuffer=[];this.dirRecords=[];this.currentSourceOffset=0;this.entriesCount=0;this.currentFile=null;this._sources=[]}Go.inherits(Ud,$o);Ud.prototype.push=function(t){var e=t.meta.percent||0;var i=this.entriesCount;var r=this._sources.length;if(this.accumulate){this.contentBuffer.push(t)}else{this.bytesWritten+=t.data.length;$o.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:i?(e+100*(i-r-1))/i:100}})}};Ud.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten;this.currentFile=t["file"].name;var e=this.streamFiles&&!t["file"].dir;if(e){var i=Bd(t,e,false,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else{this.accumulate=true}};Ud.prototype.closedSource=function(t){this.accumulate=false;var e=this.streamFiles&&!t["file"].dir;var i=Bd(t,e,true,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.dirRecords.push(i.dirRecord);if(e){this.push({data:jd(t),meta:{percent:100}})}else{this.push({data:i.fileRecord,meta:{percent:0}});while(this.contentBuffer.length){this.push(this.contentBuffer.shift())}}this.currentFile=null};Ud.prototype.flush=function(){var t=this.bytesWritten;for(var e=0;e<this.dirRecords.length;e++){this.push({data:this.dirRecords[e],meta:{percent:100}})}var i=this.bytesWritten-t;var r=Dd(this.dirRecords.length,i,t,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})};Ud.prototype.prepareNextSource=function(){this.previous=this._sources.shift();this.openedSource(this.previous.streamInfo);if(this.isPaused){this.previous.pause()}else{this.previous.resume()}};Ud.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;t.on("data",(function(t){e.processChunk(t)}));t.on("end",(function(){e.closedSource(e.previous.streamInfo);if(e._sources.length){e.prepareNextSource()}else{e.end()}}));t.on("error",(function(t){e.error(t)}));return this};Ud.prototype.resume=function(){if(!$o.prototype.resume.call(this)){return false}if(!this.previous&&this._sources.length){this.prepareNextSource();return true}if(!this.previous&&!this._sources.length&&!this.generatedError){this.end();return true}};Ud.prototype.error=function(t){var e=this._sources;if(!$o.prototype.error.call(this,t)){return false}for(var i=0;i<e.length;i++){try{e[i].error(t)}catch(t){}}return true};Ud.prototype.lock=function(){$o.prototype.lock.call(this);var t=this._sources;for(var e=0;e<t.length;e++){t[e].lock()}};var Md=Ud;var Fd=function(t,e){var i=t||e;var r=Sd[i];if(!r){throw new Error(i+" is not a valid compression method !")}return r};var qd=function(t,e,i){var r=new Md(e.streamFiles,i,e.platform,e.encodeFileName);var n=0;try{t.forEach((function(t,i){n++;var s=Fd(i.options.compression,e.compression);var o=i.options.compressionOptions||e.compressionOptions||{};var a=i.dir,h=i.date;i._compressWorker(s,o).withStreamInfo("file",{name:t,dir:a,date:h,comment:i.comment||"",unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions}).pipe(r)}));r.entriesCount=n}catch(zp){r.error(zp)}return r};var Wd={generateWorker:qd};function Hd(t,e){$o.call(this,"Nodejs stream input adapter for "+t);this._upstreamEnded=false;this._bindStream(e)}Go.inherits(Hd,$o);Hd.prototype._bindStream=function(t){var e=this;this._stream=t;t.pause();t.on("data",(function(t){e.push({data:t,meta:{percent:0}})})).on("error",(function(t){if(e.isPaused){this.generatedError=t}else{e.error(t)}})).on("end",(function(){if(e.isPaused){e._upstreamEnded=true}else{e.end()}}))};Hd.prototype.pause=function(){if(!$o.prototype.pause.call(this)){return false}this._stream.pause();return true};Hd.prototype.resume=function(){if(!$o.prototype.resume.call(this)){return false}if(this._upstreamEnded){this.end()}else{this._stream.resume()}return true};var Yd=Hd;var Zd=function(t,e,i){var r=Go.getTypeOf(e),n;var s=Go.extend(i||{},_a);s.date=s.date||new Date;if(s.compression!==null){s.compression=s.compression.toUpperCase()}if(typeof s.unixPermissions==="string"){s.unixPermissions=parseInt(s.unixPermissions,8)}if(s.unixPermissions&&s.unixPermissions&16384){s.dir=true}if(s.dosPermissions&&s.dosPermissions&16){s.dir=true}if(s.dir){t=Xd(t)}if(s.createFolders&&(n=Vd(t))){Kd.call(this,n,true)}var o=r==="string"&&s.binary===false&&s.base64===false;if(!i||typeof i.binary==="undefined"){s.binary=!o}var a=e instanceof Na&&e.uncompressedSize===0;if(a||s.dir||!e||e.length===0){s.base64=false;s.binary=true;e="";s.compression="STORE";r="string"}var h=null;if(e instanceof Na||e instanceof $o){h=e}else if(wo.isNode&&wo.isStream(e)){h=new Yd(t,e)}else{h=Go.prepareContent(t,e,s.binary,s.optimizedBinaryString,s.base64)}var f=new Ma(t,h,s);this.files[t]=f};var Vd=function(t){if(t.slice(-1)==="/"){t=t.substring(0,t.length-1)}var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""};var Xd=function(t){if(t.slice(-1)!=="/"){t+="/"}return t};var Kd=function(t,e){e=typeof e!=="undefined"?e:_a.createFolders;t=Xd(t);if(!this.files[t]){Zd.call(this,t,null,{dir:true,createFolders:e})}return this.files[t]};function Gd(t){return Object.prototype.toString.call(t)==="[object RegExp]"}var Jd={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,i,r;for(e in this.files){if(!this.files.hasOwnProperty(e)){continue}r=this.files[e];i=e.slice(this.root.length,e.length);if(i&&e.slice(0,this.root.length)===this.root){t(i,r)}}},filter:function(t){var e=[];this.forEach((function(i,r){if(t(i,r)){e.push(r)}}));return e},file:function(t,e,i){if(arguments.length===1){if(Gd(t)){var r=t;return this.filter((function(t,e){return!e.dir&&r.test(t)}))}else{var n=this.files[this.root+t];if(n&&!n.dir){return n}else{return null}}}else{t=this.root+t;Zd.call(this,t,e,i)}return this},folder:function(t){if(!t){return this}if(Gd(t)){return this.filter((function(e,i){return i.dir&&t.test(e)}))}var e=this.root+t;var i=Kd.call(this,e);var r=this.clone();r.root=i.name;return r},remove:function(t){t=this.root+t;var e=this.files[t];if(!e){if(t.slice(-1)!=="/"){t+="/"}e=this.files[t]}if(e&&!e.dir){delete this.files[t]}else{var i=this.filter((function(e,i){return i.name.slice(0,t.length)===t}));for(var r=0;r<i.length;r++){delete this.files[i[r].name]}}return this},generate:function(t){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,i={};try{i=Go.extend(t||{},{streamFiles:false,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:Qo.utf8encode});i.type=i.type.toLowerCase();i.compression=i.compression.toUpperCase();if(i.type==="binarystring"){i.type="string"}if(!i.type){throw new Error("No output type specified.")}Go.checkSupport(i.type);if(i.platform==="darwin"||i.platform==="freebsd"||i.platform==="linux"||i.platform==="sunos"){i.platform="UNIX"}if(i.platform==="win32"){i.platform="DOS"}var r=i.comment||this.comment||"";e=Wd.generateWorker(this,i,r)}catch(zp){e=new $o("error");e.error(zp)}return new la(e,i.type||"string",i.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){t=t||{};if(!t.type){t.type="nodebuffer"}return this.generateInternalStream(t).toNodejsStream(e)}};var $d=Jd;function Qd(t){this.data=t;this.length=t.length;this.index=0;this.zero=0}Qd.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0){throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")}},setIndex:function(t){this.checkIndex(t);this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e=0,i;this.checkOffset(t);for(i=this.index+t-1;i>=this.index;i--){e=(e<<8)+this.byteAt(i)}this.index+=t;return e},readString:function(t){return Go.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(t&31)<<1))}};var tp=Qd;function ep(t){tp.call(this,t);for(var e=0;e<this.data.length;e++){t[e]=t[e]&255}}Go.inherits(ep,tp);ep.prototype.byteAt=function(t){return this.data[this.zero+t]};ep.prototype.lastIndexOfSignature=function(t){var e=t.charCodeAt(0),i=t.charCodeAt(1),r=t.charCodeAt(2),n=t.charCodeAt(3);for(var s=this.length-4;s>=0;--s){if(this.data[s]===e&&this.data[s+1]===i&&this.data[s+2]===r&&this.data[s+3]===n){return s-this.zero}}return-1};ep.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),i=t.charCodeAt(1),r=t.charCodeAt(2),n=t.charCodeAt(3),s=this.readData(4);return e===s[0]&&i===s[1]&&r===s[2]&&n===s[3]};ep.prototype.readData=function(t){this.checkOffset(t);if(t===0){return[]}var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);this.index+=t;return e};var ip=ep;function rp(t){tp.call(this,t)}Go.inherits(rp,tp);rp.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)};rp.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero};rp.prototype.readAndCheckSignature=function(t){var e=this.readData(4);return t===e};rp.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);this.index+=t;return e};var np=rp;function sp(t){ip.call(this,t)}Go.inherits(sp,ip);sp.prototype.readData=function(t){this.checkOffset(t);if(t===0){return new Uint8Array(0)}var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);this.index+=t;return e};var op=sp;function ap(t){op.call(this,t)}Go.inherits(ap,op);ap.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);this.index+=t;return e};var hp=ap;var fp=function(t){var e=Go.getTypeOf(t);Go.checkSupport(e);if(e==="string"&&!po.uint8array){return new np(t)}if(e==="nodebuffer"){return new hp(t)}if(po.uint8array){return new op(Go.transformTo("uint8array",t))}return new ip(Go.transformTo("array",t))};var lp=0;var up=3;var cp=function(t){for(var e in Sd){if(!Sd.hasOwnProperty(e)){continue}if(Sd[e].magic===t){return Sd[e]}}return null};function dp(t,e){this.options=t;this.loadOptions=e}dp.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(t){var e,i;t.skip(22);this.fileNameLength=t.readInt(2);i=t.readInt(2);this.fileName=t.readData(this.fileNameLength);t.skip(i);if(this.compressedSize===-1||this.uncompressedSize===-1){throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory "+"(compressedSize === -1 || uncompressedSize === -1)")}e=cp(this.compressionMethod);if(e===null){throw new Error("Corrupted zip : compression "+Go.pretty(this.compressionMethod)+" unknown (inner file : "+Go.transformTo("string",this.fileName)+")")}this.decompressed=new Na(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2);t.skip(2);this.bitFlag=t.readInt(2);this.compressionMethod=t.readString(2);this.date=t.readDate();this.crc32=t.readInt(4);this.compressedSize=t.readInt(4);this.uncompressedSize=t.readInt(4);var e=t.readInt(2);this.extraFieldsLength=t.readInt(2);this.fileCommentLength=t.readInt(2);this.diskNumberStart=t.readInt(2);this.internalFileAttributes=t.readInt(2);this.externalFileAttributes=t.readInt(4);this.localHeaderOffset=t.readInt(4);if(this.isEncrypted()){throw new Error("Encrypted zip are not supported")}t.skip(e);this.readExtraFields(t);this.parseZIP64ExtraField(t);this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null;this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=this.externalFileAttributes&16?true:false;if(t===lp){this.dosPermissions=this.externalFileAttributes&63}if(t===up){this.unixPermissions=this.externalFileAttributes>>16&65535}if(!this.dir&&this.fileNameStr.slice(-1)==="/"){this.dir=true}},parseZIP64ExtraField:function(t){if(!this.extraFields[1]){return}var e=fp(this.extraFields[1].value);if(this.uncompressedSize===Go.MAX_VALUE_32BITS){this.uncompressedSize=e.readInt(8)}if(this.compressedSize===Go.MAX_VALUE_32BITS){this.compressedSize=e.readInt(8)}if(this.localHeaderOffset===Go.MAX_VALUE_32BITS){this.localHeaderOffset=e.readInt(8)}if(this.diskNumberStart===Go.MAX_VALUE_32BITS){this.diskNumberStart=e.readInt(4)}},readExtraFields:function(t){var e=t.index+this.extraFieldsLength,i,r,n;if(!this.extraFields){this.extraFields={}}while(t.index<e){i=t.readInt(2);r=t.readInt(2);n=t.readData(r);this.extraFields[i]={id:i,length:r,value:n}}},handleUTF8:function(){var t=po.uint8array?"uint8array":"array";if(this.useUTF8()){this.fileNameStr=Qo.utf8decode(this.fileName);this.fileCommentStr=Qo.utf8decode(this.fileComment)}else{var e=this.findExtraFieldUnicodePath();if(e!==null){this.fileNameStr=e}else{var i=Go.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var r=this.findExtraFieldUnicodeComment();if(r!==null){this.fileCommentStr=r}else{var n=Go.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(n)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=fp(t.value);if(e.readInt(1)!==1){return null}if(La(this.fileName)!==e.readInt(4)){return null}return Qo.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=fp(t.value);if(e.readInt(1)!==1){return null}if(La(this.fileComment)!==e.readInt(4)){return null}return Qo.utf8decode(e.readData(t.length-5))}return null}};var pp=dp;function vp(t){this.files=[];this.loadOptions=t}vp.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature "+"("+Go.pretty(e)+", expected "+Go.pretty(t)+")")}},isSignature:function(t,e){var i=this.reader.index;this.reader.setIndex(t);var r=this.reader.readString(4);var n=r===e;this.reader.setIndex(i);return n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength);var e=po.uint8array?"uint8array":"array";var i=Go.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.reader.skip(4);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};var t=this.zip64EndOfCentralSize-44,e=0,i,r,n;while(e<t){i=this.reader.readInt(2);r=this.reader.readInt(4);n=this.reader.readData(r);this.zip64ExtensibleData[i]={id:i,length:r,value:n}}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(this.disksCount>1){throw new Error("Multi-volumes zip are not supported")}},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++){e=this.files[t];this.reader.setIndex(e.localHeaderOffset);this.checkSignature(Id.LOCAL_FILE_HEADER);e.readLocalPart(this.reader);e.handleUTF8();e.processAttributes()}},readCentralDir:function(){var t;this.reader.setIndex(this.centralDirOffset);while(this.reader.readAndCheckSignature(Id.CENTRAL_FILE_HEADER)){t=new pp({zip64:this.zip64},this.loadOptions);t.readCentralPart(this.reader);this.files.push(t)}if(this.centralDirRecords!==this.files.length){if(this.centralDirRecords!==0&&this.files.length===0){throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)}}},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(Id.CENTRAL_DIRECTORY_END);if(t<0){var e=!this.isSignature(0,Id.LOCAL_FILE_HEADER);if(e){throw new Error("Can't find end of central directory : is this a zip file ? "+"If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html")}else{throw new Error("Corrupted zip: can't find end of central directory")}}this.reader.setIndex(t);var i=t;this.checkSignature(Id.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral();if(this.diskNumber===Go.MAX_VALUE_16BITS||this.diskWithCentralDirStart===Go.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===Go.MAX_VALUE_16BITS||this.centralDirRecords===Go.MAX_VALUE_16BITS||this.centralDirSize===Go.MAX_VALUE_32BITS||this.centralDirOffset===Go.MAX_VALUE_32BITS){this.zip64=true;t=this.reader.lastIndexOfSignature(Id.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(t<0){throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator")}this.reader.setIndex(t);this.checkSignature(Id.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();if(!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,Id.ZIP64_CENTRAL_DIRECTORY_END)){this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(Id.ZIP64_CENTRAL_DIRECTORY_END);if(this.relativeOffsetEndOfZip64CentralDir<0){throw new Error("Corrupted zip: can't find the ZIP64 end of central directory")}}this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(Id.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;if(this.zip64){r+=20;r+=12+this.zip64EndOfCentralSize}var n=i-r;if(n>0){if(this.isSignature(i,Id.CENTRAL_FILE_HEADER));else{this.reader.zero=n}}else if(n<0){throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")}},prepareReader:function(t){this.reader=fp(t)},load:function(t){this.prepareReader(t);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};var gp=vp;function mp(t){return new Ko.Promise((function(e,i){var r=t.decompressed.getContentWorker().pipe(new za);r.on("error",(function(t){i(t)})).on("end",(function(){if(r.streamInfo.crc32!==t.decompressed.crc32){i(new Error("Corrupted zip : CRC32 mismatch"))}else{e()}})).resume()}))}var yp=function(t,e){var i=this;e=Go.extend(e||{},{base64:false,checkCRC32:false,optimizedBinaryString:false,createFolders:false,decodeFileName:Qo.utf8decode});if(wo.isNode&&wo.isStream(t)){return Ko.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file."))}return Go.prepareContent("the loaded zip file",t,true,e.optimizedBinaryString,e.base64).then((function(t){var i=new gp(e);i.load(t);return i})).then((function t(i){var r=[Ko.Promise.resolve(i)];var n=i.files;if(e.checkCRC32){for(var s=0;s<n.length;s++){r.push(mp(n[s]))}}return Ko.Promise.all(r)})).then((function t(r){var n=r.shift();var s=n.files;for(var o=0;o<s.length;o++){var a=s[o];i.file(a.fileNameStr,a.decompressed,{binary:true,optimizedBinaryString:true,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:e.createFolders})}if(n.zipComment.length){i.comment=n.zipComment}return i}))};function wp(){if(!(this instanceof wp)){return new wp}if(arguments.length){throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.")}this.files={};this.comment=null;this.root="";this.clone=function(){var t=new wp;for(var e in this){if(typeof this[e]!=="function"){t[e]=this[e]}}return t}}wp.prototype=$d;wp.prototype.loadAsync=yp;wp.support=po;wp.defaults=_a;wp.version="3.2.0";wp.loadAsync=function(t,e){return(new wp).loadAsync(t,e)};wp.external=Ko;var bp=wp;var _p=function(){function t(){this.zip=new bp;this.urlCache={}}t.prototype.checkRequirements=function(){console.log("check for jszip");try{if(typeof bp==="undefined"){var t=require("jszip");this.zip=new t}else{this.zip=new bp}}catch(zp){throw new Error("JSZip lib not loaded")}};t.prototype.open=function(t,e){return this.zip.loadAsync(t,{base64:e})};t.prototype.openUrl=function(t,e){return Oi(t,"binary").then(function(t){return this.zip.loadAsync(t,{base64:e})}.bind(this))};t.prototype.request=function(t,e){var i=new kt;var r;var n=new Dt(t);if(!e){e=n.extension}if(e=="blob"){r=this.getBlob(t)}else{r=this.getText(t)}if(r){r.then(function(t){var r=this.handleResponse(t,e);i.resolve(r)}.bind(this))}else{i.reject({message:"File not found in the epub: "+t,stack:(new Error).stack})}return i.promise};t.prototype.handleResponse=function(t,e){var i;if(e=="json"){i=JSON.parse(t)}else if(ft(e)){i=vt(t,"text/xml")}else if(e=="xhtml"){i=vt(t,"application/xhtml+xml")}else if(e=="html"||e=="htm"){i=vt(t,"text/html")}else{i=t}return i};t.prototype.getBlob=function(t,e){var i=window.decodeURIComponent(t.substr(1));var r=this.zip.file(i);if(r){e=e||fe.lookup(r.name);return r.async("uint8array").then((function(t){return new Blob([t],{type:e})}))}};t.prototype.getText=function(t,e){var i=window.decodeURIComponent(t.substr(1));var r=this.zip.file(i);if(r){return r.async("string").then((function(t){return t}))}};t.prototype.getBase64=function(t,e){var i=window.decodeURIComponent(t.substr(1));var r=this.zip.file(i);if(r){e=e||fe.lookup(r.name);return r.async("base64").then((function(t){return"data:"+e+";base64,"+t}))}};t.prototype.createUrl=function(t,e){var i=new kt;var r=window.URL||window.webkitURL||window.mozURL;var n;var s;var o=e&&e.base64;if(t in this.urlCache){i.resolve(this.urlCache[t]);return i.promise}if(o){s=this.getBase64(t);if(s){s.then(function(e){this.urlCache[t]=e;i.resolve(e)}.bind(this))}}else{s=this.getBlob(t);if(s){s.then(function(e){n=r.createObjectURL(e);this.urlCache[t]=n;i.resolve(n)}.bind(this))}}if(!s){i.reject({message:"File not found in the epub: "+t,stack:(new Error).stack})}return i.promise};t.prototype.revokeUrl=function(t){var e=window.URL||window.webkitURL||window.mozURL;var i=this.urlCache[t];if(i)e.revokeObjectURL(i)};t.prototype.destroy=function(){var t=window.URL||window.webkitURL||window.mozURL;for(var e in this.urlCache){t.revokeObjectURL(e)}this.zip=undefined;this.urlCache={}};return t}();var xp=function(){function t(t,e,i){this.urlCache={};this.storage=undefined;this.name=t;this.requester=e||Oi;this.resolver=i;this.online=true;this.checkRequirements();this.addListeners()}t.prototype.checkRequirements=function(){try{var t=void 0;if(typeof localforage==="undefined"){t=require("localforage")}else{t=localforage}this.storage=t.createInstance({name:this.name})}catch(zp){throw new Error("localForage lib not loaded")}};t.prototype.addListeners=function(){this._status=this.status.bind(this);window.addEventListener("online",this._status);window.addEventListener("offline",this._status)};t.prototype.removeListeners=function(){window.removeEventListener("online",this._status);window.removeEventListener("offline",this._status);this._status=undefined};t.prototype.status=function(t){var e=navigator.onLine;this.online=e;if(e){this.emit("online",this)}else{this.emit("offline",this)}};t.prototype.add=function(t,e){var i=this;var r=t.resources.map((function(t){var r=t.href;var n=i.resolver(r);var s=window.encodeURIComponent(n);return i.storage.getItem(s).then((function(t){if(!t||e){return i.requester(n,"binary").then((function(t){return i.storage.setItem(s,t)}))}else{return t}}))}));return Promise.all(r)};t.prototype.put=function(t,e,i){var r=this;var n=window.encodeURIComponent(t);return this.storage.getItem(n).then((function(s){if(!s){return r.requester(t,"binary",e,i).then((function(t){return r.storage.setItem(n,t)}))}return s}))};t.prototype.request=function(t,e,i,r){var n=this;if(this.online){return this.requester(t,e,i,r).then((function(e){n.put(t);return e}))}else{return this.retrieve(t,e)}};t.prototype.retrieve=function(t,e){var i=this;var r=new kt;var n;var s=new Dt(t);if(!e){e=s.extension}if(e=="blob"){n=this.getBlob(t)}else{n=this.getText(t)}return n.then((function(r){var n=new kt;var s;if(r){s=i.handleResponse(r,e);n.resolve(s)}else{n.reject({message:"File not found in storage: "+t,stack:(new Error).stack})}return n.promise}))};t.prototype.handleResponse=function(t,e){var i;if(e=="json"){i=JSON.parse(t)}else if(ft(e)){i=vt(t,"text/xml")}else if(e=="xhtml"){i=vt(t,"application/xhtml+xml")}else if(e=="html"||e=="htm"){i=vt(t,"text/html")}else{i=t}return i};t.prototype.getBlob=function(t,e){var i=window.encodeURIComponent(t);return this.storage.getItem(i).then((function(i){if(!i)return;e=e||fe.lookup(t);return new Blob([i],{type:e})}))};t.prototype.getText=function(t,e){var i=window.encodeURIComponent(t);e=e||fe.lookup(t);return this.storage.getItem(i).then((function(t){var i=new kt;var r=new FileReader;var n;if(!t)return;n=new Blob([t],{type:e});r.addEventListener("loadend",(function(){i.resolve(r.result)}));r.readAsText(n,e);return i.promise}))};t.prototype.getBase64=function(t,e){var i=window.encodeURIComponent(t);e=e||fe.lookup(t);return this.storage.getItem(i).then((function(t){var i=new kt;var r=new FileReader;var n;if(!t)return;n=new Blob([t],{type:e});r.addEventListener("loadend",(function(){i.resolve(r.result)}));r.readAsDataURL(n,e);return i.promise}))};t.prototype.createUrl=function(t,e){var i=new kt;var r=window.URL||window.webkitURL||window.mozURL;var n;var s;var o=e&&e.base64;if(t in this.urlCache){i.resolve(this.urlCache[t]);return i.promise}if(o){s=this.getBase64(t);if(s){s.then(function(e){this.urlCache[t]=e;i.resolve(e)}.bind(this))}}else{s=this.getBlob(t);if(s){s.then(function(e){n=r.createObjectURL(e);this.urlCache[t]=n;i.resolve(n)}.bind(this))}}if(!s){i.reject({message:"File not found in storage: "+t,stack:(new Error).stack})}return i.promise};t.prototype.revokeUrl=function(t){var e=window.URL||window.webkitURL||window.mozURL;var i=this.urlCache[t];if(i)e.revokeObjectURL(i)};t.prototype.destroy=function(){var t=window.URL||window.webkitURL||window.mozURL;for(var e in this.urlCache){t.revokeObjectURL(e)}this.urlCache={};this.removeListeners()};return t}();M(xp.prototype);var kp=function(){function t(t){this.interactive="";this.fixedLayout="";this.openToSpread="";this.orientationLock="";if(t){this.parse(t)}}t.prototype.parse=function(t){var e=this;if(!t){return this}var i=gt(t,"display_options");if(!i){return this}var r=mt(i,"option");r.forEach((function(t){var i="";if(t.childNodes.length){i=t.childNodes[0].nodeValue}switch(t.attributes.name.value){case"interactive":e.interactive=i;break;case"fixed-layout":e.fixedLayout=i;break;case"open-to-spread":e.openToSpread=i;break;case"orientation-lock":e.orientationLock=i;break}}));return this};t.prototype.destroy=function(){this.interactive=undefined;this.fixedLayout=undefined;this.openToSpread=undefined;this.orientationLock=undefined};return t}();var Ep="META-INF/container.xml";var Sp="META-INF/com.apple.ibooks.display-options.xml";var Cp={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};var Rp=function(){function t(t,e){var i=this;if(typeof e==="undefined"&&typeof t!=="string"&&t instanceof Blob===false){e=t;t=undefined}this.settings=$(this.settings||{},{requestMethod:undefined,requestCredentials:undefined,requestHeaders:undefined,encoding:undefined,replacements:undefined,canonical:undefined,openAs:undefined,store:undefined});$(this.settings,e);this.opening=new kt;this.opened=this.opening.promise;this.isOpen=false;this.loading={manifest:new kt,spine:new kt,metadata:new kt,cover:new kt,navigation:new kt,pageList:new kt,resources:new kt,displayOptions:new kt};this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise};this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]);this.isRendered=false;this.request=this.settings.requestMethod||Oi;this.spine=new Gt;this.locations=new ee(this.spine,this.load.bind(this));this.navigation=undefined;this.pageList=undefined;this.url=undefined;this.path=undefined;this.archived=false;this.archive=undefined;this.storage=undefined;this.resources=undefined;this.rendition=undefined;this.container=undefined;this.packaging=undefined;this.displayOptions=undefined;if(this.settings.store){this.store(this.settings.store)}if(t){this.open(t,this.settings.openAs).catch((function(e){var r=new Error("Cannot load book at "+t);i.emit(te.BOOK.OPEN_FAILED,r)}))}}t.prototype.open=function(t,e){var i;var r=e||this.determineType(t);if(r===Cp.BINARY){this.archived=true;this.url=new jt("/","");i=this.openEpub(t)}else if(r===Cp.BASE64){this.archived=true;this.url=new jt("/","");i=this.openEpub(t,r)}else if(r===Cp.EPUB){this.archived=true;this.url=new jt("/","");i=this.request(t,"binary",this.settings.requestCredentials).then(this.openEpub.bind(this))}else if(r==Cp.OPF){this.url=new jt(t);i=this.openPackaging(this.url.Path.toString())}else if(r==Cp.MANIFEST){this.url=new jt(t);i=this.openManifest(this.url.Path.toString())}else{this.url=new jt(t);i=this.openContainer(Ep).then(this.openPackaging.bind(this))}return i};t.prototype.openEpub=function(t,e){var i=this;return this.unarchive(t,e||this.settings.encoding).then((function(){return i.openContainer(Ep)})).then((function(t){return i.openPackaging(t)}))};t.prototype.openContainer=function(t){var e=this;return this.load(t).then((function(t){e.container=new ie(t);return e.resolve(e.container.packagePath)}))};t.prototype.openPackaging=function(t){var e=this;this.path=new Dt(t);return this.load(t).then((function(t){e.packaging=new re(t);return e.unpack(e.packaging)}))};t.prototype.openManifest=function(t){var e=this;this.path=new Dt(t);return this.load(t).then((function(t){e.packaging=new re;e.packaging.load(t);return e.unpack(e.packaging)}))};t.prototype.load=function(t){var e=this.resolve(t);if(this.archived){return this.archive.request(e)}else{return this.request(e,null,this.settings.requestCredentials,this.settings.requestHeaders)}};t.prototype.resolve=function(t,e){if(!t){return}var i=t;var r=t.indexOf("://")>-1;if(r){return t}if(this.path){i=this.path.resolve(t)}if(e!=false&&this.url){i=this.url.resolve(i)}return i};t.prototype.canonical=function(t){var e=t;if(!t){return""}if(this.settings.canonical){e=this.settings.canonical(t)}else{e=this.resolve(t,true)}return e};t.prototype.determineType=function(t){var e;var i;var r;if(this.settings.encoding==="base64"){return Cp.BASE64}if(typeof t!="string"){return Cp.BINARY}e=new jt(t);i=e.path();r=i.extension;if(!r){return Cp.DIRECTORY}if(r==="epub"){return Cp.EPUB}if(r==="opf"){return Cp.OPF}if(r==="json"){return Cp.MANIFEST}};t.prototype.unpack=function(t){var e=this;this.package=t;if(this.packaging.metadata.layout===""){this.load(this.url.resolve(Sp)).then((function(t){e.displayOptions=new kp(t);e.loading.displayOptions.resolve(e.displayOptions)})).catch((function(t){e.displayOptions=new kp;e.loading.displayOptions.resolve(e.displayOptions)}))}else{this.displayOptions=new kp;this.loading.displayOptions.resolve(this.displayOptions)}this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this));this.resources=new le(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")});this.loadNavigation(this.packaging).then((function(){e.loading.navigation.resolve(e.navigation)}));if(this.packaging.coverPath){this.cover=this.resolve(this.packaging.coverPath)}this.loading.manifest.resolve(this.packaging.manifest);this.loading.metadata.resolve(this.packaging.metadata);this.loading.spine.resolve(this.spine);this.loading.cover.resolve(this.cover);this.loading.resources.resolve(this.resources);this.loading.pageList.resolve(this.pageList);this.isOpen=true;if(this.archived||this.settings.replacements&&this.settings.replacements!="none"){this.replacements().then((function(){e.loaded.displayOptions.then((function(){e.opening.resolve(e)}))})).catch((function(t){console.error(t)}))}else{this.loaded.displayOptions.then((function(){e.opening.resolve(e)}))}};t.prototype.loadNavigation=function(t){var e=this;var i=t.navPath||t.ncxPath;var r=t.toc;if(r){return new Promise((function(i,n){e.navigation=new ne(r);if(t.pageList){e.pageList=new ue(t.pageList)}i(e.navigation)}))}if(!i){return new Promise((function(t,i){e.navigation=new ne;e.pageList=new ue;t(e.navigation)}))}return this.load(i,"xml").then((function(t){e.navigation=new ne(t);e.pageList=new ue(t);return e.navigation}))};t.prototype.section=function(t){return this.spine.get(t)};t.prototype.renderTo=function(t,e){this.rendition=new Ai(this,e);this.rendition.attachTo(t);return this.rendition};t.prototype.setRequestCredentials=function(t){this.settings.requestCredentials=t};t.prototype.setRequestHeaders=function(t){this.settings.requestHeaders=t};t.prototype.unarchive=function(t,e){this.archive=new _p;return this.archive.open(t,e)};t.prototype.store=function(t){var e=this;var i=this.settings.replacements&&this.settings.replacements!=="none";var r=this.url;var n=this.settings.requestMethod||Oi.bind(this);this.storage=new xp(t,n,this.resolve.bind(this));this.request=this.storage.request.bind(this.storage);this.opened.then((function(){if(e.archived){e.storage.requester=e.archive.request.bind(e.archive)}var t=function(t,i){i.output=e.resources.substitute(t,i.url)};e.resources.settings.replacements=i||"blobUrl";e.resources.replacements().then((function(){return e.resources.replaceCss()}));e.storage.on("offline",(function(){e.url=new jt("/","");e.spine.hooks.serialize.register(t)}));e.storage.on("online",(function(){e.url=r;e.spine.hooks.serialize.deregister(t)}))}));return this.storage};t.prototype.coverUrl=function(){var t=this;var e=this.loaded.cover.then((function(e){if(t.archived){return t.resources.get(t.cover)}else{return t.cover}}));return e};t.prototype.replacements=function(){var t=this;this.spine.hooks.serialize.register((function(e,i){i.output=t.resources.substitute(e,i.url)}));return this.resources.replacements().then((function(){return t.resources.replaceCss()}))};t.prototype.getRange=function(t){var e=new qt(t);var i=this.spine.get(e.spinePos);var r=this.load.bind(this);if(!i){return new Promise((function(t,e){e("CFI could not be found")}))}return i.load(r).then((function(t){var r=e.toRange(i.document);return r}))};t.prototype.key=function(t){var e=t||this.packaging.metadata.identifier||this.url.filename;return"epubjs:"+$t+":"+e};t.prototype.destroy=function(){this.opened=undefined;this.loading=undefined;this.loaded=undefined;this.ready=undefined;this.isOpen=false;this.isRendered=false;this.spine&&this.spine.destroy();this.locations&&this.locations.destroy();this.pageList&&this.pageList.destroy();this.archive&&this.archive.destroy();this.resources&&this.resources.destroy();this.container&&this.container.destroy();this.packaging&&this.packaging.destroy();this.rendition&&this.rendition.destroy();this.displayOptions&&this.displayOptions.destroy();this.spine=undefined;this.locations=undefined;this.pageList=undefined;this.archive=undefined;this.resources=undefined;this.container=undefined;this.packaging=undefined;this.rendition=undefined;this.navigation=undefined;this.url=undefined;this.path=undefined;this.archived=false};return t}();M(Rp.prototype);(function(t){var e=function(){try{return!!Symbol.iterator}catch(t){return false}};var i=e();var r=function(t){var e={next:function(){var e=t.shift();return{done:e===void 0,value:e}}};if(i){e[Symbol.iterator]=function(){return e}}return e};var n=function(t){return encodeURIComponent(t).replace(/%20/g,"+")};var s=function(t){return decodeURIComponent(String(t).replace(/\+/g," "))};var o=function(){var e=function(t){Object.defineProperty(this,"_entries",{writable:true,value:{}});var i=typeof t;if(i==="undefined");else if(i==="string"){if(t!==""){this._fromString(t)}}else if(t instanceof e){var r=this;t.forEach((function(t,e){r.append(e,t)}))}else if(t!==null&&i==="object"){if(Object.prototype.toString.call(t)==="[object Array]"){for(var n=0;n<t.length;n++){var s=t[n];if(Object.prototype.toString.call(s)==="[object Array]"||s.length!==2){this.append(s[0],s[1])}else{throw new TypeError("Expected [string, any] as entry at index "+n+" of URLSearchParams's input")}}}else{for(var o in t){if(t.hasOwnProperty(o)){this.append(o,t[o])}}}}else{throw new TypeError("Unsupported input's type for URLSearchParams")}};var s=e.prototype;s.append=function(t,e){if(t in this._entries){this._entries[t].push(String(e))}else{this._entries[t]=[String(e)]}};s.delete=function(t){delete this._entries[t]};s.get=function(t){return t in this._entries?this._entries[t][0]:null};s.getAll=function(t){return t in this._entries?this._entries[t].slice(0):[]};s.has=function(t){return t in this._entries};s.set=function(t,e){this._entries[t]=[String(e)]};s.forEach=function(t,e){var i;for(var r in this._entries){if(this._entries.hasOwnProperty(r)){i=this._entries[r];for(var n=0;n<i.length;n++){t.call(e,i[n],r,this)}}}};s.keys=function(){var t=[];this.forEach((function(e,i){t.push(i)}));return r(t)};s.values=function(){var t=[];this.forEach((function(e){t.push(e)}));return r(t)};s.entries=function(){var t=[];this.forEach((function(e,i){t.push([i,e])}));return r(t)};if(i){s[Symbol.iterator]=s.entries}s.toString=function(){var t=[];this.forEach((function(e,i){t.push(n(i)+"="+n(e))}));return t.join("&")};t.URLSearchParams=e};var a=function(){try{var e=t.URLSearchParams;return new e("?a=1").toString()==="a=1"&&typeof e.prototype.set==="function"}catch(zp){return false}};if(!a()){o()}var h=t.URLSearchParams.prototype;if(typeof h.sort!=="function"){h.sort=function(){var t=this;var e=[];this.forEach((function(i,r){e.push([r,i]);if(!t._entries){t.delete(r)}}));e.sort((function(t,e){if(t[0]<e[0]){return-1}else if(t[0]>e[0]){return+1}else{return 0}}));if(t._entries){t._entries={}}for(var i=0;i<e.length;i++){this.append(e[i][0],e[i][1])}}}if(typeof h._fromString!=="function"){Object.defineProperty(h,"_fromString",{enumerable:false,configurable:false,writable:false,value:function(t){if(this._entries){this._entries={}}else{var e=[];this.forEach((function(t,i){e.push(i)}));for(var i=0;i<e.length;i++){this.delete(e[i])}}t=t.replace(/^\?/,"");var r=t.split("&");var n;for(var i=0;i<r.length;i++){n=r[i].split("=");this.append(s(n[0]),n.length>1?s(n[1]):"")}}})}})(typeof s!=="undefined"?s:typeof window!=="undefined"?window:typeof self!=="undefined"?self:s);(function(t){var e=function(){try{var e=new t.URL("b","http://a");e.pathname="c%20d";return e.href==="http://a/c%20d"&&e.searchParams}catch(zp){return false}};var i=function(){var e=t.URL;var i=function(e,i){if(typeof e!=="string")e=String(e);var r=document,n;if(i&&(t.location===void 0||i!==t.location.href)){r=document.implementation.createHTMLDocument("");n=r.createElement("base");n.href=i;r.head.appendChild(n);try{if(n.href.indexOf(i)!==0)throw new Error(n.href)}catch(nl){throw new Error("URL unable to set base "+i+" due to "+nl)}}var s=r.createElement("a");s.href=e;if(n){r.body.appendChild(s);s.href=s.href}if(s.protocol===":"||!/:/.test(s.href)){throw new TypeError("Invalid URL")}Object.defineProperty(this,"_anchorElement",{value:s});var o=new t.URLSearchParams(this.search);var a=true;var h=true;var f=this;["append","delete","set"].forEach((function(t){var e=o[t];o[t]=function(){e.apply(o,arguments);if(a){h=false;f.search=o.toString();h=true}}}));Object.defineProperty(this,"searchParams",{value:o,enumerable:true});var l=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:false,configurable:false,writable:false,value:function(){if(this.search!==l){l=this.search;if(h){a=false;this.searchParams._fromString(this.search);a=true}}}})};var r=i.prototype;var n=function(t){Object.defineProperty(r,t,{get:function(){return this._anchorElement[t]},set:function(e){this._anchorElement[t]=e},enumerable:true})};["hash","host","hostname","port","protocol"].forEach((function(t){n(t)}));Object.defineProperty(r,"search",{get:function(){return this._anchorElement["search"]},set:function(t){this._anchorElement["search"]=t;this._updateSearchParams()},enumerable:true});Object.defineProperties(r,{toString:{get:function(){var t=this;return function(){return t.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(t){this._anchorElement.href=t;this._updateSearchParams()},enumerable:true},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(t){this._anchorElement.pathname=t},enumerable:true},origin:{get:function(){var t={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol];var e=this._anchorElement.port!=t&&this._anchorElement.port!=="";return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(e?":"+this._anchorElement.port:"")},enumerable:true},password:{get:function(){return""},set:function(t){},enumerable:true},username:{get:function(){return""},set:function(t){},enumerable:true}});i.createObjectURL=function(t){return e.createObjectURL.apply(e,arguments)};i.revokeObjectURL=function(t){return e.revokeObjectURL.apply(e,arguments)};t.URL=i};if(!e()){i()}if(t.location!==void 0&&!("origin"in t.location)){var r=function(){return t.location.protocol+"//"+t.location.hostname+(t.location.port?":"+t.location.port:"")};try{Object.defineProperty(t.location,"origin",{get:r,enumerable:true})}catch(zp){setInterval((function(){t.location.origin=r()}),100)}}})(typeof s!=="undefined"?s:typeof window!=="undefined"?window:typeof self!=="undefined"?self:s);function Tp(t,e){return new Rp(t,e)}Tp.VERSION=$t;if(typeof Li!=="undefined"){Li.EPUBJS_VERSION=$t}Tp.Book=Rp;Tp.Rendition=Ai;Tp.Contents=we;Tp.CFI=qt;Tp.utils=Ot;var Ap;(function(t){t["LTR"]="ltr";t["RTL"]="rtl"})(Ap||(Ap={}));var Op=a((function(t){
/*!
                  Copyright (c) 2017 Jed Watson.
                  Licensed under the MIT License (MIT), see
                  http://jedwatson.github.io/classnames
                */
(function(){var e={}.hasOwnProperty;function i(){var t=[];for(var r=0;r<arguments.length;r++){var n=arguments[r];if(!n)continue;var s=typeof n;if(s==="string"||s==="number"){t.push(n)}else if(Array.isArray(n)&&n.length){var o=i.apply(null,n);if(o){t.push(o)}}else if(s==="object"){for(var a in n){if(e.call(n,a)&&n[a]){t.push(a)}}}}return t.join(" ")}if(t.exports){i.default=i;t.exports=i}else{window.classNames=i}})()}));var Lp=t("uv_ebook_reader",function(){function t(t){e(this,t);this._book=null;this._rendition=null;this._bookReady=false;this._prevEnabled=true;this._nextEnabled=true;this._showDivider=false;this.width="100%";this.height="100%";this.minSpreadWidth=700;this.bookReady=i(this,"bookReady",7);this.loadedBookMetadata=i(this,"loadedBookMetadata",7);this.loadedNavigation=i(this,"loadedNavigation",7);this.relocated=i(this,"relocated",7);this.renditionAttached=i(this,"renditionAttached",7)}t.prototype.load=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){if(this._book){this._book.destroy();this._book=null;this._rendition=null;this._bookReady=false}this._bookPath=t;return[2]}))}))};t.prototype.resize=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){if(this._bookReady){this._rendition.resize(this._viewer.clientWidth,this._viewer.clientHeight)}return[2]}))}))};t.prototype.display=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){this._rendition.display(t);return[2]}))}))};t.prototype._prev=function(){if(!this._bookReady){return}if(this._book.package.metadata.direction===Ap.RTL){this._rendition.next()}else{this._rendition.prev()}};t.prototype._next=function(){if(!this._bookReady){return}if(this._book.package.metadata.direction===Ap.RTL){this._rendition.prev()}else{this._rendition.next()}};t.prototype._prevButtonClickedHandler=function(t){this._prev();t.preventDefault()};t.prototype._nextButtonClickedHandler=function(t){this._next();t.preventDefault()};t.prototype.render=function(){var t=this;var e=Op({show:this._bookReady&&this._showDivider});var i=Op({arrow:true,disabled:!this._prevEnabled&&!this._bookReady});var n=Op({twoup:this._showDivider});var s=Op({arrow:true,disabled:!this._nextEnabled&&!this._bookReady});return r("div",{id:"main"},r("div",{id:"titlebar"}),r("div",{id:"divider",class:e}),r("div",{id:"prev",class:i,onClick:function(e){return t._prevButtonClickedHandler(e)}},"<"),r("div",{id:"viewer",class:n,ref:function(e){return t._viewer=e}}),this._nextEnabled?r("div",{id:"next",class:s,onClick:function(e){return t._nextButtonClickedHandler(e)}},">"):null,!this._bookReady&&r("div",{id:"spinner"},r("div",{class:"square"})))};t.prototype._renderBook=function(){var t=this;if(this._bookPath&&!this._rendition){this._book=Tp(this._bookPath);this._rendition=this._book.renderTo(this._viewer,{flow:"auto",width:this.width,height:this.height,minSpreadWidth:this.minSpreadWidth});this._rendition.themes.register("custom",{"*":{"font-family":"'Stix', serif !important","font-variant-numeric":"oldstyle-nums !important"}});this._rendition.themes.select("custom");this._rendition.display();this._rendition.on("attached",(function(){t.renditionAttached.emit()}));this._rendition.on("layout",(function(){if(t._viewer.clientWidth>=t.minSpreadWidth){t._showDivider=true}else{t._showDivider=false}}));this._rendition.on("relocated",(function(e){t._prevEnabled=!e.atStart;t._nextEnabled=!e.atEnd;t.relocated.emit(e)}));this._book.ready.then((function(){t._bookReady=true;t.bookReady.emit()}));this._book.loaded.metadata.then((function(e){t.loadedBookMetadata.emit(e)}));this._book.loaded.navigation.then((function(e){t.loadedNavigation.emit(e)}))}};t.prototype.componentDidUpdate=function(){this._renderBook()};Object.defineProperty(t,"assetsDirs",{get:function(){return["assets"]},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"el",{get:function(){return n(this)},enumerable:true,configurable:true});Object.defineProperty(t,"style",{get:function(){return"#main{position:absolute;width:100%;height:100%;right:0;overflow:hidden}#titlebar{height:10%}#viewer{width:75%;height:80%;margin:0 auto;max-width:1250px;z-index:2;position:relative;overflow:hidden}#viewer iframe{border:none}#prev{left:20px}#next{right:20px}.arrow{position:absolute;top:50%;margin-top:-50px;font-size:64px;color:var(--reader-arrow-color);font-family:monospace,sans-serif;font-weight:700;cursor:pointer;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.arrow:hover{color:var(--reader-arrow-hover-color)}.arrow.active,.arrow:active{color:#000}#divider{position:absolute;width:1px;border-right:1px solid #000;height:80%;z-index:1;left:50%;margin-left:-1px;top:10%;opacity:.15;-webkit-box-shadow:-2px 0 15px #000;box-shadow:-2px 0 15px #000;display:none}#divider.show{display:block}#spinner{position:absolute;z-index:10;left:50%;top:calc(50% - 15px)}#spinner .square{background-color:var(--reader-spinner-color,#fff);margin:0 0 0 -15px;width:30px;height:30px;-webkit-animation:sk-rotateplane 1.2s ease-in-out infinite;-moz-animation:sk-rotateplane 1.2s infinite ease-in-out;animation:sk-rotateplane 1.2s ease-in-out infinite}\@-webkit-keyframes sk-rotateplane{0%{-webkit-transform:perspective(120px)}50%{-webkit-transform:perspective(120px) rotateY(180deg)}to{-webkit-transform:perspective(120px) rotateY(180deg) rotateX(180deg)}}\@keyframes sk-rotateplane{0%{transform:perspective(120px) rotateX(0deg) rotateY(0deg);-webkit-transform:perspective(120px) rotateX(0deg) rotateY(0deg)}50%{transform:perspective(120px) rotateX(-180.1deg) rotateY(0deg);-webkit-transform:perspective(120px) rotateX(-180.1deg) rotateY(0deg)}to{transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg);-webkit-transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg)}}.highlight{background-color:#ff0}.md-show,.md-show~.overlay{visibility:visible}.md-show~.overlay{opacity:1}.md-content{color:#fff;background:#6b6b6b;position:relative;border-radius:3px;margin:0 auto;height:320px}.md-content h3{margin:0;padding:6px;text-align:center;font-size:22px;font-weight:300;opacity:.8;background:rgba(0,0,0,.1);border-radius:3px 3px 0 0}.md-content>div{padding:15px 40px 30px;margin:0;font-weight:300;font-size:14px}.md-content>div p{margin:0;padding:10px 0}.md-content>div ul{margin:0;padding:0 0 30px 20px}.md-content>div ul li{padding:5px 0}.md-content button{display:block;margin:0 auto;font-size:.8em}.md-effect-1 .md-content{-webkit-transform:scale(.7);-moz-transform:scale(.7);-ms-transform:scale(.7);transform:scale(.7);opacity:0;-webkit-transition:all .3s;-moz-transition:all .3s;-ms-transition:all .3s;transition:all .3s}.md-show.md-effect-1 .md-content{-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1);opacity:1}.md-content>.closer{font-size:18px;position:absolute;right:0;top:0;font-size:24px;padding:4px}"},enumerable:true,configurable:true});return t}());var Ip=t("uv_ebook_toc",function(){function t(t){e(this,t);this.toc=[];this.selected=null;this.disabled=false;this.itemClicked=i(this,"itemClicked",7)}t.prototype._itemClickedHandler=function(t){var e=t.currentTarget;var i=e.getAttribute("href");this.selected=e.parentElement.id;this.itemClicked.emit(i);t.preventDefault()};t.prototype.render=function(){var t=this;var e=Op({disabled:this.disabled});return r("div",{id:"toc",class:e},r("ul",null,this.toc.map((function(e){return r("li",{id:e.id,class:Op({selected:t.selected===e.href})},r("a",{href:e.href,onClick:function(e){return t._itemClickedHandler(e)}},e.label))}))))};Object.defineProperty(t,"assetsDirs",{get:function(){return["assets"]},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"el",{get:function(){return n(this)},enumerable:true,configurable:true});Object.defineProperty(t,"style",{get:function(){return"#toc ul{margin:var(--toc-margin);padding:var(--toc-padding);list-style-type:var(--toc-list-style-type)}#toc ul li{padding:var(--toc-link-padding)}#toc ul li a{color:var(--toc-link-color)}#toc ul li.selected a{color:var(--toc-link-selected-color)}"},enumerable:true,configurable:true});return t}())}}}));