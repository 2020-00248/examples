import{r as t,c as i,h as r,g as e}from"./p-3c948b1f.js";var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function h(t,i){return t(i={exports:{}},i.exports),i.exports}var o=function(t){return null!=t},a={object:!0,function:!0,undefined:!0},u=/^\s*class[\s{/}]/,f=Function.prototype.toString,c=function(t){return!!function(t){if("function"!=typeof t)return!1;if(!hasOwnProperty.call(t,"length"))return!1;try{if("number"!=typeof t.length)return!1;if("function"!=typeof t.call)return!1;if("function"!=typeof t.apply)return!1}catch(i){return!1}return!function(t){if(!function(t){return!!o(t)&&hasOwnProperty.call(a,typeof t)}(t))return!1;try{return!!t.constructor&&t.constructor.prototype===t}catch(i){return!1}}(t)}(t)&&!u.test(f.call(t))},l=function(t){return null!=t},d=Object.keys,v=function(){try{return!0}catch(t){return!1}}()?Object.keys:function(t){return d(l(t)?Object(t):t)},p=function(t){if(!l(t))throw new TypeError("Cannot use null or undefined");return t},w=Math.max,m=function(){var t,i=Object.assign;return"function"==typeof i&&(i(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}()?Object.assign:function(t,i){var r,e,s,n=w(arguments.length,2);for(t=Object(p(t)),s=function(e){try{t[e]=i[e]}catch(s){r||(r=s)}},e=1;e<n;++e)v(i=arguments[e]).forEach(s);if(void 0!==r)throw r;return t},b=Array.prototype.forEach,g=Object.create,y=function(t,i){var r;for(r in t)i[r]=t[r]},x=function(){var t=g(null);return b.call(arguments,(function(i){l(i)&&y(Object(i),t)})),t},k="razdwatrzy",E=String.prototype.indexOf,A="function"==typeof k.contains&&!0===k.contains("dwa")&&!1===k.contains("foo")?String.prototype.contains:function(t){return E.call(this,t,arguments[1])>-1},T=h((function(t){(t.exports=function(t,i){var r,e,s,n,h;return arguments.length<2||"string"!=typeof t?(n=i,i=t,t=null):n=arguments[2],o(t)?(r=A.call(t,"c"),e=A.call(t,"e"),s=A.call(t,"w")):(r=s=!0,e=!1),h={value:i,configurable:r,enumerable:e,writable:s},n?m(x(n),h):h}).gs=function(t,i,r){var e,s,n,h;return"string"!=typeof t?(n=r,r=i,i=t,t=null):n=arguments[3],o(i)?c(i)?o(r)?c(r)||(n=r,r=void 0):r=void 0:(n=i,i=r=void 0):i=void 0,o(t)?(e=A.call(t,"c"),s=A.call(t,"e")):(e=!0,s=!1),h={get:i,set:r,configurable:e,enumerable:s},n?m(x(n),h):h}})),S=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t},j=h((function(t,i){var r,e,s,n,h,o,a,u=Function.prototype.apply,f=Function.prototype.call,c=Object.create,l=Object.defineProperty,d=Object.defineProperties,v=Object.prototype.hasOwnProperty,p={configurable:!0,enumerable:!1,writable:!0};e=function(t,i){var e,n;return S(i),n=this,r.call(this,t,e=function(){s.call(n,t,e),u.call(i,this,arguments)}),e.__eeOnceListener__=i,this},h={on:r=function(t,i){var r;return S(i),v.call(this,"__ee__")?r=this.__ee__:(r=p.value=c(null),l(this,"__ee__",p),p.value=null),r[t]?"object"==typeof r[t]?r[t].push(i):r[t]=[r[t],i]:r[t]=i,this},once:e,off:s=function(t,i){var r,e,s,n;if(S(i),!v.call(this,"__ee__"))return this;if(!(r=this.__ee__)[t])return this;if("object"==typeof(e=r[t]))for(n=0;s=e[n];++n)s!==i&&s.__eeOnceListener__!==i||(2===e.length?r[t]=e[n?0:1]:e.splice(n,1));else e!==i&&e.__eeOnceListener__!==i||delete r[t];return this},emit:n=function(t){var i,r,e,s,n;if(v.call(this,"__ee__")&&(s=this.__ee__[t]))if("object"==typeof s){for(r=arguments.length,n=new Array(r-1),i=1;i<r;++i)n[i-1]=arguments[i];for(s=s.slice(),i=0;e=s[i];++i)u.call(e,this,n)}else switch(arguments.length){case 1:f.call(s,this);break;case 2:f.call(s,this,arguments[1]);break;case 3:f.call(s,this,arguments[1],arguments[2]);break;default:for(r=arguments.length,n=new Array(r-1),i=1;i<r;++i)n[i-1]=arguments[i];u.call(s,this,n)}}},o={on:T(r),once:T(e),off:T(s),emit:T(n)},a=d({},o),t.exports=i=function(t){return null==t?c(a):d(Object(t),o)},i.methods=h}));const O="undefined"!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),R=1,C="undefined"!=typeof URL?URL:"undefined"!=typeof window?window.URL||window.webkitURL||window.mozURL:void 0;function N(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(i){var r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==i?r:7&r|8).toString(16)}))}function z(t){return!(!t||1!=t.nodeType)}function M(t){return!isNaN(parseFloat(t))&&isFinite(t)}function I(t){let i=parseFloat(t);return!1!==M(t)&&("string"==typeof t&&t.indexOf(".")>-1||Math.floor(i)!==i)}function L(t){var i=["-webkit-","-webkit-","-moz-","-o-","-ms-"],r=t.toLowerCase(),e=["Webkit","webkit","Moz","O","ms"].length;if("undefined"==typeof document||void 0!==document.body.style[r])return t;for(var s=0;s<e;s++)if(void 0!==document.body.style[i[s]+r])return i[s]+r;return t}function F(t){for(var i=1,r=arguments.length;i<r;i++){var e=arguments[i];for(var s in e)void 0===t[s]&&(t[s]=e[s])}return t}function _(t){return[].slice.call(arguments,1).forEach((function(i){i&&Object.getOwnPropertyNames(i).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))}))})),t}function P(t,i,r,e,s){var n,h=e||0,o=s||i.length,a=parseInt(h+(o-h)/2);return r||(r=function(t,i){return t>i?1:t<i?-1:t==i?0:void 0}),o-h<=0?a:(n=r(i[a],t),o-h==1?n>=0?a:a+1:0===n?a:-1===n?P(t,i,r,a,o):P(t,i,r,h,a))}function U(t,i,r,e,s){var n,h=e||0,o=s||i.length,a=parseInt(h+(o-h)/2);return r||(r=function(t,i){return t>i?1:t<i?-1:t==i?0:void 0}),o-h<=0?-1:(n=r(i[a],t),o-h==1?0===n?a:-1:0===n?a:-1===n?U(t,i,r,a,o):U(t,i,r,h,a))}function B(t){var i=window.getComputedStyle(t),r=0,e=0;return["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach((function(t){r+=parseFloat(i[t])||0})),["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach((function(t){e+=parseFloat(i[t])||0})),{height:e,width:r}}function D(t){var i=window.getComputedStyle(t),r=0,e=0;return["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach((function(t){r+=parseFloat(i[t])||0})),["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach((function(t){e+=parseFloat(i[t])||0})),{height:e,width:r}}function Z(t){let i;if(t.nodeType==Node.TEXT_NODE){let r=t.ownerDocument.createRange();r.selectNodeContents(t),i=r.getBoundingClientRect()}else i=t.getBoundingClientRect();return i}function q(){var t=window.innerWidth,i=window.innerHeight;return{top:0,left:0,right:t,bottom:i,width:t,height:i}}function W(t,i){for(var r,e=t.parentNode.childNodes,s=-1,n=0;n<e.length&&((r=e[n]).nodeType===i&&s++,r!=t);n++);return s}function H(t){return W(t,R)}function K(t){return["xml","opf","ncx"].indexOf(t)>-1}function $(t,i){return new Blob([t],{type:i})}function X(t,i){var r=$(t,i);return C.createObjectURL(r)}function J(t){return C.revokeObjectURL(t)}function Y(t,i){if("string"==typeof t)return"data:"+i+";base64,"+btoa(encodeURIComponent(t))}function G(t){return Object.prototype.toString.call(t).slice(8,-1)}function V(t,i,r){var e;return e="undefined"==typeof DOMParser||r?require("xmldom").DOMParser:DOMParser,65279===t.charCodeAt(0)&&(t=t.slice(1)),(new e).parseFromString(t,i)}function Q(t,i){var r;if(!t)throw new Error("No Element Provided");return void 0!==t.querySelector?t.querySelector(i):(r=t.getElementsByTagName(i)).length?r[0]:void 0}function tt(t,i){return void 0!==t.querySelector?t.querySelectorAll(i):t.getElementsByTagName(i)}function it(t,i,r){var e,s;if(void 0!==t.querySelector){for(var n in i+="[",r)i+=n+"~='"+r[n]+"'";return t.querySelector(i+="]")}if(e=t.getElementsByTagName(i),s=Array.prototype.slice.call(e,0).filter((function(t){for(var i in r)if(t.getAttribute(i)===r[i])return!0;return!1})))return s[0]}function rt(t,i){void 0!==(t.ownerDocument||t).createTreeWalker?et(t,i,NodeFilter.SHOW_TEXT):st(t,(function(t){t&&3===t.nodeType&&i(t)}))}function et(t,i,r){var e=document.createTreeWalker(t,r,null,!1);let s;for(;s=e.nextNode();)i(s)}function st(t,i){if(i(t))return!0;if(t=t.firstChild)do{if(st(t,i))return!0;t=t.nextSibling}while(t)}function nt(t){return new Promise((function(i){var r=new FileReader;r.readAsDataURL(t),r.onloadend=function(){i(r.result)}}))}function ht(){this.resolve=null,this.reject=null,this.id=N(),this.promise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),Object.freeze(this)}function ot(t,i,r){var e;if(void 0!==t.querySelector&&(e=t.querySelector(`${i}[*|type="${r}"]`)),e&&0!==e.length)return e;e=tt(t,i);for(var s=0;s<e.length;s++)if(e[s].getAttributeNS("http://www.idpf.org/2007/ops","type")===r||e[s].getAttribute("epub:type")===r)return e[s]}function at(t){for(var i=[],r=t.childNodes,e=0;e<r.length;e++){let t=r[e];1===t.nodeType&&i.push(t)}return i}function ut(t){for(var i=[t];t;t=t.parentNode)i.unshift(t);return i}function ft(t,i,r){for(var e=[],s=t.childNodes,n=0;n<s.length;n++){let t=s[n];if(1===t.nodeType&&t.nodeName.toLowerCase()===i){if(r)return t;e.push(t)}}if(!r)return e}function ct(t,i){let r;if(null!==t&&""!==i)for(r=t.parentNode;1===r.nodeType;){if(r.tagName.toLowerCase()===i)return r;r=r.parentNode}}class lt{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(t,i){this.startContainer=t,this.startOffset=i,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(t,i){this.endContainer=t,this.endOffset=i,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(t){this.collapsed=!0,t?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(t){let i=t.parentNode,r=Array.prototype.indexOf.call(i.childNodes,t);this.setStart(i,r),this.setEnd(i,r+1)}selectNodeContents(t){let i=3===t.nodeType?t.textContent.length:parent.childNodes.length;this.setStart(t,0),this.setEnd(t,i)}_commonAncestorContainer(t,i){var r=ut(t||this.startContainer),e=ut(i||this.endContainer);if(r[0]==e[0])for(var s=0;s<r.length;s++)if(r[s]!=e[s])return r[s-1]}_checkCollapsed(){this.collapsed=this.startContainer===this.endContainer&&this.startOffset===this.endOffset}toString(){}}const dt=Object.freeze({__proto__:null,requestAnimationFrame:O,uuid:N,documentHeight:function(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)},isElement:z,isNumber:M,isFloat:I,prefixed:L,defaults:F,extend:_,insert:function(t,i,r){var e=P(t,i,r);return i.splice(e,0,t),e},locationOf:P,indexOfSorted:U,bounds:B,borders:D,nodeBounds:Z,windowBounds:q,indexOfNode:W,indexOfTextNode:function(t){return W(t,3)},indexOfElementNode:H,isXml:K,createBlob:$,createBlobUrl:X,revokeBlobUrl:J,createBase64Url:Y,type:G,parse:V,qs:Q,qsa:tt,qsp:it,sprint:rt,treeWalker:et,walk:st,blob2base64:nt,defer:ht,querySelectorByType:ot,findChildren:at,parents:ut,filterChildren:ft,getParentByTagName:ct,RangeObject:lt});if(!vt)var vt={cwd:function(){return"/"}};function pt(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received "+t)}function wt(t,i){for(var r,e="",s=-1,n=0,h=0;h<=t.length;++h){if(h<t.length)r=t.charCodeAt(h);else{if(47===r)break;r=47}if(47===r){if(s===h-1||1===n);else if(s!==h-1&&2===n){if(e.length<2||46!==e.charCodeAt(e.length-1)||46!==e.charCodeAt(e.length-2))if(e.length>2){for(var o=e.length-1,a=o;a>=0&&47!==e.charCodeAt(a);--a);if(a!==o){e=-1===a?"":e.slice(0,a),s=h,n=0;continue}}else if(2===e.length||1===e.length){e="",s=h,n=0;continue}i&&(e.length>0?e+="/..":e="..")}else e.length>0?e+="/"+t.slice(s+1,h):e=t.slice(s+1,h);s=h,n=0}else 46===r&&-1!==n?++n:n=-1}return e}var mt={resolve:function(){for(var t,i="",r=!1,e=arguments.length-1;e>=-1&&!r;e--){var s;e>=0?s=arguments[e]:(void 0===t&&(t=vt.cwd()),s=t),pt(s),0!==s.length&&(i=s+"/"+i,r=47===s.charCodeAt(0))}return i=wt(i,!r),r?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(t){if(pt(t),0===t.length)return".";var i=47===t.charCodeAt(0),r=47===t.charCodeAt(t.length-1);return 0!==(t=wt(t,!i)).length||i||(t="."),t.length>0&&r&&(t+="/"),i?"/"+t:t},isAbsolute:function(t){return pt(t),t.length>0&&47===t.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var t,i=0;i<arguments.length;++i){var r=arguments[i];pt(r),r.length>0&&(void 0===t?t=r:t+="/"+r)}return void 0===t?".":mt.normalize(t)},relative:function(t,i){if(pt(t),pt(i),t===i)return"";if((t=mt.resolve(t))===(i=mt.resolve(i)))return"";for(var r=1;r<t.length&&47===t.charCodeAt(r);++r);for(var e=t.length,s=e-r,n=1;n<i.length&&47===i.charCodeAt(n);++n);for(var h=i.length-n,o=s<h?s:h,a=-1,u=0;u<=o;++u){if(u===o){if(h>o){if(47===i.charCodeAt(n+u))return i.slice(n+u+1);if(0===u)return i.slice(n+u)}else s>o&&(47===t.charCodeAt(r+u)?a=u:0===u&&(a=0));break}var f=t.charCodeAt(r+u);if(f!==i.charCodeAt(n+u))break;47===f&&(a=u)}var c="";for(u=r+a+1;u<=e;++u)u!==e&&47!==t.charCodeAt(u)||(c+=0===c.length?"..":"/..");return c.length>0?c+i.slice(n+a):(47===i.charCodeAt(n+=a)&&++n,i.slice(n))},_makeLong:function(t){return t},dirname:function(t){if(pt(t),0===t.length)return".";for(var i=t.charCodeAt(0),r=47===i,e=-1,s=!0,n=t.length-1;n>=1;--n)if(47===(i=t.charCodeAt(n))){if(!s){e=n;break}}else s=!1;return-1===e?r?"/":".":r&&1===e?"//":t.slice(0,e)},basename:function(t,i){if(void 0!==i&&"string"!=typeof i)throw new TypeError('"ext" argument must be a string');pt(t);var r,e=0,s=-1,n=!0;if(void 0!==i&&i.length>0&&i.length<=t.length){if(i.length===t.length&&i===t)return"";var h=i.length-1,o=-1;for(r=t.length-1;r>=0;--r){var a=t.charCodeAt(r);if(47===a){if(!n){e=r+1;break}}else-1===o&&(n=!1,o=r+1),h>=0&&(a===i.charCodeAt(h)?-1==--h&&(s=r):(h=-1,s=o))}return e===s?s=o:-1===s&&(s=t.length),t.slice(e,s)}for(r=t.length-1;r>=0;--r)if(47===t.charCodeAt(r)){if(!n){e=r+1;break}}else-1===s&&(n=!1,s=r+1);return-1===s?"":t.slice(e,s)},extname:function(t){pt(t);for(var i=-1,r=0,e=-1,s=!0,n=0,h=t.length-1;h>=0;--h){var o=t.charCodeAt(h);if(47!==o)-1===e&&(s=!1,e=h+1),46===o?-1===i?i=h:1!==n&&(n=1):-1!==i&&(n=-1);else if(!s){r=h+1;break}}return-1===i||-1===e||0===n||1===n&&i===e-1&&i===r+1?"":t.slice(i,e)},format:function(t){if(null===t||"object"!=typeof t)throw new TypeError('Parameter "pathObject" must be an object, not '+typeof t);return function(t,i){var r=i.dir||i.root,e=i.base||(i.name||"")+(i.ext||"");return r?r===i.root?r+e:r+"/"+e:e}(0,t)},parse:function(t){pt(t);var i={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return i;var r,e=t.charCodeAt(0),s=47===e;s?(i.root="/",r=1):r=0;for(var n=-1,h=0,o=-1,a=!0,u=t.length-1,f=0;u>=r;--u)if(47!==(e=t.charCodeAt(u)))-1===o&&(a=!1,o=u+1),46===e?-1===n?n=u:1!==f&&(f=1):-1!==n&&(f=-1);else if(!a){h=u+1;break}return-1===n||-1===o||0===f||1===f&&n===o-1&&n===h+1?-1!==o&&(i.base=i.name=t.slice(0===h&&s?1:h,o)):(0===h&&s?(i.name=t.slice(1,n),i.base=t.slice(1,o)):(i.name=t.slice(h,n),i.base=t.slice(h,o)),i.ext=t.slice(n,o)),h>0?i.dir=t.slice(0,h-1):s&&(i.dir="/"),i},sep:"/",delimiter:":",posix:null},bt=mt;class gt{constructor(t){var i;t.indexOf("://")>-1&&(t=new URL(t).pathname),i=this.parse(t),this.path=t,this.directory=this.isDirectory(t)?t:i.dir+"/",this.filename=i.base,this.extension=i.ext.slice(1)}parse(t){return bt.parse(t)}isAbsolute(t){return bt.isAbsolute(t||this.path)}isDirectory(t){return"/"===t.charAt(t.length-1)}resolve(t){return bt.resolve(this.directory,t)}relative(t){return t&&t.indexOf("://")>-1?t:bt.relative(this.directory,t)}splitPath(t){return this.splitPathRe.exec(t).slice(1)}toString(){return this.path}}class yt{constructor(t,i){var r=t.indexOf("://")>-1,e=t;if(this.Url=void 0,this.href=t,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=i,!r&&!1!==i&&"string"!=typeof i&&window&&window.location&&(this.base=window.location.href),r||this.base)try{this.Url=this.base?new URL(t,this.base):new URL(t),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,e=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch(s){this.Url=void 0,this.base&&(e=new gt(this.base).resolve(e))}this.Path=new gt(e),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(t){var i;return t.indexOf("://")>-1?t:(i=bt.resolve(this.directory,t),this.origin+i)}relative(t){return bt.relative(t,this.directory)}toString(){return this.href}}const xt=1,kt=3,Et=9;class At{constructor(t,i,r){var e;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof At))return new At(t,i,r);if("string"==typeof i?this.base=this.parseComponent(i):"object"==typeof i&&i.steps&&(this.base=i),"string"===(e=this.checkType(t)))return this.str=t,_(this,this.parse(t));if("range"===e)return _(this,this.fromRange(t,this.base,r));if("node"===e)return _(this,this.fromNode(t,this.base,r));if("EpubCFI"===e&&t.path)return t;if(t)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(t){return this.isCfiString(t)?"string":!t||"object"!=typeof t||"Range"!==G(t)&&void 0===t.startContainer?t&&"object"==typeof t&&void 0!==t.nodeType?"node":!!(t&&"object"==typeof t&&t instanceof At)&&"EpubCFI":"range"}parse(t){var i,r,e,s={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return"string"!=typeof t?{spinePos:-1}:(0===t.indexOf("epubcfi(")&&")"===t[t.length-1]&&(t=t.slice(8,t.length-1)),(i=this.getChapterComponent(t))?(s.base=this.parseComponent(i),r=this.getPathComponent(t),s.path=this.parseComponent(r),(e=this.getRange(t))&&(s.range=!0,s.start=this.parseComponent(e[0]),s.end=this.parseComponent(e[1])),s.spinePos=s.base.steps[1].index,s):{spinePos:-1})}parseComponent(t){var i={steps:[],terminal:{offset:null,assertion:null}},r=t.split(":"),e=r[0].split("/");return r.length>1&&(i.terminal=this.parseTerminal(r[1])),""===e[0]&&e.shift(),i.steps=e.map(function(t){return this.parseStep(t)}.bind(this)),i}parseStep(t){var i,r,e,s,n;if((s=t.match(/\[(.*)\]/))&&s[1]&&(n=s[1]),r=parseInt(t),!isNaN(r))return r%2==0?(i="element",e=r/2-1):(i="text",e=(r-1)/2),{type:i,index:e,id:n||null}}parseTerminal(t){var i,r,e=t.match(/\[(.*)\]/);return e&&e[1]?(i=parseInt(t.split("[")[0]),r=e[1]):i=parseInt(t),M(i)||(i=null),{offset:i,assertion:r}}getChapterComponent(t){return t.split("!")[0]}getPathComponent(t){var i=t.split("!");if(i[1])return i[1].split(",")[0]}getRange(t){var i=t.split(",");return 3===i.length&&[i[1],i[2]]}getCharecterOffsetComponent(t){return t.split(":")[1]||""}joinSteps(t){return t?t.map((function(t){var i="";return"element"===t.type&&(i+=2*(t.index+1)),"text"===t.type&&(i+=1+2*t.index),t.id&&(i+="["+t.id+"]"),i})).join("/"):""}segmentString(t){var i="/";return i+=this.joinSteps(t.steps),t.terminal&&null!=t.terminal.offset&&(i+=":"+t.terminal.offset),t.terminal&&null!=t.terminal.assertion&&(i+="["+t.terminal.assertion+"]"),i}toString(){var t="epubcfi(";return t+=this.segmentString(this.base),t+="!",t+=this.segmentString(this.path),this.range&&this.start&&(t+=",",t+=this.segmentString(this.start)),this.range&&this.end&&(t+=",",t+=this.segmentString(this.end)),t+")"}compare(t,i){var r,e,s,n;if("string"==typeof t&&(t=new At(t)),"string"==typeof i&&(i=new At(i)),t.spinePos>i.spinePos)return 1;if(t.spinePos<i.spinePos)return-1;t.range?(r=t.path.steps.concat(t.start.steps),s=t.start.terminal):(r=t.path.steps,s=t.path.terminal),i.range?(e=i.path.steps.concat(i.start.steps),n=i.start.terminal):(e=i.path.steps,n=i.path.terminal);for(var h=0;h<r.length;h++){if(!r[h])return-1;if(!e[h])return 1;if(r[h].index>e[h].index)return 1;if(r[h].index<e[h].index)return-1}return r.length<e.length?-1:s.offset>n.offset?1:s.offset<n.offset?-1:0}step(t){return{id:t.id,tagName:t.tagName,type:t.nodeType===kt?"text":"element",index:this.position(t)}}filteredStep(t,i){var r=this.filter(t,i);if(r)return{id:r.id,tagName:r.tagName,type:r.nodeType===kt?"text":"element",index:this.filteredPosition(r,i)}}pathTo(t,i,r){for(var e,s={steps:[],terminal:{offset:null,assertion:null}},n=t;n&&n.parentNode&&n.parentNode.nodeType!=Et;)(e=r?this.filteredStep(n,r):this.step(n))&&s.steps.unshift(e),n=n.parentNode;return null!=i&&i>=0&&(s.terminal.offset=i,"text"!=s.steps[s.steps.length-1].type&&s.steps.push({type:"text",index:0})),s}equalStep(t,i){return!(!t||!i)&&t.index===i.index&&t.id===i.id&&t.type===i.type}fromRange(t,i,r){var e={range:!1,base:{},path:{},start:null,end:null},s=t.startContainer,n=t.endContainer,h=t.startOffset,o=t.endOffset,a=!1;if(r&&(a=null!=s.ownerDocument.querySelector("."+r)),"string"==typeof i?(e.base=this.parseComponent(i),e.spinePos=e.base.steps[1].index):"object"==typeof i&&(e.base=i),t.collapsed)a&&(h=this.patchOffset(s,h,r)),e.path=this.pathTo(s,h,r);else{e.range=!0,a&&(h=this.patchOffset(s,h,r)),e.start=this.pathTo(s,h,r),a&&(o=this.patchOffset(n,o,r)),e.end=this.pathTo(n,o,r),e.path={steps:[],terminal:null};var u,f=e.start.steps.length;for(u=0;u<f&&this.equalStep(e.start.steps[u],e.end.steps[u]);u++)u===f-1?e.start.terminal===e.end.terminal&&(e.path.steps.push(e.start.steps[u]),e.range=!1):e.path.steps.push(e.start.steps[u]);e.start.steps=e.start.steps.slice(e.path.steps.length),e.end.steps=e.end.steps.slice(e.path.steps.length)}return e}fromNode(t,i,r){var e={range:!1,base:{},path:{},start:null,end:null};return"string"==typeof i?(e.base=this.parseComponent(i),e.spinePos=e.base.steps[1].index):"object"==typeof i&&(e.base=i),e.path=this.pathTo(t,null,r),e}filter(t,i){var r,e,s,n,h,o=!1;return t.nodeType===kt?(o=!0,s=t.parentNode,r=t.parentNode.classList.contains(i)):(o=!1,r=t.classList.contains(i)),r&&o?(h=s.nextSibling,(n=s.previousSibling)&&n.nodeType===kt?e=n:h&&h.nodeType===kt&&(e=h),e||t):!(r&&!o)&&t}patchOffset(t,i,r){if(t.nodeType!=kt)throw new Error("Anchor must be a text node");var e=t,s=i;for(t.parentNode.classList.contains(r)&&(e=t.parentNode);e.previousSibling;){if(e.previousSibling.nodeType===xt){if(!e.previousSibling.classList.contains(r))break;s+=e.previousSibling.textContent.length}else s+=e.previousSibling.textContent.length;e=e.previousSibling}return s}normalizedMap(t,i,r){var e,s,n,h={},o=-1,a=t.length;for(e=0;e<a;e++)(s=t[e].nodeType)===xt&&t[e].classList.contains(r)&&(s=kt),e>0&&s===kt&&n===kt?h[e]=o:i===s&&(h[e]=o+=1),n=s;return h}position(t){var i,r;return t.nodeType===xt?((i=t.parentNode.children)||(i=at(t.parentNode)),r=Array.prototype.indexOf.call(i,t)):r=(i=this.textNodes(t.parentNode)).indexOf(t),r}filteredPosition(t,i){var r,e;return t.nodeType===xt?e=this.normalizedMap(r=t.parentNode.children,xt,i):(r=t.parentNode.childNodes,t.parentNode.classList.contains(i)&&(r=(t=t.parentNode).parentNode.childNodes),e=this.normalizedMap(r,kt,i)),e[Array.prototype.indexOf.call(r,t)]}stepsToXpath(t){var i=[".","*"];return t.forEach((function(t){var r=t.index+1;i.push(t.id?"*[position()="+r+" and @id='"+t.id+"']":"text"===t.type?"text()["+r+"]":"*["+r+"]")})),i.join("/")}stepsToQuerySelector(t){var i=["html"];return t.forEach((function(t){var r=t.index+1;t.id?i.push("#"+t.id):"text"===t.type||i.push("*:nth-child("+r+")")})),i.join(">")}textNodes(t,i){return Array.prototype.slice.call(t.childNodes).filter((function(t){return t.nodeType===kt||!(!i||!t.classList.contains(i))}))}walkToNode(t,i,r){var e,s,n=i||document,h=n.documentElement,o=t.length;for(s=0;s<o&&("element"===(e=t[s]).type?h=e.id?n.getElementById(e.id):(h.children||at(h))[e.index]:"text"===e.type&&(h=this.textNodes(h,r)[e.index]),h);s++);return h}findNode(t,i,r){var e,s,n=i||document;return r||void 0===n.evaluate?e=r?this.walkToNode(t,n,r):this.walkToNode(t,n):(s=this.stepsToXpath(t),e=n.evaluate(s,n,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),e}fixMiss(t,i,r,e){var s,n,h=this.findNode(t.slice(0,-1),r,e),o=h.childNodes,a=this.normalizedMap(o,kt,e),u=t[t.length-1].index;for(let f in a){if(!a.hasOwnProperty(f))return;if(a[f]===u){if(!(i>(n=(s=o[f]).textContent.length))){h=s.nodeType===xt?s.childNodes[0]:s;break}i-=n}}return{container:h,offset:i}}toRange(t,i){var r,e,s,n,h,o,a,u,f=t||document,c=!!i&&null!=f.querySelector("."+i);if(r=void 0!==f.createRange?f.createRange():new lt,this.range?(o=this.path.steps.concat((e=this.start).steps),n=this.findNode(o,f,c?i:null),a=this.path.steps.concat((s=this.end).steps),h=this.findNode(a,f,c?i:null)):(e=this.path,o=this.path.steps,n=this.findNode(this.path.steps,f,c?i:null)),!n)return console.log("No startContainer found for",this.toString()),null;try{r.setStart(n,null!=e.terminal.offset?e.terminal.offset:0)}catch(l){u=this.fixMiss(o,e.terminal.offset,f,c?i:null),r.setStart(u.container,u.offset)}if(h)try{r.setEnd(h,null!=s.terminal.offset?s.terminal.offset:0)}catch(l){u=this.fixMiss(a,this.end.terminal.offset,f,c?i:null),r.setEnd(u.container,u.offset)}return r}isCfiString(t){return"string"==typeof t&&0===t.indexOf("epubcfi(")&&")"===t[t.length-1]}generateChapterComponent(t,i,r){var e="/"+2*(t+1)+"/";return e+=2*(parseInt(i)+1),r&&(e+="["+r+"]"),e}collapse(t){this.range&&(this.range=!1,t?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}class Tt{constructor(t){this.context=t||this,this.hooks=[]}register(){for(var t=0;t<arguments.length;++t)if("function"==typeof arguments[t])this.hooks.push(arguments[t]);else for(var i=0;i<arguments[t].length;++i)this.hooks.push(arguments[t][i])}deregister(t){let i;for(let r=0;r<this.hooks.length;r++)if((i=this.hooks[r])===t){this.hooks.splice(r,1);break}}trigger(){var t=arguments,i=this.context,r=[];return this.hooks.forEach((function(e){var s=e.apply(i,t);s&&"function"==typeof s.then&&r.push(s)})),Promise.all(r)}list(){return this.hooks}clear(){return this.hooks=[]}}function St(t,i){var r,e,s=i.url,n=s.indexOf("://")>-1;t&&(e=Q(t,"head"),(r=Q(e,"base"))||(r=t.createElement("base"),e.insertBefore(r,e.firstChild)),!n&&window&&window.location&&(s=window.location.origin+s),r.setAttribute("href",s))}function jt(t,i){var r,e,s=i.canonical;t&&(r=Q(t,"head"),(e=Q(r,"link[rel='canonical']"))?e.setAttribute("href",s):((e=t.createElement("link")).setAttribute("rel","canonical"),e.setAttribute("href",s),r.appendChild(e)))}function Ot(t,i){var r,e,s=i.idref;t&&(r=Q(t,"head"),(e=Q(r,"link[property='dc.identifier']"))?e.setAttribute("content",s):((e=t.createElement("meta")).setAttribute("name","dc.identifier"),e.setAttribute("content",s),r.appendChild(e)))}function Rt(t,i,r){return i.forEach((function(i,e){i&&r[e]&&(t=t.replace(new RegExp(i,"g"),r[e]))})),t}class Ct{constructor(t,i){this.idref=t.idref,this.linear="yes"===t.linear,this.properties=t.properties,this.index=t.index,this.href=t.href,this.url=t.url,this.canonical=t.canonical,this.next=t.next,this.prev=t.prev,this.cfiBase=t.cfiBase,i?this.hooks=i:(this.hooks={},this.hooks.serialize=new Tt(this),this.hooks.content=new Tt(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(t){var i=t||this.request||require("./utils/request"),r=new ht,e=r.promise;return this.contents?r.resolve(this.contents):i(this.url).then(function(t){return this.document=t,this.contents=t.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){r.resolve(this.contents)}.bind(this)).catch((function(t){r.reject(t)})),e}base(){return St(this.document,this)}render(t){var i=new ht,r=i.promise;return this.load(t).then(function(t){var i=("undefined"!=typeof navigator&&navigator.userAgent||"").indexOf("Trident")>=0,r=new("undefined"==typeof XMLSerializer||i?require("xmldom/dom-parser").XMLSerializer:XMLSerializer);return this.output=r.serializeToString(t),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){i.resolve(this.output)}.bind(this)).catch((function(t){i.reject(t)})),r}find(t){var i=this,r=[],e=t.toLowerCase();return rt(i.document,(function(t){!function(t){for(var s,n,h,o=t.textContent.toLowerCase(),a=i.document.createRange(),u=-1;-1!=n;)-1!=(n=o.indexOf(e,u+1))&&((a=i.document.createRange()).setStart(t,n),a.setEnd(t,n+e.length),s=i.cfiFromRange(a),h=t.textContent.length<150?t.textContent:"..."+(h=t.textContent.substring(n-75,n+75))+"...",r.push({cfi:s,excerpt:h})),u=n}(t)})),r}reconcileLayoutSettings(t){var i={layout:t.layout,spread:t.spread,orientation:t.orientation};return this.properties.forEach((function(t){var r,e,s=t.replace("rendition:",""),n=s.indexOf("-");-1!=n&&(r=s.slice(0,n),e=s.slice(n+1),i[r]=e)})),i}cfiFromRange(t){return new At(t,this.cfiBase).toString()}cfiFromElement(t){return new At(t,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}class Nt{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new Tt,this.hooks.content=new Tt,this.hooks.content.register(St),this.hooks.content.register(jt),this.hooks.content.register(Ot),this.epubcfi=new At,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(t,i,r){this.items=t.spine,this.manifest=t.manifest,this.spineNodeIndex=t.spineNodeIndex,this.baseUrl=t.baseUrl||t.basePath||"",this.length=this.items.length,this.items.forEach((t,e)=>{var s,n=this.manifest[t.idref];t.index=e,t.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,t.index,t.idref),t.href&&(t.url=i(t.href,!0),t.canonical=r(t.href)),n&&(t.href=n.href,t.url=i(t.href,!0),t.canonical=r(t.href),n.properties.length&&t.properties.push.apply(t.properties,n.properties)),"yes"===t.linear?(t.prev=function(){let i=t.index;for(;i>0;){let t=this.get(i-1);if(t&&t.linear)return t;i-=1}}.bind(this),t.next=function(){let i=t.index;for(;i<this.spineItems.length-1;){let t=this.get(i+1);if(t&&t.linear)return t;i+=1}}.bind(this)):(t.prev=function(){},t.next=function(){}),s=new Ct(t,this.hooks),this.append(s)}),this.loaded=!0}get(t){var i=0;if(void 0===t)for(;i<this.spineItems.length;){let t=this.spineItems[i];if(t&&t.linear)break;i+=1}else this.epubcfi.isCfiString(t)?i=new At(t).spinePos:"number"==typeof t||!1===isNaN(t)?i=t:"string"==typeof t&&0===t.indexOf("#")?i=this.spineById[t.substring(1)]:"string"==typeof t&&(t=t.split("#")[0],i=this.spineByHref[t]||this.spineByHref[encodeURI(t)]);return this.spineItems[i]||null}append(t){var i=this.spineItems.length;return t.index=i,this.spineItems.push(t),this.spineByHref[decodeURI(t.href)]=i,this.spineByHref[encodeURI(t.href)]=i,this.spineByHref[t.href]=i,this.spineById[t.idref]=i,i}prepend(t){return this.spineByHref[t.href]=0,this.spineById[t.idref]=0,this.spineItems.forEach((function(t,i){t.index=i})),0}remove(t){var i=this.spineItems.indexOf(t);if(i>-1)return delete this.spineByHref[t.href],delete this.spineById[t.idref],this.spineItems.splice(i,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let t=0;do{let i=this.get(t);if(i&&i.linear)return i;t+=1}while(t<this.spineItems.length)}last(){let t=this.spineItems.length-1;do{let i=this.get(t);if(i&&i.linear)return i;t-=1}while(t>=0)}destroy(){this.each(t=>t.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}class zt{constructor(t){this._q=[],this.context=t,this.tick=O,this.running=!1,this.paused=!1}enqueue(){var t,i,r=[].shift.call(arguments),e=arguments;if(!r)throw new Error("No Task Provided");return i="function"==typeof r?{task:r,args:e,deferred:t=new ht,promise:t.promise}:{promise:r},this._q.push(i),0!=this.paused||this.running||this.run(),i.promise}dequeue(){var t,i,r;return!this._q.length||this.paused?((t=new ht).deferred.resolve(),t.promise):(i=(t=this._q.shift()).task)?(r=i.apply(this.context,t.args))&&"function"==typeof r.then?r.then(function(){t.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){t.deferred.reject.apply(this.context,arguments)}.bind(this)):(t.deferred.resolve.apply(this.context,r),t.promise):t.promise?t.promise:void 0}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new ht),this.tick.call(window,()=>{this._q.length?this.dequeue().then(function(){this.run()}.bind(this)):(this.defered.resolve(),this.running=void 0)}),1==this.paused&&(this.paused=!1),this.defered.promise}flush(){return this.running?this.running:this._q.length?(this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running):void 0}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}const Mt="0.3",It=["keydown","keyup","keypressed","mouseup","mousedown","click","touchend","touchstart","touchmove"],Lt={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};class Ft{constructor(t,i,r){this.spine=t,this.request=i,this.pause=r||100,this.q=new zt(this),this.epubcfi=new At,this._locations=[],this.total=0,this.break=150,this._current=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(t){return t&&(this.break=t),this.q.pause(),this.spine.each(function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(t){return t.load(this.request).then(function(i){var r=new ht,e=this.parse(i,t.cfiBase);return this._locations=this._locations.concat(e),t.unload(),this.processingTimeout=setTimeout(()=>r.resolve(e),this.pause),r.promise}.bind(this))}parse(t,i,r){var e,s,n=[],h=Q(t.ownerDocument,"body"),o=0,a=r||this.break;if(rt(h,function(t){var r,h=t.length,u=0;if(0===t.textContent.trim().length)return!1;for(0==o&&((e=this.createRange()).startContainer=t,e.startOffset=0),(r=a-o)>h&&(o+=h,u=h);u<h;)if(r=a-o,0===o&&(u+=1,(e=this.createRange()).startContainer=t,e.startOffset=u),u+r>=h)o+=h-u,u=h;else{u+=r,e.endContainer=t,e.endOffset=u;let s=new At(e,i).toString();n.push(s),o=0}s=t}.bind(this)),e&&e.startContainer&&s){e.endContainer=s,e.endOffset=s.length;let t=new At(e,i).toString();n.push(t),o=0}return n}locationFromCfi(t){let i;return At.prototype.isCfiString(t)&&(t=new At(t)),0===this._locations.length?-1:(i=P(t,this._locations,this.epubcfi.compare))>this.total?this.total:i}percentageFromCfi(t){if(0===this._locations.length)return null;var i=this.locationFromCfi(t);return this.percentageFromLocation(i)}percentageFromLocation(t){return t&&this.total?t/this.total:0}cfiFromLocation(t){var i=-1;return"number"!=typeof t&&(t=parseInt(t)),t>=0&&t<this._locations.length&&(i=this._locations[t]),i}cfiFromPercentage(t){let i;if(t>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),t>=1){let t=new At(this._locations[this.total]);return t.collapse(),t.toString()}return i=Math.ceil(this.total*t),this.cfiFromLocation(i)}load(t){return this._locations="string"==typeof t?JSON.parse(t):t,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(t){var i;if("string"==typeof t)this._currentCfi=t;else{if("number"!=typeof t)return;this._current=t}0!==this._locations.length&&("string"==typeof t?(i=this.locationFromCfi(t),this._current=i):i=t,this.emit(Lt.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(i)}))}get currentLocation(){return this._current}set currentLocation(t){this.setCurrent(t)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}j(Ft.prototype);class _t{constructor(t){this.packagePath="",this.directory="",this.encoding="",t&&this.parse(t)}parse(t){var i;if(!t)throw new Error("Container File Not Found");if(!(i=Q(t,"rootfile")))throw new Error("No RootFile Found");this.packagePath=i.getAttribute("full-path"),this.directory=bt.dirname(this.packagePath),this.encoding=t.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}class Pt{constructor(t){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},t&&this.parse(t)}parse(t){var i,r,e;if(!t)throw new Error("Package File Not Found");if(!(i=Q(t,"metadata")))throw new Error("No Metadata Found");if(!(r=Q(t,"manifest")))throw new Error("No Manifest Found");if(!(e=Q(t,"spine")))throw new Error("No Spine Found");return this.manifest=this.parseManifest(r),this.navPath=this.findNavPath(r),this.ncxPath=this.findNcxPath(r,e),this.coverPath=this.findCoverPath(t),this.spineNodeIndex=H(e),this.spine=this.parseSpine(e,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(t),this.metadata=this.parseMetadata(i),this.metadata.direction=e.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(t){var i={};return i.title=this.getElementText(t,"title"),i.creator=this.getElementText(t,"creator"),i.description=this.getElementText(t,"description"),i.pubdate=this.getElementText(t,"date"),i.publisher=this.getElementText(t,"publisher"),i.identifier=this.getElementText(t,"identifier"),i.language=this.getElementText(t,"language"),i.rights=this.getElementText(t,"rights"),i.modified_date=this.getPropertyText(t,"dcterms:modified"),i.layout=this.getPropertyText(t,"rendition:layout"),i.orientation=this.getPropertyText(t,"rendition:orientation"),i.flow=this.getPropertyText(t,"rendition:flow"),i.viewport=this.getPropertyText(t,"rendition:viewport"),i.media_active_class=this.getPropertyText(t,"media:active-class"),i}parseManifest(t){var i={},r=tt(t,"item");return Array.prototype.slice.call(r).forEach((function(t){var r=t.getAttribute("id"),e=t.getAttribute("href")||"",s=t.getAttribute("media-type")||"",n=t.getAttribute("media-overlay")||"",h=t.getAttribute("properties")||"";i[r]={href:e,type:s,overlay:n,properties:h.length?h.split(" "):[]}})),i}parseSpine(t,i){var r=[],e=tt(t,"itemref");return Array.prototype.slice.call(e).forEach((function(t,i){var e=t.getAttribute("idref"),s=t.getAttribute("properties")||"",n=s.length?s.split(" "):[],h={idref:e,linear:t.getAttribute("linear")||"yes",properties:n,index:i};r.push(h)})),r}findUniqueIdentifier(t){var i=t.documentElement.getAttribute("unique-identifier");if(!i)return"";var r=t.getElementById(i);return r&&"identifier"===r.localName&&"http://purl.org/dc/elements/1.1/"===r.namespaceURI&&r.childNodes.length>0?r.childNodes[0].nodeValue.trim():""}findNavPath(t){var i=it(t,"item",{properties:"nav"});return!!i&&i.getAttribute("href")}findNcxPath(t,i){var r,e=it(t,"item",{"media-type":"application/x-dtbncx+xml"});return e||(r=i.getAttribute("toc"))&&(e=t.querySelector(`#${r}`)),!!e&&e.getAttribute("href")}findCoverPath(t){if("2.0"===Q(t,"package").getAttribute("version")){var i=it(t,"meta",{name:"cover"});if(i){var r=i.getAttribute("content"),e=t.getElementById(r);return e?e.getAttribute("href"):""}return!1}var s=it(t,"item",{properties:"cover-image"});return s?s.getAttribute("href"):""}getElementText(t,i){var r,e=t.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",i);return e&&0!==e.length&&(r=e[0]).childNodes.length?r.childNodes[0].nodeValue:""}getPropertyText(t,i){var r=it(t,"meta",{property:i});return r&&r.childNodes.length?r.childNodes[0].nodeValue:""}load(t){return this.metadata=t.metadata,this.spine=(t.readingOrder||t.spine).map((t,i)=>(t.index=i,t.linear=t.linear||"yes",t)),t.resources.forEach((t,i)=>{this.manifest[i]=t,t.rel&&"cover"===t.rel[0]&&(this.coverPath=t.href)}),this.spineNodeIndex=0,this.toc=t.toc.map(t=>(t.label=t.title,t)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}class Ut{constructor(t){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,t&&this.parse(t)}parse(t){let i,r,e=t.nodeType;e&&(i=Q(t,"html"),r=Q(t,"ncx")),e?i?(this.toc=this.parseNav(t),this.landmarks=this.parseLandmarks(t)):r&&(this.toc=this.parseNcx(t)):this.toc=this.load(t),this.length=0,this.unpack(this.toc)}unpack(t){for(var i,r=0;r<t.length;r++)(i=t[r]).href&&(this.tocByHref[i.href]=r),i.id&&(this.tocById[i.id]=r),this.length++,i.subitems.length&&this.unpack(i.subitems)}get(t){var i;return t?(0===t.indexOf("#")?i=this.tocById[t.substring(1)]:t in this.tocByHref&&(i=this.tocByHref[t]),this.toc[i]):this.toc}landmark(t){return t?this.landmarks[this.landmarksByType[t]]:this.landmarks}parseNav(t){var i,r,e=ot(t,"nav","toc"),s=e?tt(e,"li"):[],n=s.length,h={},o=[];if(!s||0===n)return o;for(i=0;i<n;++i)(r=this.navItem(s[i]))&&(h[r.id]=r,r.parent?h[r.parent].subitems.push(r):o.push(r));return o}navItem(t){let i=t.getAttribute("id")||void 0,r=ft(t,"a",!0);if(!r)return;let e=r.getAttribute("href")||"";i||(i=e);let s,n=r.textContent||"",h=ct(t,"li");if(h&&!(s=h.getAttribute("id"))){const t=ft(h,"a",!0);s=t&&t.getAttribute("href")}for(;!s&&h;)if((h=ct(h,"li"))&&!(s=h.getAttribute("id"))){const t=ft(h,"a",!0);s=t&&t.getAttribute("href")}return{id:i,href:e,label:n,subitems:[],parent:s}}parseLandmarks(t){var i,r,e=ot(t,"nav","landmarks"),s=e?tt(e,"li"):[],n=s.length,h=[];if(!s||0===n)return h;for(i=0;i<n;++i)(r=this.landmarkItem(s[i]))&&(h.push(r),this.landmarksByType[r.type]=i);return h}landmarkItem(t){let i=ft(t,"a",!0);if(!i)return;let r=i.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0;return{href:i.getAttribute("href")||"",label:i.textContent||"",type:r}}parseNcx(t){var i,r,e=tt(t,"navPoint"),s=e.length,n={},h=[];if(!e||0===s)return h;for(i=0;i<s;++i)n[(r=this.ncxItem(e[i])).id]=r,r.parent?n[r.parent].subitems.push(r):h.push(r);return h}ncxItem(t){var i,r=t.getAttribute("id")||!1,e=Q(t,"content").getAttribute("src"),s=Q(t,"navLabel"),n=s.textContent?s.textContent:"",h=t.parentNode;return!h||"navPoint"!==h.nodeName&&"navPoint"!==h.nodeName.split(":").slice(-1)[0]||(i=h.getAttribute("id")),{id:r,href:e,label:n,subitems:[],parent:i}}load(t){return t.map(t=>(t.label=t.title,t.subitems=t.children?this.load(t.children):[],t))}forEach(t){return this.toc.forEach(t)}}var Bt={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},Dt=function(){var t,i,r,e,s={};for(t in Bt)if(Bt.hasOwnProperty(t))for(i in Bt[t])if(Bt[t].hasOwnProperty(i))if("string"==typeof(r=Bt[t][i]))s[r]=t+"/"+i;else for(e=0;e<r.length;e++)s[r[e]]=t+"/"+i;return s}(),Zt={lookup:function(t){return t&&Dt[t.split(".").pop().toLowerCase()]||"text/plain"}};class qt{constructor(t,i){this.settings={replacements:i&&i.replacements||"base64",archive:i&&i.archive,resolver:i&&i.resolver,request:i&&i.request},this.process(t)}process(t){this.manifest=t,this.resources=Object.keys(t).map((function(i){return t[i]})),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter((function(t){if("application/xhtml+xml"===t.type||"text/html"===t.type)return!0})),this.assets=this.resources.filter((function(t){if("application/xhtml+xml"!==t.type&&"text/html"!==t.type)return!0})),this.css=this.resources.filter((function(t){if("text/css"===t.type)return!0}))}splitUrls(){this.urls=this.assets.map(function(t){return t.href}.bind(this)),this.cssUrls=this.css.map((function(t){return t.href}))}createUrl(t){var i=new yt(t),r=Zt.lookup(i.filename);return this.settings.archive?this.settings.archive.createUrl(t,{base64:"base64"===this.settings.replacements}):"base64"===this.settings.replacements?this.settings.request(t,"blob").then(t=>nt(t)).then(t=>Y(t,r)):this.settings.request(t,"blob").then(t=>X(t,r))}replacements(){if("none"===this.settings.replacements)return new Promise(function(t){t(this.urls)}.bind(this));var t=this.urls.map(t=>{var i=this.settings.resolver(t);return this.createUrl(i).catch(t=>(console.error(t),null))});return Promise.all(t).then(t=>(this.replacementUrls=t.filter(t=>"string"==typeof t),t))}replaceCss(t,i){var r=[];return t=t||this.settings.archive,i=i||this.settings.resolver,this.cssUrls.forEach(function(e){var s=this.createCssFile(e,t,i).then(function(t){var i=this.urls.indexOf(e);i>-1&&(this.replacementUrls[i]=t)}.bind(this));r.push(s)}.bind(this)),Promise.all(r)}createCssFile(t){if(bt.isAbsolute(t))return new Promise((function(t){t()}));var i,r=this.settings.resolver(t);i=this.settings.archive?this.settings.archive.getText(r):this.settings.request(r,"text");var e=this.urls.map(t=>{var i=this.settings.resolver(t);return new gt(r).relative(i)});return i?i.then(t=>(t=Rt(t,e,this.replacementUrls),"base64"===this.settings.replacements?Y(t,"text/css"):X(t,"text/css")),()=>new Promise((function(t){t()}))):new Promise((function(t){t()}))}relativeTo(t,i){return i=i||this.settings.resolver,this.urls.map(function(r){var e=i(r);return new gt(t).relative(e)}.bind(this))}get(t){var i=this.urls.indexOf(t);if(-1!==i)return this.replacementUrls.length?new Promise(function(t){t(this.replacementUrls[i])}.bind(this)):this.createUrl(t)}substitute(t,i){return Rt(t,i?this.relativeTo(i):this.urls,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}class Wt{constructor(t){this.pages=[],this.locations=[],this.epubcfi=new At,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,t&&(this.pageList=this.parse(t)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(t){var i=Q(t,"html"),r=Q(t,"ncx");return i?this.parseNav(t):r?this.parseNcx(t):void 0}parseNav(t){var i,r,e=ot(t,"nav","page-list"),s=e?tt(e,"li"):[],n=s.length,h=[];if(!s||0===n)return h;for(i=0;i<n;++i)r=this.item(s[i]),h.push(r);return h}parseNcx(t){var i,r,e,s,n=[],h=0;if(!(r=Q(t,"pageList")))return n;if(s=(e=tt(r,"pageTarget")).length,!e||0===e.length)return n;for(h=0;h<s;++h)i=this.ncxItem(e[h]),n.push(i);return n}ncxItem(t){var i=Q(t,"navLabel"),r=Q(i,"text").textContent;return{href:Q(t,"content").getAttribute("src"),page:parseInt(r,10)}}item(t){var i,r=Q(t,"a"),e=r.getAttribute("href")||"",s=parseInt(r.textContent||"");return-1!=e.indexOf("epubcfi")?{cfi:(i=e.split("#")).length>1&&i[1],href:e,packageUrl:i[0],page:s}:{href:e,page:s}}process(t){t.forEach((function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)}),this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(t){var i=-1;if(0===this.locations.length)return-1;var r=U(t,this.locations,this.epubcfi.compare);return-1!=r?i=this.pages[r]:void 0!==(i=(r=P(t,this.locations,this.epubcfi.compare))-1>=0?this.pages[r-1]:this.pages[0])||(i=-1),i}cfiFromPage(t){var i=-1;"number"!=typeof t&&(t=parseInt(t));var r=this.pages.indexOf(t);return-1!=r&&(i=this.locations[r]),i}pageFromPercentage(t){return Math.round(this.totalPages*t)}percentageFromPage(t){return Math.round((t-this.firstPage)/this.totalPages*1e3)/1e3}percentageFromCfi(t){var i=this.pageFromCfi(t);return this.percentageFromPage(i)}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}class Ht{constructor(t){this.settings=t,this.name=t.layout||"reflowable",this._spread="none"!==t.spread,this._minSpreadWidth=t.minSpreadWidth||800,this._evenSpreads=t.evenSpreads||!1,this._flow="scrolled"===t.flow||"scrolled-continuous"===t.flow||"scrolled-doc"===t.flow?"scrolled":"paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(t){return void 0!==t&&(this._flow="scrolled"===t||"scrolled-continuous"===t||"scrolled-doc"===t?"scrolled":"paginated",this.update({flow:this._flow})),this._flow}spread(t,i){return t&&(this._spread="none"!==t,this.update({spread:this._spread})),i>=0&&(this._minSpreadWidth=i),this._spread}calculate(t,i,r){var e,s,n,h,o,a=r||0,u=t,f=i,c=Math.floor(u/12);"reflowable"!==this.name||"paginated"!==this._flow||r>=0||(a=c%2==0?c:c-1),"pre-paginated"===this.name&&(a=0),(o=this._spread&&u>=this._minSpreadWidth?2:1)>1?n=(e=u/o-a)+a:(e=u,n=u),"pre-paginated"===this.name&&o>1&&(u=e),s=e*o+a,h=u,this.width=u,this.height=f,this.spreadWidth=s,this.pageWidth=n,this.delta=h,this.columnWidth=e,this.gap=a,this.divisor=o,this.update({width:u,height:f,spreadWidth:s,pageWidth:n,delta:h,columnWidth:e,gap:a,divisor:o})}format(t){return"pre-paginated"===this.name?t.fit(this.columnWidth,this.height):"paginated"===this._flow?t.columns(this.width,this.height,this.columnWidth,this.gap):t.size(this.width,null)}count(t,i){let r,e;return"pre-paginated"===this.name?(r=1,e=1):"paginated"===this._flow?(i=i||this.delta,e=(r=Math.ceil(t/i))*this.divisor):(i=i||this.height,e=r=Math.ceil(t/i)),{spreads:r,pages:e}}update(t){if(Object.keys(t).forEach(i=>{this.props[i]===t[i]&&delete t[i]}),Object.keys(t).length>0){let i=_(this.props,t);this.emit(Lt.LAYOUT.UPDATED,i,t)}}}j(Ht.prototype);class Kt{constructor(t){this.rendition=t,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(0!==arguments.length)return 1===arguments.length&&"object"==typeof arguments[0]?this.registerThemes(arguments[0]):1===arguments.length&&"string"==typeof arguments[0]?this.default(arguments[0]):2===arguments.length&&"string"==typeof arguments[1]?this.registerUrl(arguments[0],arguments[1]):2===arguments.length&&"object"==typeof arguments[1]?this.registerRules(arguments[0],arguments[1]):void 0}default(t){if(t)return"string"==typeof t?this.registerUrl("default",t):"object"==typeof t?this.registerRules("default",t):void 0}registerThemes(t){for(var i in t)t.hasOwnProperty(i)&&("string"==typeof t[i]?this.registerUrl(i,t[i]):this.registerRules(i,t[i]))}registerUrl(t,i){var r=new yt(i);this._themes[t]={url:r.toString()},this._injected[t]&&this.update(t)}registerRules(t,i){this._themes[t]={rules:i},this._injected[t]&&this.update(t)}select(t){var i=this._current;this._current=t,this.update(t),this.rendition.getContents().forEach(r=>{r.removeClass(i),r.addClass(t)})}update(t){this.rendition.getContents().forEach(i=>{this.add(t,i)})}inject(t){var i,r=[],e=this._themes;for(var s in e)!e.hasOwnProperty(s)||s!==this._current&&"default"!==s||(((i=e[s]).rules&&Object.keys(i.rules).length>0||i.url&&-1===r.indexOf(i.url))&&this.add(s,t),this._injected.push(s));"default"!=this._current&&t.addClass(this._current)}add(t,i){var r=this._themes[t];r&&i&&(r.url?i.addStylesheet(r.url):r.serialized||r.rules&&(i.addStylesheetRules(r.rules),r.injected=!0))}override(t,i,r){var e=this.rendition.getContents();this._overrides[t]={value:i,priority:!0===r},e.forEach(i=>{i.css(t,this._overrides[t].value,this._overrides[t].priority)})}removeOverride(t){var i=this.rendition.getContents();delete this._overrides[t],i.forEach(i=>{i.css(t)})}overrides(t){var i=this._overrides;for(var r in i)i.hasOwnProperty(r)&&t.css(r,i[r].value,i[r].priority)}fontSize(t){this.override("font-size",t)}font(t){this.override("font-family",t,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}class $t{constructor(t,i,r,e){this.layout=t,this.horizontal="horizontal"===r,this.direction=i||"ltr",this._dev=e}section(t){var i=this.findRanges(t);return this.rangeListToCfiList(t.section.cfiBase,i)}page(t,i,r,e){var s,n=!(!t||!t.document)&&t.document.body;if(n){if(s=this.rangePairToCfiPair(i,{start:this.findStart(n,r,e),end:this.findEnd(n,r,e)}),!0===this._dev){let i=t.document,r=new At(s.start).toRange(i),e=new At(s.end).toRange(i),n=i.defaultView.getSelection(),h=i.createRange();n.removeAllRanges(),h.setStart(r.startContainer,r.startOffset),h.setEnd(e.endContainer,e.endOffset),n.addRange(h)}return s}}walk(t,i){if(!t||t.nodeType!==Node.TEXT_NODE){var r=function(t){return t.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},e=r;e.acceptNode=r;for(var s,n,h=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,e,!1);(s=h.nextNode())&&!(n=i(s)););return n}}findRanges(t){for(var i,r,e=[],s=t.contents.scrollWidth(),n=Math.ceil(s/this.layout.spreadWidth)*this.layout.divisor,h=this.layout.columnWidth,o=this.layout.gap,a=0;a<n.pages;a++)e.push({start:this.findStart(t.document.body,i=(h+o)*a,r=h*(a+1)+o*a),end:this.findEnd(t.document.body,i,r)});return e}findStart(t,i,r){for(var e,s,n=[t],h=t;n.length;)if(e=n.shift(),s=this.walk(e,t=>{var e,s,o,a;if(a=Z(t),this.horizontal&&"ltr"===this.direction){if((e=this.horizontal?a.left:a.top)>=i&&e<=r)return t;if((s=this.horizontal?a.right:a.bottom)>i)return t;h=t,n.push(t)}else if(this.horizontal&&"rtl"===this.direction){if((s=a.right)<=r&&s>=i)return t;if((e=a.left)<r)return t;h=t,n.push(t)}else{if((o=a.top)>=i&&o<=r)return t;if(a.bottom>i)return t;h=t,n.push(t)}}))return this.findTextStartRange(s,i,r);return this.findTextStartRange(h,i,r)}findEnd(t,i,r){for(var e,s,n=[t],h=t;n.length;)if(e=n.shift(),s=this.walk(e,t=>{var e,s,o,a,u;if(u=Z(t),this.horizontal&&"ltr"===this.direction){if(e=Math.round(u.left),s=Math.round(u.right),e>r&&h)return h;if(s>r)return t;h=t,n.push(t)}else if(this.horizontal&&"rtl"===this.direction){if(e=Math.round(this.horizontal?u.left:u.top),(s=Math.round(this.horizontal?u.right:u.bottom))<i&&h)return h;if(e<i)return t;h=t,n.push(t)}else{if(o=Math.round(u.top),a=Math.round(u.bottom),o>r&&h)return h;if(a>r)return t;h=t,n.push(t)}}))return this.findTextEndRange(s,i,r);return this.findTextEndRange(h,i,r)}findTextStartRange(t,i,r){for(var e,s,n=this.splitTextNodeIntoRanges(t),h=0;h<n.length;h++)if(s=(e=n[h]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(s.left>=i)return e}else if(this.horizontal&&"rtl"===this.direction){if(s.right<=r)return e}else if(s.top>=i)return e;return n[0]}findTextEndRange(t,i,r){for(var e,s,n,h=this.splitTextNodeIntoRanges(t),o=0;o<h.length;o++){if(n=(s=h[o]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(n.left>r&&e)return e;if(n.right>r)return s}else if(this.horizontal&&"rtl"===this.direction){if(n.right<i&&e)return e;if(n.left<i)return s}else{if(n.top>r&&e)return e;if(n.bottom>r)return s}e=s}return h[h.length-1]}splitTextNodeIntoRanges(t,i){var r,e=[],s=(t.textContent||"").trim(),n=t.ownerDocument,h=i||" ",o=s.indexOf(h);if(-1===o||t.nodeType!=Node.TEXT_NODE)return(r=n.createRange()).selectNodeContents(t),[r];for((r=n.createRange()).setStart(t,0),r.setEnd(t,o),e.push(r),r=!1;-1!=o;)(o=s.indexOf(h,o+1))>0&&(r&&(r.setEnd(t,o),e.push(r)),(r=n.createRange()).setStart(t,o+1));return r&&(r.setEnd(t,s.length),e.push(r)),e}rangePairToCfiPair(t,i){var r=i.start,e=i.end;return r.collapse(!0),e.collapse(!1),{start:new At(r,t).toString(),end:new At(e,t).toString()}}rangeListToCfiList(t,i){for(var r,e=[],s=0;s<i.length;s++)r=this.rangePairToCfiPair(t,i[s]),e.push(r);return e}axis(t){return t&&(this.horizontal="horizontal"===t),this.horizontal}}const Xt="undefined"!=typeof navigator,Jt=Xt&&/Chrome/.test(navigator.userAgent),Yt=Xt&&!Jt&&/AppleWebKit/.test(navigator.userAgent),Gt=1;class Vt{constructor(t,i,r,e){this.epubcfi=new At,this.document=t,this.documentElement=this.document.documentElement,this.content=i||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=e||0,this.cfiBase=r||"",this.epubReadingSystem("epub.js",Mt),this.listeners()}static get listenedEvents(){return It}width(t){var i=this.content;return t&&M(t)&&(t+="px"),t&&(i.style.width=t),this.window.getComputedStyle(i).width}height(t){var i=this.content;return t&&M(t)&&(t+="px"),t&&(i.style.height=t),this.window.getComputedStyle(i).height}contentWidth(t){var i=this.content||this.document.body;return t&&M(t)&&(t+="px"),t&&(i.style.width=t),this.window.getComputedStyle(i).width}contentHeight(t){var i=this.content||this.document.body;return t&&M(t)&&(t+="px"),t&&(i.style.height=t),this.window.getComputedStyle(i).height}textWidth(){let t,i,r=this.document.createRange(),e=this.content||this.document.body,s=D(e);return r.selectNodeContents(e),i=(t=r.getBoundingClientRect()).width,s&&s.width&&(i+=s.width),Math.round(i)}textHeight(){let t,i,r=this.document.createRange(),e=this.content||this.document.body,s=D(e);return r.selectNodeContents(e),(i=(t=r.getBoundingClientRect()).height)&&s.height&&(i+=s.height),i&&t.top&&(i+=t.top),Math.round(i)}scrollWidth(){return this.documentElement.scrollWidth}scrollHeight(){return this.documentElement.scrollHeight}overflow(t){return t&&(this.documentElement.style.overflow=t),this.window.getComputedStyle(this.documentElement).overflow}overflowX(t){return t&&(this.documentElement.style.overflowX=t),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(t){return t&&(this.documentElement.style.overflowY=t),this.window.getComputedStyle(this.documentElement).overflowY}css(t,i,r){var e=this.content||this.document.body;return i?e.style.setProperty(t,i,r?"important":""):e.style.removeProperty(t),this.window.getComputedStyle(e)[t]}viewport(t){var i,r=this.document.querySelector("meta[name='viewport']"),e={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},s=[];if(r&&r.hasAttribute("content")){let t=r.getAttribute("content"),i=t.match(/width\s*=\s*([^,]*)/),s=t.match(/height\s*=\s*([^,]*)/),n=t.match(/initial-scale\s*=\s*([^,]*)/),h=t.match(/minimum-scale\s*=\s*([^,]*)/),o=t.match(/maximum-scale\s*=\s*([^,]*)/),a=t.match(/user-scalable\s*=\s*([^,]*)/);i&&i.length&&void 0!==i[1]&&(e.width=i[1]),s&&s.length&&void 0!==s[1]&&(e.height=s[1]),n&&n.length&&void 0!==n[1]&&(e.scale=n[1]),h&&h.length&&void 0!==h[1]&&(e.minimum=h[1]),o&&o.length&&void 0!==o[1]&&(e.maximum=o[1]),a&&a.length&&void 0!==a[1]&&(e.scalable=a[1])}return i=F(t||{},e),t&&(i.width&&s.push("width="+i.width),i.height&&s.push("height="+i.height),i.scale&&s.push("initial-scale="+i.scale),"no"===i.scalable?(s.push("minimum-scale="+i.scale),s.push("maximum-scale="+i.scale),s.push("user-scalable="+i.scalable)):(i.scalable&&s.push("user-scalable="+i.scalable),i.minimum&&s.push("minimum-scale="+i.minimum),i.maximum&&s.push("minimum-scale="+i.maximum)),r||((r=this.document.createElement("meta")).setAttribute("name","viewport"),this.document.querySelector("head").appendChild(r)),r.setAttribute("content",s.join(", ")),this.window.scrollTo(0,0)),i}expand(){this.emit(Lt.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),this.resizeListeners(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),clearTimeout(this.expanding)}resizeCheck(){let t=this.textWidth(),i=this.textHeight();t==this._size.width&&i==this._size.height||(this._size={width:t,height:i},this.onResize&&this.onResize(this._size),this.emit(Lt.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this))}transitionListeners(){let t=this.content;t.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",t.style.transitionDuration="0.001ms",t.style.transitionTimingFunction="linear",t.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var t=this.document.styleSheets,i=function(t){t.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),r=0;r<t.length;r+=1){var e;try{e=t[r].cssRules}catch(n){return}if(!e)return;for(var s=0;s<e.length;s+=1)e[s].media&&this.window.matchMedia(e[s].media.mediaText).addListener(i)}}resizeObservers(){this.observer=new MutationObserver(()=>{this.resizeCheck()}),this.observer.observe(this.document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}imageLoadListeners(){for(var t,i=this.document.querySelectorAll("img"),r=0;r<i.length;r++)void 0!==(t=i[r]).naturalWidth&&0===t.naturalWidth&&(t.onload=this.expand.bind(this))}fontLoadListeners(){this.document&&this.document.fonts&&this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(t,i){var r,e={left:0,top:0};if(!this.document)return e;if(this.epubcfi.isCfiString(t)){let n=new At(t).toRange(this.document,i);if(n){try{if(!n.endContainer||n.startContainer==n.endContainer&&n.startOffset==n.endOffset){let t=n.startContainer.textContent.indexOf(" ",n.startOffset);-1==t&&(t=n.startContainer.textContent.length),n.setEnd(n.startContainer,t)}}catch(s){console.error("setting end offset to start container length failed",s)}if(n.startContainer.nodeType===Node.ELEMENT_NODE)r=n.startContainer.getBoundingClientRect(),e.left=r.left,e.top=r.top;else if(Yt){let t=n.startContainer,i=new Range;try{t.nodeType===Gt?r=t.getBoundingClientRect():n.startOffset+2<t.length?(i.setStart(t,n.startOffset),i.setEnd(t,n.startOffset+2),r=i.getBoundingClientRect()):n.startOffset-2>0?(i.setStart(t,n.startOffset-2),i.setEnd(t,n.startOffset),r=i.getBoundingClientRect()):r=t.parentNode.getBoundingClientRect()}catch(s){console.error(s,s.stack)}}else r=n.getBoundingClientRect()}}else if("string"==typeof t&&t.indexOf("#")>-1){let i=t.substring(t.indexOf("#")+1),e=this.document.getElementById(i);if(e)if(Yt){let t=new Range;t.selectNode(e),r=t.getBoundingClientRect()}else r=e.getBoundingClientRect()}return r&&(e.left=r.left,e.top=r.top),e}addStylesheet(t){return new Promise(function(i){var r,e=!1;this.document?(r=this.document.querySelector("link[href='"+t+"']"))?i(!0):((r=this.document.createElement("link")).type="text/css",r.rel="stylesheet",r.href=t,r.onload=r.onreadystatechange=function(){e||this.readyState&&"complete"!=this.readyState||(e=!0,setTimeout(()=>{i(!0)},1))},this.document.head.appendChild(r)):i(!1)}.bind(this))}addStylesheetRules(t){var i,r,e="epubjs-inserted-css";if(this.document&&t&&0!==t.length)if((i=this.document.getElementById("#"+e))||((i=this.document.createElement("style")).id=e),this.document.head.appendChild(i),r=i.sheet,"[object Array]"===Object.prototype.toString.call(t))for(var s=0,n=t.length;s<n;s++){var h=1,o=t[s],a=t[s][0],u="";"[object Array]"===Object.prototype.toString.call(o[1][0])&&(o=o[1],h=0);for(var f=o.length;h<f;h++){var c=o[h];u+=c[0]+":"+c[1]+(c[2]?" !important":"")+";\n"}r.insertRule(a+"{"+u+"}",r.cssRules.length)}else Object.keys(t).forEach(i=>{const e=t[i];if(Array.isArray(e))e.forEach(t=>{const e=Object.keys(t).map(i=>`${i}:${t[i]}`).join(";");r.insertRule(`${i}{${e}}`,r.cssRules.length)});else{const t=Object.keys(e).map(t=>`${t}:${e[t]}`).join(";");r.insertRule(`${i}{${t}}`,r.cssRules.length)}})}addScript(t){return new Promise(function(i){var r,e=!1;this.document?((r=this.document.createElement("script")).type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){e||this.readyState&&"complete"!=this.readyState||(e=!0,setTimeout((function(){i(!0)}),1))},this.document.head.appendChild(r)):i(!1)}.bind(this))}addClass(t){var i;this.document&&(i=this.content||this.document.body)&&i.classList.add(t)}removeClass(t){var i;this.document&&(i=this.content||this.document.body)&&i.classList.remove(t)}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),It.forEach((function(t){this.document.addEventListener(t,this._triggerEvent,{passive:!0})}),this))}removeEventListeners(){this.document&&(It.forEach((function(t){this.document.removeEventListener(t,this._triggerEvent,{passive:!0})}),this),this._triggerEvent=void 0)}triggerEvent(t){this.emit(t.type,t)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(t){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}.bind(this),250)}triggerSelectedEvent(t){var i,r;t&&t.rangeCount>0&&((i=t.getRangeAt(0)).collapsed||(r=new At(i,this.cfiBase).toString(),this.emit(Lt.CONTENTS.SELECTED,r),this.emit(Lt.CONTENTS.SELECTED_RANGE,i)))}range(t,i){return new At(t).toRange(this.document,i)}cfiFromRange(t,i){return new At(t,this.cfiBase,i).toString()}cfiFromNode(t,i){return new At(t,this.cfiBase,i).toString()}map(t){return new $t(t).section()}size(t,i){var r={scale:1,scalable:"no"};this.layoutStyle("scrolling"),t>=0&&(this.width(t),r.width=t,this.css("padding","0 "+t/12+"px")),i>=0&&(this.height(i),r.height=i),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(r)}columns(t,i,r,e){let s=L("column-axis"),n=L("column-gap"),h=L("column-width"),o=L("column-fill"),a=0===this.writingMode().indexOf("vertical")?"vertical":"horizontal";this.layoutStyle("paginated"),"rtl"===this.content.dir&&this.direction("rtl"),this.width(t),this.height(i),this.viewport({width:t,height:i,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),"vertical"===a?(this.css("padding-top",e/2+"px",!0),this.css("padding-bottom",e/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",e/2+"px",!0),this.css("padding-right",e/2+"px",!0)),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(s,"horizontal"),this.css(o,"auto"),this.css(n,e+"px"),this.css(h,r+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(t,i,r){var e="scale("+t+")",s="";this.css("transform-origin","top left"),(i>=0||r>=0)&&(s=" translate("+(i||0)+"px, "+(r||0)+"px )"),this.css("transform",e+s)}fit(t,i){var r=this.viewport(),e=parseInt(r.width),s=parseInt(r.height),n=t/e,h=i/s,o=n<h?n:h;this.layoutStyle("paginated"),this.width(e),this.height(s),this.overflow("hidden"),this.scaler(o,0,0),this.css("background-size",e*o+"px "+s*o+"px"),this.css("background-color","transparent")}direction(t){this.documentElement&&(this.documentElement.style.direction=t)}mapPage(t,i,r,e,s){return new $t(i,s).page(this,t,r,e)}linksHandler(){!function(t,i){var r=t.querySelectorAll("a[href]");if(r.length)for(var e=Q(t.ownerDocument,"base"),s=e?e.getAttribute("href"):void 0,n=function(t){var r=t.getAttribute("href");if(0!==r.indexOf("mailto:"))if(r.indexOf("://")>-1)t.setAttribute("target","_blank");else{var e;try{e=new yt(r,s)}catch(n){}t.onclick=function(){return i(e&&e.hash?e.Path.path+e.hash:e?e.Path.path:r),!1}}}.bind(this),h=0;h<r.length;h++)n(r[h])}(this.content,t=>{this.emit(Lt.CONTENTS.LINK_CLICKED,t)})}writingMode(t){let i=L("writing-mode");return t&&this.documentElement&&(this.documentElement.style[i]=t),this.window.getComputedStyle(this.documentElement)[i]||""}layoutStyle(t){return t&&(this._layoutStyle=t,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(t,i){return navigator.epubReadingSystem={name:t,version:i,layoutStyle:this.layoutStyle(),hasFeature:function(t){switch(t){case"dom-manipulation":case"layout-changes":case"touch-events":case"mouse-events":case"keyboard-events":return!0;case"spine-scripting":default:return!1}}},navigator.epubReadingSystem}destroy(){this.observer&&this.observer.disconnect(),this.document.removeEventListener("transitionend",this._resizeCheck),this.removeListeners()}}j(Vt.prototype);class Qt{constructor(t){this.rendition=t,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(t,i,r,e,s,n){let h=encodeURI(i+t),o=new At(i).spinePos,a=new ti({type:t,cfiRange:i,data:r,sectionIndex:o,cb:e,className:s,styles:n});return this._annotations[h]=a,o in this._annotationsBySectionIndex?this._annotationsBySectionIndex[o].push(h):this._annotationsBySectionIndex[o]=[h],this.rendition.views().forEach(t=>{a.sectionIndex===t.index&&a.attach(t)}),a}remove(t,i){let r=encodeURI(t+i);if(r in this._annotations){let t=this._annotations[r];if(i&&t.type!==i)return;this.rendition.views().forEach(i=>{this._removeFromAnnotationBySectionIndex(t.sectionIndex,r),t.sectionIndex===i.index&&t.detach(i)}),delete this._annotations[r]}}_removeFromAnnotationBySectionIndex(t,i){this._annotationsBySectionIndex[t]=this._annotationsAt(t).filter(t=>t!==i)}_annotationsAt(t){return this._annotationsBySectionIndex[t]}highlight(t,i,r,e,s){return this.add("highlight",t,i,r,e,s)}underline(t,i,r,e,s){return this.add("underline",t,i,r,e,s)}mark(t,i,r){return this.add("mark",t,i,r)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(t){let i=t.index;i in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[i].forEach(i=>{this._annotations[i].attach(t)})}clear(t){let i=t.index;i in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[i].forEach(i=>{this._annotations[i].detach(t)})}show(){}hide(){}}class ti{constructor({type:t,cfiRange:i,data:r,sectionIndex:e,cb:s,className:n,styles:h}){this.type=t,this.cfiRange=i,this.data=r,this.sectionIndex=e,this.mark=void 0,this.cb=s,this.className=n,this.styles=h}update(t){this.data=t}attach(t){let i,{cfiRange:r,data:e,type:s,cb:n,className:h,styles:o}=this;return"highlight"===s?i=t.highlight(r,e,n,h,o):"underline"===s?i=t.underline(r,e,n,h,o):"mark"===s&&(i=t.mark(r,e,n)),this.mark=i,this.emit(Lt.ANNOTATION.ATTACH,i),i}detach(t){let i,{cfiRange:r,type:e}=this;return t&&("highlight"===e?i=t.unhighlight(r):"underline"===e?i=t.ununderline(r):"mark"===e&&(i=t.unmark(r))),this.mark=void 0,this.emit(Lt.ANNOTATION.DETACH,i),i}text(){}}j(ti.prototype);var ii=h((function(t,i){function r(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}Object.defineProperty(i,"__esModule",{value:!0}),i.createElement=r,i.default={createElement:r}}));n(ii);var ri=h((function(t,i){function r(t,i){function r(r){for(var n=i.length-1;n>=0;n--){var h=i[n],o=r.clientX,a=r.clientY;if(r.touches&&r.touches.length&&(o=r.touches[0].clientX,a=r.touches[0].clientY),s(h,t,o,a)){h.dispatchEvent(e(r));break}}}if("iframe"===t.nodeName||"IFRAME"===t.nodeName)try{this.target=t.contentDocument}catch(Xh){this.target=t}else this.target=t;for(var n=["mouseup","mousedown","click","touchstart"],h=0;h<n.length;h++)this.target.addEventListener(n[h],(function(t){return r(t)}),!1)}function e(t){var i=Object.assign({},t,{bubbles:!1});try{return new MouseEvent(t.type,i)}catch(Xh){var r=document.createEvent("MouseEvents");return r.initMouseEvent(t.type,!1,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget),r}}function s(t,i,r,e){var s=i.getBoundingClientRect();function n(t,i,r){var e=t.top-s.top,n=t.left-s.left;return e<=r&&n<=i&&e+t.height>r&&n+t.width>i}if(!n(t.getBoundingClientRect(),r,e))return!1;for(var h=t.getClientRects(),o=0,a=h.length;o<a;o++)if(n(h[o],r,e))return!0;return!1}Object.defineProperty(i,"__esModule",{value:!0}),i.proxyMouse=r,i.clone=e,i.default={proxyMouse:r}}));n(ri);var ei=h((function(t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Underline=i.Highlight=i.Mark=i.Pane=void 0;var r=function(){function t(t,i){for(var r=0;r<i.length;r++){var e=i[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(i,r,e){return r&&t(i.prototype,r),e&&t(i,e),i}}(),e=n(ii),s=n(ri);function n(t){return t&&t.__esModule?t:{default:t}}function h(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}function o(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}function a(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}i.Pane=function(){function t(i){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;a(this,t),this.target=i,this.element=e.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),s.default.proxyMouse(this.target,this.marks),this.container=r,this.container.appendChild(this.element),this.render()}return r(t,[{key:"addMark",value:function(t){var i=e.default.createElement("g");return this.element.appendChild(i),t.bind(i,this.container),this.marks.push(t),t.render(),t}},{key:"removeMark",value:function(t){var i=this.marks.indexOf(t);if(-1!==i){var r=t.unbind();this.element.removeChild(r),this.marks.splice(i,1)}}},{key:"render",value:function(){var t,i,r,e;!function(t,i){t.style.setProperty("top",i.top+"px","important"),t.style.setProperty("left",i.left+"px","important"),t.style.setProperty("height",i.height+"px","important"),t.style.setProperty("width",i.width+"px","important")}(this.element,(t=this.target,i=this.container,r=i.getBoundingClientRect(),e=t.getBoundingClientRect(),{top:e.top-r.top,left:e.left-r.left,height:t.scrollHeight,width:t.scrollWidth}));var s=!0,n=!1,h=void 0;try{for(var o,a=this.marks[Symbol.iterator]();!(s=(o=a.next()).done);s=!0)o.value.render()}catch(Xh){n=!0,h=Xh}finally{try{!s&&a.return&&a.return()}finally{if(n)throw h}}}}]),t}();var u=i.Mark=function(){function t(){a(this,t),this.element=null}return r(t,[{key:"bind",value:function(t,i){this.element=t,this.container=i}},{key:"unbind",value:function(){var t=this.element;return this.element=null,t}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(t){this.element&&this.element.dispatchEvent(t)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var t=[],i=this.element.firstChild;i;)t.push(i.getBoundingClientRect()),i=i.nextSibling;return t}},{key:"filteredRanges",value:function(){var t=Array.from(this.range.getClientRects());return t.filter((function(i){for(var r=0;r<t.length;r++){if(t[r]===i)return!0;if((s=i).right<=(e=t[r]).right&&s.left>=e.left&&s.top>=e.top&&s.bottom<=e.bottom)return!1}var e,s;return!0}))}}]),t}(),f=i.Highlight=function(t){function i(t,r,e,s){a(this,i);var n=h(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return n.range=t,n.className=r,n.data=e||{},n.attributes=s||{},n}return o(i,t),r(i,[{key:"bind",value:function(t,r){for(var e in function t(i,r,e){null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,r);if(void 0===s){var n=Object.getPrototypeOf(i);return null===n?void 0:t(n,r,e)}if("value"in s)return s.value;var h=s.get;return void 0!==h?h.call(e):void 0}(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"bind",this).call(this,t,r),this.data)this.data.hasOwnProperty(e)&&(this.element.dataset[e]=this.data[e]);for(var e in this.attributes)this.attributes.hasOwnProperty(e)&&this.element.setAttribute(e,this.attributes[e]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var t=this.element.ownerDocument.createDocumentFragment(),i=this.filteredRanges(),r=this.element.getBoundingClientRect(),s=this.container.getBoundingClientRect(),n=0,h=i.length;n<h;n++){var o=i[n],a=e.default.createElement("rect");a.setAttribute("x",o.left-r.left+s.left),a.setAttribute("y",o.top-r.top+s.top),a.setAttribute("height",o.height),a.setAttribute("width",o.width),t.appendChild(a)}this.element.appendChild(t)}}]),i}(u);i.Underline=function(t){function i(t,r,e,s){return a(this,i),h(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,r,e,s))}return o(i,t),r(i,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var t=this.element.ownerDocument.createDocumentFragment(),i=this.filteredRanges(),r=this.element.getBoundingClientRect(),s=this.container.getBoundingClientRect(),n=0,h=i.length;n<h;n++){var o=i[n],a=e.default.createElement("rect");a.setAttribute("x",o.left-r.left+s.left),a.setAttribute("y",o.top-r.top+s.top),a.setAttribute("height",o.height),a.setAttribute("width",o.width),a.setAttribute("fill","none");var u=e.default.createElement("line");u.setAttribute("x1",o.left-r.left+s.left),u.setAttribute("x2",o.left-r.left+s.left+o.width),u.setAttribute("y1",o.top-r.top+s.top+o.height-1),u.setAttribute("y2",o.top-r.top+s.top+o.height-1),u.setAttribute("stroke-width",1),u.setAttribute("stroke","black"),u.setAttribute("stroke-linecap","square"),t.appendChild(a),t.appendChild(u)}this.element.appendChild(t)}}]),i}(f)}));n(ei);var si=ei.Underline,ni=ei.Highlight,hi=ei.Pane;class oi{constructor(t,i){this.settings=_({ignoreClass:"",axis:i.layout&&"scrolled"===i.layout.props.flow?"vertical":"horizontal",direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0},i||{}),this.id="epubjs-view-"+N(),this.section=t,this.index=t.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new At,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(t){var i=document.createElement("div");return i.classList.add("epub-view"),i.style.height="0px",i.style.width="0px",i.style.overflow="hidden",i.style.position="relative",i.style.display="block",i.style.flex=t&&"horizontal"==t?"none":"initial",i}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=B(this.element),this.supportsSrcdoc="srcdoc"in this.iframe,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(t,i){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(t)),this.sectionRender.then(function(t){return this.load(t)}.bind(this)).then(function(){this.layout.format(this.contents);let t=0===this.contents.writingMode().indexOf("vertical")?"vertical":"horizontal";return this.setAxis(t),this.emit(Lt.VIEWS.AXIS,t),this.addListeners(),new Promise(t=>{this.expand(),t()})}.bind(this),function(t){return this.emit(Lt.VIEWS.LOAD_ERROR,t),new Promise((i,r)=>{r(t)})}.bind(this)).then(function(){this.emit(Lt.VIEWS.RENDERED,this.section)}.bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(t,i){var r=t||this.settings.width,e=i||this.settings.height;this.lock("pre-paginated"===this.layout.name?"both":"horizontal"===this.settings.axis?"height":"width",r,e),this.settings.width=r,this.settings.height=e}lock(t,i,r){var e,s=D(this.element);e=this.iframe?D(this.iframe):{width:0,height:0},"width"==t&&M(i)&&(this.lockedWidth=i-s.width-e.width),"height"==t&&M(r)&&(this.lockedHeight=r-s.height-e.height),"both"===t&&M(i)&&M(r)&&(this.lockedWidth=i-s.width-e.width,this.lockedHeight=r-s.height-e.height),this.displayed&&this.iframe&&this.expand()}expand(t){var i=this.lockedWidth,r=this.lockedHeight;this.iframe&&!this._expanding&&(this._expanding=!0,"pre-paginated"===this.layout.name?(i=this.layout.columnWidth,r=this.layout.height):"horizontal"===this.settings.axis?((i=this.contents.textWidth())%this.layout.pageWidth>0&&(i=Math.ceil(i/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&this.layout.divisor>1&&"reflowable"===this.layout.name&&i/this.layout.pageWidth%2>0&&(i+=this.layout.pageWidth)):"vertical"===this.settings.axis&&(r=this.contents.textHeight()),(this._needsReframe||i!=this._width||r!=this._height)&&this.reframe(i,r),this._expanding=!1)}reframe(t,i){var r;M(t)&&(this.element.style.width=t+"px",this.iframe.style.width=t+"px",this._width=t),M(i)&&(this.element.style.height=i+"px",this.iframe.style.height=i+"px",this._height=i),r={width:t,height:i,widthDelta:this.prevBounds?t-this.prevBounds.width:t,heightDelta:this.prevBounds?i-this.prevBounds.height:i},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let t;for(let i in this.marks)this.marks.hasOwnProperty(i)&&this.placeMark((t=this.marks[i]).element,t.range)}),this.onResize(this,r),this.emit(Lt.VIEWS.RESIZED,r),this.prevBounds=r,this.elementBounds=B(this.element)}load(t){var i=new ht,r=i.promise;if(!this.iframe)return i.reject(new Error("No Iframe Available")),r;if(this.iframe.onload=function(t){this.onLoad(t,i)}.bind(this),"blobUrl"===this.settings.method)this.blobUrl=X(t,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if("srcdoc"===this.settings.method)this.iframe.srcdoc=t,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return i.reject(new Error("No Document Available")),r;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var e=this;MSApp.execUnsafeLocalFunction((function(){e.iframe.contentDocument.write(t)}))}else this.iframe.contentDocument.write(t);this.iframe.contentDocument.close()}return r}onLoad(t,i){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new Vt(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var r=this.document.querySelector("link[rel='canonical']");r?r.setAttribute("href",this.section.canonical):((r=this.document.createElement("link")).setAttribute("rel","canonical"),r.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(r)),this.contents.on(Lt.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(Lt.CONTENTS.RESIZE,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),i.resolve(this.contents)}setLayout(t){this.layout=t,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(t){"scrolled"===this.layout.props.flow&&(t="vertical"),this.settings.axis=t,this.element.style.flex="horizontal"==t?"none":"initial",this.size()}addListeners(){}removeListeners(t){}display(t){var i=new ht;return this.displayed?i.resolve(this):this.render(t).then(function(){this.emit(Lt.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,i.resolve(this)}.bind(this),(function(t){i.reject(t,this)})),i.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.style.transform=null),this.emit(Lt.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(Lt.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(t){this.iframe.getBoundingClientRect();var i=this.contents.locationOf(t,this.settings.ignoreClass);return{left:i.left,top:i.top}}onDisplayed(t){}onResize(t,i){}bounds(t){return!t&&this.elementBounds||(this.elementBounds=B(this.element)),this.elementBounds}highlight(t,i={},r,e="epubjs-hl",s={}){if(!this.contents)return;const n=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},s);let h=this.contents.range(t),o=()=>{this.emit(Lt.VIEWS.MARK_CLICKED,t,i)};i.epubcfi=t,this.pane||(this.pane=new hi(this.iframe,this.element));let a=new ni(h,e,i,n),u=this.pane.addMark(a);return this.highlights[t]={mark:u,element:u.element,listeners:[o,r]},u.element.setAttribute("ref",e),u.element.addEventListener("click",o),u.element.addEventListener("touchstart",o),r&&(u.element.addEventListener("click",r),u.element.addEventListener("touchstart",r)),u}underline(t,i={},r,e="epubjs-ul",s={}){if(!this.contents)return;const n=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},s);let h=this.contents.range(t),o=()=>{this.emit(Lt.VIEWS.MARK_CLICKED,t,i)};i.epubcfi=t,this.pane||(this.pane=new hi(this.iframe,this.element));let a=new si(h,e,i,n),u=this.pane.addMark(a);return this.underlines[t]={mark:u,element:u.element,listeners:[o,r]},u.element.setAttribute("ref",e),u.element.addEventListener("click",o),u.element.addEventListener("touchstart",o),r&&(u.element.addEventListener("click",r),u.element.addEventListener("touchstart",r)),u}mark(t,i={},r){if(!this.contents)return;if(t in this.marks)return this.marks[t];let e=this.contents.range(t);if(!e)return;let s=e.commonAncestorContainer,n=1===s.nodeType?s:s.parentNode,h=()=>{this.emit(Lt.VIEWS.MARK_CLICKED,t,i)};e.collapsed&&1===s.nodeType?(e=new Range).selectNodeContents(s):e.collapsed&&(e=new Range).selectNodeContents(n);let o=this.document.createElement("a");return o.setAttribute("ref","epubjs-mk"),o.style.position="absolute",o.dataset.epubcfi=t,i&&Object.keys(i).forEach(t=>{o.dataset[t]=i[t]}),r&&(o.addEventListener("click",r),o.addEventListener("touchstart",r)),o.addEventListener("click",h),o.addEventListener("touchstart",h),this.placeMark(o,e),this.element.appendChild(o),this.marks[t]={element:o,range:e,listeners:[h,r]},n}placeMark(t,i){let r,e,s;if("pre-paginated"===this.layout.name||"horizontal"!==this.settings.axis){let t=i.getBoundingClientRect();r=t.top,e=t.right}else{let t,h=i.getClientRects();for(var n=0;n!=h.length;n++)t=h[n],(!s||t.left<s)&&(s=t.left,e=Math.ceil(s/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,r=t.top)}t.style.top=`${r}px`,t.style.left=`${e}px`}unhighlight(t){let i;t in this.highlights&&(this.pane.removeMark((i=this.highlights[t]).mark),i.listeners.forEach(t=>{t&&(i.element.removeEventListener("click",t),i.element.removeEventListener("touchstart",t))}),delete this.highlights[t])}ununderline(t){let i;t in this.underlines&&(this.pane.removeMark((i=this.underlines[t]).mark),i.listeners.forEach(t=>{t&&(i.element.removeEventListener("click",t),i.element.removeEventListener("touchstart",t))}),delete this.underlines[t])}unmark(t){let i;t in this.marks&&(this.element.removeChild((i=this.marks[t]).element),i.listeners.forEach(t=>{t&&(i.element.removeEventListener("click",t),i.element.removeEventListener("touchstart",t))}),delete this.marks[t])}destroy(){for(let t in this.highlights)this.unhighlight(t);for(let t in this.underlines)this.ununderline(t);for(let t in this.marks)this.unmark(t);this.blobUrl&&J(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}j(oi.prototype);var ai=function(t){var i=typeof t;return null!=t&&("object"==i||"function"==i)},ui="object"==typeof s&&s&&s.Object===Object&&s,fi="object"==typeof self&&self&&self.Object===Object&&self,ci=ui||fi||Function("return this")(),li=function(){return ci.Date.now()},di=ci.Symbol,vi=Object.prototype,pi=vi.hasOwnProperty,wi=vi.toString,mi=di?di.toStringTag:void 0,bi=Object.prototype.toString,gi=di?di.toStringTag:void 0,yi=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":gi&&gi in Object(t)?function(t){var i=pi.call(t,mi),r=t[mi];try{t[mi]=void 0;var e=!0}catch(n){}var s=wi.call(t);return e&&(i?t[mi]=r:delete t[mi]),s}(t):function(t){return bi.call(t)}(t)},xi=/^\s+|\s+$/g,ki=/^[-+]0x[0-9a-f]+$/i,Ei=/^0b[01]+$/i,Ai=/^0o[0-7]+$/i,Ti=parseInt,Si=function(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return null!=t&&"object"==typeof t}(t)&&"[object Symbol]"==yi(t)}(t))return NaN;if(ai(t)){var i="function"==typeof t.valueOf?t.valueOf():t;t=ai(i)?i+"":i}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(xi,"");var r=Ei.test(t);return r||Ai.test(t)?Ti(t.slice(2),r?2:8):ki.test(t)?NaN:+t},ji=Math.max,Oi=Math.min,Ri=function(t,i,r){var e,s,n,h,o,a,u=0,f=!1,c=!1,l=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function d(i){var r=e,n=s;return e=s=void 0,u=i,h=t.apply(n,r)}function v(t){var r=t-a;return void 0===a||r>=i||r<0||c&&t-u>=n}function p(){var t=li();if(v(t))return w(t);o=setTimeout(p,function(t){var r=i-(t-a);return c?Oi(r,n-(t-u)):r}(t))}function w(t){return o=void 0,l&&e?d(t):(e=s=void 0,h)}function m(){var t=li(),r=v(t);if(e=arguments,s=this,a=t,r){if(void 0===o)return function(t){return u=t,o=setTimeout(p,i),f?d(t):h}(a);if(c)return clearTimeout(o),o=setTimeout(p,i),d(a)}return void 0===o&&(o=setTimeout(p,i)),h}return i=Si(i)||0,ai(r)&&(f=!!r.leading,n=(c="maxWait"in r)?ji(Si(r.maxWait)||0,i):n,l="trailing"in r?!!r.trailing:l),m.cancel=function(){void 0!==o&&clearTimeout(o),u=0,e=a=s=o=void 0},m.flush=function(){return void 0===o?h:w(li())},m},Ci=function(t,i,r){var e=!0,s=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return ai(r)&&(e="leading"in r?!!r.leading:e,s="trailing"in r?!!r.trailing:s),Ri(t,i,{leading:e,maxWait:i,trailing:s})};class Ni{constructor(t){this.settings=t||{},this.id="epubjs-container-"+N(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(t){let i=t.height,r=t.width,e=t.overflow||!1,s=t.axis||"vertical",n=t.direction;_(this.settings,t),t.height&&M(t.height)&&(i=t.height+"px"),t.width&&M(t.width)&&(r=t.width+"px");let h=document.createElement("div");return h.id=this.id,h.classList.add("epub-container"),h.style.wordSpacing="0",h.style.lineHeight="0",h.style.verticalAlign="top",h.style.position="relative","horizontal"===s&&(h.style.display="flex",h.style.flexDirection="row",h.style.flexWrap="nowrap"),r&&(h.style.width=r),i&&(h.style.height=i),e&&("scroll"===e&&"vertical"===s?(h.style["overflow-y"]=e,h.style["overflow-x"]="hidden"):"scroll"===e&&"horizontal"===s?(h.style["overflow-y"]="hidden",h.style["overflow-x"]=e):h.style.overflow=e),n&&(h.dir=n,h.style.direction=n),n&&this.settings.fullsize&&(document.body.style.direction=n),h}wrap(t){var i=document.createElement("div");return i.style.visibility="hidden",i.style.overflow="hidden",i.style.width="0",i.style.height="0",i.appendChild(t),i}getElement(t){var i;if(z(t)?i=t:"string"==typeof t&&(i=document.getElementById(t)),!i)throw new Error("Not an Element");return i}attachTo(t){var i=this.getElement(t);if(i)return i.appendChild(this.settings.hidden?this.wrapper:this.container),this.element=i,i}getContainer(){return this.container}onResize(t){M(this.settings.width)&&M(this.settings.height)||(this.resizeFunc=Ci(t,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(t){this.orientationChangeFunc=t,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(t,i){var r;let e=t||this.settings.width,s=i||this.settings.height;null===t?(r=this.element.getBoundingClientRect()).width&&(t=Math.floor(r.width),this.container.style.width=t+"px"):this.container.style.width=M(t)?t+"px":t,null===i?(r=r||this.element.getBoundingClientRect()).height&&(this.container.style.height=(i=r.height)+"px"):this.container.style.height=M(i)?i+"px":i,M(t)||(t=this.container.clientWidth),M(i)||(i=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let n=q(),h=window.getComputedStyle(document.body),o=parseFloat(h["padding-left"])||0,a=parseFloat(h["padding-right"])||0,u=parseFloat(h["padding-top"])||0,f=parseFloat(h["padding-bottom"])||0;return e||(t=n.width-o-a),(this.settings.fullsize&&!s||!s)&&(i=n.height-u-f),{width:t-this.containerPadding.left-this.containerPadding.right,height:i-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let t;return"visible"!==this.container.style.overflow&&(t=this.container&&this.container.getBoundingClientRect()),t&&t.width&&t.height?t:q()}getSheet(){var t=document.createElement("style");return t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet}addStyleRules(t,i){var r="#"+this.id+" ",e="";this.sheet||(this.sheet=this.getSheet()),i.forEach((function(t){for(var i in t)t.hasOwnProperty(i)&&(e+=i+":"+t[i]+";")})),this.sheet.insertRule(r+t+" {"+e+"}",0)}axis(t){"horizontal"===t?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=t}direction(t){this.container&&(this.container.dir=t,this.container.style.direction=t),this.settings.fullsize&&(document.body.style.direction=t),this.settings.dir=t}overflow(t){this.container&&("scroll"===t&&"vertical"===this.settings.axis?(this.container.style["overflow-y"]=t,this.container.style["overflow-x"]="hidden"):"scroll"===t&&"horizontal"===this.settings.axis?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=t):this.container.style.overflow=t),this.settings.overflow=t}destroy(){this.element&&(this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}class zi{constructor(t){this.container=t,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(t){return this._views.indexOf(t)}slice(){return this._views.slice.apply(this._views,arguments)}get(t){return this._views[t]}append(t){return this._views.push(t),this.container&&this.container.appendChild(t.element),this.length++,t}prepend(t){return this._views.unshift(t),this.container&&this.container.insertBefore(t.element,this.container.firstChild),this.length++,t}insert(t,i){return this._views.splice(i,0,t),this.container&&(i<this.container.children.length?this.container.insertBefore(t.element,this.container.children[i]):this.container.appendChild(t.element)),this.length++,t}remove(t){var i=this._views.indexOf(t);i>-1&&this._views.splice(i,1),this.destroy(t),this.length--}destroy(t){t.displayed&&t.destroy(),this.container&&this.container.removeChild(t.element),t=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var t=this.length;if(this.length){for(var i=0;i<t;i++)this.destroy(this._views[i]);this._views=[],this.length=0}}find(t){for(var i,r=this.length,e=0;e<r;e++)if((i=this._views[e]).displayed&&i.section.index==t.index)return i}displayed(){for(var t,i=[],r=this.length,e=0;e<r;e++)(t=this._views[e]).displayed&&i.push(t);return i}show(){for(var t,i=this.length,r=0;r<i;r++)(t=this._views[r]).displayed&&t.show();this.hidden=!1}hide(){for(var t,i=this.length,r=0;r<i;r++)(t=this._views[r]).displayed&&t.hide();this.hidden=!0}}class Mi{constructor(t){this.name="default",this.optsSettings=t.settings,this.View=t.view,this.request=t.request,this.renditionQueue=t.queue,this.q=new zt(this),this.settings=_(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0}),_(this.settings,t.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0},this.rendered=!1}render(t,i){let r=t.tagName;void 0!==this.settings.fullsize||!r||"body"!=r.toLowerCase()&&"html"!=r.toLowerCase()||(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=i,this.stage=new Ni({width:i.width,height:i.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(t),this.container=this.stage.getContainer(),this.views=new zi(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var t;window.addEventListener("unload",function(){this.destroy()}.bind(this)),t=this.settings.fullsize?window:this.container,this._onScroll=this.onScroll.bind(this),t.addEventListener("scroll",this._onScroll)}removeEventListeners(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(t){let{orientation:i}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout(function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(Lt.MANAGERS.ORIENTATION_CHANGE,i)}.bind(this),500)}onResized(t){this.resize()}resize(t,i,r){let e=this.stage.size(t,i);this.winBounds=q(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height?this._stageSize=void 0:this._stageSize&&this._stageSize.width===e.width&&this._stageSize.height===e.height||(this._stageSize=e,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(Lt.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},r))}createView(t){return new this.View(t,this.viewSettings)}display(t,i){var r=new ht,e=r.promise;(i===t.href||M(i))&&(i=void 0);var s=this.views.find(t);if(s&&t){let t=s.offset();if("ltr"===this.settings.direction)this.scrollTo(t.left,t.top,!0);else{let i=s.width();this.scrollTo(t.left+i,t.top,!0)}if(i){let t=s.locationOf(i);this.moveTo(t)}return r.resolve(),e}return this.clear(),this.add(t).then(function(t){if(i){let r=t.locationOf(i);this.moveTo(r)}}.bind(this),t=>{r.reject(t)}).then(function(){var i;if("pre-paginated"===this.layout.name&&this.layout.divisor>1&&t.index>0&&(i=t.next()))return this.add(i)}.bind(this)).then(function(){this.views.show(),r.resolve()}.bind(this)),e}afterDisplayed(t){this.emit(Lt.MANAGERS.ADDED,t)}afterResized(t){this.emit(Lt.MANAGERS.RESIZE,t.section)}moveTo(t){var i=0,r=0;this.isPaginated?(i=Math.floor(t.left/this.layout.delta)*this.layout.delta)+this.layout.delta>this.container.scrollWidth&&(i=this.container.scrollWidth-this.layout.delta):r=t.top,this.scrollTo(i,r,!0)}add(t){var i=this.createView(t);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(Lt.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.display(this.request)}append(t){var i=this.createView(t);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(Lt.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.display(this.request)}prepend(t){var i=this.createView(t);return i.on(Lt.VIEWS.RESIZED,t=>{this.counter(t)}),this.views.prepend(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(Lt.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.display(this.request)}counter(t){"vertical"===this.settings.axis?this.scrollBy(0,t.heightDelta,!0):this.scrollBy(t.widthDelta,0,!0)}next(){var t;let i=this.settings.direction;if(this.views.length)return!this.isPaginated||"horizontal"!==this.settings.axis||i&&"ltr"!==i?this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===i?(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft>0?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):t=this.views.last().section.next()):t=this.views.last().section.next():(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft+this.container.offsetWidth+this.layout.delta<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next()),t?(this.clear(),this.append(t).then(function(){var i;if("pre-paginated"===this.layout.name&&this.layout.divisor>1&&(i=t.next()))return this.append(i)}.bind(this),t=>t).then(function(){this.views.show()}.bind(this))):void 0}prev(){var t;let i=this.settings.direction;if(this.views.length)return!this.isPaginated||"horizontal"!==this.settings.axis||i&&"ltr"!==i?this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===i?(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft+this.container.offsetWidth+this.layout.delta<=this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):t=this.views.first().section.prev()):t=this.views.first().section.prev():(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft>0?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev()),t?(this.clear(),this.prepend(t).then(function(){var i;if("pre-paginated"===this.layout.name&&this.layout.divisor>1&&(i=t.prev()))return this.prepend(i)}.bind(this),t=>t).then(function(){this.isPaginated&&"horizontal"===this.settings.axis&&this.scrollTo("rtl"===this.settings.direction?0:this.container.scrollWidth-this.layout.delta,0,!0),this.views.show()}.bind(this))):void 0}current(){var t=this.visible();return t.length?t[t.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.location="vertical"===this.settings.axis?this.scrolledLocation():this.paginatedLocation(),this.location}scrolledLocation(){let t=this.visible(),i=this.container.getBoundingClientRect(),r=i.height<window.innerHeight?i.height:window.innerHeight,e=0,s=0;return this.settings.fullsize&&(e=window.scrollY),t.map(t=>{let{index:n,href:h}=t.section,o=t.position(),a=t.height(),u=e+i.top-o.top+s,f=u+r-s;f>a&&(s=(f=a)-u);let c=this.layout.count(a,r).pages,l=Math.ceil(u/r),d=[],v=Math.ceil(f/r);d=[];for(var p=l;p<=v;p++)d.push(p+1);return{index:n,href:h,pages:d,totalPages:c,mapping:this.mapping.page(t.contents,t.section.cfiBase,u,f)}})}paginatedLocation(){let t=this.visible(),i=this.container.getBoundingClientRect(),r=0;return this.settings.fullsize&&(r=window.scrollX),t.map(t=>{let{index:e,href:s}=t.section,n=(t.offset(),t.position().left),h=t.width(),o=r+i.left-n+0,a=o+this.layout.width-0,u=this.mapping.page(t.contents,t.section.cfiBase,o,a),f=this.layout.count(h).pages,c=Math.floor(o/this.layout.pageWidth),l=[],d=Math.floor(a/this.layout.pageWidth);if(c<0&&(c=0,d+=1),"rtl"===this.settings.direction){let t=c;c=f-d,d=f-t}for(var v=c+1;v<=d;v++)l.push(v);return{index:e,href:s,pages:l,totalPages:f,mapping:u}})}isVisible(t,i,r,e){var s=t.position(),n=e||this.bounds();return"horizontal"===this.settings.axis&&s.right>n.left-i&&s.left<n.right+r||"vertical"===this.settings.axis&&s.bottom>n.top-i&&s.top<n.bottom+r}visible(){for(var t,i=this.bounds(),r=this.views.displayed(),e=r.length,s=[],n=0;n<e;n++)!0===this.isVisible(t=r[n],0,0,i)&&s.push(t);return s}scrollBy(t,i,r){let e="rtl"===this.settings.direction?-1:1;r&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(t*e,i*e):(t&&(this.container.scrollLeft+=t*e),i&&(this.container.scrollTop+=i)),this.scrolled=!0}scrollTo(t,i,r){r&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(t,i):(this.container.scrollLeft=t,this.container.scrollTop=i),this.scrolled=!0}onScroll(){let t,i;this.settings.fullsize?(t=window.scrollY,i=window.scrollX):(t=this.container.scrollTop,i=this.container.scrollLeft),this.scrollTop=t,this.scrollLeft=i,this.ignore?this.ignore=!1:(this.emit(Lt.MANAGERS.SCROLL,{top:t,left:i}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.emit(Lt.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20))}bounds(){return this.stage.bounds()}applyLayout(t){this.layout=t,this.updateLayout()}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(t){this.viewSettings.layout=t,this.mapping=new $t(t.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach((function(i){i&&i.setLayout(t)}))}updateAxis(t,i){this.isPaginated||(t="vertical"),(i||t!==this.settings.axis)&&(this.settings.axis=t,this.stage&&this.stage.axis(t),this.viewSettings.axis=t,this.mapping&&(this.mapping=new $t(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&this.layout.spread("vertical"===t?"none":this.layout.settings.spread))}updateFlow(t,i="auto"){let r="paginated"===t||"auto"===t;this.isPaginated=r,this.updateAxis("scrolled-doc"===t||"scrolled-continuous"===t||"scrolled"===t?"vertical":"horizontal"),this.viewSettings.flow=t,this.overflow=this.settings.overflow?this.settings.overflow:r?"hidden":i,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var t=[];return this.views?(this.views.forEach((function(i){const r=i&&i.contents;r&&t.push(r)})),t):t}direction(t="ltr"){this.settings.direction=t,this.stage&&this.stage.direction(t),this.viewSettings.direction=t,this.updateLayout()}isRendered(){return this.rendered}}j(Mi.prototype);const Ii=Math.PI/2,Li={easeOutSine:function(t){return Math.sin(t*Ii)},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)},easeInCubic:function(t){return Math.pow(t,3)}};class Fi{constructor(t,i){this.settings=_({duration:80,minVelocity:.2,minDistance:10,easing:Li.easeInCubic},i||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(t)}setup(t){this.manager=t,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=2*this.settings.duration,this.isVertical="vertical"===this.manager.settings.axis,this.manager.isPaginated&&!this.isVertical&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(Lt.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(Lt.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(t){let i=t.contents;["touchstart","touchmove","touchend"].forEach(t=>{i.on(t,t=>this.triggerViewEvent(t,i))})}triggerViewEvent(t,i){this.emit(t.type,t,i)}onScroll(t){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(t){this.resizeCanceler=!0}onTouchStart(t){let{screenX:i,screenY:r}=t.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=i,this.startTouchY=r,this.startTime=this.now()),this.endTouchX=i,this.endTouchY=r,this.endTime=this.now()}onTouchMove(t){let{screenX:i,screenY:r}=t.touches[0],e=Math.abs(r-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&e<10&&(this.element.scrollLeft-=i-this.endTouchX),this.endTouchX=i,this.endTouchY=r,this.endTime=this.now()}onTouchEnd(t){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let i=this.wasSwiped();0!==i?this.snap(i):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let t=this.layout.pageWidth*this.layout.divisor,i=this.endTouchX-this.startTouchX,r=Math.abs(i),e=i/(this.endTime-this.startTime),s=this.settings.minVelocity;return r<=this.settings.minDistance||r>=t?0:e>s?-1:e<-s?1:void 0}needsSnap(){return this.scrollLeft%(this.layout.pageWidth*this.layout.divisor)!=0}snap(t=0){let i=this.layout.pageWidth*this.layout.divisor,r=Math.round(this.scrollLeft/i)*i;return t&&(r+=t*i),this.smoothScrollTo(r)}smoothScrollTo(t){const i=new ht,r=this.scrollLeft,e=this.now(),s=this.settings.duration,n=this.settings.easing;return this.snapping=!0,function h(){const o=this.now(),a=Math.min(1,(o-e)/s);if(n(a),this.touchCanceler||this.resizeCanceler)return this.resizeCanceler=!1,this.snapping=!1,void i.resolve();a<1?(window.requestAnimationFrame(h.bind(this)),this.scrollTo(r+(t-r)*a,0)):(this.scrollTo(t,0),this.snapping=!1,i.resolve())}.call(this),i.promise}scrollTo(t=0,i=0){this.fullsize?window.scroll(t,i):(this.scroller.scrollLeft=t,this.scroller.scrollTop=i)}now(){return"now"in window.performance?performance.now():(new Date).getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}j(Fi.prototype);class _i extends Mi{constructor(t){super(t),this.name="continuous",this.settings=_(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10}),_(this.settings,t.settings||{}),"undefined"!=t.settings.gap&&0===t.settings.gap&&(this.settings.gap=t.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1},this.scrollTop=0,this.scrollLeft=0}display(t,i){return Mi.prototype.display.call(this,t,i).then(function(){return this.fill()}.bind(this))}fill(t){var i=t||new ht;return this.q.enqueue(()=>this.check()).then(t=>{t?this.fill(i):i.resolve()}),i.promise}moveTo(t){var i=0,r=0;this.isPaginated?i=Math.floor(t.left/this.layout.delta)*this.layout.delta:r=t.top,(i>0||r>0)&&this.scrollBy(i,r,!0)}afterResized(t){this.emit(Lt.MANAGERS.RESIZE,t.section)}removeShownListeners(t){t.onDisplayed=function(){}}add(t){var i=this.createView(t);return this.views.append(i),i.on(Lt.VIEWS.RESIZED,()=>{i.expanded=!0}),i.on(Lt.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.display(this.request)}append(t){var i=this.createView(t);return i.on(Lt.VIEWS.RESIZED,()=>{i.expanded=!0}),i.on(Lt.VIEWS.AXIS,t=>{this.updateAxis(t)}),this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i}prepend(t){var i=this.createView(t);return i.on(Lt.VIEWS.RESIZED,t=>{this.counter(t),i.expanded=!0}),i.on(Lt.VIEWS.AXIS,t=>{this.updateAxis(t)}),this.views.prepend(i),i.onDisplayed=this.afterDisplayed.bind(this),i}counter(t){"vertical"===this.settings.axis?this.scrollBy(0,t.heightDelta,!0):this.scrollBy(t.widthDelta,0,!0)}update(t){for(var i,r=this.bounds(),e=this.views.all(),s=e.length,n=void 0!==t?t:this.settings.offset||0,h=new ht,o=[],a=0;a<s;a++)if(!0===this.isVisible(i=e[a],n,n,r))if(i.displayed)i.show();else{let t=i.display(this.request).then((function(t){t.show()}),()=>{i.hide()});o.push(t)}else this.q.enqueue(i.destroy.bind(i)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250);return o.length?Promise.all(o).catch(t=>{h.reject(t)}):(h.resolve(),h.promise)}check(t,i){var r=new ht,e=[],s="horizontal"===this.settings.axis,n=this.settings.offset||0;t&&s&&(n=t),i&&!s&&(n=i);var h=this._bounds;let o="rtl"===this.settings.direction;var a=s?this.scrollLeft:this.scrollTop*(s&&o?-1:1);let u=()=>{let t=this.views.first(),i=t&&t.section.prev();i&&e.push(this.prepend(i))},f=()=>{let t=this.views.last(),i=t&&t.section.next();i&&e.push(this.append(i))};a+(s?Math.floor(h.width):h.height)+n>=(s?this.container.scrollWidth:this.container.scrollHeight)&&(s&&o?u():f()),a-n<0&&(s&&o?f():u());let c=e.map(t=>t.displayed);return e.length?Promise.all(c).then(()=>{if("pre-paginated"===this.layout.name&&this.layout.props.spread)return this.check()}).then(()=>this.update(n),t=>t):(this.q.enqueue(function(){this.update()}.bind(this)),r.resolve(!1),r.promise)}trim(){for(var t=new ht,i=this.views.displayed(),r=i[i.length-1],e=this.views.indexOf(i[0]),s=this.views.indexOf(r),n=this.views.slice(0,e),h=this.views.slice(s+1),o=0;o<n.length-1;o++)this.erase(n[o],n);for(var a=1;a<h.length;a++)this.erase(h[a]);return t.resolve(),t.promise}erase(t,i){var r,e;this.settings.fullsize?(r=window.scrollY,e=window.scrollX):(r=this.container.scrollTop,e=this.container.scrollLeft);var s=t.bounds();this.views.remove(t),i&&("vertical"===this.settings.axis?this.scrollTo(0,r-s.height,!0):this.scrollTo(e-Math.floor(s.width),0,!0))}addEventListeners(t){window.addEventListener("unload",function(){this.ignore=!0,this.destroy()}.bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new Fi(this,this.settings.snap&&"object"==typeof this.settings.snap&&this.settings.snap))}addScrollListeners(){var t;this.tick=O,this.settings.fullsize?(this.prevScrollTop=window.scrollY,this.prevScrollLeft=window.scrollX):(this.prevScrollTop=this.container.scrollTop,this.prevScrollLeft=this.container.scrollLeft),this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(t=window,this.scrollTop=window.scrollY,this.scrollLeft=window.scrollX):(t=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),t.addEventListener("scroll",this._onScroll),this._scrolled=Ri(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let t,i,r="rtl"===this.settings.direction?-1:1;this.settings.fullsize?(t=window.scrollY*r,i=window.scrollX*r):(t=this.container.scrollTop,i=this.container.scrollLeft),this.scrollTop=t,this.scrollLeft=i,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(t-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(i-this.prevScrollLeft),this.prevScrollTop=t,this.prevScrollLeft=i,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}.bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue(function(){this.check()}.bind(this)),this.emit(Lt.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(Lt.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)}next(){this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy("pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue(function(){this.check()}.bind(this)))}prev(){this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(-("pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta),0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue(function(){this.check()}.bind(this)))}updateFlow(t){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(t,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new Fi(this,this.settings.snap&&"object"==typeof this.settings.snap&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}class Pi{constructor(t,i){this.settings=_(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1}),_(this.settings,i),"object"==typeof this.settings.manager&&(this.manager=this.settings.manager),this.book=t,this.hooks={},this.hooks.display=new Tt(this),this.hooks.serialize=new Tt(this),this.hooks.content=new Tt(this),this.hooks.unloaded=new Tt(this),this.hooks.layout=new Tt(this),this.hooks.render=new Tt(this),this.hooks.show=new Tt(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new Kt(this),this.annotations=new Qt(this),this.epubcfi=new At,this.q=new zt(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new ht,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(t){this.manager=t}requireManager(t){return"string"==typeof t&&"default"===t?Mi:"string"==typeof t&&"continuous"===t?_i:t}requireView(t){return"string"==typeof t&&"iframe"===t?oi:t}start(){this.settings.layout||"pre-paginated"!==this.book.package.metadata.layout&&"true"!==this.book.displayOptions.fixedLayout||(this.settings.layout="pre-paginated"),this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(Lt.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(Lt.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(Lt.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(Lt.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(Lt.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(Lt.RENDITION.STARTED),this.starting.resolve()}attachTo(t){return this.q.enqueue(function(){this.manager.render(t,{width:this.settings.width,height:this.settings.height}),this.emit(Lt.RENDITION.ATTACHED)}.bind(this))}display(t){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,t)}_display(t){if(this.book){this.epubcfi.isCfiString(t);var i,r=new ht,e=r.promise;return this.displaying=r,this.book.locations.length()&&I(t)&&(t=this.book.locations.cfiFromPercentage(parseFloat(t))),(i=this.book.spine.get(t))?(this.manager.display(i,t).then(()=>{r.resolve(i),this.displaying=void 0,this.emit(Lt.RENDITION.DISPLAYED,i),this.reportLocation()},t=>{this.emit(Lt.RENDITION.DISPLAY_ERROR,t)}),e):(r.reject(new Error("No Section Found")),e)}}afterDisplayed(t){t.on(Lt.VIEWS.MARK_CLICKED,(i,r)=>this.triggerMarkEvent(i,r,t.contents)),this.hooks.render.trigger(t,this).then(()=>{t.contents?this.hooks.content.trigger(t.contents,this).then(()=>{this.emit(Lt.RENDITION.RENDERED,t.section,t)}):this.emit(Lt.RENDITION.RENDERED,t.section,t)})}afterRemoved(t){this.hooks.unloaded.trigger(t,this).then(()=>{this.emit(Lt.RENDITION.REMOVED,t.section,t)})}onResized(t,i){this.emit(Lt.RENDITION.RESIZED,{width:t.width,height:t.height},i),this.location&&this.location.start&&this.display(i||this.location.start.cfi)}onOrientationChange(t){this.emit(Lt.RENDITION.ORIENTATION_CHANGE,t)}moveTo(t){this.manager.moveTo(t)}resize(t,i,r){t&&(this.settings.width=t),i&&(this.settings.height=i),this.manager.resize(t,i,r)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(t){return{layout:this.settings.layout||t.layout||"reflowable",spread:this.settings.spread||t.spread||"auto",orientation:this.settings.orientation||t.orientation||"auto",flow:this.settings.flow||t.flow||"auto",viewport:t.viewport||"",minSpreadWidth:this.settings.minSpreadWidth||t.minSpreadWidth||800,direction:this.settings.direction||t.direction||"ltr"}}flow(t){var i=t;"scrolled"!==t&&"scrolled-doc"!==t&&"scrolled-continuous"!==t||(i="scrolled"),"auto"!==t&&"paginated"!==t||(i="paginated"),this.settings.flow=t,this._layout&&this._layout.flow(i),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(i),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(t){return t&&(this._layout=new Ht(t),this._layout.spread(t.spread,this.settings.minSpreadWidth),this._layout.on(Lt.LAYOUT.UPDATED,(t,i)=>{this.emit(Lt.RENDITION.LAYOUT,t,i)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(t,i){this.settings.spread=t,i&&(this.settings.minSpreadWidth=i),this._layout&&this._layout.spread(t,i),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(t){this.settings.direction=t||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue(function(){requestAnimationFrame(function(){var t=this.manager.currentLocation();if(t&&t.then&&"function"==typeof t.then)t.then(function(t){let i=this.located(t);i&&i.start&&i.end&&(this.location=i,this.emit(Lt.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Lt.RENDITION.RELOCATED,this.location))}.bind(this));else if(t){let i=this.located(t);if(!i||!i.start||!i.end)return;this.location=i,this.emit(Lt.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Lt.RENDITION.RELOCATED,this.location)}}.bind(this))}.bind(this))}currentLocation(){var t=this.manager.currentLocation();if(t&&t.then&&"function"==typeof t.then)t.then(function(t){return this.located(t)}.bind(this));else if(t)return this.located(t)}located(t){if(!t.length)return{};let i=t[0],r=t[t.length-1],e={start:{index:i.index,href:i.href,cfi:i.mapping.start,displayed:{page:i.pages[0]||1,total:i.totalPages}},end:{index:r.index,href:r.href,cfi:r.mapping.end,displayed:{page:r.pages[r.pages.length-1]||1,total:r.totalPages}}},s=this.book.locations.locationFromCfi(i.mapping.start),n=this.book.locations.locationFromCfi(r.mapping.end);null!=s&&(e.start.location=s,e.start.percentage=this.book.locations.percentageFromLocation(s)),null!=n&&(e.end.location=n,e.end.percentage=this.book.locations.percentageFromLocation(n));let h=this.book.pageList.pageFromCfi(i.mapping.start),o=this.book.pageList.pageFromCfi(r.mapping.end);return-1!=h&&(e.start.page=h),-1!=o&&(e.end.page=o),r.index===this.book.spine.last().index&&e.end.displayed.page>=e.end.displayed.total&&(e.atEnd=!0),i.index===this.book.spine.first().index&&1===e.start.displayed.page&&(e.atStart=!0),e}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(t){It.forEach(i=>{t.on(i,i=>this.triggerViewEvent(i,t))}),t.on(Lt.CONTENTS.SELECTED,i=>this.triggerSelectedEvent(i,t))}triggerViewEvent(t,i){this.emit(t.type,t,i)}triggerSelectedEvent(t,i){this.emit(Lt.RENDITION.SELECTED,t,i)}triggerMarkEvent(t,i,r){this.emit(Lt.RENDITION.MARK_CLICKED,t,i,r)}getRange(t,i){var r=new At(t),e=this.manager.visible().filter((function(t){if(r.spinePos===t.index)return!0}));if(e.length)return e[0].contents.range(r,i)}adjustImages(t){if("pre-paginated"===this._layout.name)return new Promise((function(t){t()}));let i=t.window.getComputedStyle(t.content,null),r=.95*(t.content.offsetHeight-(parseFloat(i.paddingTop)+parseFloat(i.paddingBottom))),e=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight);return t.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-e+"px":"100%")+"!important","max-height":r+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-e+"px":"100%")+"!important","max-height":r+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise((function(t){setTimeout((function(){t()}),1)}))}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(t){t&&t.on(Lt.CONTENTS.LINK_CLICKED,t=>{let i=this.book.path.relative(t);this.display(i)})}injectStylesheet(t,i){let r=t.createElement("link");r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",this.settings.stylesheet),t.getElementsByTagName("head")[0].appendChild(r)}injectScript(t,i){let r=t.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",this.settings.script),r.textContent=" ",t.getElementsByTagName("head")[0].appendChild(r)}injectIdentifier(t,i){let r=this.book.packaging.metadata.identifier,e=t.createElement("meta");e.setAttribute("name","dc.relation.ispartof"),r&&e.setAttribute("content",r),t.getElementsByTagName("head")[0].appendChild(e)}}function Ui(t,i,r,e){var s,n="undefined"!=typeof window&&window.URL,h=n?"blob":"arraybuffer",o=new ht,a=new XMLHttpRequest,u=XMLHttpRequest.prototype;for(s in"overrideMimeType"in u||Object.defineProperty(u,"overrideMimeType",{value:function(){}}),r&&(a.withCredentials=!0),a.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var t=!1;if(""!==this.responseType&&"document"!==this.responseType||(t=this.responseXML),200===this.status||0===this.status||t){var r;if(!this.response&&!t)return o.reject({status:this.status,message:"Empty Response",stack:(new Error).stack}),o.promise;if(403===this.status)return o.reject({status:this.status,response:this.response,message:"Forbidden",stack:(new Error).stack}),o.promise;r=t?this.responseXML:K(i)?V(this.response,"text/xml"):"xhtml"==i?V(this.response,"application/xhtml+xml"):"html"==i||"htm"==i?V(this.response,"text/html"):"json"==i?JSON.parse(this.response):"blob"==i?n?this.response:new Blob([this.response]):this.response,o.resolve(r)}else o.reject({status:this.status,message:this.response,stack:(new Error).stack})}},a.onerror=function(t){o.reject(t)},a.open("GET",t,!0),e)a.setRequestHeader(s,e[s]);return"json"==i&&a.setRequestHeader("Accept","application/json"),i||(i=new gt(t).extension),"blob"==i&&(a.responseType=h),K(i)&&a.overrideMimeType("text/xml"),"binary"==i&&(a.responseType="arraybuffer"),a.send(),o.promise}j(Pi.prototype);const Bi="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};var Di=[],Zi=[],qi="undefined"!=typeof Uint8Array?Uint8Array:Array,Wi=!1;function Hi(){Wi=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,r=t.length;i<r;++i)Di[i]=t[i],Zi[t.charCodeAt(i)]=i;Zi["-".charCodeAt(0)]=62,Zi["_".charCodeAt(0)]=63}function Ki(t,i,r){for(var e,s=[],n=i;n<r;n+=3)s.push(Di[(e=(t[n]<<16)+(t[n+1]<<8)+t[n+2])>>18&63]+Di[e>>12&63]+Di[e>>6&63]+Di[63&e]);return s.join("")}function $i(t,i,r,e,s){var n,h,o=8*s-e-1,a=(1<<o)-1,u=a>>1,f=-7,c=r?s-1:0,l=r?-1:1,d=t[i+c];for(c+=l,n=d&(1<<-f)-1,d>>=-f,f+=o;f>0;n=256*n+t[i+c],c+=l,f-=8);for(h=n&(1<<-f)-1,n>>=-f,f+=e;f>0;h=256*h+t[i+c],c+=l,f-=8);if(0===n)n=1-u;else{if(n===a)return h?NaN:1/0*(d?-1:1);h+=Math.pow(2,e),n-=u}return(d?-1:1)*h*Math.pow(2,n-e)}function Xi(t,i,r,e,s,n){var h,o,a,u=8*n-s-1,f=(1<<u)-1,c=f>>1,l=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,d=e?0:n-1,v=e?1:-1,p=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(o=isNaN(i)?1:0,h=f):(h=Math.floor(Math.log(i)/Math.LN2),i*(a=Math.pow(2,-h))<1&&(h--,a*=2),(i+=h+c>=1?l/a:l*Math.pow(2,1-c))*a>=2&&(h++,a/=2),h+c>=f?(o=0,h=f):h+c>=1?(o=(i*a-1)*Math.pow(2,s),h+=c):(o=i*Math.pow(2,c-1)*Math.pow(2,s),h=0));s>=8;t[r+d]=255&o,d+=v,o/=256,s-=8);for(h=h<<s|o,u+=s;u>0;t[r+d]=255&h,d+=v,h/=256,u-=8);t[r+d-v]|=128*p}var Ji={}.toString,Yi=Array.isArray||function(t){return"[object Array]"==Ji.call(t)};function Gi(){return Qi.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Vi(t,i){if(Gi()<i)throw new RangeError("Invalid typed array length");return Qi.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(i)).__proto__=Qi.prototype:(null===t&&(t=new Qi(i)),t.length=i),t}function Qi(t,i,r){if(!(Qi.TYPED_ARRAY_SUPPORT||this instanceof Qi))return new Qi(t,i,r);if("number"==typeof t){if("string"==typeof i)throw new Error("If encoding is specified then the first argument must be a string");return rr(this,t)}return tr(this,t,i,r)}function tr(t,i,r,e){if("number"==typeof i)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&i instanceof ArrayBuffer?function(t,i,r,e){if(r<0||i.byteLength<r)throw new RangeError("'offset' is out of bounds");if(i.byteLength<r+(e||0))throw new RangeError("'length' is out of bounds");return i=void 0===r&&void 0===e?new Uint8Array(i):void 0===e?new Uint8Array(i,r):new Uint8Array(i,r,e),Qi.TYPED_ARRAY_SUPPORT?(t=i).__proto__=Qi.prototype:t=er(t,i),t}(t,i,r,e):"string"==typeof i?function(t,i,r){if("string"==typeof r&&""!==r||(r="utf8"),!Qi.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var e=0|hr(i,r),s=(t=Vi(t,e)).write(i,r);return s!==e&&(t=t.slice(0,s)),t}(t,i,r):function(t,i){if(nr(i)){var r=0|sr(i.length);return 0===(t=Vi(t,r)).length?t:(i.copy(t,0,0,r),t)}if(i){if("undefined"!=typeof ArrayBuffer&&i.buffer instanceof ArrayBuffer||"length"in i)return"number"!=typeof i.length||(e=i.length)!=e?Vi(t,0):er(t,i);if("Buffer"===i.type&&Yi(i.data))return er(t,i.data)}var e;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,i)}function ir(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function rr(t,i){if(ir(i),t=Vi(t,i<0?0:0|sr(i)),!Qi.TYPED_ARRAY_SUPPORT)for(var r=0;r<i;++r)t[r]=0;return t}function er(t,i){var r=i.length<0?0:0|sr(i.length);t=Vi(t,r);for(var e=0;e<r;e+=1)t[e]=255&i[e];return t}function sr(t){if(t>=Gi())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Gi().toString(16)+" bytes");return 0|t}function nr(t){return!(null==t||!t._isBuffer)}function hr(t,i){if(nr(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var e=!1;;)switch(i){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return zr(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Mr(t).length;default:if(e)return zr(t).length;i=(""+i).toLowerCase(),e=!0}}function or(t,i,r){var e=!1;if((void 0===i||i<0)&&(i=0),i>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(i>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return kr(this,i,r);case"utf8":case"utf-8":return br(this,i,r);case"ascii":return yr(this,i,r);case"latin1":case"binary":return xr(this,i,r);case"base64":return mr(this,i,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Er(this,i,r);default:if(e)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),e=!0}}function ar(t,i,r){var e=t[i];t[i]=t[r],t[r]=e}function ur(t,i,r,e,s){if(0===t.length)return-1;if("string"==typeof r?(e=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=s?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(s)return-1;r=t.length-1}else if(r<0){if(!s)return-1;r=0}if("string"==typeof i&&(i=Qi.from(i,e)),nr(i))return 0===i.length?-1:fr(t,i,r,e,s);if("number"==typeof i)return i&=255,Qi.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(t,i,r):Uint8Array.prototype.lastIndexOf.call(t,i,r):fr(t,[i],r,e,s);throw new TypeError("val must be string, number or Buffer")}function fr(t,i,r,e,s){var n,h=1,o=t.length,a=i.length;if(void 0!==e&&("ucs2"===(e=String(e).toLowerCase())||"ucs-2"===e||"utf16le"===e||"utf-16le"===e)){if(t.length<2||i.length<2)return-1;h=2,o/=2,a/=2,r/=2}function u(t,i){return 1===h?t[i]:t.readUInt16BE(i*h)}if(s){var f=-1;for(n=r;n<o;n++)if(u(t,n)===u(i,-1===f?0:n-f)){if(-1===f&&(f=n),n-f+1===a)return f*h}else-1!==f&&(n-=n-f),f=-1}else for(r+a>o&&(r=o-a),n=r;n>=0;n--){for(var c=!0,l=0;l<a;l++)if(u(t,n+l)!==u(i,l)){c=!1;break}if(c)return n}return-1}function cr(t,i,r,e){r=Number(r)||0;var s=t.length-r;e?(e=Number(e))>s&&(e=s):e=s;var n=i.length;if(n%2!=0)throw new TypeError("Invalid hex string");e>n/2&&(e=n/2);for(var h=0;h<e;++h){var o=parseInt(i.substr(2*h,2),16);if(isNaN(o))return h;t[r+h]=o}return h}function lr(t,i,r,e){return Ir(zr(i,t.length-r),t,r,e)}function dr(t,i,r,e){return Ir(function(t){for(var i=[],r=0;r<t.length;++r)i.push(255&t.charCodeAt(r));return i}(i),t,r,e)}function vr(t,i,r,e){return dr(t,i,r,e)}function pr(t,i,r,e){return Ir(Mr(i),t,r,e)}function wr(t,i,r,e){return Ir(function(t,i){for(var r,e,s=[],n=0;n<t.length&&!((i-=2)<0);++n)e=(r=t.charCodeAt(n))>>8,s.push(r%256),s.push(e);return s}(i,t.length-r),t,r,e)}function mr(t,i,r){return function(t){var i;Wi||Hi();for(var r=t.length,e=r%3,s="",n=[],h=0,o=r-e;h<o;h+=16383)n.push(Ki(t,h,h+16383>o?o:h+16383));return 1===e?(s+=Di[(i=t[r-1])>>2],s+=Di[i<<4&63],s+="=="):2===e&&(s+=Di[(i=(t[r-2]<<8)+t[r-1])>>10],s+=Di[i>>4&63],s+=Di[i<<2&63],s+="="),n.push(s),n.join("")}(0===i&&r===t.length?t:t.slice(i,r))}function br(t,i,r){r=Math.min(t.length,r);for(var e=[],s=i;s<r;){var n,h,o,a,u=t[s],f=null,c=u>239?4:u>223?3:u>191?2:1;if(s+c<=r)switch(c){case 1:u<128&&(f=u);break;case 2:128==(192&(n=t[s+1]))&&(a=(31&u)<<6|63&n)>127&&(f=a);break;case 3:h=t[s+2],128==(192&(n=t[s+1]))&&128==(192&h)&&(a=(15&u)<<12|(63&n)<<6|63&h)>2047&&(a<55296||a>57343)&&(f=a);break;case 4:h=t[s+2],o=t[s+3],128==(192&(n=t[s+1]))&&128==(192&h)&&128==(192&o)&&(a=(15&u)<<18|(63&n)<<12|(63&h)<<6|63&o)>65535&&a<1114112&&(f=a)}null===f?(f=65533,c=1):f>65535&&(e.push((f-=65536)>>>10&1023|55296),f=56320|1023&f),e.push(f),s+=c}return function(t){var i=t.length;if(i<=gr)return String.fromCharCode.apply(String,t);for(var r="",e=0;e<i;)r+=String.fromCharCode.apply(String,t.slice(e,e+=gr));return r}(e)}Qi.TYPED_ARRAY_SUPPORT=void 0===Bi.TYPED_ARRAY_SUPPORT||Bi.TYPED_ARRAY_SUPPORT,Qi.poolSize=8192,Qi._augment=function(t){return t.__proto__=Qi.prototype,t},Qi.from=function(t,i,r){return tr(null,t,i,r)},Qi.TYPED_ARRAY_SUPPORT&&(Qi.prototype.__proto__=Uint8Array.prototype,Qi.__proto__=Uint8Array),Qi.alloc=function(t,i,r){return function(t,i,r,e){return ir(i),i<=0?Vi(null,i):void 0!==r?"string"==typeof e?Vi(null,i).fill(r,e):Vi(null,i).fill(r):Vi(null,i)}(0,t,i,r)},Qi.allocUnsafe=function(t){return rr(null,t)},Qi.allocUnsafeSlow=function(t){return rr(null,t)},Qi.isBuffer=function(t){return null!=t&&(!!t._isBuffer||Lr(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&Lr(t.slice(0,0))}(t))},Qi.compare=function(t,i){if(!nr(t)||!nr(i))throw new TypeError("Arguments must be Buffers");if(t===i)return 0;for(var r=t.length,e=i.length,s=0,n=Math.min(r,e);s<n;++s)if(t[s]!==i[s]){r=t[s],e=i[s];break}return r<e?-1:e<r?1:0},Qi.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Qi.concat=function(t,i){if(!Yi(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Qi.alloc(0);var r;if(void 0===i)for(i=0,r=0;r<t.length;++r)i+=t[r].length;var e=Qi.allocUnsafe(i),s=0;for(r=0;r<t.length;++r){var n=t[r];if(!nr(n))throw new TypeError('"list" argument must be an Array of Buffers');n.copy(e,s),s+=n.length}return e},Qi.byteLength=hr,Qi.prototype._isBuffer=!0,Qi.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<t;i+=2)ar(this,i,i+1);return this},Qi.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<t;i+=4)ar(this,i,i+3),ar(this,i+1,i+2);return this},Qi.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<t;i+=8)ar(this,i,i+7),ar(this,i+1,i+6),ar(this,i+2,i+5),ar(this,i+3,i+4);return this},Qi.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?br(this,0,t):or.apply(this,arguments)},Qi.prototype.equals=function(t){if(!nr(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Qi.compare(this,t)},Qi.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},Qi.prototype.compare=function(t,i,r,e,s){if(!nr(t))throw new TypeError("Argument must be a Buffer");if(void 0===i&&(i=0),void 0===r&&(r=t?t.length:0),void 0===e&&(e=0),void 0===s&&(s=this.length),i<0||r>t.length||e<0||s>this.length)throw new RangeError("out of range index");if(e>=s&&i>=r)return 0;if(e>=s)return-1;if(i>=r)return 1;if(this===t)return 0;for(var n=(s>>>=0)-(e>>>=0),h=(r>>>=0)-(i>>>=0),o=Math.min(n,h),a=this.slice(e,s),u=t.slice(i,r),f=0;f<o;++f)if(a[f]!==u[f]){n=a[f],h=u[f];break}return n<h?-1:h<n?1:0},Qi.prototype.includes=function(t,i,r){return-1!==this.indexOf(t,i,r)},Qi.prototype.indexOf=function(t,i,r){return ur(this,t,i,r,!0)},Qi.prototype.lastIndexOf=function(t,i,r){return ur(this,t,i,r,!1)},Qi.prototype.write=function(t,i,r,e){if(void 0===i)e="utf8",r=this.length,i=0;else if(void 0===r&&"string"==typeof i)e=i,r=this.length,i=0;else{if(!isFinite(i))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");i|=0,isFinite(r)?(r|=0,void 0===e&&(e="utf8")):(e=r,r=void 0)}var s=this.length-i;if((void 0===r||r>s)&&(r=s),t.length>0&&(r<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");e||(e="utf8");for(var n=!1;;)switch(e){case"hex":return cr(this,t,i,r);case"utf8":case"utf-8":return lr(this,t,i,r);case"ascii":return dr(this,t,i,r);case"latin1":case"binary":return vr(this,t,i,r);case"base64":return pr(this,t,i,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return wr(this,t,i,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(""+e).toLowerCase(),n=!0}},Qi.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var gr=4096;function yr(t,i,r){var e="";r=Math.min(t.length,r);for(var s=i;s<r;++s)e+=String.fromCharCode(127&t[s]);return e}function xr(t,i,r){var e="";r=Math.min(t.length,r);for(var s=i;s<r;++s)e+=String.fromCharCode(t[s]);return e}function kr(t,i,r){var e,s=t.length;(!i||i<0)&&(i=0),(!r||r<0||r>s)&&(r=s);for(var n="",h=i;h<r;++h)n+=(e=t[h])<16?"0"+e.toString(16):e.toString(16);return n}function Er(t,i,r){for(var e=t.slice(i,r),s="",n=0;n<e.length;n+=2)s+=String.fromCharCode(e[n]+256*e[n+1]);return s}function Ar(t,i,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+i>r)throw new RangeError("Trying to access beyond buffer length")}function Tr(t,i,r,e,s,n){if(!nr(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(i>s||i<n)throw new RangeError('"value" argument is out of bounds');if(r+e>t.length)throw new RangeError("Index out of range")}function Sr(t,i,r,e){i<0&&(i=65535+i+1);for(var s=0,n=Math.min(t.length-r,2);s<n;++s)t[r+s]=(i&255<<8*(e?s:1-s))>>>8*(e?s:1-s)}function jr(t,i,r,e){i<0&&(i=4294967295+i+1);for(var s=0,n=Math.min(t.length-r,4);s<n;++s)t[r+s]=i>>>8*(e?s:3-s)&255}function Or(t,i,r,e){if(r+e>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Rr(t,i,r,e,s){return s||Or(t,0,r,4),Xi(t,i,r,e,23,4),r+4}function Cr(t,i,r,e,s){return s||Or(t,0,r,8),Xi(t,i,r,e,52,8),r+8}Qi.prototype.slice=function(t,i){var r,e=this.length;if((t=~~t)<0?(t+=e)<0&&(t=0):t>e&&(t=e),(i=void 0===i?e:~~i)<0?(i+=e)<0&&(i=0):i>e&&(i=e),i<t&&(i=t),Qi.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,i)).__proto__=Qi.prototype;else{var s=i-t;r=new Qi(s,void 0);for(var n=0;n<s;++n)r[n]=this[n+t]}return r},Qi.prototype.readUIntLE=function(t,i,r){t|=0,i|=0,r||Ar(t,i,this.length);for(var e=this[t],s=1,n=0;++n<i&&(s*=256);)e+=this[t+n]*s;return e},Qi.prototype.readUIntBE=function(t,i,r){t|=0,i|=0,r||Ar(t,i,this.length);for(var e=this[t+--i],s=1;i>0&&(s*=256);)e+=this[t+--i]*s;return e},Qi.prototype.readUInt8=function(t,i){return i||Ar(t,1,this.length),this[t]},Qi.prototype.readUInt16LE=function(t,i){return i||Ar(t,2,this.length),this[t]|this[t+1]<<8},Qi.prototype.readUInt16BE=function(t,i){return i||Ar(t,2,this.length),this[t]<<8|this[t+1]},Qi.prototype.readUInt32LE=function(t,i){return i||Ar(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Qi.prototype.readUInt32BE=function(t,i){return i||Ar(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Qi.prototype.readIntLE=function(t,i,r){t|=0,i|=0,r||Ar(t,i,this.length);for(var e=this[t],s=1,n=0;++n<i&&(s*=256);)e+=this[t+n]*s;return e>=(s*=128)&&(e-=Math.pow(2,8*i)),e},Qi.prototype.readIntBE=function(t,i,r){t|=0,i|=0,r||Ar(t,i,this.length);for(var e=i,s=1,n=this[t+--e];e>0&&(s*=256);)n+=this[t+--e]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*i)),n},Qi.prototype.readInt8=function(t,i){return i||Ar(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Qi.prototype.readInt16LE=function(t,i){i||Ar(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Qi.prototype.readInt16BE=function(t,i){i||Ar(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Qi.prototype.readInt32LE=function(t,i){return i||Ar(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Qi.prototype.readInt32BE=function(t,i){return i||Ar(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Qi.prototype.readFloatLE=function(t,i){return i||Ar(t,4,this.length),$i(this,t,!0,23,4)},Qi.prototype.readFloatBE=function(t,i){return i||Ar(t,4,this.length),$i(this,t,!1,23,4)},Qi.prototype.readDoubleLE=function(t,i){return i||Ar(t,8,this.length),$i(this,t,!0,52,8)},Qi.prototype.readDoubleBE=function(t,i){return i||Ar(t,8,this.length),$i(this,t,!1,52,8)},Qi.prototype.writeUIntLE=function(t,i,r,e){t=+t,i|=0,r|=0,e||Tr(this,t,i,r,Math.pow(2,8*r)-1,0);var s=1,n=0;for(this[i]=255&t;++n<r&&(s*=256);)this[i+n]=t/s&255;return i+r},Qi.prototype.writeUIntBE=function(t,i,r,e){t=+t,i|=0,r|=0,e||Tr(this,t,i,r,Math.pow(2,8*r)-1,0);var s=r-1,n=1;for(this[i+s]=255&t;--s>=0&&(n*=256);)this[i+s]=t/n&255;return i+r},Qi.prototype.writeUInt8=function(t,i,r){return t=+t,i|=0,r||Tr(this,t,i,1,255,0),Qi.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[i]=255&t,i+1},Qi.prototype.writeUInt16LE=function(t,i,r){return t=+t,i|=0,r||Tr(this,t,i,2,65535,0),Qi.TYPED_ARRAY_SUPPORT?(this[i]=255&t,this[i+1]=t>>>8):Sr(this,t,i,!0),i+2},Qi.prototype.writeUInt16BE=function(t,i,r){return t=+t,i|=0,r||Tr(this,t,i,2,65535,0),Qi.TYPED_ARRAY_SUPPORT?(this[i]=t>>>8,this[i+1]=255&t):Sr(this,t,i,!1),i+2},Qi.prototype.writeUInt32LE=function(t,i,r){return t=+t,i|=0,r||Tr(this,t,i,4,4294967295,0),Qi.TYPED_ARRAY_SUPPORT?(this[i+3]=t>>>24,this[i+2]=t>>>16,this[i+1]=t>>>8,this[i]=255&t):jr(this,t,i,!0),i+4},Qi.prototype.writeUInt32BE=function(t,i,r){return t=+t,i|=0,r||Tr(this,t,i,4,4294967295,0),Qi.TYPED_ARRAY_SUPPORT?(this[i]=t>>>24,this[i+1]=t>>>16,this[i+2]=t>>>8,this[i+3]=255&t):jr(this,t,i,!1),i+4},Qi.prototype.writeIntLE=function(t,i,r,e){if(t=+t,i|=0,!e){var s=Math.pow(2,8*r-1);Tr(this,t,i,r,s-1,-s)}var n=0,h=1,o=0;for(this[i]=255&t;++n<r&&(h*=256);)t<0&&0===o&&0!==this[i+n-1]&&(o=1),this[i+n]=(t/h>>0)-o&255;return i+r},Qi.prototype.writeIntBE=function(t,i,r,e){if(t=+t,i|=0,!e){var s=Math.pow(2,8*r-1);Tr(this,t,i,r,s-1,-s)}var n=r-1,h=1,o=0;for(this[i+n]=255&t;--n>=0&&(h*=256);)t<0&&0===o&&0!==this[i+n+1]&&(o=1),this[i+n]=(t/h>>0)-o&255;return i+r},Qi.prototype.writeInt8=function(t,i,r){return t=+t,i|=0,r||Tr(this,t,i,1,127,-128),Qi.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[i]=255&t,i+1},Qi.prototype.writeInt16LE=function(t,i,r){return t=+t,i|=0,r||Tr(this,t,i,2,32767,-32768),Qi.TYPED_ARRAY_SUPPORT?(this[i]=255&t,this[i+1]=t>>>8):Sr(this,t,i,!0),i+2},Qi.prototype.writeInt16BE=function(t,i,r){return t=+t,i|=0,r||Tr(this,t,i,2,32767,-32768),Qi.TYPED_ARRAY_SUPPORT?(this[i]=t>>>8,this[i+1]=255&t):Sr(this,t,i,!1),i+2},Qi.prototype.writeInt32LE=function(t,i,r){return t=+t,i|=0,r||Tr(this,t,i,4,2147483647,-2147483648),Qi.TYPED_ARRAY_SUPPORT?(this[i]=255&t,this[i+1]=t>>>8,this[i+2]=t>>>16,this[i+3]=t>>>24):jr(this,t,i,!0),i+4},Qi.prototype.writeInt32BE=function(t,i,r){return t=+t,i|=0,r||Tr(this,t,i,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),Qi.TYPED_ARRAY_SUPPORT?(this[i]=t>>>24,this[i+1]=t>>>16,this[i+2]=t>>>8,this[i+3]=255&t):jr(this,t,i,!1),i+4},Qi.prototype.writeFloatLE=function(t,i,r){return Rr(this,t,i,!0,r)},Qi.prototype.writeFloatBE=function(t,i,r){return Rr(this,t,i,!1,r)},Qi.prototype.writeDoubleLE=function(t,i,r){return Cr(this,t,i,!0,r)},Qi.prototype.writeDoubleBE=function(t,i,r){return Cr(this,t,i,!1,r)},Qi.prototype.copy=function(t,i,r,e){if(r||(r=0),e||0===e||(e=this.length),i>=t.length&&(i=t.length),i||(i=0),e>0&&e<r&&(e=r),e===r)return 0;if(0===t.length||0===this.length)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(e<0)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length),t.length-i<e-r&&(e=t.length-i+r);var s,n=e-r;if(this===t&&r<i&&i<e)for(s=n-1;s>=0;--s)t[s+i]=this[s+r];else if(n<1e3||!Qi.TYPED_ARRAY_SUPPORT)for(s=0;s<n;++s)t[s+i]=this[s+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+n),i);return n},Qi.prototype.fill=function(t,i,r,e){if("string"==typeof t){if("string"==typeof i?(e=i,i=0,r=this.length):"string"==typeof r&&(e=r,r=this.length),1===t.length){var s=t.charCodeAt(0);s<256&&(t=s)}if(void 0!==e&&"string"!=typeof e)throw new TypeError("encoding must be a string");if("string"==typeof e&&!Qi.isEncoding(e))throw new TypeError("Unknown encoding: "+e)}else"number"==typeof t&&(t&=255);if(i<0||this.length<i||this.length<r)throw new RangeError("Out of range index");if(r<=i)return this;var n;if(i>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(n=i;n<r;++n)this[n]=t;else{var h=nr(t)?t:zr(new Qi(t,e).toString()),o=h.length;for(n=0;n<r-i;++n)this[n+i]=h[n%o]}return this};var Nr=/[^+\/0-9A-Za-z-_]/g;function zr(t,i){var r;i=i||1/0;for(var e=t.length,s=null,n=[],h=0;h<e;++h){if((r=t.charCodeAt(h))>55295&&r<57344){if(!s){if(r>56319){(i-=3)>-1&&n.push(239,191,189);continue}if(h+1===e){(i-=3)>-1&&n.push(239,191,189);continue}s=r;continue}if(r<56320){(i-=3)>-1&&n.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&(i-=3)>-1&&n.push(239,191,189);if(s=null,r<128){if((i-=1)<0)break;n.push(r)}else if(r<2048){if((i-=2)<0)break;n.push(r>>6|192,63&r|128)}else if(r<65536){if((i-=3)<0)break;n.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((i-=4)<0)break;n.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return n}function Mr(t){return function(t){var i,r,e,s,n,h;Wi||Hi();var o=t.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");h=new qi(3*o/4-(n="="===t[o-2]?2:"="===t[o-1]?1:0)),e=n>0?o-4:o;var a=0;for(i=0,r=0;i<e;i+=4,r+=3)s=Zi[t.charCodeAt(i)]<<18|Zi[t.charCodeAt(i+1)]<<12|Zi[t.charCodeAt(i+2)]<<6|Zi[t.charCodeAt(i+3)],h[a++]=s>>16&255,h[a++]=s>>8&255,h[a++]=255&s;return 2===n?(s=Zi[t.charCodeAt(i)]<<2|Zi[t.charCodeAt(i+1)]>>4,h[a++]=255&s):1===n&&(s=Zi[t.charCodeAt(i)]<<10|Zi[t.charCodeAt(i+1)]<<4|Zi[t.charCodeAt(i+2)]>>2,h[a++]=s>>8&255,h[a++]=255&s),h}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Nr,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Ir(t,i,r,e){for(var s=0;s<e&&!(s+r>=i.length||s>=t.length);++s)i[s+r]=t[s];return s}function Lr(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function Fr(){}function _r(){_r.init.call(this)}function Pr(t){return void 0===t._maxListeners?_r.defaultMaxListeners:t._maxListeners}function Ur(t,i,r){if(i)t.call(r);else for(var e=t.length,s=$r(t,e),n=0;n<e;++n)s[n].call(r)}function Br(t,i,r,e){if(i)t.call(r,e);else for(var s=t.length,n=$r(t,s),h=0;h<s;++h)n[h].call(r,e)}function Dr(t,i,r,e,s){if(i)t.call(r,e,s);else for(var n=t.length,h=$r(t,n),o=0;o<n;++o)h[o].call(r,e,s)}function Zr(t,i,r,e,s,n){if(i)t.call(r,e,s,n);else for(var h=t.length,o=$r(t,h),a=0;a<h;++a)o[a].call(r,e,s,n)}function qr(t,i,r,e){if(i)t.apply(r,e);else for(var s=t.length,n=$r(t,s),h=0;h<s;++h)n[h].apply(r,e)}function Wr(t,i,r,e){var s,n,h,o;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((n=t._events)?(n.newListener&&(t.emit("newListener",i,r.listener?r.listener:r),n=t._events),h=n[i]):(n=t._events=new Fr,t._eventsCount=0),h){if("function"==typeof h?h=n[i]=e?[r,h]:[h,r]:e?h.unshift(r):h.push(r),!h.warned&&(s=Pr(t))&&s>0&&h.length>s){h.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+h.length+" "+i+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=i,a.count=h.length,o=a,"function"==typeof console.warn?console.warn(o):console.log(o)}}else h=n[i]=r,++t._eventsCount;return t}function Hr(t,i,r){var e=!1;function s(){t.removeListener(i,s),e||(e=!0,r.apply(t,arguments))}return s.listener=r,s}function Kr(t){var i=this._events;if(i){var r=i[t];if("function"==typeof r)return 1;if(r)return r.length}return 0}function $r(t,i){for(var r=new Array(i);i--;)r[i]=t[i];return r}function Xr(){throw new Error("setTimeout has not been defined")}function Jr(){throw new Error("clearTimeout has not been defined")}Fr.prototype=Object.create(null),_r.EventEmitter=_r,_r.usingDomains=!1,_r.prototype.domain=void 0,_r.prototype._events=void 0,_r.prototype._maxListeners=void 0,_r.defaultMaxListeners=10,_r.init=function(){this.domain=null,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Fr,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},_r.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},_r.prototype.getMaxListeners=function(){return Pr(this)},_r.prototype.emit=function(t){var i,r,e,s,n,h,o,a="error"===t;if(h=this._events)a=a&&null==h.error;else if(!a)return!1;if(o=this.domain,a){if(i=arguments[1],!o){if(i instanceof Error)throw i;var u=new Error('Uncaught, unspecified "error" event. ('+i+")");throw u.context=i,u}return i||(i=new Error('Uncaught, unspecified "error" event')),i.domainEmitter=this,i.domain=o,i.domainThrown=!1,o.emit("error",i),!1}if(!(r=h[t]))return!1;var f="function"==typeof r;switch(e=arguments.length){case 1:Ur(r,f,this);break;case 2:Br(r,f,this,arguments[1]);break;case 3:Dr(r,f,this,arguments[1],arguments[2]);break;case 4:Zr(r,f,this,arguments[1],arguments[2],arguments[3]);break;default:for(s=new Array(e-1),n=1;n<e;n++)s[n-1]=arguments[n];qr(r,f,this,s)}return!0},_r.prototype.on=_r.prototype.addListener=function(t,i){return Wr(this,t,i,!1)},_r.prototype.prependListener=function(t,i){return Wr(this,t,i,!0)},_r.prototype.once=function(t,i){if("function"!=typeof i)throw new TypeError('"listener" argument must be a function');return this.on(t,Hr(this,t,i)),this},_r.prototype.prependOnceListener=function(t,i){if("function"!=typeof i)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,Hr(this,t,i)),this},_r.prototype.removeListener=function(t,i){var r,e,s,n,h;if("function"!=typeof i)throw new TypeError('"listener" argument must be a function');if(!(e=this._events))return this;if(!(r=e[t]))return this;if(r===i||r.listener&&r.listener===i)0==--this._eventsCount?this._events=new Fr:(delete e[t],e.removeListener&&this.emit("removeListener",t,r.listener||i));else if("function"!=typeof r){for(s=-1,n=r.length;n-- >0;)if(r[n]===i||r[n].listener&&r[n].listener===i){h=r[n].listener,s=n;break}if(s<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new Fr,this;delete e[t]}else!function(t,i){for(var r=i,e=r+1,s=t.length;e<s;r+=1,e+=1)t[r]=t[e];t.pop()}(r,s);e.removeListener&&this.emit("removeListener",t,h||i)}return this},_r.prototype.removeAllListeners=function(t){var i,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new Fr,this._eventsCount=0):r[t]&&(0==--this._eventsCount?this._events=new Fr:delete r[t]),this;if(0===arguments.length){for(var e,s=Object.keys(r),n=0;n<s.length;++n)"removeListener"!==(e=s[n])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=new Fr,this._eventsCount=0,this}if("function"==typeof(i=r[t]))this.removeListener(t,i);else if(i)do{this.removeListener(t,i[i.length-1])}while(i[0]);return this},_r.prototype.listeners=function(t){var i,r=this._events;return r&&(i=r[t])?"function"==typeof i?[i.listener||i]:function(t){for(var i=new Array(t.length),r=0;r<i.length;++r)i[r]=t[r].listener||t[r];return i}(i):[]},_r.listenerCount=function(t,i){return"function"==typeof t.listenerCount?t.listenerCount(i):Kr.call(t,i)},_r.prototype.listenerCount=Kr,_r.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Yr=Xr,Gr=Jr;function Vr(t){if(Yr===setTimeout)return setTimeout(t,0);if((Yr===Xr||!Yr)&&setTimeout)return Yr=setTimeout,setTimeout(t,0);try{return Yr(t,0)}catch(i){try{return Yr.call(null,t,0)}catch(i){return Yr.call(this,t,0)}}}"function"==typeof Bi.setTimeout&&(Yr=setTimeout),"function"==typeof Bi.clearTimeout&&(Gr=clearTimeout);var Qr,te=[],ie=!1,re=-1;function ee(){ie&&Qr&&(ie=!1,Qr.length?te=Qr.concat(te):re=-1,te.length&&se())}function se(){if(!ie){var t=Vr(ee);ie=!0;for(var i=te.length;i;){for(Qr=te,te=[];++re<i;)Qr&&Qr[re].run();re=-1,i=te.length}Qr=null,ie=!1,function(t){if(Gr===clearTimeout)return clearTimeout(t);if((Gr===Jr||!Gr)&&clearTimeout)return Gr=clearTimeout,clearTimeout(t);try{Gr(t)}catch(i){try{return Gr.call(null,t)}catch(i){return Gr.call(this,t)}}}(t)}}function ne(t){var i=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)i[r-1]=arguments[r];te.push(new he(t,i)),1!==te.length||ie||Vr(se)}function he(t,i){this.fun=t,this.array=i}he.prototype.run=function(){this.fun.apply(null,this.array)};const oe="function"==typeof Object.create?function(t,i){t.super_=i,t.prototype=Object.create(i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,i){t.super_=i;var r=function(){};r.prototype=i.prototype,t.prototype=new r,t.prototype.constructor=t};var ae=/%[sdj%]/g;function ue(t){if(!xe(t)){for(var i=[],r=0;r<arguments.length;r++)i.push(de(arguments[r]));return i.join(" ")}r=1;for(var e=arguments,s=e.length,n=String(t).replace(ae,(function(t){if("%%"===t)return"%";if(r>=s)return t;switch(t){case"%s":return String(e[r++]);case"%d":return Number(e[r++]);case"%j":try{return JSON.stringify(e[r++])}catch(i){return"[Circular]"}default:return t}})),h=e[r];r<s;h=e[++r])ye(h)||!Ae(h)?n+=" "+h:n+=" "+de(h);return n}function fe(t,i){if(ke(Bi.process))return function(){return fe(t,i).apply(this,arguments)};var r=!1;return function(){return r||(console.error(i),r=!0),t.apply(this,arguments)}}var ce,le={};function de(t,i){var r={seen:[],stylize:pe};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),ge(i)?r.showHidden=i:i&&function(t,i){if(!i||!Ae(i))return t;for(var r=Object.keys(i),e=r.length;e--;)t[r[e]]=i[r[e]]}(r,i),ke(r.showHidden)&&(r.showHidden=!1),ke(r.depth)&&(r.depth=2),ke(r.colors)&&(r.colors=!1),ke(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=ve),we(r,t,r.depth)}function ve(t,i){var r=de.styles[i];return r?"["+de.colors[r][0]+"m"+t+"["+de.colors[r][1]+"m":t}function pe(t){return t}function we(t,i,r){if(t.customInspect&&i&&je(i.inspect)&&i.inspect!==de&&(!i.constructor||i.constructor.prototype!==i)){var e=i.inspect(r,t);return xe(e)||(e=we(t,e,r)),e}var s=function(t,i){if(ke(i))return t.stylize("undefined","undefined");if(xe(i)){var r="'"+JSON.stringify(i).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return"number"==typeof i?t.stylize(""+i,"number"):ge(i)?t.stylize(""+i,"boolean"):ye(i)?t.stylize("null","null"):void 0}(t,i);if(s)return s;var n=Object.keys(i),h=function(t){var i={};return t.forEach((function(t){i[t]=!0})),i}(n);if(t.showHidden&&(n=Object.getOwnPropertyNames(i)),Se(i)&&(n.indexOf("message")>=0||n.indexOf("description")>=0))return me(i);if(0===n.length){if(je(i))return t.stylize("[Function"+(i.name?": "+i.name:"")+"]","special");if(Ee(i))return t.stylize(RegExp.prototype.toString.call(i),"regexp");if(Te(i))return t.stylize(Date.prototype.toString.call(i),"date");if(Se(i))return me(i)}var o,a="",u=!1,f=["{","}"];return Array.isArray(i)&&(u=!0,f=["[","]"]),je(i)&&(a=" [Function"+(i.name?": "+i.name:"")+"]"),Ee(i)&&(a=" "+RegExp.prototype.toString.call(i)),Te(i)&&(a=" "+Date.prototype.toUTCString.call(i)),Se(i)&&(a=" "+me(i)),0!==n.length||u&&0!=i.length?r<0?Ee(i)?t.stylize(RegExp.prototype.toString.call(i),"regexp"):t.stylize("[Object]","special"):(t.seen.push(i),o=u?function(t,i,r,e,s){for(var n=[],h=0,o=i.length;h<o;++h)Re(i,String(h))?n.push(be(t,i,r,e,String(h),!0)):n.push("");return s.forEach((function(s){s.match(/^\d+$/)||n.push(be(t,i,r,e,s,!0))})),n}(t,i,r,h,n):n.map((function(e){return be(t,i,r,h,e,u)})),t.seen.pop(),function(t,i,r){return t.reduce((function(t,i){return i.indexOf("\n"),t+i.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?r[0]+(""===i?"":i+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+i+" "+t.join(", ")+" "+r[1]}(o,a,f)):f[0]+a+f[1]}function me(t){return"["+Error.prototype.toString.call(t)+"]"}function be(t,i,r,e,s,n){var h,o,a;if((a=Object.getOwnPropertyDescriptor(i,s)||{value:i[s]}).get?o=t.stylize(a.set?"[Getter/Setter]":"[Getter]","special"):a.set&&(o=t.stylize("[Setter]","special")),Re(e,s)||(h="["+s+"]"),o||(t.seen.indexOf(a.value)<0?(o=ye(r)?we(t,a.value,null):we(t,a.value,r-1)).indexOf("\n")>-1&&(o=n?o.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+o.split("\n").map((function(t){return"   "+t})).join("\n")):o=t.stylize("[Circular]","special")),ke(h)){if(n&&s.match(/^\d+$/))return o;(h=JSON.stringify(""+s)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(h=h.substr(1,h.length-2),h=t.stylize(h,"name")):(h=h.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),h=t.stylize(h,"string"))}return h+": "+o}function ge(t){return"boolean"==typeof t}function ye(t){return null===t}function xe(t){return"string"==typeof t}function ke(t){return void 0===t}function Ee(t){return Ae(t)&&"[object RegExp]"===Oe(t)}function Ae(t){return"object"==typeof t&&null!==t}function Te(t){return Ae(t)&&"[object Date]"===Oe(t)}function Se(t){return Ae(t)&&("[object Error]"===Oe(t)||t instanceof Error)}function je(t){return"function"==typeof t}function Oe(t){return Object.prototype.toString.call(t)}function Re(t,i){return Object.prototype.hasOwnProperty.call(t,i)}function Ce(){this.head=null,this.tail=null,this.length=0}de.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},de.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},Ce.prototype.push=function(t){var i={data:t,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length},Ce.prototype.unshift=function(t){var i={data:t,next:this.head};0===this.length&&(this.tail=i),this.head=i,++this.length},Ce.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,t}},Ce.prototype.clear=function(){this.head=this.tail=null,this.length=0},Ce.prototype.join=function(t){if(0===this.length)return"";for(var i=this.head,r=""+i.data;i=i.next;)r+=t+i.data;return r},Ce.prototype.concat=function(t){if(0===this.length)return Qi.alloc(0);if(1===this.length)return this.head.data;for(var i=Qi.allocUnsafe(t>>>0),r=this.head,e=0;r;)r.data.copy(i,e),e+=r.data.length,r=r.next;return i};var Ne=Qi.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function ze(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),function(t){if(t&&!Ne(t))throw new Error("Unknown encoding: "+t)}(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=Ie;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=Le;break;default:return void(this.write=Me)}this.charBuffer=new Qi(6),this.charReceived=0,this.charLength=0}function Me(t){return t.toString(this.encoding)}function Ie(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function Le(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}ze.prototype.write=function(t){for(var i="";this.charLength;){var r=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(t=t.slice(r,t.length),!((e=(i=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(i.length-1))>=55296&&e<=56319)){if(this.charReceived=this.charLength=0,0===t.length)return i;break}this.charLength+=this.surrogateSize,i=""}this.detectIncompleteChar(t);var e,s=t.length;if(this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,s),s-=this.charReceived),(e=(i+=t.toString(this.encoding,0,s)).charCodeAt(s=i.length-1))>=55296&&e<=56319){var n=this.surrogateSize;return this.charLength+=n,this.charReceived+=n,this.charBuffer.copy(this.charBuffer,n,0,n),t.copy(this.charBuffer,0,0,n),i.substring(0,s)}return i},ze.prototype.detectIncompleteChar=function(t){for(var i=t.length>=3?3:t.length;i>0;i--){var r=t[t.length-i];if(1==i&&r>>5==6){this.charLength=2;break}if(i<=2&&r>>4==14){this.charLength=3;break}if(i<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=i},ze.prototype.end=function(t){var i="";if(t&&t.length&&(i=this.write(t)),this.charReceived){var r=this.encoding;i+=this.charBuffer.slice(0,this.charReceived).toString(r)}return i},Ue.ReadableState=Pe;var Fe,_e=(Fe="stream",ke(ce)&&(ce=""),Fe=Fe.toUpperCase(),le[Fe]||(le[Fe]=new RegExp("\\b"+Fe+"\\b","i").test(ce)?function(){var t=ue.apply(null,arguments);console.error("%s %d: %s",Fe,0,t)}:function(){}),le[Fe]);function Pe(t,i){this.objectMode=!!(t=t||{}).objectMode,i instanceof ds&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark;this.highWaterMark=r||0===r?r:this.objectMode?16:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=new Ce,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(this.decoder=new ze(t.encoding),this.encoding=t.encoding)}function Ue(t){if(!(this instanceof Ue))return new Ue(t);this._readableState=new Pe(t,this),this.readable=!0,t&&"function"==typeof t.read&&(this._read=t.read),_r.call(this)}function Be(t,i,r,e,s){var n=function(t,i){var r=null;return Qi.isBuffer(i)||"string"==typeof i||null==i||t.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}(i,r);if(n)t.emit("error",n);else if(null===r)i.reading=!1,function(t,i){if(!i.ended){if(i.decoder){var r=i.decoder.end();r&&r.length&&(i.buffer.push(r),i.length+=i.objectMode?1:r.length)}i.ended=!0,qe(t)}}(t,i);else if(i.objectMode||r&&r.length>0)if(i.ended&&!s){var h=new Error("stream.push() after EOF");t.emit("error",h)}else if(i.endEmitted&&s){var o=new Error("stream.unshift() after end event");t.emit("error",o)}else{var a;!i.decoder||s||e||(r=i.decoder.write(r),a=!i.objectMode&&0===r.length),s||(i.reading=!1),a||(i.flowing&&0===i.length&&!i.sync?(t.emit("data",r),t.read(0)):(i.length+=i.objectMode?1:r.length,s?i.buffer.unshift(r):i.buffer.push(r),i.needReadable&&qe(t))),function(t,i){i.readingMore||(i.readingMore=!0,ne(He,t,i))}(t,i)}else s||(i.reading=!1);return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(i)}oe(Ue,_r),Ue.prototype.push=function(t,i){var r=this._readableState;return r.objectMode||"string"!=typeof t||(i=i||r.defaultEncoding)!==r.encoding&&(t=Qi.from(t,i),i=""),Be(this,r,t,i,!1)},Ue.prototype.unshift=function(t){return Be(this,this._readableState,t,"",!0)},Ue.prototype.isPaused=function(){return!1===this._readableState.flowing},Ue.prototype.setEncoding=function(t){return this._readableState.decoder=new ze(t),this._readableState.encoding=t,this};var De=8388608;function Ze(t,i){return t<=0||0===i.length&&i.ended?0:i.objectMode?1:t!=t?i.flowing&&i.length?i.buffer.head.data.length:i.length:(t>i.highWaterMark&&(i.highWaterMark=function(t){return t>=De?t=De:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=i.length?t:i.ended?i.length:(i.needReadable=!0,0))}function qe(t){var i=t._readableState;i.needReadable=!1,i.emittedReadable||(_e("emitReadable",i.flowing),i.emittedReadable=!0,i.sync?ne(We,t):We(t))}function We(t){_e("emit readable"),t.emit("readable"),Xe(t)}function He(t,i){for(var r=i.length;!i.reading&&!i.flowing&&!i.ended&&i.length<i.highWaterMark&&(_e("maybeReadMore read 0"),t.read(0),r!==i.length);)r=i.length;i.readingMore=!1}function Ke(t){_e("readable nexttick read 0"),t.read(0)}function $e(t,i){i.reading||(_e("resume read 0"),t.read(0)),i.resumeScheduled=!1,i.awaitDrain=0,t.emit("resume"),Xe(t),i.flowing&&!i.reading&&t.read(0)}function Xe(t){var i=t._readableState;for(_e("flow",i.flowing);i.flowing&&null!==t.read(););}function Je(t,i){return 0===i.length?null:(i.objectMode?r=i.buffer.shift():!t||t>=i.length?(r=i.decoder?i.buffer.join(""):1===i.buffer.length?i.buffer.head.data:i.buffer.concat(i.length),i.buffer.clear()):r=function(t,i,r){var e;return t<i.head.data.length?(e=i.head.data.slice(0,t),i.head.data=i.head.data.slice(t)):e=t===i.head.data.length?i.shift():r?function(t,i){var r=i.head,e=1,s=r.data;for(t-=s.length;r=r.next;){var n=r.data,h=t>n.length?n.length:t;if(s+=h===n.length?n:n.slice(0,t),0==(t-=h)){h===n.length?(++e,i.head=r.next?r.next:i.tail=null):(i.head=r,r.data=n.slice(h));break}++e}return i.length-=e,s}(t,i):function(t,i){var r=Qi.allocUnsafe(t),e=i.head,s=1;for(e.data.copy(r),t-=e.data.length;e=e.next;){var n=e.data,h=t>n.length?n.length:t;if(n.copy(r,r.length-t,0,h),0==(t-=h)){h===n.length?(++s,i.head=e.next?e.next:i.tail=null):(i.head=e,e.data=n.slice(h));break}++s}return i.length-=s,r}(t,i),e}(t,i.buffer,i.decoder),r);var r}function Ye(t){var i=t._readableState;if(i.length>0)throw new Error('"endReadable()" called on non-empty stream');i.endEmitted||(i.ended=!0,ne(Ge,i,t))}function Ge(t,i){t.endEmitted||0!==t.length||(t.endEmitted=!0,i.readable=!1,i.emit("end"))}function Ve(t,i){for(var r=0,e=t.length;r<e;r++)if(t[r]===i)return r;return-1}function Qe(){}function ts(t,i,r){this.chunk=t,this.encoding=i,this.callback=r,this.next=null}function is(t,i){Object.defineProperty(this,"buffer",{get:fe((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),this.objectMode=!!(t=t||{}).objectMode,i instanceof ds&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark;this.highWaterMark=r||0===r?r:this.objectMode?16:16384,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.decodeStrings=!(!1===t.decodeStrings),this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,i){var r=t._writableState,e=r.sync,s=r.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(r),i)!function(t,i,r,e,s){--i.pendingcb,r?ne(s,e):s(e),t._writableState.errorEmitted=!0,t.emit("error",e)}(t,r,e,i,s);else{var n=hs(r);n||r.corked||r.bufferProcessing||!r.bufferedRequest||ns(t,r),e?ne(ss,t,r,n,s):ss(t,r,n,s)}}(i,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new us(this)}function rs(t){if(!(this instanceof rs||this instanceof ds))return new rs(t);this._writableState=new is(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev)),_r.call(this)}function es(t,i,r,e,s,n,h){i.writelen=e,i.writecb=h,i.writing=!0,i.sync=!0,r?t._writev(s,i.onwrite):t._write(s,n,i.onwrite),i.sync=!1}function ss(t,i,r,e){r||function(t,i){0===i.length&&i.needDrain&&(i.needDrain=!1,t.emit("drain"))}(t,i),i.pendingcb--,e(),as(t,i)}function ns(t,i){i.bufferProcessing=!0;var r=i.bufferedRequest;if(t._writev&&r&&r.next){var e=new Array(i.bufferedRequestCount),s=i.corkedRequestsFree;s.entry=r;for(var n=0;r;)e[n]=r,r=r.next,n+=1;es(t,i,!0,i.length,e,"",s.finish),i.pendingcb++,i.lastBufferedRequest=null,s.next?(i.corkedRequestsFree=s.next,s.next=null):i.corkedRequestsFree=new us(i)}else{for(;r;){var h=r.chunk;if(es(t,i,!1,i.objectMode?1:h.length,h,r.encoding,r.callback),r=r.next,i.writing)break}null===r&&(i.lastBufferedRequest=null)}i.bufferedRequestCount=0,i.bufferedRequest=r,i.bufferProcessing=!1}function hs(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function os(t,i){i.prefinished||(i.prefinished=!0,t.emit("prefinish"))}function as(t,i){var r=hs(i);return r&&(0===i.pendingcb?(os(t,i),i.finished=!0,t.emit("finish")):os(t,i)),r}function us(t){var i=this;this.next=null,this.entry=null,this.finish=function(r){var e=i.entry;for(i.entry=null;e;){var s=e.callback;t.pendingcb--,s(r),e=e.next}t.corkedRequestsFree?t.corkedRequestsFree.next=i:t.corkedRequestsFree=i}}Ue.prototype.read=function(t){_e("read",t),t=parseInt(t,10);var i=this._readableState,r=t;if(0!==t&&(i.emittedReadable=!1),0===t&&i.needReadable&&(i.length>=i.highWaterMark||i.ended))return _e("read: emitReadable",i.length,i.ended),0===i.length&&i.ended?Ye(this):qe(this),null;if(0===(t=Ze(t,i))&&i.ended)return 0===i.length&&Ye(this),null;var e,s=i.needReadable;return _e("need readable",s),(0===i.length||i.length-t<i.highWaterMark)&&_e("length less than watermark",s=!0),i.ended||i.reading?_e("reading or ended",s=!1):s&&(_e("do read"),i.reading=!0,i.sync=!0,0===i.length&&(i.needReadable=!0),this._read(i.highWaterMark),i.sync=!1,i.reading||(t=Ze(r,i))),null===(e=t>0?Je(t,i):null)?(i.needReadable=!0,t=0):i.length-=t,0===i.length&&(i.ended||(i.needReadable=!0),r!==t&&i.ended&&Ye(this)),null!==e&&this.emit("data",e),e},Ue.prototype._read=function(){this.emit("error",new Error("not implemented"))},Ue.prototype.pipe=function(t,i){var r=this,e=this._readableState;switch(e.pipesCount){case 0:e.pipes=t;break;case 1:e.pipes=[e.pipes,t];break;default:e.pipes.push(t)}e.pipesCount+=1,_e("pipe count=%d opts=%j",e.pipesCount,i);var s=i&&!1===i.end?u:h;function n(t){_e("onunpipe"),t===r&&u()}function h(){_e("onend"),t.end()}e.endEmitted?ne(s):r.once("end",s),t.on("unpipe",n);var o=function(t){return function(){var i=t._readableState;_e("pipeOnDrain",i.awaitDrain),i.awaitDrain&&i.awaitDrain--,0===i.awaitDrain&&t.listeners("data").length&&(i.flowing=!0,Xe(t))}}(r);t.on("drain",o);var a=!1;function u(){_e("cleanup"),t.removeListener("close",d),t.removeListener("finish",v),t.removeListener("drain",o),t.removeListener("error",l),t.removeListener("unpipe",n),r.removeListener("end",h),r.removeListener("end",u),r.removeListener("data",c),a=!0,!e.awaitDrain||t._writableState&&!t._writableState.needDrain||o()}var f=!1;function c(i){_e("ondata"),f=!1,!1!==t.write(i)||f||((1===e.pipesCount&&e.pipes===t||e.pipesCount>1&&-1!==Ve(e.pipes,t))&&!a&&(_e("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,f=!0),r.pause())}function l(i){_e("onerror",i),p(),t.removeListener("error",l),0===t.listeners("error").length&&t.emit("error",i)}function d(){t.removeListener("finish",v),p()}function v(){_e("onfinish"),t.removeListener("close",d),p()}function p(){_e("unpipe"),r.unpipe(t)}return r.on("data",c),function(t,i,r){if("function"==typeof t.prependListener)return t.prependListener("error",r);t._events&&t._events.error?Array.isArray(t._events.error)?t._events.error.unshift(r):t._events.error=[r,t._events.error]:t.on("error",r)}(t,0,l),t.once("close",d),t.once("finish",v),t.emit("pipe",r),e.flowing||(_e("pipe resume"),r.resume()),t},Ue.prototype.unpipe=function(t){var i=this._readableState;if(0===i.pipesCount)return this;if(1===i.pipesCount)return t&&t!==i.pipes?this:(t||(t=i.pipes),i.pipes=null,i.pipesCount=0,i.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var r=i.pipes,e=i.pipesCount;i.pipes=null,i.pipesCount=0,i.flowing=!1;for(var s=0;s<e;s++)r[s].emit("unpipe",this);return this}var n=Ve(i.pipes,t);return-1===n?this:(i.pipes.splice(n,1),i.pipesCount-=1,1===i.pipesCount&&(i.pipes=i.pipes[0]),t.emit("unpipe",this),this)},Ue.prototype.addListener=Ue.prototype.on=function(t,i){var r=_r.prototype.on.call(this,t,i);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var e=this._readableState;e.endEmitted||e.readableListening||(e.readableListening=e.needReadable=!0,e.emittedReadable=!1,e.reading?e.length&&qe(this):ne(Ke,this))}return r},Ue.prototype.resume=function(){var t=this._readableState;return t.flowing||(_e("resume"),t.flowing=!0,function(t,i){i.resumeScheduled||(i.resumeScheduled=!0,ne($e,t,i))}(this,t)),this},Ue.prototype.pause=function(){return _e("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(_e("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Ue.prototype.wrap=function(t){var i=this._readableState,r=!1,e=this;for(var s in t.on("end",(function(){if(_e("wrapped end"),i.decoder&&!i.ended){var t=i.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(s){_e("wrapped data"),i.decoder&&(s=i.decoder.write(s)),i.objectMode&&null==s||(i.objectMode||s&&s.length)&&(e.push(s)||(r=!0,t.pause()))})),t)void 0===this[s]&&"function"==typeof t[s]&&(this[s]=function(i){return function(){return t[i].apply(t,arguments)}}(s));return function(i){for(var r=0,s=i.length;r<s;r++)t.on(n=i[r],e.emit.bind(e,n));var n}(["error","close","destroy","pause","resume"]),e._read=function(i){_e("wrapped _read",i),r&&(r=!1,t.resume())},e},Ue._fromList=Je,rs.WritableState=is,oe(rs,_r),is.prototype.getBuffer=function(){for(var t=this.bufferedRequest,i=[];t;)i.push(t),t=t.next;return i},rs.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},rs.prototype.write=function(t,i,r){var e=this._writableState,s=!1;return"function"==typeof i&&(r=i,i=null),Qi.isBuffer(t)?i="buffer":i||(i=e.defaultEncoding),"function"!=typeof r&&(r=Qe),e.ended?function(t,i){var r=new Error("write after end");t.emit("error",r),ne(i,r)}(this,r):function(t,i,r,e){var s=!0,n=!1;return null===r?n=new TypeError("May not write null values to stream"):Qi.isBuffer(r)||"string"==typeof r||void 0===r||i.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n&&(t.emit("error",n),ne(e,n),s=!1),s}(this,e,t,r)&&(e.pendingcb++,s=function(t,i,r,e,s){r=function(t,i,r){return t.objectMode||!1===t.decodeStrings||"string"!=typeof i||(i=Qi.from(i,r)),i}(i,r,e),Qi.isBuffer(r)&&(e="buffer");var n=i.objectMode?1:r.length;i.length+=n;var h=i.length<i.highWaterMark;if(h||(i.needDrain=!0),i.writing||i.corked){var o=i.lastBufferedRequest;i.lastBufferedRequest=new ts(r,e,s),o?o.next=i.lastBufferedRequest:i.bufferedRequest=i.lastBufferedRequest,i.bufferedRequestCount+=1}else es(t,i,!1,n,r,e,s);return h}(this,e,t,i,r)),s},rs.prototype.cork=function(){this._writableState.corked++},rs.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||ns(this,t))},rs.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},rs.prototype._write=function(t,i,r){r(new Error("not implemented"))},rs.prototype._writev=null,rs.prototype.end=function(t,i,r){var e=this._writableState;"function"==typeof t?(r=t,t=null,i=null):"function"==typeof i&&(r=i,i=null),null!=t&&this.write(t,i),e.corked&&(e.corked=1,this.uncork()),e.ending||e.finished||function(t,i,r){i.ending=!0,as(t,i),r&&(i.finished?ne(r):t.once("finish",r)),i.ended=!0,t.writable=!1}(this,e,r)},oe(ds,Ue);for(var fs=Object.keys(rs.prototype),cs=0;cs<fs.length;cs++){var ls=fs[cs];ds.prototype[ls]||(ds.prototype[ls]=rs.prototype[ls])}function ds(t){if(!(this instanceof ds))return new ds(t);Ue.call(this,t),rs.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",vs)}function vs(){this.allowHalfOpen||this._writableState.ended||ne(ps,this)}function ps(t){t.end()}function ws(t){this.afterTransform=function(i,r){return function(t,i,r){var e=t._transformState;e.transforming=!1;var s=e.writecb;if(!s)return t.emit("error",new Error("no writecb in Transform class"));e.writechunk=null,e.writecb=null,null!=r&&t.push(r),s(i);var n=t._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&t._read(n.highWaterMark)}(t,i,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function ms(t){if(!(this instanceof ms))return new ms(t);ds.call(this,t),this._transformState=new ws(this);var i=this;this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(t){bs(i,t)})):bs(i)}))}function bs(t,i){if(i)return t.emit("error",i);var r=t._transformState;if(t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(r.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}function gs(t){if(!(this instanceof gs))return new gs(t);ms.call(this,t)}function ys(){_r.call(this)}oe(ms,ds),ms.prototype.push=function(t,i){return this._transformState.needTransform=!1,ds.prototype.push.call(this,t,i)},ms.prototype._transform=function(){throw new Error("Not implemented")},ms.prototype._write=function(t,i,r){var e=this._transformState;if(e.writecb=r,e.writechunk=t,e.writeencoding=i,!e.transforming){var s=this._readableState;(e.needTransform||s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}},ms.prototype._read=function(){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},oe(gs,ms),gs.prototype._transform=function(t,i,r){r(null,t)},oe(ys,_r),ys.Readable=Ue,ys.Writable=rs,ys.Duplex=ds,ys.Transform=ms,ys.PassThrough=gs,ys.Stream=ys,ys.prototype.pipe=function(t,i){var r=this;function e(i){t.writable&&!1===t.write(i)&&r.pause&&r.pause()}function s(){r.readable&&r.resume&&r.resume()}r.on("data",e),t.on("drain",s),t._isStdio||i&&!1===i.end||(r.on("end",h),r.on("close",o));var n=!1;function h(){n||(n=!0,t.end())}function o(){n||(n=!0,"function"==typeof t.destroy&&t.destroy())}function a(t){if(u(),0===_r.listenerCount(this,"error"))throw t}function u(){r.removeListener("data",e),t.removeListener("drain",s),r.removeListener("end",h),r.removeListener("close",o),r.removeListener("error",a),t.removeListener("error",a),r.removeListener("end",u),r.removeListener("close",u),t.removeListener("close",u)}return r.on("error",a),t.on("error",a),r.on("end",u),r.on("close",u),t.on("close",u),t.emit("pipe",r),t};var xs,ks,Es=ys,As=h((function(t,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,i.nodebuffer=!0,i.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)i.blob=!1;else{var r=new ArrayBuffer(0);try{i.blob=0===new Blob([r],{type:"application/zip"}).size}catch(s){try{var e=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);e.append(r),i.blob=0===e.getBlob("application/zip").size}catch(s){i.blob=!1}}}try{i.nodestream=!!Es.Readable}catch(s){i.nodestream=!1}})),Ts="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ss={encode:function(t){for(var i,r,e,s,n,h,o=[],a=0,u=t.length,f=u,c="string"!==Vs.getTypeOf(t);a<t.length;)f=u-a,c?(i=t[a++],r=a<u?t[a++]:0,e=a<u?t[a++]:0):(i=t.charCodeAt(a++),r=a<u?t.charCodeAt(a++):0,e=a<u?t.charCodeAt(a++):0),s=(3&i)<<4|r>>4,n=f>1?(15&r)<<2|e>>6:64,h=f>2?63&e:64,o.push(Ts.charAt(i>>2)+Ts.charAt(s)+Ts.charAt(n)+Ts.charAt(h));return o.join("")},decode:function(t){var i,r,e,s,n,h,o=0,a=0;if("data:"===t.substr(0,"data:".length))throw new Error("Invalid base64 input, it looks like a data url.");var u,f=3*(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(t.charAt(t.length-1)===Ts.charAt(64)&&f--,t.charAt(t.length-2)===Ts.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(u=As.uint8array?new Uint8Array(0|f):new Array(0|f);o<t.length;)e=Ts.indexOf(t.charAt(o++)),i=(15&(s=Ts.indexOf(t.charAt(o++))))<<4|(n=Ts.indexOf(t.charAt(o++)))>>2,r=(3&n)<<6|(h=Ts.indexOf(t.charAt(o++))),u[a++]=e<<2|s>>4,64!==n&&(u[a++]=i),64!==h&&(u[a++]=r);return u}},js=function(t,i){if(Qi.from&&Qi.from!==Uint8Array.from)return Qi.from(t,i);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new Qi(t,i)},Os=function(t){if(Qi.alloc)return Qi.alloc(t);var i=new Qi(t);return i.fill(0),i},Rs=function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume},Cs="function"==typeof setImmediate?setImmediate:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)},Ns=s.MutationObserver||s.WebKitMutationObserver;if(Ns){var zs=0,Ms=new Ns(_s),Is=s.document.createTextNode("");Ms.observe(Is,{characterData:!0}),xs=function(){Is.data=zs=++zs%2}}else if(s.setImmediate||void 0===s.MessageChannel)xs="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var t=s.document.createElement("script");t.onreadystatechange=function(){_s(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},s.document.documentElement.appendChild(t)}:function(){setTimeout(_s,0)};else{var Ls=new s.MessageChannel;Ls.port1.onmessage=_s,xs=function(){Ls.port2.postMessage(0)}}var Fs=[];function _s(){var t,i;ks=!0;for(var r=Fs.length;r;){for(i=Fs,Fs=[],t=-1;++t<r;)i[t]();r=Fs.length}ks=!1}var Ps=function(t){1!==Fs.push(t)||ks||xs()};function Us(){}var Bs={},Ds=["REJECTED"],Zs=["FULFILLED"],qs=["PENDING"],Ws=Hs;function Hs(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=qs,this.queue=[],this.outcome=void 0,t!==Us&&Js(this,t)}function Ks(t,i,r){this.promise=t,"function"==typeof i&&(this.onFulfilled=i,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function $s(t,i,r){Ps((function(){var e;try{e=i(r)}catch(s){return Bs.reject(t,s)}e===t?Bs.reject(t,new TypeError("Cannot resolve promise with itself")):Bs.resolve(t,e)}))}function Xs(t){var i=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof i)return function(){i.apply(t,arguments)}}function Js(t,i){var r=!1;function e(i){r||(r=!0,Bs.reject(t,i))}function s(i){r||(r=!0,Bs.resolve(t,i))}var n=Ys((function(){i(s,e)}));"error"===n.status&&e(n.value)}function Ys(t,i){var r={};try{r.value=t(i),r.status="success"}catch(e){r.status="error",r.value=e}return r}Hs.prototype.finally=function(t){if("function"!=typeof t)return this;var i=this.constructor;return this.then((function(r){return i.resolve(t()).then((function(){return r}))}),(function(r){return i.resolve(t()).then((function(){throw r}))}))},Hs.prototype.catch=function(t){return this.then(null,t)},Hs.prototype.then=function(t,i){if("function"!=typeof t&&this.state===Zs||"function"!=typeof i&&this.state===Ds)return this;var r=new this.constructor(Us);return this.state!==qs?$s(r,this.state===Zs?t:i,this.outcome):this.queue.push(new Ks(r,t,i)),r},Ks.prototype.callFulfilled=function(t){Bs.resolve(this.promise,t)},Ks.prototype.otherCallFulfilled=function(t){$s(this.promise,this.onFulfilled,t)},Ks.prototype.callRejected=function(t){Bs.reject(this.promise,t)},Ks.prototype.otherCallRejected=function(t){$s(this.promise,this.onRejected,t)},Bs.resolve=function(t,i){var r=Ys(Xs,i);if("error"===r.status)return Bs.reject(t,r.value);var e=r.value;if(e)Js(t,e);else{t.state=Zs,t.outcome=i;for(var s=-1,n=t.queue.length;++s<n;)t.queue[s].callFulfilled(i)}return t},Bs.reject=function(t,i){t.state=Ds,t.outcome=i;for(var r=-1,e=t.queue.length;++r<e;)t.queue[r].callRejected(i);return t},Hs.resolve=function(t){return t instanceof this?t:Bs.resolve(new this(Us),t)},Hs.reject=function(t){var i=new this(Us);return Bs.reject(i,t)},Hs.all=function(t){var i=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,e=!1;if(!r)return this.resolve([]);for(var s=new Array(r),n=0,h=-1,o=new this(Us);++h<r;)a(t[h],h);return o;function a(t,h){i.resolve(t).then((function(t){s[h]=t,++n!==r||e||(e=!0,Bs.resolve(o,s))}),(function(t){e||(e=!0,Bs.reject(o,t))}))}},Hs.race=function(t){if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,r=!1;if(!i)return this.resolve([]);for(var e=-1,s=new this(Us);++e<i;)this.resolve(t[e]).then((function(t){r||(r=!0,Bs.resolve(s,t))}),(function(t){r||(r=!0,Bs.reject(s,t))}));return s};var Gs={Promise:"undefined"!=typeof Promise?Promise:Ws},Vs=h((function(t,i){function r(t){return t}function e(t,i){for(var r=0;r<t.length;++r)i[r]=255&t.charCodeAt(r);return i}i.newBlob=function(t,r){i.checkSupport("blob");try{return new Blob([t],{type:r})}catch(s){try{var e=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return e.append(t),e.getBlob(r)}catch(s){throw new Error("Bug : can't construct the Blob.")}}};var s={stringifyByChunk:function(t,i,r){var e=[],s=0,n=t.length;if(n<=r)return String.fromCharCode.apply(null,t);for(;s<n;)e.push("array"===i||"nodebuffer"===i?String.fromCharCode.apply(null,t.slice(s,Math.min(s+r,n))):String.fromCharCode.apply(null,t.subarray(s,Math.min(s+r,n)))),s+=r;return e.join("")},stringifyByChar:function(t){for(var i="",r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i},applyCanBeUsed:{uint8array:function(){try{return As.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return As.nodebuffer&&1===String.fromCharCode.apply(null,Os(1)).length}catch(t){return!1}}()}};function n(t){var r=65536,e=i.getTypeOf(t),n=!0;if("uint8array"===e?n=s.applyCanBeUsed.uint8array:"nodebuffer"===e&&(n=s.applyCanBeUsed.nodebuffer),n)for(;r>1;)try{return s.stringifyByChunk(t,e,r)}catch(h){r=Math.floor(r/2)}return s.stringifyByChar(t)}function h(t,i){for(var r=0;r<t.length;r++)i[r]=t[r];return i}i.applyFromCharCode=n;var o={};o.string={string:r,array:function(t){return e(t,new Array(t.length))},arraybuffer:function(t){return o.string.uint8array(t).buffer},uint8array:function(t){return e(t,new Uint8Array(t.length))},nodebuffer:function(t){return e(t,Os(t.length))}},o.array={string:n,array:r,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return js(t)}},o.arraybuffer={string:function(t){return n(new Uint8Array(t))},array:function(t){return h(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:r,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return js(new Uint8Array(t))}},o.uint8array={string:n,array:function(t){return h(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:r,nodebuffer:function(t){return js(t)}},o.nodebuffer={string:n,array:function(t){return h(t,new Array(t.length))},arraybuffer:function(t){return o.nodebuffer.uint8array(t).buffer},uint8array:function(t){return h(t,new Uint8Array(t.length))},nodebuffer:r},i.transformTo=function(t,r){if(r||(r=""),!t)return r;i.checkSupport(t);var e=i.getTypeOf(r);return o[e][t](r)},i.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":As.nodebuffer&&Qi.isBuffer(t)?"nodebuffer":As.uint8array&&t instanceof Uint8Array?"uint8array":As.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(t){if(!As[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(t){var i,r,e="";for(r=0;r<(t||"").length;r++)e+="\\x"+((i=t.charCodeAt(r))<16?"0":"")+i.toString(16).toUpperCase();return e},i.delay=function(t,i,r){Cs((function(){t.apply(r||null,i||[])}))},i.inherits=function(t,i){var r=function(){};r.prototype=i.prototype,t.prototype=new r},i.extend=function(){var t,i,r={};for(t=0;t<arguments.length;t++)for(i in arguments[t])arguments[t].hasOwnProperty(i)&&void 0===r[i]&&(r[i]=arguments[t][i]);return r},i.prepareContent=function(t,r,s,n,h){return Gs.Promise.resolve(r).then((function(t){return As.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)))&&"undefined"!=typeof FileReader?new Gs.Promise((function(i,r){var e=new FileReader;e.onload=function(t){i(t.target.result)},e.onerror=function(t){r(t.target.error)},e.readAsArrayBuffer(t)})):t})).then((function(r){var o=i.getTypeOf(r);return o?("arraybuffer"===o?r=i.transformTo("uint8array",r):"string"===o&&(h?r=Ss.decode(r):s&&!0!==n&&(r=function(t){return e(t,As.uint8array?new Uint8Array(t.length):new Array(t.length))}(r))),r):Gs.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}}));function Qs(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}Qs.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,i){return this._listeners[t].push(i),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,i){if(this._listeners[t])for(var r=0;r<this._listeners[t].length;r++)this._listeners[t][r].call(this,i)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var i=this;return t.on("data",(function(t){i.processChunk(t)})),t.on("end",(function(){i.end()})),t.on("error",(function(t){i.error(t)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var t=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,i){return this.extraStreamInfo[t]=i,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}};var tn=Qs,rn=h((function(t,i){for(var r=new Array(256),e=0;e<256;e++)r[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;function s(){tn.call(this,"utf-8 decode"),this.leftOver=null}function n(){tn.call(this,"utf-8 encode")}r[254]=r[254]=1,i.utf8encode=function(t){return As.nodebuffer?js(t,"utf-8"):function(t){var i,r,e,s,n,h=t.length,o=0;for(s=0;s<h;s++)55296==(64512&(r=t.charCodeAt(s)))&&s+1<h&&56320==(64512&(e=t.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(e-56320),s++),o+=r<128?1:r<2048?2:r<65536?3:4;for(i=As.uint8array?new Uint8Array(o):new Array(o),n=0,s=0;n<o;s++)55296==(64512&(r=t.charCodeAt(s)))&&s+1<h&&56320==(64512&(e=t.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(e-56320),s++),r<128?i[n++]=r:r<2048?(i[n++]=192|r>>>6,i[n++]=128|63&r):r<65536?(i[n++]=224|r>>>12,i[n++]=128|r>>>6&63,i[n++]=128|63&r):(i[n++]=240|r>>>18,i[n++]=128|r>>>12&63,i[n++]=128|r>>>6&63,i[n++]=128|63&r);return i}(t)},i.utf8decode=function(t){return As.nodebuffer?Vs.transformTo("nodebuffer",t).toString("utf-8"):function(t){var i,e,s,n,h=t.length,o=new Array(2*h);for(e=0,i=0;i<h;)if((s=t[i++])<128)o[e++]=s;else if((n=r[s])>4)o[e++]=65533,i+=n-1;else{for(s&=2===n?31:3===n?15:7;n>1&&i<h;)s=s<<6|63&t[i++],n--;n>1?o[e++]=65533:s<65536?o[e++]=s:(o[e++]=55296|(s-=65536)>>10&1023,o[e++]=56320|1023&s)}return o.length!==e&&(o.subarray?o=o.subarray(0,e):o.length=e),Vs.applyFromCharCode(o)}(t=Vs.transformTo(As.uint8array?"uint8array":"array",t))},Vs.inherits(s,tn),s.prototype.processChunk=function(t){var e=Vs.transformTo(As.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(As.uint8array){var s=e;(e=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),e.set(s,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var n=function(t,i){var e;for((i=i||t.length)>t.length&&(i=t.length),e=i-1;e>=0&&128==(192&t[e]);)e--;return e<0?i:0===e?i:e+r[t[e]]>i?e:i}(e),h=e;n!==e.length&&(As.uint8array?(h=e.subarray(0,n),this.leftOver=e.subarray(n,e.length)):(h=e.slice(0,n),this.leftOver=e.slice(n,e.length))),this.push({data:i.utf8decode(h),meta:t.meta})},s.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=s,Vs.inherits(n,tn),n.prototype.processChunk=function(t){this.push({data:i.utf8encode(t.data),meta:t.meta})},i.Utf8EncodeWorker=n}));function en(t){tn.call(this,"ConvertWorker to "+t),this.destType=t}Vs.inherits(en,tn),en.prototype.processChunk=function(t){this.push({data:Vs.transformTo(this.destType,t.data),meta:t.meta})};var sn=en,nn=Es.Readable;function hn(t,i,r){nn.call(this,i),this._helper=t;var e=this;t.on("data",(function(t,i){e.push(t)||e._helper.pause(),r&&r(i)})).on("error",(function(t){e.emit("error",t)})).on("end",(function(){e.push(null)}))}Vs.inherits(hn,nn),hn.prototype._read=function(){this._helper.resume()};var on=hn,an=null;if(As.nodestream)try{an=on}catch(Ga){}function un(t,i,r){var e=i;switch(i){case"blob":case"arraybuffer":e="uint8array";break;case"base64":e="string"}try{this._internalType=e,this._outputType=i,this._mimeType=r,Vs.checkSupport(e),this._worker=t.pipe(new sn(e)),t.lock()}catch(Ga){this._worker=new tn("error"),this._worker.error(Ga)}}un.prototype={accumulate:function(t){return i=this,r=t,new Gs.Promise((function(t,e){var s=[],n=i._internalType,h=i._outputType,o=i._mimeType;i.on("data",(function(t,i){s.push(t),r&&r(i)})).on("error",(function(t){s=[],e(t)})).on("end",(function(){try{var i=function(t,i,r){switch(t){case"blob":return Vs.newBlob(Vs.transformTo("arraybuffer",i),r);case"base64":return Ss.encode(i);default:return Vs.transformTo(t,i)}}(h,function(t,i){var r,e=0,s=null,n=0;for(r=0;r<i.length;r++)n+=i[r].length;switch(t){case"string":return i.join("");case"array":return Array.prototype.concat.apply([],i);case"uint8array":for(s=new Uint8Array(n),r=0;r<i.length;r++)s.set(i[r],e),e+=i[r].length;return s;case"nodebuffer":return Qi.concat(i);default:throw new Error("concat : unsupported type '"+t+"'")}}(n,s),o);t(i)}catch(Ga){e(Ga)}s=[]})).resume()}));var i,r},on:function(t,i){var r=this;return this._worker.on(t,"data"===t?function(t){i.call(r,t.data,t.meta)}:function(){Vs.delay(i,arguments,r)}),this},resume:function(){return Vs.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(Vs.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new an(this,{objectMode:"nodebuffer"!==this._outputType},t)}};var fn=un,cn={base64:!1,binary:!1,dir:!1,createFolders:!0,date:null,compression:null,compressionOptions:null,comment:null,unixPermissions:null,dosPermissions:null};function ln(t){tn.call(this,"DataWorker");var i=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then((function(t){i.dataIsReady=!0,i.data=t,i.max=t&&t.length||0,i.type=Vs.getTypeOf(t),i.isPaused||i._tickAndRepeat()}),(function(t){i.error(t)}))}Vs.inherits(ln,tn),ln.prototype.cleanUp=function(){tn.prototype.cleanUp.call(this),this.data=null},ln.prototype.resume=function(){return!!tn.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,Vs.delay(this._tickAndRepeat,[],this)),!0)},ln.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(Vs.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},ln.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,i=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,i);break;case"uint8array":t=this.data.subarray(this.index,i);break;case"array":case"nodebuffer":t=this.data.slice(this.index,i)}return this.index=i,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})};var dn=ln;function vn(t){tn.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}Vs.inherits(vn,tn),vn.prototype.processChunk=function(t){t&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+t.data.length),tn.prototype.processChunk.call(this,t)};var pn=vn,wn=function(){for(var t,i=[],r=0;r<256;r++){t=r;for(var e=0;e<8;e++)t=1&t?3988292384^t>>>1:t>>>1;i[r]=t}return i}(),mn=function(t,i){return void 0!==t&&t.length?"string"!==Vs.getTypeOf(t)?function(t,i,r){var e=wn,s=0+r;t^=-1;for(var n=0;n<s;n++)t=t>>>8^e[255&(t^i[n])];return-1^t}(0|i,t,t.length):function(t,i,r){var e=wn,s=0+r;t^=-1;for(var n=0;n<s;n++)t=t>>>8^e[255&(t^i.charCodeAt(n))];return-1^t}(0|i,t,t.length):0};function bn(){tn.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}Vs.inherits(bn,tn),bn.prototype.processChunk=function(t){this.streamInfo.crc32=mn(t.data,this.streamInfo.crc32||0),this.push(t)};var gn=bn;function yn(t,i,r,e,s){this.compressedSize=t,this.uncompressedSize=i,this.crc32=r,this.compression=e,this.compressedContent=s}yn.prototype={getContentWorker:function(){var t=new dn(Gs.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new pn("data_length")),i=this;return t.on("end",(function(){if(this.streamInfo.data_length!==i.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),t},getCompressedWorker:function(){return new dn(Gs.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},yn.createWorkerFrom=function(t,i,r){return t.pipe(new gn).pipe(new pn("uncompressedSize")).pipe(i.compressWorker(r)).pipe(new pn("compressedSize")).withStreamInfo("compression",i)};var xn=yn,kn=function(t,i,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=i,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}};kn.prototype={internalStream:function(t){var i=null,r="string";try{if(!t)throw new Error("No output type specified.");var e="string"===(r=t.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),i=this._decompressWorker();var s=!this._dataBinary;s&&!e&&(i=i.pipe(new rn.Utf8EncodeWorker)),!s&&e&&(i=i.pipe(new rn.Utf8DecodeWorker))}catch(Ga){(i=new tn("error")).error(Ga)}return new fn(i,r,"")},async:function(t,i){return this.internalStream(t).accumulate(i)},nodeStream:function(t,i){return this.internalStream(t||"nodebuffer").toNodejsStream(i)},_compressWorker:function(t,i){if(this._data instanceof xn&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new rn.Utf8EncodeWorker)),xn.createWorkerFrom(r,t,i)},_decompressWorker:function(){return this._data instanceof xn?this._data.getContentWorker():this._data instanceof tn?this._data:new dn(this._data)}};for(var En=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],An=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},Tn=0;Tn<En.length;Tn++)kn.prototype[En[Tn]]=An;var Sn=kn,jn=h((function(t,i){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function e(t,i){return Object.prototype.hasOwnProperty.call(t,i)}i.assign=function(t){for(var i=Array.prototype.slice.call(arguments,1);i.length;){var r=i.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var s in r)e(r,s)&&(t[s]=r[s])}}return t},i.shrinkBuf=function(t,i){return t.length===i?t:t.subarray?t.subarray(0,i):(t.length=i,t)};var s={arraySet:function(t,i,r,e,s){if(i.subarray&&t.subarray)t.set(i.subarray(r,r+e),s);else for(var n=0;n<e;n++)t[s+n]=i[r+n]},flattenChunks:function(t){var i,r,e,s,n,h;for(e=0,i=0,r=t.length;i<r;i++)e+=t[i].length;for(h=new Uint8Array(e),s=0,i=0,r=t.length;i<r;i++)h.set(n=t[i],s),s+=n.length;return h}},n={arraySet:function(t,i,r,e,s){for(var n=0;n<e;n++)t[s+n]=i[r+n]},flattenChunks:function(t){return[].concat.apply([],t)}};i.setTyped=function(t){t?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,n))},i.setTyped(r)}));function On(t){for(var i=t.length;--i>=0;)t[i]=0}var Rn=0,Cn=256,Nn=Cn+1+29,zn=30,Mn=19,In=2*Nn+1,Ln=15,Fn=16,_n=256,Pn=16,Un=17,Bn=18,Dn=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Zn=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],qn=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Wn=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Hn=new Array(2*(Nn+2));On(Hn);var Kn=new Array(2*zn);On(Kn);var $n=new Array(512);On($n);var Xn=new Array(256);On(Xn);var Jn=new Array(29);On(Jn);var Yn,Gn,Vn,Qn=new Array(zn);function th(t,i,r,e,s){this.static_tree=t,this.extra_bits=i,this.extra_base=r,this.elems=e,this.max_length=s,this.has_stree=t&&t.length}function ih(t,i){this.dyn_tree=t,this.max_code=0,this.stat_desc=i}function rh(t){return t<256?$n[t]:$n[256+(t>>>7)]}function eh(t,i){t.pending_buf[t.pending++]=255&i,t.pending_buf[t.pending++]=i>>>8&255}function sh(t,i,r){t.bi_valid>Fn-r?(t.bi_buf|=i<<t.bi_valid&65535,eh(t,t.bi_buf),t.bi_buf=i>>Fn-t.bi_valid,t.bi_valid+=r-Fn):(t.bi_buf|=i<<t.bi_valid&65535,t.bi_valid+=r)}function nh(t,i,r){sh(t,r[2*i],r[2*i+1])}function hh(t,i){var r=0;do{r|=1&t,t>>>=1,r<<=1}while(--i>0);return r>>>1}function oh(t,i,r){var e,s,n=new Array(Ln+1),h=0;for(e=1;e<=Ln;e++)n[e]=h=h+r[e-1]<<1;for(s=0;s<=i;s++){var o=t[2*s+1];0!==o&&(t[2*s]=hh(n[o]++,o))}}function ah(t){var i;for(i=0;i<Nn;i++)t.dyn_ltree[2*i]=0;for(i=0;i<zn;i++)t.dyn_dtree[2*i]=0;for(i=0;i<Mn;i++)t.bl_tree[2*i]=0;t.dyn_ltree[2*_n]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function uh(t){t.bi_valid>8?eh(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function fh(t,i,r,e){var s=2*i,n=2*r;return t[s]<t[n]||t[s]===t[n]&&e[i]<=e[r]}function ch(t,i,r){for(var e=t.heap[r],s=r<<1;s<=t.heap_len&&(s<t.heap_len&&fh(i,t.heap[s+1],t.heap[s],t.depth)&&s++,!fh(i,e,t.heap[s],t.depth));)t.heap[r]=t.heap[s],r=s,s<<=1;t.heap[r]=e}function lh(t,i,r){var e,s,n,h,o=0;if(0!==t.last_lit)do{e=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],s=t.pending_buf[t.l_buf+o],o++,0===e?nh(t,s,i):(nh(t,(n=Xn[s])+Cn+1,i),0!==(h=Dn[n])&&sh(t,s-=Jn[n],h),nh(t,n=rh(--e),r),0!==(h=Zn[n])&&sh(t,e-=Qn[n],h))}while(o<t.last_lit);nh(t,_n,i)}function dh(t,i){var r,e,s,n=i.dyn_tree,h=i.stat_desc.static_tree,o=i.stat_desc.has_stree,a=i.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=In,r=0;r<a;r++)0!==n[2*r]?(t.heap[++t.heap_len]=u=r,t.depth[r]=0):n[2*r+1]=0;for(;t.heap_len<2;)n[2*(s=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[s]=0,t.opt_len--,o&&(t.static_len-=h[2*s+1]);for(i.max_code=u,r=t.heap_len>>1;r>=1;r--)ch(t,n,r);s=a;do{r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],ch(t,n,1),e=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=e,n[2*s]=n[2*r]+n[2*e],t.depth[s]=(t.depth[r]>=t.depth[e]?t.depth[r]:t.depth[e])+1,n[2*r+1]=n[2*e+1]=s,t.heap[1]=s++,ch(t,n,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,i){var r,e,s,n,h,o,a=i.dyn_tree,u=i.max_code,f=i.stat_desc.static_tree,c=i.stat_desc.has_stree,l=i.stat_desc.extra_bits,d=i.stat_desc.extra_base,v=i.stat_desc.max_length,p=0;for(n=0;n<=Ln;n++)t.bl_count[n]=0;for(a[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<In;r++)(n=a[2*a[2*(e=t.heap[r])+1]+1]+1)>v&&(n=v,p++),a[2*e+1]=n,e>u||(t.bl_count[n]++,h=0,e>=d&&(h=l[e-d]),t.opt_len+=(o=a[2*e])*(n+h),c&&(t.static_len+=o*(f[2*e+1]+h)));if(0!==p){do{for(n=v-1;0===t.bl_count[n];)n--;t.bl_count[n]--,t.bl_count[n+1]+=2,t.bl_count[v]--,p-=2}while(p>0);for(n=v;0!==n;n--)for(e=t.bl_count[n];0!==e;)(s=t.heap[--r])>u||(a[2*s+1]!==n&&(t.opt_len+=(n-a[2*s+1])*a[2*s],a[2*s+1]=n),e--)}}(t,i),oh(n,u,t.bl_count)}function vh(t,i,r){var e,s,n=-1,h=i[1],o=0,a=7,u=4;for(0===h&&(a=138,u=3),i[2*(r+1)+1]=65535,e=0;e<=r;e++)s=h,h=i[2*(e+1)+1],++o<a&&s===h||(o<u?t.bl_tree[2*s]+=o:0!==s?(s!==n&&t.bl_tree[2*s]++,t.bl_tree[2*Pn]++):o<=10?t.bl_tree[2*Un]++:t.bl_tree[2*Bn]++,o=0,n=s,0===h?(a=138,u=3):s===h?(a=6,u=3):(a=7,u=4))}function ph(t,i,r){var e,s,n=-1,h=i[1],o=0,a=7,u=4;for(0===h&&(a=138,u=3),e=0;e<=r;e++)if(s=h,h=i[2*(e+1)+1],!(++o<a&&s===h)){if(o<u)do{nh(t,s,t.bl_tree)}while(0!=--o);else 0!==s?(s!==n&&(nh(t,s,t.bl_tree),o--),nh(t,Pn,t.bl_tree),sh(t,o-3,2)):o<=10?(nh(t,Un,t.bl_tree),sh(t,o-3,3)):(nh(t,Bn,t.bl_tree),sh(t,o-11,7));o=0,n=s,0===h?(a=138,u=3):s===h?(a=6,u=3):(a=7,u=4)}}On(Qn);var wh=!1;function mh(t,i,r,e){sh(t,(Rn<<1)+(e?1:0),3),function(t,i,r){uh(t),eh(t,r),eh(t,~r),jn.arraySet(t.pending_buf,t.window,i,r,t.pending),t.pending+=r}(t,i,r)}var bh,gh={_tr_init:function(t){wh||(function(){var t,i,r,e,s,n=new Array(Ln+1);for(r=0,e=0;e<28;e++)for(Jn[e]=r,t=0;t<1<<Dn[e];t++)Xn[r++]=e;for(Xn[r-1]=e,s=0,e=0;e<16;e++)for(Qn[e]=s,t=0;t<1<<Zn[e];t++)$n[s++]=e;for(s>>=7;e<zn;e++)for(Qn[e]=s<<7,t=0;t<1<<Zn[e]-7;t++)$n[256+s++]=e;for(i=0;i<=Ln;i++)n[i]=0;for(t=0;t<=143;)Hn[2*t+1]=8,t++,n[8]++;for(;t<=255;)Hn[2*t+1]=9,t++,n[9]++;for(;t<=279;)Hn[2*t+1]=7,t++,n[7]++;for(;t<=287;)Hn[2*t+1]=8,t++,n[8]++;for(oh(Hn,Nn+1,n),t=0;t<zn;t++)Kn[2*t+1]=5,Kn[2*t]=hh(t,5);Yn=new th(Hn,Dn,Cn+1,Nn,Ln),Gn=new th(Kn,Zn,0,zn,Ln),Vn=new th(new Array(0),qn,0,Mn,7)}(),wh=!0),t.l_desc=new ih(t.dyn_ltree,Yn),t.d_desc=new ih(t.dyn_dtree,Gn),t.bl_desc=new ih(t.bl_tree,Vn),t.bi_buf=0,t.bi_valid=0,ah(t)},_tr_stored_block:mh,_tr_flush_block:function(t,i,r,e){var s,n,h=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var i,r=4093624447;for(i=0;i<=31;i++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*i])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(i=32;i<Cn;i++)if(0!==t.dyn_ltree[2*i])return 1;return 0}(t)),dh(t,t.l_desc),dh(t,t.d_desc),h=function(t){var i;for(vh(t,t.dyn_ltree,t.l_desc.max_code),vh(t,t.dyn_dtree,t.d_desc.max_code),dh(t,t.bl_desc),i=Mn-1;i>=3&&0===t.bl_tree[2*Wn[i]+1];i--);return t.opt_len+=3*(i+1)+5+5+4,i}(t),(n=t.static_len+3+7>>>3)<=(s=t.opt_len+3+7>>>3)&&(s=n)):s=n=r+5,r+4<=s&&-1!==i?mh(t,i,r,e):4===t.strategy||n===s?(sh(t,2+(e?1:0),3),lh(t,Hn,Kn)):(sh(t,4+(e?1:0),3),function(t,i,r,e){var s;for(sh(t,i-257,5),sh(t,r-1,5),sh(t,e-4,4),s=0;s<e;s++)sh(t,t.bl_tree[2*Wn[s]+1],3);ph(t,t.dyn_ltree,i-1),ph(t,t.dyn_dtree,r-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,h+1),lh(t,t.dyn_ltree,t.dyn_dtree)),ah(t),e&&uh(t)},_tr_tally:function(t,i,r){return t.pending_buf[t.d_buf+2*t.last_lit]=i>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&i,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===i?t.dyn_ltree[2*r]++:(t.matches++,i--,t.dyn_ltree[2*(Xn[r]+Cn+1)]++,t.dyn_dtree[2*rh(i)]++),t.last_lit===t.lit_bufsize-1},_tr_align:function(t){sh(t,2,3),nh(t,_n,Hn),function(t){16===t.bi_valid?(eh(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},yh=function(t,i,r,e){for(var s=65535&t|0,n=t>>>16&65535|0,h=0;0!==r;){r-=h=r>2e3?2e3:r;do{n=n+(s=s+i[e++]|0)|0}while(--h);s%=65521,n%=65521}return s|n<<16|0},xh=function(){for(var t,i=[],r=0;r<256;r++){t=r;for(var e=0;e<8;e++)t=1&t?3988292384^t>>>1:t>>>1;i[r]=t}return i}(),kh=function(t,i,r,e){var s=xh,n=e+r;t^=-1;for(var h=e;h<n;h++)t=t>>>8^s[255&(t^i[h])];return-1^t},Eh={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ah=0,Th=4,Sh=0,jh=-2,Oh=-1,Rh=1,Ch=4,Nh=2,zh=8,Mh=9,Ih=286,Lh=30,Fh=19,_h=2*Ih+1,Ph=15,Uh=3,Bh=258,Dh=Bh+Uh+1,Zh=42,qh=113,Wh=1,Hh=2,Kh=3,$h=4;function Xh(t,i){return t.msg=Eh[i],i}function Jh(t){return(t<<1)-(t>4?9:0)}function Yh(t){for(var i=t.length;--i>=0;)t[i]=0}function Gh(t){var i=t.state,r=i.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(jn.arraySet(t.output,i.pending_buf,i.pending_out,r,t.next_out),t.next_out+=r,i.pending_out+=r,t.total_out+=r,t.avail_out-=r,i.pending-=r,0===i.pending&&(i.pending_out=0))}function Vh(t,i){gh._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,i),t.block_start=t.strstart,Gh(t.strm)}function Qh(t,i){t.pending_buf[t.pending++]=i}function to(t,i){t.pending_buf[t.pending++]=i>>>8&255,t.pending_buf[t.pending++]=255&i}function io(t,i){var r,e,s=t.max_chain_length,n=t.strstart,h=t.prev_length,o=t.nice_match,a=t.strstart>t.w_size-Dh?t.strstart-(t.w_size-Dh):0,u=t.window,f=t.w_mask,c=t.prev,l=t.strstart+Bh,d=u[n+h-1],v=u[n+h];t.prev_length>=t.good_match&&(s>>=2),o>t.lookahead&&(o=t.lookahead);do{if(u[(r=i)+h]===v&&u[r+h-1]===d&&u[r]===u[n]&&u[++r]===u[n+1]){n+=2,r++;do{}while(u[++n]===u[++r]&&u[++n]===u[++r]&&u[++n]===u[++r]&&u[++n]===u[++r]&&u[++n]===u[++r]&&u[++n]===u[++r]&&u[++n]===u[++r]&&u[++n]===u[++r]&&n<l);if(e=Bh-(l-n),n=l-Bh,e>h){if(t.match_start=i,h=e,e>=o)break;d=u[n+h-1],v=u[n+h]}}}while((i=c[i&f])>a&&0!=--s);return h<=t.lookahead?h:t.lookahead}function ro(t){var i,r,e,s,n,h,o,a,u,f,c=t.w_size;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=c+(c-Dh)){jn.arraySet(t.window,t.window,c,c,0),t.match_start-=c,t.strstart-=c,t.block_start-=c,i=r=t.hash_size;do{e=t.head[--i],t.head[i]=e>=c?e-c:0}while(--r);i=r=c;do{e=t.prev[--i],t.prev[i]=e>=c?e-c:0}while(--r);s+=c}if(0===t.strm.avail_in)break;if(o=t.window,a=t.strstart+t.lookahead,f=void 0,(f=(h=t.strm).avail_in)>(u=s)&&(f=u),r=0===f?0:(h.avail_in-=f,jn.arraySet(o,h.input,h.next_in,f,a),1===h.state.wrap?h.adler=yh(h.adler,o,f,a):2===h.state.wrap&&(h.adler=kh(h.adler,o,f,a)),h.next_in+=f,h.total_in+=f,f),t.lookahead+=r,t.lookahead+t.insert>=Uh)for(t.ins_h=t.window[n=t.strstart-t.insert],t.ins_h=(t.ins_h<<t.hash_shift^t.window[n+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[n+Uh-1])&t.hash_mask,t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,!(t.lookahead+t.insert<Uh)););}while(t.lookahead<Dh&&0!==t.strm.avail_in)}function eo(t,i){for(var r,e;;){if(t.lookahead<Dh){if(ro(t),t.lookahead<Dh&&i===Ah)return Wh;if(0===t.lookahead)break}if(r=0,t.lookahead>=Uh&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Uh-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-Dh&&(t.match_length=io(t,r)),t.match_length>=Uh)if(e=gh._tr_tally(t,t.strstart-t.match_start,t.match_length-Uh),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Uh){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Uh-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else e=gh._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(e&&(Vh(t,!1),0===t.strm.avail_out))return Wh}return t.insert=t.strstart<Uh-1?t.strstart:Uh-1,i===Th?(Vh(t,!0),0===t.strm.avail_out?Kh:$h):t.last_lit&&(Vh(t,!1),0===t.strm.avail_out)?Wh:Hh}function so(t,i){for(var r,e,s;;){if(t.lookahead<Dh){if(ro(t),t.lookahead<Dh&&i===Ah)return Wh;if(0===t.lookahead)break}if(r=0,t.lookahead>=Uh&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Uh-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Uh-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Dh&&(t.match_length=io(t,r),t.match_length<=5&&(t.strategy===Rh||t.match_length===Uh&&t.strstart-t.match_start>4096)&&(t.match_length=Uh-1)),t.prev_length>=Uh&&t.match_length<=t.prev_length){s=t.strstart+t.lookahead-Uh,e=gh._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-Uh),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=s&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+Uh-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=Uh-1,t.strstart++,e&&(Vh(t,!1),0===t.strm.avail_out))return Wh}else if(t.match_available){if((e=gh._tr_tally(t,0,t.window[t.strstart-1]))&&Vh(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return Wh}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(e=gh._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Uh-1?t.strstart:Uh-1,i===Th?(Vh(t,!0),0===t.strm.avail_out?Kh:$h):t.last_lit&&(Vh(t,!1),0===t.strm.avail_out)?Wh:Hh}function no(t,i,r,e,s){this.good_length=t,this.max_lazy=i,this.nice_length=r,this.max_chain=e,this.func=s}function ho(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=zh,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new jn.Buf16(2*_h),this.dyn_dtree=new jn.Buf16(2*(2*Lh+1)),this.bl_tree=new jn.Buf16(2*(2*Fh+1)),Yh(this.dyn_ltree),Yh(this.dyn_dtree),Yh(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new jn.Buf16(Ph+1),this.heap=new jn.Buf16(2*Ih+1),Yh(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new jn.Buf16(2*Ih+1),Yh(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function oo(t){var i;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=Nh,(i=t.state).pending=0,i.pending_out=0,i.wrap<0&&(i.wrap=-i.wrap),i.status=i.wrap?Zh:qh,t.adler=2===i.wrap?0:1,i.last_flush=Ah,gh._tr_init(i),Sh):Xh(t,jh)}function ao(t){var i,r=oo(t);return r===Sh&&((i=t.state).window_size=2*i.w_size,Yh(i.head),i.max_lazy_match=bh[i.level].max_lazy,i.good_match=bh[i.level].good_length,i.nice_match=bh[i.level].nice_length,i.max_chain_length=bh[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=Uh-1,i.match_available=0,i.ins_h=0),r}function uo(t,i,r,e,s,n){if(!t)return jh;var h=1;if(i===Oh&&(i=6),e<0?(h=0,e=-e):e>15&&(h=2,e-=16),s<1||s>Mh||r!==zh||e<8||e>15||i<0||i>9||n<0||n>Ch)return Xh(t,jh);8===e&&(e=9);var o=new ho;return t.state=o,o.strm=t,o.wrap=h,o.gzhead=null,o.w_bits=e,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=s+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+Uh-1)/Uh),o.window=new jn.Buf8(2*o.w_size),o.head=new jn.Buf16(o.hash_size),o.prev=new jn.Buf16(o.w_size),o.lit_bufsize=1<<s+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new jn.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=i,o.strategy=n,o.method=r,ao(t)}bh=[new no(0,0,0,0,(function(t,i){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(ro(t),0===t.lookahead&&i===Ah)return Wh;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var e=t.block_start+r;if((0===t.strstart||t.strstart>=e)&&(t.lookahead=t.strstart-e,t.strstart=e,Vh(t,!1),0===t.strm.avail_out))return Wh;if(t.strstart-t.block_start>=t.w_size-Dh&&(Vh(t,!1),0===t.strm.avail_out))return Wh}return t.insert=0,i===Th?(Vh(t,!0),0===t.strm.avail_out?Kh:$h):(t.strstart>t.block_start&&Vh(t,!1),Wh)})),new no(4,4,8,4,eo),new no(4,5,16,8,eo),new no(4,6,32,32,eo),new no(4,4,16,16,so),new no(8,16,32,32,so),new no(8,16,128,128,so),new no(8,32,128,256,so),new no(32,128,258,1024,so),new no(32,258,258,4096,so)];var fo={deflateInit:function(t,i){return uo(t,i,zh,15,8,0)},deflateInit2:uo,deflateReset:ao,deflateResetKeep:oo,deflateSetHeader:function(t,i){return t&&t.state?2!==t.state.wrap?jh:(t.state.gzhead=i,Sh):jh},deflate:function(t,i){var r,e,s,n;if(!t||!t.state||i>5||i<0)return t?Xh(t,jh):jh;if(e=t.state,!t.output||!t.input&&0!==t.avail_in||666===e.status&&i!==Th)return Xh(t,0===t.avail_out?-5:jh);if(e.strm=t,r=e.last_flush,e.last_flush=i,e.status===Zh)if(2===e.wrap)t.adler=0,Qh(e,31),Qh(e,139),Qh(e,8),e.gzhead?(Qh(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),Qh(e,255&e.gzhead.time),Qh(e,e.gzhead.time>>8&255),Qh(e,e.gzhead.time>>16&255),Qh(e,e.gzhead.time>>24&255),Qh(e,9===e.level?2:e.strategy>=2||e.level<2?4:0),Qh(e,255&e.gzhead.os),e.gzhead.extra&&e.gzhead.extra.length&&(Qh(e,255&e.gzhead.extra.length),Qh(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(t.adler=kh(t.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=69):(Qh(e,0),Qh(e,0),Qh(e,0),Qh(e,0),Qh(e,0),Qh(e,9===e.level?2:e.strategy>=2||e.level<2?4:0),Qh(e,3),e.status=qh);else{var h=zh+(e.w_bits-8<<4)<<8;h|=(e.strategy>=2||e.level<2?0:e.level<6?1:6===e.level?2:3)<<6,0!==e.strstart&&(h|=32),h+=31-h%31,e.status=qh,to(e,h),0!==e.strstart&&(to(e,t.adler>>>16),to(e,65535&t.adler)),t.adler=1}if(69===e.status)if(e.gzhead.extra){for(s=e.pending;e.gzindex<(65535&e.gzhead.extra.length)&&(e.pending!==e.pending_buf_size||(e.gzhead.hcrc&&e.pending>s&&(t.adler=kh(t.adler,e.pending_buf,e.pending-s,s)),Gh(t),s=e.pending,e.pending!==e.pending_buf_size));)Qh(e,255&e.gzhead.extra[e.gzindex]),e.gzindex++;e.gzhead.hcrc&&e.pending>s&&(t.adler=kh(t.adler,e.pending_buf,e.pending-s,s)),e.gzindex===e.gzhead.extra.length&&(e.gzindex=0,e.status=73)}else e.status=73;if(73===e.status)if(e.gzhead.name){s=e.pending;do{if(e.pending===e.pending_buf_size&&(e.gzhead.hcrc&&e.pending>s&&(t.adler=kh(t.adler,e.pending_buf,e.pending-s,s)),Gh(t),s=e.pending,e.pending===e.pending_buf_size)){n=1;break}n=e.gzindex<e.gzhead.name.length?255&e.gzhead.name.charCodeAt(e.gzindex++):0,Qh(e,n)}while(0!==n);e.gzhead.hcrc&&e.pending>s&&(t.adler=kh(t.adler,e.pending_buf,e.pending-s,s)),0===n&&(e.gzindex=0,e.status=91)}else e.status=91;if(91===e.status)if(e.gzhead.comment){s=e.pending;do{if(e.pending===e.pending_buf_size&&(e.gzhead.hcrc&&e.pending>s&&(t.adler=kh(t.adler,e.pending_buf,e.pending-s,s)),Gh(t),s=e.pending,e.pending===e.pending_buf_size)){n=1;break}n=e.gzindex<e.gzhead.comment.length?255&e.gzhead.comment.charCodeAt(e.gzindex++):0,Qh(e,n)}while(0!==n);e.gzhead.hcrc&&e.pending>s&&(t.adler=kh(t.adler,e.pending_buf,e.pending-s,s)),0===n&&(e.status=103)}else e.status=103;if(103===e.status&&(e.gzhead.hcrc?(e.pending+2>e.pending_buf_size&&Gh(t),e.pending+2<=e.pending_buf_size&&(Qh(e,255&t.adler),Qh(e,t.adler>>8&255),t.adler=0,e.status=qh)):e.status=qh),0!==e.pending){if(Gh(t),0===t.avail_out)return e.last_flush=-1,Sh}else if(0===t.avail_in&&Jh(i)<=Jh(r)&&i!==Th)return Xh(t,-5);if(666===e.status&&0!==t.avail_in)return Xh(t,-5);if(0!==t.avail_in||0!==e.lookahead||i!==Ah&&666!==e.status){var o=2===e.strategy?function(t,i){for(var r;;){if(0===t.lookahead&&(ro(t),0===t.lookahead)){if(i===Ah)return Wh;break}if(t.match_length=0,r=gh._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(Vh(t,!1),0===t.strm.avail_out))return Wh}return t.insert=0,i===Th?(Vh(t,!0),0===t.strm.avail_out?Kh:$h):t.last_lit&&(Vh(t,!1),0===t.strm.avail_out)?Wh:Hh}(e,i):3===e.strategy?function(t,i){for(var r,e,s,n,h=t.window;;){if(t.lookahead<=Bh){if(ro(t),t.lookahead<=Bh&&i===Ah)return Wh;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=Uh&&t.strstart>0&&(e=h[s=t.strstart-1])===h[++s]&&e===h[++s]&&e===h[++s]){n=t.strstart+Bh;do{}while(e===h[++s]&&e===h[++s]&&e===h[++s]&&e===h[++s]&&e===h[++s]&&e===h[++s]&&e===h[++s]&&e===h[++s]&&s<n);t.match_length=Bh-(n-s),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Uh?(r=gh._tr_tally(t,1,t.match_length-Uh),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=gh._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(Vh(t,!1),0===t.strm.avail_out))return Wh}return t.insert=0,i===Th?(Vh(t,!0),0===t.strm.avail_out?Kh:$h):t.last_lit&&(Vh(t,!1),0===t.strm.avail_out)?Wh:Hh}(e,i):bh[e.level].func(e,i);if(o!==Kh&&o!==$h||(e.status=666),o===Wh||o===Kh)return 0===t.avail_out&&(e.last_flush=-1),Sh;if(o===Hh&&(1===i?gh._tr_align(e):5!==i&&(gh._tr_stored_block(e,0,0,!1),3===i&&(Yh(e.head),0===e.lookahead&&(e.strstart=0,e.block_start=0,e.insert=0))),Gh(t),0===t.avail_out))return e.last_flush=-1,Sh}return i!==Th?Sh:e.wrap<=0?1:(2===e.wrap?(Qh(e,255&t.adler),Qh(e,t.adler>>8&255),Qh(e,t.adler>>16&255),Qh(e,t.adler>>24&255),Qh(e,255&t.total_in),Qh(e,t.total_in>>8&255),Qh(e,t.total_in>>16&255),Qh(e,t.total_in>>24&255)):(to(e,t.adler>>>16),to(e,65535&t.adler)),Gh(t),e.wrap>0&&(e.wrap=-e.wrap),0!==e.pending?Sh:1)},deflateEnd:function(t){var i;return t&&t.state?(i=t.state.status)!==Zh&&69!==i&&73!==i&&91!==i&&103!==i&&i!==qh&&666!==i?Xh(t,jh):(t.state=null,i===qh?Xh(t,-3):Sh):jh},deflateSetDictionary:function(t,i){var r,e,s,n,h,o,a,u,f=i.length;if(!t||!t.state)return jh;if(2===(n=(r=t.state).wrap)||1===n&&r.status!==Zh||r.lookahead)return jh;for(1===n&&(t.adler=yh(t.adler,i,f,0)),r.wrap=0,f>=r.w_size&&(0===n&&(Yh(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new jn.Buf8(r.w_size),jn.arraySet(u,i,f-r.w_size,r.w_size,0),i=u,f=r.w_size),h=t.avail_in,o=t.next_in,a=t.input,t.avail_in=f,t.next_in=0,t.input=i,ro(r);r.lookahead>=Uh;){e=r.strstart,s=r.lookahead-(Uh-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[e+Uh-1])&r.hash_mask,r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--s);r.strstart=e,r.lookahead=Uh-1,ro(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=Uh-1,r.match_available=0,t.next_in=o,t.input=a,t.avail_in=h,r.wrap=n,Sh},deflateInfo:"pako deflate (from Nodeca project)"},co=!0,lo=!0;try{String.fromCharCode.apply(null,[0])}catch(Va){co=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Va){lo=!1}for(var vo=new jn.Buf8(256),po=0;po<256;po++)vo[po]=po>=252?6:po>=248?5:po>=240?4:po>=224?3:po>=192?2:1;function wo(t,i){if(i<65534&&(t.subarray&&lo||!t.subarray&&co))return String.fromCharCode.apply(null,jn.shrinkBuf(t,i));for(var r="",e=0;e<i;e++)r+=String.fromCharCode(t[e]);return r}vo[254]=vo[254]=1;var mo={string2buf:function(t){var i,r,e,s,n,h=t.length,o=0;for(s=0;s<h;s++)55296==(64512&(r=t.charCodeAt(s)))&&s+1<h&&56320==(64512&(e=t.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(e-56320),s++),o+=r<128?1:r<2048?2:r<65536?3:4;for(i=new jn.Buf8(o),n=0,s=0;n<o;s++)55296==(64512&(r=t.charCodeAt(s)))&&s+1<h&&56320==(64512&(e=t.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(e-56320),s++),r<128?i[n++]=r:r<2048?(i[n++]=192|r>>>6,i[n++]=128|63&r):r<65536?(i[n++]=224|r>>>12,i[n++]=128|r>>>6&63,i[n++]=128|63&r):(i[n++]=240|r>>>18,i[n++]=128|r>>>12&63,i[n++]=128|r>>>6&63,i[n++]=128|63&r);return i},buf2binstring:function(t){return wo(t,t.length)},binstring2buf:function(t){for(var i=new jn.Buf8(t.length),r=0,e=i.length;r<e;r++)i[r]=t.charCodeAt(r);return i},buf2string:function(t,i){var r,e,s,n,h=i||t.length,o=new Array(2*h);for(e=0,r=0;r<h;)if((s=t[r++])<128)o[e++]=s;else if((n=vo[s])>4)o[e++]=65533,r+=n-1;else{for(s&=2===n?31:3===n?15:7;n>1&&r<h;)s=s<<6|63&t[r++],n--;n>1?o[e++]=65533:s<65536?o[e++]=s:(o[e++]=55296|(s-=65536)>>10&1023,o[e++]=56320|1023&s)}return wo(o,e)},utf8border:function(t,i){var r;for((i=i||t.length)>t.length&&(i=t.length),r=i-1;r>=0&&128==(192&t[r]);)r--;return r<0?i:0===r?i:r+vo[t[r]]>i?r:i}},bo=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},go=Object.prototype.toString,yo=0,xo=-1,ko=0,Eo=8;function Ao(t){if(!(this instanceof Ao))return new Ao(t);this.options=jn.assign({level:xo,method:Eo,chunkSize:16384,windowBits:15,memLevel:8,strategy:ko,to:""},t||{});var i=this.options;i.raw&&i.windowBits>0?i.windowBits=-i.windowBits:i.gzip&&i.windowBits>0&&i.windowBits<16&&(i.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new bo,this.strm.avail_out=0;var r=fo.deflateInit2(this.strm,i.level,i.method,i.windowBits,i.memLevel,i.strategy);if(r!==yo)throw new Error(Eh[r]);if(i.header&&fo.deflateSetHeader(this.strm,i.header),i.dictionary){var e;if(e="string"==typeof i.dictionary?mo.string2buf(i.dictionary):"[object ArrayBuffer]"===go.call(i.dictionary)?new Uint8Array(i.dictionary):i.dictionary,(r=fo.deflateSetDictionary(this.strm,e))!==yo)throw new Error(Eh[r]);this._dict_set=!0}}function To(t,i){var r=new Ao(i);if(r.push(t,!0),r.err)throw r.msg||Eh[r.err];return r.result}Ao.prototype.push=function(t,i){var r,e,s=this.strm,n=this.options.chunkSize;if(this.ended)return!1;e=i===~~i?i:!0===i?4:0,s.input="string"==typeof t?mo.string2buf(t):"[object ArrayBuffer]"===go.call(t)?new Uint8Array(t):t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new jn.Buf8(n),s.next_out=0,s.avail_out=n),1!==(r=fo.deflate(s,e))&&r!==yo)return this.onEnd(r),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==e&&2!==e)||this.onData("string"===this.options.to?mo.buf2binstring(jn.shrinkBuf(s.output,s.next_out)):jn.shrinkBuf(s.output,s.next_out))}while((s.avail_in>0||0===s.avail_out)&&1!==r);return 4===e?(r=fo.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===yo):2!==e||(this.onEnd(yo),s.avail_out=0,!0)},Ao.prototype.onData=function(t){this.chunks.push(t)},Ao.prototype.onEnd=function(t){t===yo&&(this.result="string"===this.options.to?this.chunks.join(""):jn.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var So={Deflate:Ao,deflate:To,deflateRaw:function(t,i){return(i=i||{}).raw=!0,To(t,i)},gzip:function(t,i){return(i=i||{}).gzip=!0,To(t,i)}},jo=function(t,i){var r,e,s,n,h,o,a,u,f,c,l,d,v,p,w,m,b,g,y,x,k,E,A,T,S;T=t.input,s=(e=t.next_in)+(t.avail_in-5),S=t.output,h=(n=t.next_out)-(i-t.avail_out),o=n+(t.avail_out-257),a=(r=t.state).dmax,u=r.wsize,f=r.whave,c=r.wnext,l=r.window,d=r.hold,v=r.bits,p=r.lencode,w=r.distcode,m=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;t:do{v<15&&(d+=T[e++]<<v,d+=T[e++]<<(v+=8),v+=8),g=p[d&m];i:for(;;){if(d>>>=y=g>>>24,v-=y,0==(y=g>>>16&255))S[n++]=65535&g;else{if(!(16&y)){if(0==(64&y)){g=p[(65535&g)+(d&(1<<y)-1)];continue i}if(32&y){r.mode=12;break t}t.msg="invalid literal/length code",r.mode=30;break t}x=65535&g,(y&=15)&&(v<y&&(d+=T[e++]<<v,v+=8),x+=d&(1<<y)-1,d>>>=y,v-=y),v<15&&(d+=T[e++]<<v,d+=T[e++]<<(v+=8),v+=8),g=w[d&b];r:for(;;){if(d>>>=y=g>>>24,v-=y,!(16&(y=g>>>16&255))){if(0==(64&y)){g=w[(65535&g)+(d&(1<<y)-1)];continue r}t.msg="invalid distance code",r.mode=30;break t}if(k=65535&g,v<(y&=15)&&(d+=T[e++]<<v,(v+=8)<y&&(d+=T[e++]<<v,v+=8)),(k+=d&(1<<y)-1)>a){t.msg="invalid distance too far back",r.mode=30;break t}if(d>>>=y,v-=y,k>(y=n-h)){if((y=k-y)>f&&r.sane){t.msg="invalid distance too far back",r.mode=30;break t}if(E=0,A=l,0===c){if(E+=u-y,y<x){x-=y;do{S[n++]=l[E++]}while(--y);E=n-k,A=S}}else if(c<y){if(E+=u+c-y,(y-=c)<x){x-=y;do{S[n++]=l[E++]}while(--y);if(E=0,c<x){x-=y=c;do{S[n++]=l[E++]}while(--y);E=n-k,A=S}}}else if(E+=c-y,y<x){x-=y;do{S[n++]=l[E++]}while(--y);E=n-k,A=S}for(;x>2;)S[n++]=A[E++],S[n++]=A[E++],S[n++]=A[E++],x-=3;x&&(S[n++]=A[E++],x>1&&(S[n++]=A[E++]))}else{E=n-k;do{S[n++]=S[E++],S[n++]=S[E++],S[n++]=S[E++],x-=3}while(x>2);x&&(S[n++]=S[E++],x>1&&(S[n++]=S[E++]))}break}}break}}while(e<s&&n<o);d&=(1<<(v-=(x=v>>3)<<3))-1,t.next_in=e-=x,t.next_out=n,t.avail_in=e<s?s-e+5:5-(e-s),t.avail_out=n<o?o-n+257:257-(n-o),r.hold=d,r.bits=v},Oo=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Ro=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Co=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],No=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],zo=function(t,i,r,e,s,n,h,o){var a,u,f,c,l,d,v,p,w,m=o.bits,b=0,g=0,y=0,x=0,k=0,E=0,A=0,T=0,S=0,j=0,O=null,R=0,C=new jn.Buf16(16),N=new jn.Buf16(16),z=null,M=0;for(b=0;b<=15;b++)C[b]=0;for(g=0;g<e;g++)C[i[r+g]]++;for(k=m,x=15;x>=1&&0===C[x];x--);if(k>x&&(k=x),0===x)return s[n++]=20971520,s[n++]=20971520,o.bits=1,0;for(y=1;y<x&&0===C[y];y++);for(k<y&&(k=y),T=1,b=1;b<=15;b++)if(T<<=1,(T-=C[b])<0)return-1;if(T>0&&(0===t||1!==x))return-1;for(N[1]=0,b=1;b<15;b++)N[b+1]=N[b]+C[b];for(g=0;g<e;g++)0!==i[r+g]&&(h[N[i[r+g]]++]=g);if(0===t?(O=z=h,d=19):1===t?(O=Oo,R-=257,z=Ro,M-=257,d=256):(O=Co,z=No,d=-1),j=0,g=0,b=y,l=n,E=k,A=0,f=-1,c=(S=1<<k)-1,1===t&&S>852||2===t&&S>592)return 1;for(;;){v=b-A,h[g]<d?(p=0,w=h[g]):h[g]>d?(p=z[M+h[g]],w=O[R+h[g]]):(p=96,w=0),a=1<<b-A,y=u=1<<E;do{s[l+(j>>A)+(u-=a)]=v<<24|p<<16|w|0}while(0!==u);for(a=1<<b-1;j&a;)a>>=1;if(0!==a?(j&=a-1,j+=a):j=0,g++,0==--C[b]){if(b===x)break;b=i[r+h[g]]}if(b>k&&(j&c)!==f){for(0===A&&(A=k),l+=y,T=1<<(E=b-A);E+A<x&&!((T-=C[E+A])<=0);)E++,T<<=1;if(S+=1<<E,1===t&&S>852||2===t&&S>592)return 1;s[f=j&c]=k<<24|E<<16|l-n|0}}return 0!==j&&(s[l+j]=b-A<<24|64<<16|0),o.bits=k,0},Mo=1,Io=2,Lo=0,Fo=-2,_o=1,Po=852,Uo=592;function Bo(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function Do(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new jn.Buf16(320),this.work=new jn.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Zo(t){var i;return t&&t.state?(t.total_in=t.total_out=(i=t.state).total=0,t.msg="",i.wrap&&(t.adler=1&i.wrap),i.mode=_o,i.last=0,i.havedict=0,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new jn.Buf32(Po),i.distcode=i.distdyn=new jn.Buf32(Uo),i.sane=1,i.back=-1,Lo):Fo}function qo(t){var i;return t&&t.state?((i=t.state).wsize=0,i.whave=0,i.wnext=0,Zo(t)):Fo}function Wo(t,i){var r,e;return t&&t.state?(i<0?(r=0,i=-i):(r=1+(i>>4),i<48&&(i&=15)),i&&(i<8||i>15)?Fo:(null!==(e=t.state).window&&e.wbits!==i&&(e.window=null),e.wrap=r,e.wbits=i,qo(t))):Fo}function Ho(t,i){var r,e;return t?(e=new Do,t.state=e,e.window=null,(r=Wo(t,i))!==Lo&&(t.state=null),r):Fo}var Ko,$o,Xo=!0;function Jo(t){if(Xo){var i;for(Ko=new jn.Buf32(512),$o=new jn.Buf32(32),i=0;i<144;)t.lens[i++]=8;for(;i<256;)t.lens[i++]=9;for(;i<280;)t.lens[i++]=7;for(;i<288;)t.lens[i++]=8;for(zo(Mo,t.lens,0,288,Ko,0,t.work,{bits:9}),i=0;i<32;)t.lens[i++]=5;zo(Io,t.lens,0,32,$o,0,t.work,{bits:5}),Xo=!1}t.lencode=Ko,t.lenbits=9,t.distcode=$o,t.distbits=5}function Yo(t,i,r,e){var s,n=t.state;return null===n.window&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new jn.Buf8(n.wsize)),e>=n.wsize?(jn.arraySet(n.window,i,r-n.wsize,n.wsize,0),n.wnext=0,n.whave=n.wsize):((s=n.wsize-n.wnext)>e&&(s=e),jn.arraySet(n.window,i,r-e,s,n.wnext),(e-=s)?(jn.arraySet(n.window,i,r-e,e,0),n.wnext=e,n.whave=n.wsize):(n.wnext+=s,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=s))),0}var Go={inflateReset:qo,inflateReset2:Wo,inflateResetKeep:Zo,inflateInit:function(t){return Ho(t,15)},inflateInit2:Ho,inflate:function(t,i){var r,e,s,n,h,o,a,u,f,c,l,d,v,p,w,m,b,g,y,x,k,E,A,T,S=0,j=new jn.Buf8(4),O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return Fo;12===(r=t.state).mode&&(r.mode=13),h=t.next_out,s=t.output,n=t.next_in,e=t.input,u=r.hold,f=r.bits,c=o=t.avail_in,l=a=t.avail_out,E=Lo;t:for(;;)switch(r.mode){case _o:if(0===r.wrap){r.mode=13;break}for(;f<16;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}if(2&r.wrap&&35615===u){r.check=0,j[0]=255&u,j[1]=u>>>8&255,r.check=kh(r.check,j,2,0),u=0,f=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&u)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=30;break}if(8!=(15&u)){t.msg="unknown compression method",r.mode=30;break}if(f-=4,k=8+(15&(u>>>=4)),0===r.wbits)r.wbits=k;else if(k>r.wbits){t.msg="invalid window size",r.mode=30;break}r.dmax=1<<k,t.adler=r.check=1,r.mode=512&u?10:12,u=0,f=0;break;case 2:for(;f<16;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}if(r.flags=u,8!=(255&r.flags)){t.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=u>>8&1),512&r.flags&&(j[0]=255&u,j[1]=u>>>8&255,r.check=kh(r.check,j,2,0)),u=0,f=0,r.mode=3;case 3:for(;f<32;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}r.head&&(r.head.time=u),512&r.flags&&(j[0]=255&u,j[1]=u>>>8&255,j[2]=u>>>16&255,j[3]=u>>>24&255,r.check=kh(r.check,j,4,0)),u=0,f=0,r.mode=4;case 4:for(;f<16;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}r.head&&(r.head.xflags=255&u,r.head.os=u>>8),512&r.flags&&(j[0]=255&u,j[1]=u>>>8&255,r.check=kh(r.check,j,2,0)),u=0,f=0,r.mode=5;case 5:if(1024&r.flags){for(;f<16;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}r.length=u,r.head&&(r.head.extra_len=u),512&r.flags&&(j[0]=255&u,j[1]=u>>>8&255,r.check=kh(r.check,j,2,0)),u=0,f=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((d=r.length)>o&&(d=o),d&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),jn.arraySet(r.head.extra,e,n,d,k)),512&r.flags&&(r.check=kh(r.check,e,d,n)),o-=d,n+=d,r.length-=d),r.length))break t;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===o)break t;d=0;do{k=e[n+d++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k))}while(k&&d<o);if(512&r.flags&&(r.check=kh(r.check,e,d,n)),o-=d,n+=d,k)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===o)break t;d=0;do{k=e[n+d++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k))}while(k&&d<o);if(512&r.flags&&(r.check=kh(r.check,e,d,n)),o-=d,n+=d,k)break t}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;f<16;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}if(u!==(65535&r.check)){t.msg="header crc mismatch",r.mode=30;break}u=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=12;break;case 10:for(;f<32;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}t.adler=r.check=Bo(u),u=0,f=0,r.mode=11;case 11:if(0===r.havedict)return t.next_out=h,t.avail_out=a,t.next_in=n,t.avail_in=o,r.hold=u,r.bits=f,2;t.adler=r.check=1,r.mode=12;case 12:if(5===i||6===i)break t;case 13:if(r.last){u>>>=7&f,f-=7&f,r.mode=27;break}for(;f<3;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}switch(r.last=1&u,f-=1,3&(u>>>=1)){case 0:r.mode=14;break;case 1:if(Jo(r),r.mode=20,6===i){u>>>=2,f-=2;break t}break;case 2:r.mode=17;break;case 3:t.msg="invalid block type",r.mode=30}u>>>=2,f-=2;break;case 14:for(u>>>=7&f,f-=7&f;f<32;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}if((65535&u)!=(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&u,u=0,f=0,r.mode=15,6===i)break t;case 15:r.mode=16;case 16:if(d=r.length){if(d>o&&(d=o),d>a&&(d=a),0===d)break t;jn.arraySet(s,e,n,d,h),o-=d,n+=d,a-=d,h+=d,r.length-=d;break}r.mode=12;break;case 17:for(;f<14;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}if(r.nlen=257+(31&u),f-=5,r.ndist=1+(31&(u>>>=5)),f-=5,r.ncode=4+(15&(u>>>=5)),u>>>=4,f-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;f<3;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}r.lens[O[r.have++]]=7&u,u>>>=3,f-=3}for(;r.have<19;)r.lens[O[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,E=zo(0,r.lens,0,19,r.lencode,0,r.work,A={bits:r.lenbits}),r.lenbits=A.bits,E){t.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;m=(S=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,b=65535&S,!((w=S>>>24)<=f);){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}if(b<16)u>>>=w,f-=w,r.lens[r.have++]=b;else{if(16===b){for(T=w+2;f<T;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}if(u>>>=w,f-=w,0===r.have){t.msg="invalid bit length repeat",r.mode=30;break}k=r.lens[r.have-1],d=3+(3&u),u>>>=2,f-=2}else if(17===b){for(T=w+3;f<T;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}f-=w,k=0,d=3+(7&(u>>>=w)),u>>>=3,f-=3}else{for(T=w+7;f<T;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}f-=w,k=0,d=11+(127&(u>>>=w)),u>>>=7,f-=7}if(r.have+d>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=30;break}for(;d--;)r.lens[r.have++]=k}}if(30===r.mode)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,E=zo(Mo,r.lens,0,r.nlen,r.lencode,0,r.work,A={bits:r.lenbits}),r.lenbits=A.bits,E){t.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,E=zo(Io,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,A={bits:r.distbits}),r.distbits=A.bits,E){t.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===i)break t;case 20:r.mode=21;case 21:if(o>=6&&a>=258){t.next_out=h,t.avail_out=a,t.next_in=n,t.avail_in=o,r.hold=u,r.bits=f,jo(t,l),h=t.next_out,s=t.output,a=t.avail_out,n=t.next_in,e=t.input,o=t.avail_in,u=r.hold,f=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;m=(S=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,b=65535&S,!((w=S>>>24)<=f);){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}if(m&&0==(240&m)){for(g=w,y=m,x=b;m=(S=r.lencode[x+((u&(1<<g+y)-1)>>g)])>>>16&255,b=65535&S,!(g+(w=S>>>24)<=f);){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}u>>>=g,f-=g,r.back+=g}if(u>>>=w,f-=w,r.back+=w,r.length=b,0===m){r.mode=26;break}if(32&m){r.back=-1,r.mode=12;break}if(64&m){t.msg="invalid literal/length code",r.mode=30;break}r.extra=15&m,r.mode=22;case 22:if(r.extra){for(T=r.extra;f<T;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;m=(S=r.distcode[u&(1<<r.distbits)-1])>>>16&255,b=65535&S,!((w=S>>>24)<=f);){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}if(0==(240&m)){for(g=w,y=m,x=b;m=(S=r.distcode[x+((u&(1<<g+y)-1)>>g)])>>>16&255,b=65535&S,!(g+(w=S>>>24)<=f);){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}u>>>=g,f-=g,r.back+=g}if(u>>>=w,f-=w,r.back+=w,64&m){t.msg="invalid distance code",r.mode=30;break}r.offset=b,r.extra=15&m,r.mode=24;case 24:if(r.extra){for(T=r.extra;f<T;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===a)break t;if(r.offset>(d=l-a)){if((d=r.offset-d)>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=30;break}v=d>r.wnext?r.wsize-(d-=r.wnext):r.wnext-d,d>r.length&&(d=r.length),p=r.window}else p=s,v=h-r.offset,d=r.length;d>a&&(d=a),a-=d,r.length-=d;do{s[h++]=p[v++]}while(--d);0===r.length&&(r.mode=21);break;case 26:if(0===a)break t;s[h++]=r.length,a--,r.mode=21;break;case 27:if(r.wrap){for(;f<32;){if(0===o)break t;o--,u|=e[n++]<<f,f+=8}if(t.total_out+=l-=a,r.total+=l,l&&(t.adler=r.check=r.flags?kh(r.check,s,l,h-l):yh(r.check,s,l,h-l)),l=a,(r.flags?u:Bo(u))!==r.check){t.msg="incorrect data check",r.mode=30;break}u=0,f=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;f<32;){if(0===o)break t;o--,u+=e[n++]<<f,f+=8}if(u!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=30;break}u=0,f=0}r.mode=29;case 29:E=1;break t;case 30:E=-3;break t;case 31:return-4;case 32:default:return Fo}return t.next_out=h,t.avail_out=a,t.next_in=n,t.avail_in=o,r.hold=u,r.bits=f,(r.wsize||l!==t.avail_out&&r.mode<30&&(r.mode<27||4!==i))&&Yo(t,t.output,t.next_out,l-t.avail_out),l-=t.avail_out,t.total_in+=c-=t.avail_in,t.total_out+=l,r.total+=l,r.wrap&&l&&(t.adler=r.check=r.flags?kh(r.check,s,l,t.next_out-l):yh(r.check,s,l,t.next_out-l)),t.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===c&&0===l||4===i)&&E===Lo&&(E=-5),E},inflateEnd:function(t){if(!t||!t.state)return Fo;var i=t.state;return i.window&&(i.window=null),t.state=null,Lo},inflateGetHeader:function(t,i){var r;return t&&t.state?0==(2&(r=t.state).wrap)?Fo:(r.head=i,i.done=!1,Lo):Fo},inflateSetDictionary:function(t,i){var r,e=i.length;return t&&t.state?0!==(r=t.state).wrap&&11!==r.mode?Fo:11===r.mode&&yh(1,i,e,0)!==r.check?-3:Yo(t,i,e,e)?(r.mode=31,-4):(r.havedict=1,Lo):Fo},inflateInfo:"pako inflate (from Nodeca project)"},Vo={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Qo=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},ta=Object.prototype.toString;function ia(t){if(!(this instanceof ia))return new ia(t);this.options=jn.assign({chunkSize:16384,windowBits:0,to:""},t||{});var i=this.options;i.raw&&i.windowBits>=0&&i.windowBits<16&&(i.windowBits=-i.windowBits,0===i.windowBits&&(i.windowBits=-15)),!(i.windowBits>=0&&i.windowBits<16)||t&&t.windowBits||(i.windowBits+=32),i.windowBits>15&&i.windowBits<48&&0==(15&i.windowBits)&&(i.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new bo,this.strm.avail_out=0;var r=Go.inflateInit2(this.strm,i.windowBits);if(r!==Vo.Z_OK)throw new Error(Eh[r]);if(this.header=new Qo,Go.inflateGetHeader(this.strm,this.header),i.dictionary&&("string"==typeof i.dictionary?i.dictionary=mo.string2buf(i.dictionary):"[object ArrayBuffer]"===ta.call(i.dictionary)&&(i.dictionary=new Uint8Array(i.dictionary)),i.raw&&(r=Go.inflateSetDictionary(this.strm,i.dictionary))!==Vo.Z_OK))throw new Error(Eh[r])}function ra(t,i){var r=new ia(i);if(r.push(t,!0),r.err)throw r.msg||Eh[r.err];return r.result}ia.prototype.push=function(t,i){var r,e,s,n,h,o=this.strm,a=this.options.chunkSize,u=this.options.dictionary,f=!1;if(this.ended)return!1;e=i===~~i?i:!0===i?Vo.Z_FINISH:Vo.Z_NO_FLUSH,o.input="string"==typeof t?mo.binstring2buf(t):"[object ArrayBuffer]"===ta.call(t)?new Uint8Array(t):t,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new jn.Buf8(a),o.next_out=0,o.avail_out=a),(r=Go.inflate(o,Vo.Z_NO_FLUSH))===Vo.Z_NEED_DICT&&u&&(r=Go.inflateSetDictionary(this.strm,u)),r===Vo.Z_BUF_ERROR&&!0===f&&(r=Vo.Z_OK,f=!1),r!==Vo.Z_STREAM_END&&r!==Vo.Z_OK)return this.onEnd(r),this.ended=!0,!1;o.next_out&&(0!==o.avail_out&&r!==Vo.Z_STREAM_END&&(0!==o.avail_in||e!==Vo.Z_FINISH&&e!==Vo.Z_SYNC_FLUSH)||("string"===this.options.to?(s=mo.utf8border(o.output,o.next_out),n=o.next_out-s,h=mo.buf2string(o.output,s),o.next_out=n,o.avail_out=a-n,n&&jn.arraySet(o.output,o.output,s,n,0),this.onData(h)):this.onData(jn.shrinkBuf(o.output,o.next_out)))),0===o.avail_in&&0===o.avail_out&&(f=!0)}while((o.avail_in>0||0===o.avail_out)&&r!==Vo.Z_STREAM_END);return r===Vo.Z_STREAM_END&&(e=Vo.Z_FINISH),e===Vo.Z_FINISH?(r=Go.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Vo.Z_OK):e!==Vo.Z_SYNC_FLUSH||(this.onEnd(Vo.Z_OK),o.avail_out=0,!0)},ia.prototype.onData=function(t){this.chunks.push(t)},ia.prototype.onEnd=function(t){t===Vo.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):jn.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var ea={};(0,jn.assign)(ea,So,{Inflate:ia,inflate:ra,inflateRaw:function(t,i){return(i=i||{}).raw=!0,ra(t,i)},ungzip:ra},Vo);var sa=ea,na="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array?"uint8array":"array";function ha(t,i){tn.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=i,this.meta={}}Vs.inherits(ha,tn),ha.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(Vs.transformTo(na,t.data),!1)},ha.prototype.flush=function(){tn.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},ha.prototype.cleanUp=function(){tn.prototype.cleanUp.call(this),this._pako=null},ha.prototype._createPako=function(){this._pako=new sa[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(i){t.push({data:i,meta:t.meta})}};var oa={STORE:{magic:"\0\0",compressWorker:function(){return new tn("STORE compression")},uncompressWorker:function(){return new tn("STORE decompression")}},DEFLATE:{magic:"\b\0",compressWorker:function(t){return new ha("Deflate",t)},uncompressWorker:function(){return new ha("Inflate",{})}}},aa=function(t,i){var r,e="";for(r=0;r<i;r++)e+=String.fromCharCode(255&t),t>>>=8;return e},ua=function(t,i,r,e,s,n){var h,o,a=t.file,u=t.compression,f=n!==rn.utf8encode,c=Vs.transformTo("string",n(a.name)),l=Vs.transformTo("string",rn.utf8encode(a.name)),d=a.comment,v=Vs.transformTo("string",n(d)),p=Vs.transformTo("string",rn.utf8encode(d)),w=l.length!==a.name.length,m=p.length!==d.length,b="",g="",y="",x=a.dir,k=a.date,E={crc32:0,compressedSize:0,uncompressedSize:0};i&&!r||(E.crc32=t.crc32,E.compressedSize=t.compressedSize,E.uncompressedSize=t.uncompressedSize);var A=0;i&&(A|=8),f||!w&&!m||(A|=2048);var T=0,S=0;x&&(T|=16),"UNIX"===s?(S=798,T|=function(t,i){var r=t;return t||(r=i?16893:33204),(65535&r)<<16}(a.unixPermissions,x)):(S=20,T|=function(t){return 63&(t||0)}(a.dosPermissions)),h=k.getUTCHours(),h<<=6,h|=k.getUTCMinutes(),h<<=5,h|=k.getUTCSeconds()/2,o=k.getUTCFullYear()-1980,o<<=4,o|=k.getUTCMonth()+1,o<<=5,o|=k.getUTCDate(),w&&(g=aa(1,1)+aa(mn(c),4)+l,b+="up"+aa(g.length,2)+g),m&&(y=aa(1,1)+aa(mn(v),4)+p,b+="uc"+aa(y.length,2)+y);var j="";return j+="\n\0",j+=aa(A,2),j+=u.magic,j+=aa(h,2),j+=aa(o,2),j+=aa(E.crc32,4),j+=aa(E.compressedSize,4),j+=aa(E.uncompressedSize,4),j+=aa(c.length,2),{fileRecord:"PK"+(j+=aa(b.length,2))+c+b,dirRecord:"PK"+aa(S,2)+j+aa(v.length,2)+"\0\0\0\0"+aa(T,4)+aa(e,4)+c+b+v}},fa=function(t){return"PK\b"+aa(t.crc32,4)+aa(t.compressedSize,4)+aa(t.uncompressedSize,4)};function ca(t,i,r,e){tn.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=i,this.zipPlatform=r,this.encodeFileName=e,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}Vs.inherits(ca,tn),ca.prototype.push=function(t){var i=t.meta.percent||0,r=this.entriesCount,e=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,tn.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:r?(i+100*(r-e-1))/r:100}}))},ca.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var i=this.streamFiles&&!t.file.dir;if(i){var r=ua(t,i,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ca.prototype.closedSource=function(t){this.accumulate=!1;var i=this.streamFiles&&!t.file.dir,r=ua(t,i,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),i)this.push({data:fa(t),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ca.prototype.flush=function(){for(var t=this.bytesWritten,i=0;i<this.dirRecords.length;i++)this.push({data:this.dirRecords[i],meta:{percent:100}});var r=function(t,i,r,e,s){var n=Vs.transformTo("string",s(e));return"PK\0\0\0\0"+aa(t,2)+aa(t,2)+aa(i,4)+aa(r,4)+aa(n.length,2)+n}(this.dirRecords.length,this.bytesWritten-t,t,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})},ca.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ca.prototype.registerPrevious=function(t){this._sources.push(t);var i=this;return t.on("data",(function(t){i.processChunk(t)})),t.on("end",(function(){i.closedSource(i.previous.streamInfo),i._sources.length?i.prepareNextSource():i.end()})),t.on("error",(function(t){i.error(t)})),this},ca.prototype.resume=function(){return!!tn.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},ca.prototype.error=function(t){var i=this._sources;if(!tn.prototype.error.call(this,t))return!1;for(var r=0;r<i.length;r++)try{i[r].error(t)}catch(t){}return!0},ca.prototype.lock=function(){tn.prototype.lock.call(this);for(var t=this._sources,i=0;i<t.length;i++)t[i].lock()};var la=ca;function da(t,i){tn.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(i)}Vs.inherits(da,tn),da.prototype._bindStream=function(t){var i=this;this._stream=t,t.pause(),t.on("data",(function(t){i.push({data:t,meta:{percent:0}})})).on("error",(function(t){i.isPaused?this.generatedError=t:i.error(t)})).on("end",(function(){i.isPaused?i._upstreamEnded=!0:i.end()}))},da.prototype.pause=function(){return!!tn.prototype.pause.call(this)&&(this._stream.pause(),!0)},da.prototype.resume=function(){return!!tn.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)};var va=da,pa=function(t,i,r){var e,s=Vs.getTypeOf(i),n=Vs.extend(r||{},cn);n.date=n.date||new Date,null!==n.compression&&(n.compression=n.compression.toUpperCase()),"string"==typeof n.unixPermissions&&(n.unixPermissions=parseInt(n.unixPermissions,8)),n.unixPermissions&&16384&n.unixPermissions&&(n.dir=!0),n.dosPermissions&&16&n.dosPermissions&&(n.dir=!0),n.dir&&(t=ma(t)),n.createFolders&&(e=wa(t))&&ba.call(this,e,!0),r&&void 0!==r.binary||(n.binary=!("string"===s&&!1===n.binary&&!1===n.base64)),(i instanceof xn&&0===i.uncompressedSize||n.dir||!i||0===i.length)&&(n.base64=!1,n.binary=!0,i="",n.compression="STORE",s="string");var h;h=i instanceof xn||i instanceof tn?i:Rs(i)?new va(t,i):Vs.prepareContent(t,i,n.binary,n.optimizedBinaryString,n.base64);var o=new Sn(t,h,n);this.files[t]=o},wa=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var i=t.lastIndexOf("/");return i>0?t.substring(0,i):""},ma=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},ba=function(t,i){return i=void 0!==i?i:cn.createFolders,t=ma(t),this.files[t]||pa.call(this,t,null,{dir:!0,createFolders:i}),this.files[t]};function ga(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var ya={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var i,r,e;for(i in this.files)this.files.hasOwnProperty(i)&&(e=this.files[i],(r=i.slice(this.root.length,i.length))&&i.slice(0,this.root.length)===this.root&&t(r,e))},filter:function(t){var i=[];return this.forEach((function(r,e){t(r,e)&&i.push(e)})),i},file:function(t,i,r){if(1===arguments.length){if(ga(t)){var e=t;return this.filter((function(t,i){return!i.dir&&e.test(t)}))}var s=this.files[this.root+t];return s&&!s.dir?s:null}return pa.call(this,t=this.root+t,i,r),this},folder:function(t){if(!t)return this;if(ga(t))return this.filter((function(i,r){return r.dir&&t.test(i)}));var i=ba.call(this,this.root+t),r=this.clone();return r.root=i.name,r},remove:function(t){var i=this.files[t=this.root+t];if(i||("/"!==t.slice(-1)&&(t+="/"),i=this.files[t]),i&&!i.dir)delete this.files[t];else for(var r=this.filter((function(i,r){return r.name.slice(0,t.length)===t})),e=0;e<r.length;e++)delete this.files[r[e].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var i,r={};try{if((r=Vs.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:rn.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");Vs.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS"),i=function(t,i,r){var e=new la(i.streamFiles,r,i.platform,i.encodeFileName),s=0;try{t.forEach((function(t,r){s++;var n=function(t,i){var r=t||i,e=oa[r];if(!e)throw new Error(r+" is not a valid compression method !");return e}(r.options.compression,i.compression),h=r.dir,o=r.date;r._compressWorker(n,r.options.compressionOptions||i.compressionOptions||{}).withStreamInfo("file",{name:t,dir:h,date:o,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(e)})),e.entriesCount=s}catch(Ga){e.error(Ga)}return e}(this,r,r.comment||this.comment||"")}catch(Ga){(i=new tn("error")).error(Ga)}return new fn(i,r.type||"string",r.mimeType)},generateAsync:function(t,i){return this.generateInternalStream(t).accumulate(i)},generateNodeStream:function(t,i){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(i)}};function xa(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}xa.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var i,r=0;for(this.checkOffset(t),i=this.index+t-1;i>=this.index;i--)r=(r<<8)+this.byteAt(i);return this.index+=t,r},readString:function(t){return Vs.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}};var ka=xa;function Ea(t){ka.call(this,t);for(var i=0;i<this.data.length;i++)t[i]=255&t[i]}Vs.inherits(Ea,ka),Ea.prototype.byteAt=function(t){return this.data[this.zero+t]},Ea.prototype.lastIndexOfSignature=function(t){for(var i=t.charCodeAt(0),r=t.charCodeAt(1),e=t.charCodeAt(2),s=t.charCodeAt(3),n=this.length-4;n>=0;--n)if(this.data[n]===i&&this.data[n+1]===r&&this.data[n+2]===e&&this.data[n+3]===s)return n-this.zero;return-1},Ea.prototype.readAndCheckSignature=function(t){var i=t.charCodeAt(0),r=t.charCodeAt(1),e=t.charCodeAt(2),s=t.charCodeAt(3),n=this.readData(4);return i===n[0]&&r===n[1]&&e===n[2]&&s===n[3]},Ea.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var i=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,i};var Aa=Ea;function Ta(t){ka.call(this,t)}Vs.inherits(Ta,ka),Ta.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},Ta.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},Ta.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},Ta.prototype.readData=function(t){this.checkOffset(t);var i=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,i};var Sa=Ta;function ja(t){Aa.call(this,t)}Vs.inherits(ja,Aa),ja.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var i=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,i};var Oa=ja;function Ra(t){Oa.call(this,t)}Vs.inherits(Ra,Oa),Ra.prototype.readData=function(t){this.checkOffset(t);var i=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,i};var Ca=Ra,Na=function(t){var i=Vs.getTypeOf(t);return Vs.checkSupport(i),"string"!==i||As.uint8array?"nodebuffer"===i?new Ca(t):As.uint8array?new Oa(Vs.transformTo("uint8array",t)):new Aa(Vs.transformTo("array",t)):new Sa(t)};function za(t,i){this.options=t,this.loadOptions=i}za.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var i,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(i=function(t){for(var i in oa)if(oa.hasOwnProperty(i)&&oa[i].magic===t)return oa[i];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+Vs.pretty(this.compressionMethod)+" unknown (inner file : "+Vs.transformTo("string",this.fileName)+")");this.decompressed=new xn(this.compressedSize,this.uncompressedSize,this.crc32,i,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var i=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(i),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===t&&(this.dosPermissions=63&this.externalFileAttributes),3===t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var t=Na(this.extraFields[1].value);this.uncompressedSize===Vs.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===Vs.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===Vs.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===Vs.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(t){var i,r,e,s=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index<s;)i=t.readInt(2),r=t.readInt(2),e=t.readData(r),this.extraFields[i]={id:i,length:r,value:e}},handleUTF8:function(){var t=As.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=rn.utf8decode(this.fileName),this.fileCommentStr=rn.utf8decode(this.fileComment);else{var i=this.findExtraFieldUnicodePath();if(null!==i)this.fileNameStr=i;else{var r=Vs.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var e=this.findExtraFieldUnicodeComment();if(null!==e)this.fileCommentStr=e;else{var s=Vs.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var i=Na(t.value);return 1!==i.readInt(1)?null:mn(this.fileName)!==i.readInt(4)?null:rn.utf8decode(i.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var i=Na(t.value);return 1!==i.readInt(1)?null:mn(this.fileComment)!==i.readInt(4)?null:rn.utf8decode(i.readData(t.length-5))}return null}};var Ma=za;function Ia(t){this.files=[],this.loadOptions=t}Ia.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var i=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+Vs.pretty(i)+", expected "+Vs.pretty(t)+")")}},isSignature:function(t,i){var r=this.reader.index;this.reader.setIndex(t);var e=this.reader.readString(4)===i;return this.reader.setIndex(r),e},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),i=Vs.transformTo(As.uint8array?"uint8array":"array",t);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,i,r,e=this.zip64EndOfCentralSize-44;0<e;)t=this.reader.readInt(2),i=this.reader.readInt(4),r=this.reader.readData(i),this.zip64ExtensibleData[t]={id:t,length:i,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,i;for(t=0;t<this.files.length;t++)this.reader.setIndex((i=this.files[t]).localHeaderOffset),this.checkSignature("PK"),i.readLocalPart(this.reader),i.handleUTF8(),i.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature("PK");)(t=new Ma({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature("PK");if(t<0)throw this.isSignature(0,"PK")?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(t);var i=t;if(this.checkSignature("PK"),this.readBlockEndOfCentral(),this.diskNumber===Vs.MAX_VALUE_16BITS||this.diskWithCentralDirStart===Vs.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===Vs.MAX_VALUE_16BITS||this.centralDirRecords===Vs.MAX_VALUE_16BITS||this.centralDirSize===Vs.MAX_VALUE_32BITS||this.centralDirOffset===Vs.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature("PK"))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature("PK"),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,"PK")&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature("PK"),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature("PK"),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var e=i-r;if(e>0)this.isSignature(i,"PK")||(this.reader.zero=e);else if(e<0)throw new Error("Corrupted zip: missing "+Math.abs(e)+" bytes.")},prepareReader:function(t){this.reader=Na(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var La=Ia;function Fa(t){return new Gs.Promise((function(i,r){var e=t.decompressed.getContentWorker().pipe(new gn);e.on("error",(function(t){r(t)})).on("end",(function(){e.streamInfo.crc32!==t.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):i()})).resume()}))}function _a(){if(!(this instanceof _a))return new _a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var t=new _a;for(var i in this)"function"!=typeof this[i]&&(t[i]=this[i]);return t}}(_a.prototype=ya).loadAsync=function(t,i){var r=this;return i=Vs.extend(i||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:rn.utf8decode}),Rs(t)?Gs.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):Vs.prepareContent("the loaded zip file",t,!0,i.optimizedBinaryString,i.base64).then((function(t){var r=new La(i);return r.load(t),r})).then((function(t){var r=[Gs.Promise.resolve(t)],e=t.files;if(i.checkCRC32)for(var s=0;s<e.length;s++)r.push(Fa(e[s]));return Gs.Promise.all(r)})).then((function(t){for(var e=t.shift(),s=e.files,n=0;n<s.length;n++){var h=s[n];r.file(h.fileNameStr,h.decompressed,{binary:!0,optimizedBinaryString:!0,date:h.date,dir:h.dir,comment:h.fileCommentStr.length?h.fileCommentStr:null,unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions,createFolders:i.createFolders})}return e.zipComment.length&&(r.comment=e.zipComment),r}))},_a.support=As,_a.defaults=cn,_a.version="3.2.0",_a.loadAsync=function(t,i){return(new _a).loadAsync(t,i)},_a.external=Gs;var Pa=_a;class Ua{constructor(){this.zip=new Pa,this.urlCache={}}checkRequirements(){console.log("check for jszip");try{if(void 0===Pa){let t=require("jszip");this.zip=new t}else this.zip=new Pa}catch(Ga){throw new Error("JSZip lib not loaded")}}open(t,i){return this.zip.loadAsync(t,{base64:i})}openUrl(t,i){return Ui(t,"binary").then(function(t){return this.zip.loadAsync(t,{base64:i})}.bind(this))}request(t,i){var r,e=new ht,s=new gt(t);return i||(i=s.extension),(r="blob"==i?this.getBlob(t):this.getText(t))?r.then(function(t){let r=this.handleResponse(t,i);e.resolve(r)}.bind(this)):e.reject({message:"File not found in the epub: "+t,stack:(new Error).stack}),e.promise}handleResponse(t,i){return"json"==i?JSON.parse(t):K(i)?V(t,"text/xml"):"xhtml"==i?V(t,"application/xhtml+xml"):"html"==i||"htm"==i?V(t,"text/html"):t}getBlob(t,i){var r=window.decodeURIComponent(t.substr(1)),e=this.zip.file(r);if(e)return i=i||Zt.lookup(e.name),e.async("uint8array").then((function(t){return new Blob([t],{type:i})}))}getText(t,i){var r=window.decodeURIComponent(t.substr(1)),e=this.zip.file(r);if(e)return e.async("string").then((function(t){return t}))}getBase64(t,i){var r=window.decodeURIComponent(t.substr(1)),e=this.zip.file(r);if(e)return i=i||Zt.lookup(e.name),e.async("base64").then((function(t){return"data:"+i+";base64,"+t}))}createUrl(t,i){var r,e,s=new ht,n=window.URL||window.webkitURL||window.mozURL,h=i&&i.base64;return t in this.urlCache?(s.resolve(this.urlCache[t]),s.promise):(h?(e=this.getBase64(t))&&e.then(function(i){this.urlCache[t]=i,s.resolve(i)}.bind(this)):(e=this.getBlob(t))&&e.then(function(i){r=n.createObjectURL(i),this.urlCache[t]=r,s.resolve(r)}.bind(this)),e||s.reject({message:"File not found in the epub: "+t,stack:(new Error).stack}),s.promise)}revokeUrl(t){var i=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[t];r&&i.revokeObjectURL(r)}destroy(){var t=window.URL||window.webkitURL||window.mozURL;for(let i in this.urlCache)t.revokeObjectURL(i);this.zip=void 0,this.urlCache={}}}class Ba{constructor(t,i,r){this.urlCache={},this.storage=void 0,this.name=t,this.requester=i||Ui,this.resolver=r,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let t;t="undefined"==typeof localforage?require("localforage"):localforage,this.storage=t.createInstance({name:this.name})}catch(Ga){throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(t){let i=navigator.onLine;this.online=i,this.emit(i?"online":"offline",this)}add(t,i){let r=t.resources.map(t=>{let{href:r}=t,e=this.resolver(r),s=window.encodeURIComponent(e);return this.storage.getItem(s).then(t=>!t||i?this.requester(e,"binary").then(t=>this.storage.setItem(s,t)):t)});return Promise.all(r)}put(t,i,r){let e=window.encodeURIComponent(t);return this.storage.getItem(e).then(s=>s||this.requester(t,"binary",i,r).then(t=>this.storage.setItem(e,t)))}request(t,i,r,e){return this.online?this.requester(t,i,r,e).then(i=>(this.put(t),i)):this.retrieve(t,i)}retrieve(t,i){new ht;var r=new gt(t);return i||(i=r.extension),("blob"==i?this.getBlob(t):this.getText(t)).then(r=>{var e,s=new ht;return r?(e=this.handleResponse(r,i),s.resolve(e)):s.reject({message:"File not found in storage: "+t,stack:(new Error).stack}),s.promise})}handleResponse(t,i){return"json"==i?JSON.parse(t):K(i)?V(t,"text/xml"):"xhtml"==i?V(t,"application/xhtml+xml"):"html"==i||"htm"==i?V(t,"text/html"):t}getBlob(t,i){let r=window.encodeURIComponent(t);return this.storage.getItem(r).then((function(r){if(r)return i=i||Zt.lookup(t),new Blob([r],{type:i})}))}getText(t,i){let r=window.encodeURIComponent(t);return i=i||Zt.lookup(t),this.storage.getItem(r).then((function(t){var r,e=new ht,s=new FileReader;if(t)return r=new Blob([t],{type:i}),s.addEventListener("loadend",()=>{e.resolve(s.result)}),s.readAsText(r,i),e.promise}))}getBase64(t,i){let r=window.encodeURIComponent(t);return i=i||Zt.lookup(t),this.storage.getItem(r).then(t=>{var r,e=new ht,s=new FileReader;if(t)return r=new Blob([t],{type:i}),s.addEventListener("loadend",()=>{e.resolve(s.result)}),s.readAsDataURL(r,i),e.promise})}createUrl(t,i){var r,e,s=new ht,n=window.URL||window.webkitURL||window.mozURL,h=i&&i.base64;return t in this.urlCache?(s.resolve(this.urlCache[t]),s.promise):(h?(e=this.getBase64(t))&&e.then(function(i){this.urlCache[t]=i,s.resolve(i)}.bind(this)):(e=this.getBlob(t))&&e.then(function(i){r=n.createObjectURL(i),this.urlCache[t]=r,s.resolve(r)}.bind(this)),e||s.reject({message:"File not found in storage: "+t,stack:(new Error).stack}),s.promise)}revokeUrl(t){var i=window.URL||window.webkitURL||window.mozURL,r=this.urlCache[t];r&&i.revokeObjectURL(r)}destroy(){var t=window.URL||window.webkitURL||window.mozURL;for(let i in this.urlCache)t.revokeObjectURL(i);this.urlCache={},this.removeListeners()}}j(Ba.prototype);class Da{constructor(t){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",t&&this.parse(t)}parse(t){if(!t)return this;const i=Q(t,"display_options");return i?(tt(i,"option").forEach(t=>{let i="";switch(t.childNodes.length&&(i=t.childNodes[0].nodeValue),t.attributes.name.value){case"interactive":this.interactive=i;break;case"fixed-layout":this.fixedLayout=i;break;case"open-to-spread":this.openToSpread=i;break;case"orientation-lock":this.orientationLock=i}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}const Za="META-INF/container.xml",qa="META-INF/com.apple.ibooks.display-options.xml",Wa={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class Ha{constructor(t,i){void 0===i&&"string"!=typeof t&&t instanceof Blob==0&&(i=t,t=void 0),this.settings=_(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),_(this.settings,i),this.opening=new ht,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new ht,spine:new ht,metadata:new ht,cover:new ht,navigation:new ht,pageList:new ht,resources:new ht,displayOptions:new ht},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||Ui,this.spine=new Nt,this.locations=new Ft(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),t&&this.open(t,this.settings.openAs).catch(()=>{var i=new Error("Cannot load book at "+t);this.emit(Lt.BOOK.OPEN_FAILED,i)})}open(t,i){var r,e=i||this.determineType(t);return e===Wa.BINARY?(this.archived=!0,this.url=new yt("/",""),r=this.openEpub(t)):e===Wa.BASE64?(this.archived=!0,this.url=new yt("/",""),r=this.openEpub(t,e)):e===Wa.EPUB?(this.archived=!0,this.url=new yt("/",""),r=this.request(t,"binary",this.settings.requestCredentials).then(this.openEpub.bind(this))):e==Wa.OPF?(this.url=new yt(t),r=this.openPackaging(this.url.Path.toString())):e==Wa.MANIFEST?(this.url=new yt(t),r=this.openManifest(this.url.Path.toString())):(this.url=new yt(t),r=this.openContainer(Za).then(this.openPackaging.bind(this))),r}openEpub(t,i){return this.unarchive(t,i||this.settings.encoding).then(()=>this.openContainer(Za)).then(t=>this.openPackaging(t))}openContainer(t){return this.load(t).then(t=>(this.container=new _t(t),this.resolve(this.container.packagePath)))}openPackaging(t){return this.path=new gt(t),this.load(t).then(t=>(this.packaging=new Pt(t),this.unpack(this.packaging)))}openManifest(t){return this.path=new gt(t),this.load(t).then(t=>(this.packaging=new Pt,this.packaging.load(t),this.unpack(this.packaging)))}load(t){var i=this.resolve(t);return this.archived?this.archive.request(i):this.request(i,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(t,i){if(t){var r=t;return t.indexOf("://")>-1?t:(this.path&&(r=this.path.resolve(t)),0!=i&&this.url&&(r=this.url.resolve(r)),r)}}canonical(t){return t?this.settings.canonical?this.settings.canonical(t):this.resolve(t,!0):""}determineType(t){var i;return"base64"===this.settings.encoding?Wa.BASE64:"string"!=typeof t?Wa.BINARY:(i=new yt(t).path().extension)?"epub"===i?Wa.EPUB:"opf"===i?Wa.OPF:"json"===i?Wa.MANIFEST:void 0:Wa.DIRECTORY}unpack(t){this.package=t,""===this.packaging.metadata.layout?this.load(this.url.resolve(qa)).then(t=>{this.displayOptions=new Da(t),this.loading.displayOptions.resolve(this.displayOptions)}).catch(()=>{this.displayOptions=new Da,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new Da,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new qt(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&"none"!=this.settings.replacements?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(t=>{console.error(t)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(t){let i=t.navPath||t.ncxPath,r=t.toc;return r?new Promise(i=>{this.navigation=new Ut(r),t.pageList&&(this.pageList=new Wt(t.pageList)),i(this.navigation)}):i?this.load(i,"xml").then(t=>(this.navigation=new Ut(t),this.pageList=new Wt(t),this.navigation)):new Promise(t=>{this.navigation=new Ut,this.pageList=new Wt,t(this.navigation)})}section(t){return this.spine.get(t)}renderTo(t,i){return this.rendition=new Pi(this,i),this.rendition.attachTo(t),this.rendition}setRequestCredentials(t){this.settings.requestCredentials=t}setRequestHeaders(t){this.settings.requestHeaders=t}unarchive(t,i){return this.archive=new Ua,this.archive.open(t,i)}store(t){let i=this.settings.replacements&&"none"!==this.settings.replacements,r=this.url,e=this.settings.requestMethod||Ui.bind(this);return this.storage=new Ba(t,e,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let t=(t,i)=>{i.output=this.resources.substitute(t,i.url)};this.resources.settings.replacements=i||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new yt("/",""),this.spine.hooks.serialize.register(t)}),this.storage.on("online",()=>{this.url=r,this.spine.hooks.serialize.deregister(t)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.archived?this.resources.get(this.cover):this.cover)}replacements(){return this.spine.hooks.serialize.register((t,i)=>{i.output=this.resources.substitute(t,i.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(t){var i=new At(t),r=this.spine.get(i.spinePos),e=this.load.bind(this);return r?r.load(e).then((function(){return i.toRange(r.document)})):new Promise((t,i)=>{i("CFI could not be found")})}key(t){return`epubjs:${Mt}:${t||this.packaging.metadata.identifier||this.url.filename}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}function Ka(t,i){return new Ha(t,i)}var $a;j(Ha.prototype),function(t){var i=function(){try{return!!Symbol.iterator}catch(t){return!1}}(),r=function(t){var r={next:function(){var i=t.shift();return{done:void 0===i,value:i}}};return i&&(r[Symbol.iterator]=function(){return r}),r},e=function(t){return encodeURIComponent(t).replace(/%20/g,"+")},s=function(t){return decodeURIComponent(String(t).replace(/\+/g," "))};(function(){try{var i=t.URLSearchParams;return"a=1"===new i("?a=1").toString()&&"function"==typeof i.prototype.set}catch(Ga){return!1}})()||function(){var s=function(t){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var i=typeof t;if("undefined"===i);else if("string"===i)""!==t&&this._fromString(t);else if(t instanceof s){var r=this;t.forEach((function(t,i){r.append(i,t)}))}else{if(null===t||"object"!==i)throw new TypeError("Unsupported input's type for URLSearchParams");if("[object Array]"===Object.prototype.toString.call(t))for(var e=0;e<t.length;e++){var n=t[e];if("[object Array]"!==Object.prototype.toString.call(n)&&2===n.length)throw new TypeError("Expected [string, any] as entry at index "+e+" of URLSearchParams's input");this.append(n[0],n[1])}else for(var h in t)t.hasOwnProperty(h)&&this.append(h,t[h])}},n=s.prototype;n.append=function(t,i){t in this._entries?this._entries[t].push(String(i)):this._entries[t]=[String(i)]},n.delete=function(t){delete this._entries[t]},n.get=function(t){return t in this._entries?this._entries[t][0]:null},n.getAll=function(t){return t in this._entries?this._entries[t].slice(0):[]},n.has=function(t){return t in this._entries},n.set=function(t,i){this._entries[t]=[String(i)]},n.forEach=function(t,i){var r;for(var e in this._entries)if(this._entries.hasOwnProperty(e)){r=this._entries[e];for(var s=0;s<r.length;s++)t.call(i,r[s],e,this)}},n.keys=function(){var t=[];return this.forEach((function(i,r){t.push(r)})),r(t)},n.values=function(){var t=[];return this.forEach((function(i){t.push(i)})),r(t)},n.entries=function(){var t=[];return this.forEach((function(i,r){t.push([r,i])})),r(t)},i&&(n[Symbol.iterator]=n.entries),n.toString=function(){var t=[];return this.forEach((function(i,r){t.push(e(r)+"="+e(i))})),t.join("&")},t.URLSearchParams=s}();var n=t.URLSearchParams.prototype;"function"!=typeof n.sort&&(n.sort=function(){var t=this,i=[];this.forEach((function(r,e){i.push([e,r]),t._entries||t.delete(e)})),i.sort((function(t,i){return t[0]<i[0]?-1:t[0]>i[0]?1:0})),t._entries&&(t._entries={});for(var r=0;r<i.length;r++)this.append(i[r][0],i[r][1])}),"function"!=typeof n._fromString&&Object.defineProperty(n,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(t){if(this._entries)this._entries={};else{var i=[];this.forEach((function(t,r){i.push(r)}));for(var r=0;r<i.length;r++)this.delete(i[r])}var e,n=(t=t.replace(/^\?/,"")).split("&");for(r=0;r<n.length;r++)e=n[r].split("="),this.append(s(e[0]),e.length>1?s(e[1]):"")}})}(void 0!==s?s:"undefined"!=typeof window?window:"undefined"!=typeof self?self:s),function(t){if(function(){try{var i=new t.URL("b","http://a");return i.pathname="c%20d","http://a/c%20d"===i.href&&i.searchParams}catch(Ga){return!1}}()||function(){var i=t.URL,r=function(i,r){"string"!=typeof i&&(i=String(i));var e,s=document;if(r&&(void 0===t.location||r!==t.location.href)){(e=(s=document.implementation.createHTMLDocument("")).createElement("base")).href=r,s.head.appendChild(e);try{if(0!==e.href.indexOf(r))throw new Error(e.href)}catch(Xh){throw new Error("URL unable to set base "+r+" due to "+Xh)}}var n=s.createElement("a");if(n.href=i,e&&(s.body.appendChild(n),n.href=n.href),":"===n.protocol||!/:/.test(n.href))throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:n});var h=new t.URLSearchParams(this.search),o=!0,a=!0,u=this;["append","delete","set"].forEach((function(t){var i=h[t];h[t]=function(){i.apply(h,arguments),o&&(a=!1,u.search=h.toString(),a=!0)}})),Object.defineProperty(this,"searchParams",{value:h,enumerable:!0});var f=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==f&&(f=this.search,a&&(o=!1,this.searchParams._fromString(this.search),o=!0))}})},e=r.prototype;["hash","host","hostname","port","protocol"].forEach((function(t){!function(t){Object.defineProperty(e,t,{get:function(){return this._anchorElement[t]},set:function(i){this._anchorElement[t]=i},enumerable:!0})}(t)})),Object.defineProperty(e,"search",{get:function(){return this._anchorElement.search},set:function(t){this._anchorElement.search=t,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(e,{toString:{get:function(){var t=this;return function(){return t.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(t){this._anchorElement.href=t,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(t){this._anchorElement.pathname=t},enumerable:!0},origin:{get:function(){return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(this._anchorElement.port!={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol]&&""!==this._anchorElement.port?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(){},enumerable:!0},username:{get:function(){return""},set:function(){},enumerable:!0}}),r.createObjectURL=function(t){return i.createObjectURL.apply(i,arguments)},r.revokeObjectURL=function(t){return i.revokeObjectURL.apply(i,arguments)},t.URL=r}(),void 0!==t.location&&!("origin"in t.location)){var i=function(){return t.location.protocol+"//"+t.location.hostname+(t.location.port?":"+t.location.port:"")};try{Object.defineProperty(t.location,"origin",{get:i,enumerable:!0})}catch(Ga){setInterval((function(){t.location.origin=i()}),100)}}}(void 0!==s?s:"undefined"!=typeof window?window:"undefined"!=typeof self?self:s),Ka.VERSION=Mt,void 0!==Bi&&(Bi.EPUBJS_VERSION=Mt),Ka.Book=Ha,Ka.Rendition=Pi,Ka.Contents=Vt,Ka.CFI=At,Ka.utils=dt,function(t){t.LTR="ltr",t.RTL="rtl"}($a||($a={}));var Xa=h((function(t){
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){var i={}.hasOwnProperty;function r(){for(var t=[],e=0;e<arguments.length;e++){var s=arguments[e];if(s){var n=typeof s;if("string"===n||"number"===n)t.push(s);else if(Array.isArray(s)&&s.length){var h=r.apply(null,s);h&&t.push(h)}else if("object"===n)for(var o in s)i.call(s,o)&&s[o]&&t.push(o)}}return t.join(" ")}t.exports?(r.default=r,t.exports=r):window.classNames=r}()}));const Ja=class{constructor(r){t(this,r),this._book=null,this._rendition=null,this._bookReady=!1,this._prevEnabled=!0,this._nextEnabled=!0,this._showDivider=!1,this.width="100%",this.height="100%",this.minSpreadWidth=700,this.bookReady=i(this,"bookReady",7),this.loadedBookMetadata=i(this,"loadedBookMetadata",7),this.loadedNavigation=i(this,"loadedNavigation",7),this.relocated=i(this,"relocated",7),this.renditionAttached=i(this,"renditionAttached",7)}async load(t){this._book&&(this._book.destroy(),this._book=null,this._rendition=null,this._bookReady=!1),this._bookPath=t}async resize(){this._bookReady&&this._rendition.resize(this._viewer.clientWidth,this._viewer.clientHeight)}async display(t){this._rendition.display(t)}_prev(){this._bookReady&&(this._book.package.metadata.direction===$a.RTL?this._rendition.next():this._rendition.prev())}_next(){this._bookReady&&(this._book.package.metadata.direction===$a.RTL?this._rendition.prev():this._rendition.next())}_prevButtonClickedHandler(t){this._prev(),t.preventDefault()}_nextButtonClickedHandler(t){this._next(),t.preventDefault()}render(){const t=Xa({show:this._bookReady&&this._showDivider}),i=Xa({arrow:!0,disabled:!this._prevEnabled&&!this._bookReady}),e=Xa({twoup:this._showDivider}),s=Xa({arrow:!0,disabled:!this._nextEnabled&&!this._bookReady});return r("div",{id:"main"},r("div",{id:"titlebar"}),r("div",{id:"divider",class:t}),r("div",{id:"prev",class:i,onClick:t=>this._prevButtonClickedHandler(t)},"<"),r("div",{id:"viewer",class:e,ref:t=>this._viewer=t}),this._nextEnabled?r("div",{id:"next",class:s,onClick:t=>this._nextButtonClickedHandler(t)},">"):null,!this._bookReady&&r("div",{id:"spinner"},r("div",{class:"square"})))}_renderBook(){this._bookPath&&!this._rendition&&(this._book=Ka(this._bookPath),this._rendition=this._book.renderTo(this._viewer,{flow:"auto",width:this.width,height:this.height,minSpreadWidth:this.minSpreadWidth}),this._rendition.themes.register("custom",{"*":{"font-family":"'Stix', serif !important","font-variant-numeric":"oldstyle-nums !important"}}),this._rendition.themes.select("custom"),this._rendition.display(),this._rendition.on("attached",()=>{this.renditionAttached.emit()}),this._rendition.on("layout",()=>{this._showDivider=this._viewer.clientWidth>=this.minSpreadWidth}),this._rendition.on("relocated",t=>{this._prevEnabled=!t.atStart,this._nextEnabled=!t.atEnd,this.relocated.emit(t)}),this._book.ready.then(()=>{this._bookReady=!0,this.bookReady.emit()}),this._book.loaded.metadata.then(t=>{this.loadedBookMetadata.emit(t)}),this._book.loaded.navigation.then(t=>{this.loadedNavigation.emit(t)}))}componentDidUpdate(){this._renderBook()}static get assetsDirs(){return["assets"]}get el(){return e(this)}static get style(){return"#main{position:absolute;width:100%;height:100%;right:0;overflow:hidden}#titlebar{height:10%}#viewer{width:75%;height:80%;margin:0 auto;max-width:1250px;z-index:2;position:relative;overflow:hidden}#viewer iframe{border:none}#prev{left:20px}#next{right:20px}.arrow{position:absolute;top:50%;margin-top:-50px;font-size:64px;color:var(--reader-arrow-color);font-family:monospace,sans-serif;font-weight:700;cursor:pointer;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.arrow:hover{color:var(--reader-arrow-hover-color)}.arrow.active,.arrow:active{color:#000}#divider{position:absolute;width:1px;border-right:1px solid #000;height:80%;z-index:1;left:50%;margin-left:-1px;top:10%;opacity:.15;-webkit-box-shadow:-2px 0 15px #000;box-shadow:-2px 0 15px #000;display:none}#divider.show{display:block}#spinner{position:absolute;z-index:10;left:50%;top:calc(50% - 15px)}#spinner .square{background-color:var(--reader-spinner-color,#fff);margin:0 0 0 -15px;width:30px;height:30px;-webkit-animation:sk-rotateplane 1.2s ease-in-out infinite;-moz-animation:sk-rotateplane 1.2s infinite ease-in-out;animation:sk-rotateplane 1.2s ease-in-out infinite}\@-webkit-keyframes sk-rotateplane{0%{-webkit-transform:perspective(120px)}50%{-webkit-transform:perspective(120px) rotateY(180deg)}to{-webkit-transform:perspective(120px) rotateY(180deg) rotateX(180deg)}}\@keyframes sk-rotateplane{0%{transform:perspective(120px) rotateX(0deg) rotateY(0deg);-webkit-transform:perspective(120px) rotateX(0deg) rotateY(0deg)}50%{transform:perspective(120px) rotateX(-180.1deg) rotateY(0deg);-webkit-transform:perspective(120px) rotateX(-180.1deg) rotateY(0deg)}to{transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg);-webkit-transform:perspective(120px) rotateX(-180deg) rotateY(-179.9deg)}}.highlight{background-color:#ff0}.md-show,.md-show~.overlay{visibility:visible}.md-show~.overlay{opacity:1}.md-content{color:#fff;background:#6b6b6b;position:relative;border-radius:3px;margin:0 auto;height:320px}.md-content h3{margin:0;padding:6px;text-align:center;font-size:22px;font-weight:300;opacity:.8;background:rgba(0,0,0,.1);border-radius:3px 3px 0 0}.md-content>div{padding:15px 40px 30px;margin:0;font-weight:300;font-size:14px}.md-content>div p{margin:0;padding:10px 0}.md-content>div ul{margin:0;padding:0 0 30px 20px}.md-content>div ul li{padding:5px 0}.md-content button{display:block;margin:0 auto;font-size:.8em}.md-effect-1 .md-content{-webkit-transform:scale(.7);-moz-transform:scale(.7);-ms-transform:scale(.7);transform:scale(.7);opacity:0;-webkit-transition:all .3s;-moz-transition:all .3s;-ms-transition:all .3s;transition:all .3s}.md-show.md-effect-1 .md-content{-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1);opacity:1}.md-content>.closer{font-size:18px;position:absolute;right:0;top:0;font-size:24px;padding:4px}"}},Ya=class{constructor(r){t(this,r),this.toc=[],this.selected=null,this.disabled=!1,this.itemClicked=i(this,"itemClicked",7)}_itemClickedHandler(t){const i=t.currentTarget,r=i.getAttribute("href");this.selected=i.parentElement.id,this.itemClicked.emit(r),t.preventDefault()}render(){const t=Xa({disabled:this.disabled});return r("div",{id:"toc",class:t},r("ul",null,this.toc.map(t=>r("li",{id:t.id,class:Xa({selected:this.selected===t.href})},r("a",{href:t.href,onClick:t=>this._itemClickedHandler(t)},t.label)))))}static get assetsDirs(){return["assets"]}get el(){return e(this)}static get style(){return"#toc ul{margin:var(--toc-margin);padding:var(--toc-padding);list-style-type:var(--toc-list-style-type)}#toc ul li{padding:var(--toc-link-padding)}#toc ul li a{color:var(--toc-link-color)}#toc ul li.selected a{color:var(--toc-link-selected-color)}"}};export{Ja as uv_ebook_reader,Ya as uv_ebook_toc};